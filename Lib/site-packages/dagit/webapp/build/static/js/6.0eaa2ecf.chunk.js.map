{"version":3,"sources":["../../../node_modules/codemirror/addon/comment/comment.js","../../../node_modules/codemirror/addon/fold/foldgutter.js","../../../node_modules/codemirror/addon/fold/foldcode.js","../../../node_modules/codemirror/addon/fold/indent-fold.js","../../../node_modules/codemirror/addon/search/jump-to-line.js","../../../node_modules/codemirror/keymap/sublime.js","../../../node_modules/codemirror/addon/edit/matchbrackets.js","../../../node_modules/react-codemirror2/index.js","../../../node_modules/codemirror/lib/codemirror.js","../../../node_modules/codemirror/addon/dialog/dialog.js","../../../node_modules/codemirror/addon/search/searchcursor.js","../../../node_modules/codemirror/addon/hint/show-hint.js","../../../node_modules/codemirror/addon/search/search.js"],"names":["CodeMirror","noOptions","nonWS","Pos","cmp","cmpPos","firstNonWS","str","found","search","probablyInsideString","cm","pos","line","test","getTokenTypeAt","getMode","mode","useInnerComments","innerMode","getModeAt","commands","toggleComment","defineExtension","options","this","minLine","Infinity","ranges","listSelections","i","length","from","to","uncomment","lineComment","self","firstLine","getLine","commentString","end","Math","min","ch","lastLine","pad","padding","blankLines","commentBlankLines","operation","indent","baseString","whitespace","slice","cut","replaceRange","blockCommentStart","fullLines","blockComment","startString","endString","blockCommentEnd","lastLineHasText","lead","blockCommentLead","atCursor","getCursor","empty","somethingSelected","setSelection","didSomething","start","lineString","lines","indexOf","push","endPos","startLine","open","endLine","close","insideStart","insideEnd","getRange","lastStart","lastIndexOf","firstEnd","almostLastStart","openEnd","foundEnd","mod","require","defineOption","val","old","Init","clearGutter","state","foldGutter","gutter","off","onGutterClick","onChange","onViewportChange","onFold","State","parseOptions","updateInViewport","on","opts","indicatorOpen","indicatorFolded","isFolded","marks","findMarks","__isFold","fromPos","find","marker","spec","elt","document","createElement","className","cloneNode","updateFoldInfo","cur","minSize","foldOption","func","clsFolded","classTest","clsOpen","eachLine","mark","gutterMarkers","range","setGutterMarker","cls","RegExp","vp","getViewport","folded","clear","foldCode","clearTimeout","changeUpdate","setTimeout","foldOnChangeTimeSpan","updateViewportTimeSpan","doFold","force","call","finder","getOption","allowFolded","findMarksAt","cleared","myWidget","makeWidget","e","myRange","e_preventDefault","markText","replacedWith","clearOnEnter","signal","widget","text","createTextNode","appendChild","newFoldFunction","rangeFinder","toggleFold","fold","unfold","foldAll","unfoldAll","registerHelper","funcs","Array","prototype","arguments","helpers","getHelpers","defaultOptions","auto","minFoldSize","scanUp","name","undefined","editorOptions","foldOptions","lineIndent","lineNo","spaceTo","countColumn","myIndent","lastLineInFold","dialog","shortText","deflt","f","openDialog","value","selectValueOnOpen","bottom","prompt","getJumpDialog","phrase","interpretLine","string","num","Number","jumpToLine","posStr","match","exec","setCursor","round","lineCount","keyMap","cmds","findPosSubword","doc","dir","clipPos","type","startPos","next","charAt","cat","isWordChar","toUpperCase","moveSubword","extendSelectionsBy","display","shift","extend","head","insertLine","above","isReadOnly","Pass","len","newSelection","last","at","indentLine","anchor","setSelections","execCommand","wordAt","word","addCursorToSelection","newRanges","newAnchor","findPosV","goalColumn","newHead","cursorCoords","left","newRange","isSelectedRange","goSubwordLeft","goSubwordRight","scrollLineUp","info","getScrollInfo","visibleBottomLine","lineAtHeight","top","clientHeight","scrollTo","defaultTextHeight","scrollLineDown","visibleTopLine","splitSelectionByLine","lineRanges","singleSelectionTop","scroll","selectLine","extended","insertLineAfter","insertLineBefore","selectNextOccurrence","fullWord","sublimeFindFullWord","sel","query","getSearchCursor","findNext","addSelection","skipAndSelectNextOccurrence","prevAnchor","prevHead","filter","addCursorToPrevLine","addCursorToNextLine","mirror","selectBetweenBrackets","opening","scanForBracket","closing","puncType","sortLines","caseSensitive","direction","selected","toSort","sort","a","b","au","bu","modifyWordOrSelection","indices","replacements","replaceSelections","getTarget","findAndGoTo","forward","target","findPrevious","selectScope","goToBracket","prev","swapLineUp","linesToMove","newSels","scrollIntoView","swapLineDown","toggleCommentIndented","joinLines","joined","offset","obj","actual","duplicateLine","rangeCount","reverseSortLines","sortLinesInsensitive","reverseSortLinesInsensitive","nextBookmark","sublimeBookmarks","current","prevBookmark","unshift","pop","toggleBookmark","j","sublimeBookmark","k","splice","clearWhenEmpty","clearBookmarks","selectBookmarks","smartBackspace","cursors","indentUnit","cursor","toStartOfLine","column","deletePos","findPosH","prevIndent","findColumn","delLineRight","upcaseAtCursor","downcaseAtCursor","toLowerCase","setSublimeMark","sublimeMark","setBookmark","selectToSublimeMark","deleteToSublimeMark","tmp","sublimeKilled","swapWithSublimeMark","sublimeYank","replaceSelection","showInCenter","findUnder","findUnderPrevious","findAllUnder","matches","primaryIndex","macSublime","normalizeKeyMap","pcSublime","mac","default","macDefault","sublime","ie_lt8","navigator","userAgent","documentMode","matching","bracketRegex","config","findMatchingBracket","where","getLineHandle","afterCursor","getWrapperElement","re","strict","style","maxScanLen","maxScanLineLength","maxScanLines","stack","lineEnd","max","matchBrackets","autoclear","maxHighlightLen","maxHighlightLineLength","highlightNonMatching","focused","focus","doMatchBrackets","currentlyHighlighted","clearHighlighted","oldConfig","_extends","Object","assign","source","key","hasOwnProperty","apply","_typeof","Symbol","iterator","constructor","__extends","_extendStatics","d","setPrototypeOf","__proto__","p","__","create","defineProperty","exports","UnControlled","Controlled","React","SERVER_RENDERED","global","Helper","equals","x","y","_this","ok","keys","tx","ty","every","Shared","editor","props","delegateCursor","position","getDoc","delegateScroll","coordinates","delegateSelection","selection","autoScroll","applyNext","preserved","autoCursor","applyUserDefined","wire","forEach","prop","event","onBlur","onContextMenu","onCopy","onCursor","onCursorActivity","onCut","onDblClick","onDragEnter","onDragLeave","onDragOver","onDragStart","onDrop","onFocus","lineNumber","EditorChangeEvent","onInputRead","onKeyDown","onKeyHandled","onKeyPress","onKeyUp","onMouseDown","onPaste","element","onRenderLine","onScroll","data","onSelection","onTouchStart","onUpdate","_super","applied","appliedNext","appliedUserDefined","deferred","emulating","hydrated","initCb","editorDidConfigure","mounted","hydrate","_options","userDefinedOptions","defaults","some","setOption","resolveChange","initChange","lastChar","setValue","clearHistory","origin","undo","redo","getValue","mirrorChange","setHistory","getHistory","componentDidMount","defineMode","fn","ref","shared","cancel","phantomChange","onBeforeChange","editorDidMount","componentDidUpdate","prevProps","componentWillUnmount","editorWillUnmount","shouldComponentUpdate","nextProps","nextState","render","Component","continueChange","detached","onBeforeChangeCb","detach","editorDidAttach","editorDidDetach","update","module","platform","gecko","ie_upto10","ie_11up","edge","ie","ie_version","webkit","qtwebkit","chrome","presto","safari","vendor","mac_geMountainLion","phantom","ios","maxTouchPoints","android","mobile","chromeOS","windows","presto_version","flipCtrlCmd","captureRightClick","rmClass","node","after","index","removeChildren","count","childNodes","removeChild","firstChild","removeChildrenAndAdd","parent","tag","content","cssText","eltP","setAttribute","contains","child","nodeType","parentNode","host","activeElt","activeElement","body","shadowRoot","addClass","joinClasses","as","split","createRange","endNode","r","setEnd","setStart","createTextRange","moveToElementText","collapse","moveEnd","moveStart","selectInput","select","bind","args","copyObj","overwrite","tabSize","startIndex","startValue","n","nextTab","selectionStart","selectionEnd","_e","Delayed","id","time","handler","onTimeout","array","Date","set","ms","scrollerGap","toString","sel_dontScroll","sel_mouse","sel_move","goal","col","skipped","spaceStrs","spaceStr","lst","arr","map","out","insertSorted","score","priority","nothing","createObj","base","inst","nonASCIISingleCaseWordChar","isWordCharBasic","helper","isEmpty","extendingChars","isExtendingChar","charCodeAt","skipExtendingChars","findFirst","pred","midF","mid","ceil","floor","iterateBidiSections","order","part","level","bidiOther","getBidiPartAt","sticky","bidiOrdering","lowTypes","arabicTypes","charType","code","bidiRE","isNeutral","isStrong","countsAsLeft","countsAsNum","BidiSpan","outerType","types","i$1","i$2","type$1","i$3","prev$1","type$2","i$4","type$3","replace","i$5","cur$1","type$4","i$6","end$1","before","replace$1","j$1","m","i$7","isRTL","j$2","nstart","reverse","getOrder","noHandlers","emitter","addEventListener","attachEvent","_handlers","concat","getHandlers","removeEventListener","detachEvent","handlers","signalDOMEvent","override","preventDefault","defaultPrevented","e_defaultPrevented","codemirrorIgnore","signalCursorActivity","cursorActivity","curOp","cursorActivityHandlers","hasHandler","eventMixin","ctor","returnValue","e_stopPropagation","stopPropagation","cancelBubble","e_stop","e_target","srcElement","e_button","which","button","ctrlKey","zwspSupported","badBidiRects","dragAndDrop","div","zeroWidthElement","measure","offsetHeight","offsetWidth","hasBadBidiRects","txt","r0","getBoundingClientRect","r1","right","splitLinesAuto","result","l","nl","rt","hasSelection","window","getSelection","te","ownerDocument","parentElement","compareEndPoints","hasCopyEvent","oncopy","badZoomedRects","hasBadZoomedRects","normal","fromRange","abs","modes","mimeModes","dependencies","defineMIME","mime","resolveMode","mfactory","modeObj","modeExtensions","exts","helperType","modeProps","prop$1","extendMode","properties","copyState","nstate","startState","a1","a2","StringStream","lineOracle","lastColumnPos","lastColumnValue","lineStart","first","size","Error","chunk","children","sz","chunkSize","getBetween","iter","getLines","updateLineHeight","height","diff","no","h","outer","lh","isLine","lineNumberFor","String","lineNumberFormatter","firstLineNumber","equalCursorPos","copyPos","maxPos","minPos","clipLine","clipToLen","linelen","clipPosArray","eol","sol","peek","eat","eatWhile","eatSpace","skipToEnd","skipTo","backUp","indentation","pattern","consume","caseInsensitive","cased","substr","hideFirstChars","inner","lookAhead","oracle","baseToken","SavedContext","Context","maxLookAhead","baseTokens","baseTokenPos","highlightLine","context","forceToEnd","st","modeGen","lineClasses","runMode","loop","o","overlay","overlays","i_end","opaque","styles","classes","bgClass","textClass","getLineStyles","updateFrontier","getContextBefore","resetState","maxHighlightLength","stateAfter","save","styleClasses","highlightFrontier","modeFrontier","precise","findStartLine","saved","fromSaved","processLine","viewFrom","viewTo","nextLine","startAt","stream","callBlankLine","readToken","blankLine","token","copy","Token","takeToken","asArray","tokens","extractLineClasses","output","lineClass","flattenSpans","curStart","curStyle","addModeClass","mName","minindent","minline","lim","indented","retreatFrontier","sawReadOnlySpans","sawCollapsedSpans","seeReadOnlySpans","seeCollapsedSpans","MarkedSpan","getMarkedSpanFor","spans","span","removeMarkedSpan","addMarkedSpan","markedSpans","attachLine","markedSpansBefore","startCh","isInsert","nw","inclusiveLeft","insertLeft","endsAfter","inclusiveRight","markedSpansAfter","endCh","startsBefore","stretchSpansOverChange","change","full","oldFirst","oldLast","sameLine","span$1","clearEmptySpans","newMarkers","gapMarkers","gap","removeReadOnlyRanges","markers","readOnly","parts","mk","newParts","dfrom","dto","detachMarkedSpans","detachLine","attachMarkedSpans","extraLeft","extraRight","compareCollapsedMarkers","lenDiff","aPos","bPos","fromCmp","toCmp","collapsedSpanAtSide","sps","sp","collapsed","collapsedSpanAtStart","collapsedSpanAtEnd","collapsedSpanAround","conflictingCollapsedRange","visualLine","merged","visualLineEnd","visualLineContinued","visualLineNo","lineN","vis","visualLineEndNo","lineIsHidden","widgetNode","lineIsHiddenInner","heightAtLine","lineObj","lineLength","found$1","findMaxLine","maxLine","maxLineLength","maxLineChanged","Line","estimateHeight","updateLine","estHeight","cleanUpLine","styleToClassCache","styleToClassCacheWithMode","interpretTokenStyle","cache","buildLineContent","lineView","builder","pre","trailingSpace","splitSpaces","rest","addToken","buildToken","buildTokenBadBidi","insertLineContent","externalMeasured","maps","caches","lastChild","querySelector","defaultSpecialCharPlaceholder","title","startStyle","endStyle","css","attributes","displayText","special","specialChars","mustWrap","createDocumentFragment","lastIndex","txt$1","tabWidth","specialCharPlaceholder","fullStyle","attr","trailingBefore","spaceBefore","buildCollapsedSpan","ignoreWidget","input","needsContentAttribute","setUneditable","allText","spanStyle","spanEndStyle","spanStartStyle","nextChange","foundBookmarks","endStyles","upto","tokenText","LineView","hidden","buildViewArray","nextPos","view","operationGroup","pushOperation","op","ops","ownsGroup","delayedCallbacks","fireCallbacksForOps","group","callbacks","cursorActivityCalled","finishOperation","endCb","orphanDelayedCallbacks","signalLater","list","fireOrphanDelayed","delayed","updateLineForChanges","dims","changes","updateLineText","updateLineGutter","updateLineClasses","updateLineWidgets","ensureLineWrapped","replaceChild","zIndex","updateLineBackground","background","wrap","insertBefore","getLineContent","ext","built","wrapClass","gutterBackground","gutterClass","fixedGutter","fixedPos","gutterTotalWidth","lineNumbers","wrap$1","gutterWrap","gutterLeft","lineNumInnerWidth","gutterSpecs","gutterWidth","alignable","isWidget","nextSibling","insertLineWidgets","buildLineElement","insertLineWidgetsFor","allowAbove","widgets","ws","handleMouseEvents","positionLineWidget","noHScroll","width","wrapperWidth","coverGutter","paddingLeft","marginLeft","widgetHeight","parentStyle","gutters","wrapper","clientWidth","eventInWidget","getAttribute","sizer","mover","paddingTop","lineSpace","offsetTop","paddingVert","paddingH","cachedPaddingH","getComputedStyle","currentStyle","parseInt","paddingRight","isNaN","scrollGap","nativeBarWidth","displayWidth","scroller","barWidth","displayHeight","barHeight","ensureLineHeights","rect","wrapping","lineWrapping","curWidth","heights","rects","getClientRects","mapFromLineView","updateExternalMeasurement","lineMeasure","measureChar","bias","measureCharPrepared","prepareMeasureForLine","findViewForLine","findViewIndex","getDimensions","forceUpdate","hasHeights","prepared","varHeight","measureCharInner","bogus","rtop","rbottom","measureText","nullRect","nodeAndOffsetInLineMap","mStart","mEnd","coverStart","coverEnd","getUsefulRect","place","maybeUpdateRectForZooming","rSpan","charWidth","rbot","bot","singleCursorHeightPerLine","screen","logicalXDPI","deviceXDPI","scaleX","scaleY","logicalYDPI","deviceYDPI","clearLineMeasurementCacheFor","clearLineMeasurementCache","externalMeasure","clearCaches","cachedCharWidth","cachedTextHeight","lineNumChars","pageScrollX","pageXOffset","documentElement","scrollLeft","pageScrollY","marginTop","pageYOffset","scrollTop","widgetTopHeight","intoCoordSystem","includeWidgets","yOff","viewOffset","lOff","xOff","fromCoordSystem","coords","localBox","lineSpaceBox","charCoords","preparedMeasure","get","getBidi","partPos","invert","other","estimateCoords","PosWithInfo","outside","xRel","coordsChar","coordsCharInner","rangeEnd","wrappedLineExtent","begin","wrappedLineExtentChar","boxIsAfter","box","ltr","coordsBidiPartWrapped","coordsBidiPart","baseX","chAround","boxAround","atLeft","atStart","_lineNo","closestDist","endX","dist","textHeight","clientLeft","offsetLeft","compensateForHScroll","th","perLine","widgetsHeight","estimateLineHeights","est","posFromMouse","liberal","forRect","space","clientX","clientY","e$1","colDiff","regChange","lendiff","updateLineNumbers","viewChanged","resetView","viewCuttingPoint","cut$1","cutTop","cutBot","regLineChange","oldN","newN","adjustView","countDirtyView","dirty","updateSelection","showSelection","prepareSelection","primary","curFragment","selFragment","primIndex","showCursorWhenSelecting","drawSelectionCursor","drawSelectionRange","cursorHeight","otherCursor","cmpCoords","fragment","leftSide","rightSide","sizerWidth","docLTR","add","drawForLine","fromArg","toArg","lineLen","wrapX","side","extent","toPos","openStart","openRight","topLeft","topRight","botLeft","botRight","sFrom","sTo","fromLine","toLine","singleVLine","leftEnd","rightStart","restartBlink","clearInterval","blinker","cursorDiv","visibility","cursorBlinkRate","setInterval","hasFocus","ensureFocus","delayBlurEvent","delayingBlurEvent","draggingText","selForContextMenu","reset","receivedFocus","updateHeightsInViewport","prevBottom","lineDiv","updateWidgetHeight","chWidth","w","visibleLines","viewport","ensure","ensureFrom","ensureTo","maybeScrollWindow","doScroll","innerHeight","scrollNode","scrollPosIntoView","margin","limit","changed","endCoords","scrollPos","calculateScrollPos","startTop","startLeft","updateScrollTop","setScrollLeft","snapMargin","screentop","docBottom","atTop","atBottom","newTop","gutterSpace","screenleft","screenw","tooWide","addToScrollTop","resolveScrollToPos","ensureCursorVisible","scrollToPos","cursorScrollMargin","scrollToCoords","scrollToRange","scrollToCoordsRange","sPos","updateDisplaySimple","setScrollTop","startWorker","forceScroll","scrollHeight","scrollbars","isScroller","scrollWidth","alignHorizontally","measureForScrollbars","gutterW","docH","viewHeight","viewWidth","barLeft","docHeight","NativeScrollbars","vert","horiz","tabIndex","checkedZeroWidth","minHeight","minWidth","needsH","needsV","sWidth","totalHeight","totalWidth","zeroWidthHack","disableHoriz","enableZeroWidthBar","disableVert","pointerEvents","bar","delay","maybeDisable","elementFromPoint","NullScrollbars","updateScrollbars","startWidth","startHeight","updateScrollbarsInner","sizes","paddingBottom","heightForcer","borderBottom","scrollbarFiller","coverGutterNextToScrollbar","gutterFiller","scrollbarModel","initScrollbars","scrollbarStyle","axis","nextOpId","startOperation","updateInput","typing","changeObjs","selectionChanged","updateMaxLine","endOperation","endOperations","endOperation_R1","endOperation_W1","endOperation_R2","endOperation_W2","endOperation_finish","maybeClipScrollbars","mustUpdate","DisplayUpdate","updatedDisplay","updateDisplayIfNeeded","barMeasure","adjustWidthTo","maxScrollLeft","preparedSelection","takeFocus","setDocumentHeight","postUpdateDisplay","wheelStartX","wheelStartY","maybeHiddenMarkers","unhidden","maybeUnhiddenMarkers","finish","runInOp","methodOp","docMethodOp","highlight","highlightWorker","workTime","changedLines","oldStyles","highlighted","oldCls","newCls","ischange","workDelay","visible","editorIsHidden","wrapperHeight","oldDisplayWidth","events","scrollbarsClipped","marginBottom","borderRightWidth","selectionSnapshot","active","anchorNode","anchorOffset","focusNode","focusOffset","restoreSelection","snapshot","nodeName","removeAllRanges","addRange","renderedView","maybeUpdateLineNumberWidth","viewportMargin","different","lastWrapHeight","lastWrapWidth","toUpdate","selSnapshot","patchDisplay","selectionDiv","reportedViewFrom","reportedViewTo","updateNumbersFrom","container","rm","currentWheelTarget","updateNumber","updateGutterSpace","alignWidgets","comp","align","innerW","lineGutter","lineNumWidth","getGutters","sawLineNumbers","renderGutters","specs","gElt","updateGutters","Display","draggable","wheelDX","wheelDY","activeTouch","init","wheelSamples","wheelPixelsPerUnit","wheelEventDelta","dx","wheelDeltaX","dy","wheelDeltaY","detail","HORIZONTAL_AXIS","VERTICAL_AXIS","wheelDelta","wheelEventPixels","delta","onScrollWheel","canScrollX","canScrollY","pixels","movedX","movedY","sample","Selection","here","there","deepCopy","Range","normalizeSelection","mayTouch","selectionsMayTouch","prim","inv","simpleSelection","changeEnd","adjustForChange","computeSelAfterChange","offsetPos","computeReplacedSel","hint","oldPrev","newPrev","loadMode","modeOption","resetModeState","isWholeLineUpdate","wholeLineUpdateBefore","updateDoc","spansFor","linesFor","lastText","lastSpans","nlines","insert","remove","added","added$1","added$2","linkedDocs","sharedHistOnly","propagate","skip","sharedHist","linked","rel","attachDoc","setDirectionClass","directionChanged","History","done","undone","undoDepth","lastModTime","lastSelTime","lastOp","lastSelOp","lastOrigin","lastSelOrigin","generation","maxGeneration","historyChangeFromChange","histChange","attachLocalSpans","clearSelectionEvents","lastChangeEvent","hist","addChangeToHistory","selAfter","opId","history","historyEventDelay","pushSelectionToHistory","selectionEventCanBeMerged","addSelectionToHistory","clearRedo","dest","existing","removeClearedSpans","explicitlyCleared","getOldSpans","mergeOldSpans","stretched","oldCur","stretchCur","copyHistoryArray","newGroup","instantiateSel","newChanges","extendRange","posBefore","extendSelection","extendSelections","heads","replaceOneSelection","setSimpleSelection","filterSelectionChange","setSelectionReplaceHistory","setSelectionNoUndo","NaN","setSelectionInner","skipAtomicInSelection","reCheckSelection","mayClear","skipAtomic","skipAtomicInner","oldPos","preventCursorLeft","selectLeft","preventCursorRight","selectRight","atomic","near","movePos","far","cantEdit","selectAll","filterChange","canceled","makeChange","ignoreReadOnly","suppressEdits","makeChangeInner","makeChangeSingleDoc","rebased","rebaseHist","makeChangeFromHistory","allowSelectionOnly","suppress","antiChanges","returned","v","shiftDoc","distance","removed","makeChangeSingleDocInEditor","recomputeMaxLength","checkWidthStart","changesHandler","changeHandler","splitLines","rebaseHistSelSingle","rebaseHistArray","sub","copied","changeLine","handle","changeType","LeafChunk","BranchChunk","removeInner","insertInner","iterN","oldHeight","remaining","leaf","maybeSpill","me","sibling","myIndex","used","LineWidget","opt","adjustScrollWhenAboveVisible","addLineWidget","insertAt","aboveVisible","this$1","oldH","nextMarkerId","TextMarker","markTextShared","addToHistory","curLine","withOp","visual","dHeight","SharedTextMarker","isParent","findSharedMarkers","copySharedMarkers","mFrom","mTo","subMark","detachSharedMarkers","subMarker","nextDocId","Doc","lineSep","cleanGeneration","join","lineSeparator","getLineNumber","getLineHandleVisualStart","getSelections","dup","newSel","undoSelection","redoSelection","setExtending","getExtending","historySize","markClean","changeGeneration","forceSplit","isClean","gen","histData","gutterID","lineInfo","addLineClass","removeLineClass","removeLineWidget","realOpts","getAllMarks","posFromIndex","sepSize","indexFromPos","copyHistory","linkedDoc","unlinkDoc","splitIds","iterLinkedDocs","getEditor","setDirection","lastDrop","clearDragCursor","files","dataTransfer","FileReader","File","read","markAsReadAndPasteIfAllFilesAreRead","t","readTextFromFile","file","allowDropFileTypes","reader","onerror","onload","readAsText","text$1","getData","setData","effectAllowed","setDragImage","img","src","_top","frag","dragCursor","forEachCodeMirror","getElementsByClassName","byClass","editors","globalsRegistered","ensureGlobalHandlers","registerGlobalHandlers","resizeTimer","onResize","setSize","keyNames","3","8","9","13","16","17","18","19","20","27","32","33","34","35","36","37","38","39","40","44","45","46","59","61","91","92","93","106","107","109","110","111","145","173","186","187","188","189","190","191","192","219","220","221","222","224","63232","63233","63234","63235","63272","63273","63275","63276","63277","63302","fromCharCode","normalizeKeyName","alt","ctrl","cmd","keymap","keyname","lookupKey","getKeyMap","fallthrough","isModifierKey","keyCode","addModifierNames","noShift","altKey","metaKey","shiftKey","keyName","altGraphKey","deleteNearSelection","compute","kill","toKill","replaced","moveCharLogically","moveLogically","endOfLine","visually","prep","targetTop","moveVisually","bidi","mv","getWrappedLineExtent","moveInStorageOrder","searchInVisualLine","getRes","res","nextCh","basic","pcDefault","emacsy","singleSelection","killLine","deleteLine","delLineLeft","delWrappedLineLeft","delWrappedLineRight","rightPos","goDocStart","goDocEnd","goLineStart","goLineStartSmart","lineStartSmart","goLineEnd","goLineRight","goLineLeft","goLineLeftSmart","goLineUp","moveV","goLineDown","goPageUp","goPageDown","goCharLeft","moveH","goCharRight","goColumnLeft","goColumnRight","goWordLeft","goGroupRight","goGroupLeft","goWordRight","delCharBefore","deleteH","delCharAfter","delWordBefore","delWordAfter","delGroupBefore","delGroupAfter","indentAuto","indentSelection","indentMore","indentLess","insertTab","insertSoftTab","spaces","defaultTab","transposeChars","newlineAndIndent","sels","openLine","toggleOverwrite","inWS","doHandleBinding","bound","dropShift","ensurePolled","prevShift","lookupKeyForEditor","keyMaps","extraKeys","stopSeq","dispatchKey","seq","keySeq","dispatchKeyInner","handleKeyBinding","motion","handleCharBinding","lastStoppedKey","getField","handled","showCrossHair","up","charCode","lastClick","lastDoubleClick","DOUBLECLICK_DELAY","PastClick","clickRepeat","now","compare","supportsTouch","clickInGutter","repeat","selectingText","handleMappedButton","leftButtonDown","configureMouse","option","unit","addNew","moveOnDrag","contained","behavior","dragDrop","leftButtonStartDrag","leftButtonSelect","moved","dragEnd","mouseMove","dragStart","preventScroll","e2","rangeForUnit","findWordAt","ourRange","ourIndex","startSel","lastPos","extendTo","startCol","posCol","leftPos","oldRange","ranges$1","bidiSimplify","editorSize","counter","curCount","move","buttons","anchorLine","boundary","headIndex","usePart","gutterEvent","prevent","mX","mY","touches","lineBox","g","contextMenuInGutter","themeChanged","theme","optionHandlers","defineOptions","notOnInit","newBreaks","refresh","getInputField","spellcheck","autocorrect","autocapitalize","attach","wrappingChanged","integer","blur","readOnlyChanged","screenReaderLabelChanged","dragDropChanged","resetPosition","dragFunctions","toggle","enter","over","leave","drop","inputStyles","inputStyle","pasteIncoming","cutIncoming","autofocus","registerEventHandlers","finishInit","initHooks","textRendering","touchFinished","prevTouch","finishTouch","isMouseLikeTouchEvent","touch","radiusX","radiusY","farAway","pageX","pageY","inp","how","aggressive","curSpace","curSpaceString","indentString","indentWithTabs","pos$1","defineInitHook","lastCopied","setLastCopied","newLastCopied","applyTextInput","inserted","deleted","recent","paste","textLines","multiPaste","pasteLinesPerSelection","lineWise","changeEvent","triggerElectric","handlePaste","pasted","clipboardData","disableInput","electricChars","smartIndent","electricInput","copyableRanges","lineRange","disableBrowserMagic","field","hiddenTextarea","border","addEditorMethods","addKeyMap","removeKeyMap","addOverlay","modeSpec","removeOverlay","getTokenAt","getLineTokens","getHelper","help","_global","getStateAfter","defaultCharWidth","addWidget","vspace","hspace","triggerOnKeyDown","triggerOnKeyPress","triggerOnKeyUp","triggerOnMouseDown","amount","hitSide","rtlMoveVisually","goals","headPos","startChar","check","interpret","swapDoc","phraseText","phrases","getScrollerElement","getGutterElement","registerGlobalHelper","predicate","origDir","lineDir","findNextLine","moveOnce","boundToLine","astral","sawType","pageSize","moveAmount","ContentEditableInput","lastAnchorNode","lastAnchorOffset","lastFocusNode","lastFocusOffset","polling","composing","gracePeriod","readDOMTimeout","posToDOM","isInGutter","scan","badPos","bad","domTextBetween","extraLinebreak","recognizeMarker","addText","walk","cmText","markerID","isBlock","textContent","nodeValue","domToPos","lineNode","locateNodeInLineView","textNode","topNode","curNode","previousSibling","dist$1","belongsToInput","onCopyCut","lineWiseCopyCut","clearData","kludge","hadFocus","showPrimarySelection","contentEditable","updateFromDOM","readFromDOMSoon","forceCompositionEnd","label","removeAttribute","showMultipleSelections","curAnchor","curFocus","rng","getRangeAt","startGracePeriod","rememberSelection","selectionInEditor","commonAncestorContainer","poll","pollSelection","pollInterval","pollContent","fromIndex","fromNode","toNode","toIndex","newText","oldText","cutFront","cutEnd","oldTop","maxCutFront","newBot","oldBot","maxCutEnd","chFrom","chTo","TextareaInput","prevInput","pollingFast","fromTextArea","textarea","tabindex","placeholder","realSubmit","form","leaveSubmitMethodAlone","submit","wrappedSubmit","getTextArea","toTextArea","addLegacyProps","createField","prepareCopyCut","fastPoll","dispatchEvent","Event","_display","moveInputWithCursor","wrapOff","lineOff","teTop","teLeft","drawn","contextMenuPending","slowPoll","missed","same","resetSelectionOnContextMenu","oldScrollY","oldCSS","oldWrapperCSS","wrapperBox","offsetParent","scrollY","rehide","detectingSelectAll","prepareSelectAllHack","mouseup","extval","disabled","dontDelegate","method","defineDocExtension","version","factory","dialogDiv","template","innerHTML","closeNotification","newVal","currentNotificationClose","callback","closed","onClose","getElementsByTagName","onInput","closeOnEnter","closeOnBlur","evt","relatedTarget","blurring","doneTimer","duration","noFold","regexpFlags","regexp","flags","ignoreCase","multiline","ensureFlags","maybeMultiline","searchRegexpForward","searchRegexpForwardMultiline","inside","lastMatchIn","endMargin","newMatch","searchRegexpBackward","searchRegexpBackwardMultiline","adjustPos","orig","foldFunc","searchStringForward","caseFold","cutFrom","searchStringBackward","topString","SearchCursor","atOccurrence","normalize","HINT_ELEMENT_CLASS","ACTIVE_HINT_ELEMENT_CLASS","Completion","debounce","tick","startLen","updateOnCursorActivity","activityFunc","showHint","getHints","async","newOpts","selections","supportsSelection","completionActive","completion","requestAnimationFrame","cancelAnimationFrame","hintOptions","resolve","getText","buildKeyMap","baseMap","Up","moveFocus","Down","PageUp","menuSize","PageDown","Home","setFocus","End","Enter","pick","Tab","Esc","custom","customKeys","ourMap","addBinding","extra","getHintElement","hintsElement","el","Widget","picked","parentWindow","defaultView","hints","selectedHint","completions","hintId","alignWithWord","below","offsetParentPosition","bodyPosition","winW","innerWidth","winH","startScroll","moveOnOverlap","DOMRect","scrolls","paddingForScrollbar","closingOnBlur","overlapX","avoidWrap","changeActive","screenAmount","closeOnUnfocus","curScroll","point","completeOnSingleClick","selectedHintRange","getSelectedHintRange","scrollToActive","applicableHelpers","fetchHints","then","resolveAutoHints","words","resolved","app","run","fromList","anyword","closeOnPick","identStart","closeCharacters","disable","myTick","finishUpdate","completeSingle","node1","node2","firstNode","scrollMargin","term","autocomplete","searchOverlay","SearchState","posFrom","posTo","lastQuery","getSearchState","queryCaseInsensitive","persistentDialog","onEnter","clearSearch","confirmDialog","fs","openConfirm","confirm","parseString","parseQuery","isRE","startSearch","queryText","showMatchesOnScrollbar","annotate","doSearch","rev","persistent","immediate","q","hiding","searchNext","opacity","_","getQueryDialog","getReplaceQueryDialog","getReplacementQueryDialog","getDoReplaceConfirm","replaceAll","all","dialogText","advance","doReplace","findPersistent","findPersistentNext","findPersistentPrev","findPrev"],"mappings":"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","file":"static/js/6.0eaa2ecf.chunk.js","sourcesContent":["// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: https://codemirror.net/LICENSE\n\n(function(mod) {\n  if (typeof exports == \"object\" && typeof module == \"object\") // CommonJS\n    mod(require(\"../../lib/codemirror\"));\n  else if (typeof define == \"function\" && define.amd) // AMD\n    define([\"../../lib/codemirror\"], mod);\n  else // Plain browser env\n    mod(CodeMirror);\n})(function(CodeMirror) {\n  \"use strict\";\n\n  var noOptions = {};\n  var nonWS = /[^\\s\\u00a0]/;\n  var Pos = CodeMirror.Pos, cmp = CodeMirror.cmpPos;\n\n  function firstNonWS(str) {\n    var found = str.search(nonWS);\n    return found == -1 ? 0 : found;\n  }\n\n  CodeMirror.commands.toggleComment = function(cm) {\n    cm.toggleComment();\n  };\n\n  CodeMirror.defineExtension(\"toggleComment\", function(options) {\n    if (!options) options = noOptions;\n    var cm = this;\n    var minLine = Infinity, ranges = this.listSelections(), mode = null;\n    for (var i = ranges.length - 1; i >= 0; i--) {\n      var from = ranges[i].from(), to = ranges[i].to();\n      if (from.line >= minLine) continue;\n      if (to.line >= minLine) to = Pos(minLine, 0);\n      minLine = from.line;\n      if (mode == null) {\n        if (cm.uncomment(from, to, options)) mode = \"un\";\n        else { cm.lineComment(from, to, options); mode = \"line\"; }\n      } else if (mode == \"un\") {\n        cm.uncomment(from, to, options);\n      } else {\n        cm.lineComment(from, to, options);\n      }\n    }\n  });\n\n  // Rough heuristic to try and detect lines that are part of multi-line string\n  function probablyInsideString(cm, pos, line) {\n    return /\\bstring\\b/.test(cm.getTokenTypeAt(Pos(pos.line, 0))) && !/^[\\'\\\"\\`]/.test(line)\n  }\n\n  function getMode(cm, pos) {\n    var mode = cm.getMode()\n    return mode.useInnerComments === false || !mode.innerMode ? mode : cm.getModeAt(pos)\n  }\n\n  CodeMirror.defineExtension(\"lineComment\", function(from, to, options) {\n    if (!options) options = noOptions;\n    var self = this, mode = getMode(self, from);\n    var firstLine = self.getLine(from.line);\n    if (firstLine == null || probablyInsideString(self, from, firstLine)) return;\n\n    var commentString = options.lineComment || mode.lineComment;\n    if (!commentString) {\n      if (options.blockCommentStart || mode.blockCommentStart) {\n        options.fullLines = true;\n        self.blockComment(from, to, options);\n      }\n      return;\n    }\n\n    var end = Math.min(to.ch != 0 || to.line == from.line ? to.line + 1 : to.line, self.lastLine() + 1);\n    var pad = options.padding == null ? \" \" : options.padding;\n    var blankLines = options.commentBlankLines || from.line == to.line;\n\n    self.operation(function() {\n      if (options.indent) {\n        var baseString = null;\n        for (var i = from.line; i < end; ++i) {\n          var line = self.getLine(i);\n          var whitespace = line.slice(0, firstNonWS(line));\n          if (baseString == null || baseString.length > whitespace.length) {\n            baseString = whitespace;\n          }\n        }\n        for (var i = from.line; i < end; ++i) {\n          var line = self.getLine(i), cut = baseString.length;\n          if (!blankLines && !nonWS.test(line)) continue;\n          if (line.slice(0, cut) != baseString) cut = firstNonWS(line);\n          self.replaceRange(baseString + commentString + pad, Pos(i, 0), Pos(i, cut));\n        }\n      } else {\n        for (var i = from.line; i < end; ++i) {\n          if (blankLines || nonWS.test(self.getLine(i)))\n            self.replaceRange(commentString + pad, Pos(i, 0));\n        }\n      }\n    });\n  });\n\n  CodeMirror.defineExtension(\"blockComment\", function(from, to, options) {\n    if (!options) options = noOptions;\n    var self = this, mode = getMode(self, from);\n    var startString = options.blockCommentStart || mode.blockCommentStart;\n    var endString = options.blockCommentEnd || mode.blockCommentEnd;\n    if (!startString || !endString) {\n      if ((options.lineComment || mode.lineComment) && options.fullLines != false)\n        self.lineComment(from, to, options);\n      return;\n    }\n    if (/\\bcomment\\b/.test(self.getTokenTypeAt(Pos(from.line, 0)))) return\n\n    var end = Math.min(to.line, self.lastLine());\n    if (end != from.line && to.ch == 0 && nonWS.test(self.getLine(end))) --end;\n\n    var pad = options.padding == null ? \" \" : options.padding;\n    if (from.line > end) return;\n\n    self.operation(function() {\n      if (options.fullLines != false) {\n        var lastLineHasText = nonWS.test(self.getLine(end));\n        self.replaceRange(pad + endString, Pos(end));\n        self.replaceRange(startString + pad, Pos(from.line, 0));\n        var lead = options.blockCommentLead || mode.blockCommentLead;\n        if (lead != null) for (var i = from.line + 1; i <= end; ++i)\n          if (i != end || lastLineHasText)\n            self.replaceRange(lead + pad, Pos(i, 0));\n      } else {\n        var atCursor = cmp(self.getCursor(\"to\"), to) == 0, empty = !self.somethingSelected()\n        self.replaceRange(endString, to);\n        if (atCursor) self.setSelection(empty ? to : self.getCursor(\"from\"), to)\n        self.replaceRange(startString, from);\n      }\n    });\n  });\n\n  CodeMirror.defineExtension(\"uncomment\", function(from, to, options) {\n    if (!options) options = noOptions;\n    var self = this, mode = getMode(self, from);\n    var end = Math.min(to.ch != 0 || to.line == from.line ? to.line : to.line - 1, self.lastLine()), start = Math.min(from.line, end);\n\n    // Try finding line comments\n    var lineString = options.lineComment || mode.lineComment, lines = [];\n    var pad = options.padding == null ? \" \" : options.padding, didSomething;\n    lineComment: {\n      if (!lineString) break lineComment;\n      for (var i = start; i <= end; ++i) {\n        var line = self.getLine(i);\n        var found = line.indexOf(lineString);\n        if (found > -1 && !/comment/.test(self.getTokenTypeAt(Pos(i, found + 1)))) found = -1;\n        if (found == -1 && nonWS.test(line)) break lineComment;\n        if (found > -1 && nonWS.test(line.slice(0, found))) break lineComment;\n        lines.push(line);\n      }\n      self.operation(function() {\n        for (var i = start; i <= end; ++i) {\n          var line = lines[i - start];\n          var pos = line.indexOf(lineString), endPos = pos + lineString.length;\n          if (pos < 0) continue;\n          if (line.slice(endPos, endPos + pad.length) == pad) endPos += pad.length;\n          didSomething = true;\n          self.replaceRange(\"\", Pos(i, pos), Pos(i, endPos));\n        }\n      });\n      if (didSomething) return true;\n    }\n\n    // Try block comments\n    var startString = options.blockCommentStart || mode.blockCommentStart;\n    var endString = options.blockCommentEnd || mode.blockCommentEnd;\n    if (!startString || !endString) return false;\n    var lead = options.blockCommentLead || mode.blockCommentLead;\n    var startLine = self.getLine(start), open = startLine.indexOf(startString)\n    if (open == -1) return false\n    var endLine = end == start ? startLine : self.getLine(end)\n    var close = endLine.indexOf(endString, end == start ? open + startString.length : 0);\n    var insideStart = Pos(start, open + 1), insideEnd = Pos(end, close + 1)\n    if (close == -1 ||\n        !/comment/.test(self.getTokenTypeAt(insideStart)) ||\n        !/comment/.test(self.getTokenTypeAt(insideEnd)) ||\n        self.getRange(insideStart, insideEnd, \"\\n\").indexOf(endString) > -1)\n      return false;\n\n    // Avoid killing block comments completely outside the selection.\n    // Positions of the last startString before the start of the selection, and the first endString after it.\n    var lastStart = startLine.lastIndexOf(startString, from.ch);\n    var firstEnd = lastStart == -1 ? -1 : startLine.slice(0, from.ch).indexOf(endString, lastStart + startString.length);\n    if (lastStart != -1 && firstEnd != -1 && firstEnd + endString.length != from.ch) return false;\n    // Positions of the first endString after the end of the selection, and the last startString before it.\n    firstEnd = endLine.indexOf(endString, to.ch);\n    var almostLastStart = endLine.slice(to.ch).lastIndexOf(startString, firstEnd - to.ch);\n    lastStart = (firstEnd == -1 || almostLastStart == -1) ? -1 : to.ch + almostLastStart;\n    if (firstEnd != -1 && lastStart != -1 && lastStart != to.ch) return false;\n\n    self.operation(function() {\n      self.replaceRange(\"\", Pos(end, close - (pad && endLine.slice(close - pad.length, close) == pad ? pad.length : 0)),\n                        Pos(end, close + endString.length));\n      var openEnd = open + startString.length;\n      if (pad && startLine.slice(openEnd, openEnd + pad.length) == pad) openEnd += pad.length;\n      self.replaceRange(\"\", Pos(start, open), Pos(start, openEnd));\n      if (lead) for (var i = start + 1; i <= end; ++i) {\n        var line = self.getLine(i), found = line.indexOf(lead);\n        if (found == -1 || nonWS.test(line.slice(0, found))) continue;\n        var foundEnd = found + lead.length;\n        if (pad && line.slice(foundEnd, foundEnd + pad.length) == pad) foundEnd += pad.length;\n        self.replaceRange(\"\", Pos(i, found), Pos(i, foundEnd));\n      }\n    });\n    return true;\n  });\n});\n","// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: https://codemirror.net/LICENSE\n\n(function(mod) {\n  if (typeof exports == \"object\" && typeof module == \"object\") // CommonJS\n    mod(require(\"../../lib/codemirror\"), require(\"./foldcode\"));\n  else if (typeof define == \"function\" && define.amd) // AMD\n    define([\"../../lib/codemirror\", \"./foldcode\"], mod);\n  else // Plain browser env\n    mod(CodeMirror);\n})(function(CodeMirror) {\n  \"use strict\";\n\n  CodeMirror.defineOption(\"foldGutter\", false, function(cm, val, old) {\n    if (old && old != CodeMirror.Init) {\n      cm.clearGutter(cm.state.foldGutter.options.gutter);\n      cm.state.foldGutter = null;\n      cm.off(\"gutterClick\", onGutterClick);\n      cm.off(\"changes\", onChange);\n      cm.off(\"viewportChange\", onViewportChange);\n      cm.off(\"fold\", onFold);\n      cm.off(\"unfold\", onFold);\n      cm.off(\"swapDoc\", onChange);\n    }\n    if (val) {\n      cm.state.foldGutter = new State(parseOptions(val));\n      updateInViewport(cm);\n      cm.on(\"gutterClick\", onGutterClick);\n      cm.on(\"changes\", onChange);\n      cm.on(\"viewportChange\", onViewportChange);\n      cm.on(\"fold\", onFold);\n      cm.on(\"unfold\", onFold);\n      cm.on(\"swapDoc\", onChange);\n    }\n  });\n\n  var Pos = CodeMirror.Pos;\n\n  function State(options) {\n    this.options = options;\n    this.from = this.to = 0;\n  }\n\n  function parseOptions(opts) {\n    if (opts === true) opts = {};\n    if (opts.gutter == null) opts.gutter = \"CodeMirror-foldgutter\";\n    if (opts.indicatorOpen == null) opts.indicatorOpen = \"CodeMirror-foldgutter-open\";\n    if (opts.indicatorFolded == null) opts.indicatorFolded = \"CodeMirror-foldgutter-folded\";\n    return opts;\n  }\n\n  function isFolded(cm, line) {\n    var marks = cm.findMarks(Pos(line, 0), Pos(line + 1, 0));\n    for (var i = 0; i < marks.length; ++i) {\n      if (marks[i].__isFold) {\n        var fromPos = marks[i].find(-1);\n        if (fromPos && fromPos.line === line)\n          return marks[i];\n      }\n    }\n  }\n\n  function marker(spec) {\n    if (typeof spec == \"string\") {\n      var elt = document.createElement(\"div\");\n      elt.className = spec + \" CodeMirror-guttermarker-subtle\";\n      return elt;\n    } else {\n      return spec.cloneNode(true);\n    }\n  }\n\n  function updateFoldInfo(cm, from, to) {\n    var opts = cm.state.foldGutter.options, cur = from - 1;\n    var minSize = cm.foldOption(opts, \"minFoldSize\");\n    var func = cm.foldOption(opts, \"rangeFinder\");\n    // we can reuse the built-in indicator element if its className matches the new state\n    var clsFolded = typeof opts.indicatorFolded == \"string\" && classTest(opts.indicatorFolded);\n    var clsOpen = typeof opts.indicatorOpen == \"string\" && classTest(opts.indicatorOpen);\n    cm.eachLine(from, to, function(line) {\n      ++cur;\n      var mark = null;\n      var old = line.gutterMarkers;\n      if (old) old = old[opts.gutter];\n      if (isFolded(cm, cur)) {\n        if (clsFolded && old && clsFolded.test(old.className)) return;\n        mark = marker(opts.indicatorFolded);\n      } else {\n        var pos = Pos(cur, 0);\n        var range = func && func(cm, pos);\n        if (range && range.to.line - range.from.line >= minSize) {\n          if (clsOpen && old && clsOpen.test(old.className)) return;\n          mark = marker(opts.indicatorOpen);\n        }\n      }\n      if (!mark && !old) return;\n      cm.setGutterMarker(line, opts.gutter, mark);\n    });\n  }\n\n  // copied from CodeMirror/src/util/dom.js\n  function classTest(cls) { return new RegExp(\"(^|\\\\s)\" + cls + \"(?:$|\\\\s)\\\\s*\") }\n\n  function updateInViewport(cm) {\n    var vp = cm.getViewport(), state = cm.state.foldGutter;\n    if (!state) return;\n    cm.operation(function() {\n      updateFoldInfo(cm, vp.from, vp.to);\n    });\n    state.from = vp.from; state.to = vp.to;\n  }\n\n  function onGutterClick(cm, line, gutter) {\n    var state = cm.state.foldGutter;\n    if (!state) return;\n    var opts = state.options;\n    if (gutter != opts.gutter) return;\n    var folded = isFolded(cm, line);\n    if (folded) folded.clear();\n    else cm.foldCode(Pos(line, 0), opts);\n  }\n\n  function onChange(cm) {\n    var state = cm.state.foldGutter;\n    if (!state) return;\n    var opts = state.options;\n    state.from = state.to = 0;\n    clearTimeout(state.changeUpdate);\n    state.changeUpdate = setTimeout(function() { updateInViewport(cm); }, opts.foldOnChangeTimeSpan || 600);\n  }\n\n  function onViewportChange(cm) {\n    var state = cm.state.foldGutter;\n    if (!state) return;\n    var opts = state.options;\n    clearTimeout(state.changeUpdate);\n    state.changeUpdate = setTimeout(function() {\n      var vp = cm.getViewport();\n      if (state.from == state.to || vp.from - state.to > 20 || state.from - vp.to > 20) {\n        updateInViewport(cm);\n      } else {\n        cm.operation(function() {\n          if (vp.from < state.from) {\n            updateFoldInfo(cm, vp.from, state.from);\n            state.from = vp.from;\n          }\n          if (vp.to > state.to) {\n            updateFoldInfo(cm, state.to, vp.to);\n            state.to = vp.to;\n          }\n        });\n      }\n    }, opts.updateViewportTimeSpan || 400);\n  }\n\n  function onFold(cm, from) {\n    var state = cm.state.foldGutter;\n    if (!state) return;\n    var line = from.line;\n    if (line >= state.from && line < state.to)\n      updateFoldInfo(cm, line, line + 1);\n  }\n});\n","// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: https://codemirror.net/LICENSE\n\n(function(mod) {\n  if (typeof exports == \"object\" && typeof module == \"object\") // CommonJS\n    mod(require(\"../../lib/codemirror\"));\n  else if (typeof define == \"function\" && define.amd) // AMD\n    define([\"../../lib/codemirror\"], mod);\n  else // Plain browser env\n    mod(CodeMirror);\n})(function(CodeMirror) {\n  \"use strict\";\n\n  function doFold(cm, pos, options, force) {\n    if (options && options.call) {\n      var finder = options;\n      options = null;\n    } else {\n      var finder = getOption(cm, options, \"rangeFinder\");\n    }\n    if (typeof pos == \"number\") pos = CodeMirror.Pos(pos, 0);\n    var minSize = getOption(cm, options, \"minFoldSize\");\n\n    function getRange(allowFolded) {\n      var range = finder(cm, pos);\n      if (!range || range.to.line - range.from.line < minSize) return null;\n      var marks = cm.findMarksAt(range.from);\n      for (var i = 0; i < marks.length; ++i) {\n        if (marks[i].__isFold && force !== \"fold\") {\n          if (!allowFolded) return null;\n          range.cleared = true;\n          marks[i].clear();\n        }\n      }\n      return range;\n    }\n\n    var range = getRange(true);\n    if (getOption(cm, options, \"scanUp\")) while (!range && pos.line > cm.firstLine()) {\n      pos = CodeMirror.Pos(pos.line - 1, 0);\n      range = getRange(false);\n    }\n    if (!range || range.cleared || force === \"unfold\") return;\n\n    var myWidget = makeWidget(cm, options, range);\n    CodeMirror.on(myWidget, \"mousedown\", function(e) {\n      myRange.clear();\n      CodeMirror.e_preventDefault(e);\n    });\n    var myRange = cm.markText(range.from, range.to, {\n      replacedWith: myWidget,\n      clearOnEnter: getOption(cm, options, \"clearOnEnter\"),\n      __isFold: true\n    });\n    myRange.on(\"clear\", function(from, to) {\n      CodeMirror.signal(cm, \"unfold\", cm, from, to);\n    });\n    CodeMirror.signal(cm, \"fold\", cm, range.from, range.to);\n  }\n\n  function makeWidget(cm, options, range) {\n    var widget = getOption(cm, options, \"widget\");\n\n    if (typeof widget == \"function\") {\n      widget = widget(range.from, range.to);\n    }\n\n    if (typeof widget == \"string\") {\n      var text = document.createTextNode(widget);\n      widget = document.createElement(\"span\");\n      widget.appendChild(text);\n      widget.className = \"CodeMirror-foldmarker\";\n    } else if (widget) {\n      widget = widget.cloneNode(true)\n    }\n    return widget;\n  }\n\n  // Clumsy backwards-compatible interface\n  CodeMirror.newFoldFunction = function(rangeFinder, widget) {\n    return function(cm, pos) { doFold(cm, pos, {rangeFinder: rangeFinder, widget: widget}); };\n  };\n\n  // New-style interface\n  CodeMirror.defineExtension(\"foldCode\", function(pos, options, force) {\n    doFold(this, pos, options, force);\n  });\n\n  CodeMirror.defineExtension(\"isFolded\", function(pos) {\n    var marks = this.findMarksAt(pos);\n    for (var i = 0; i < marks.length; ++i)\n      if (marks[i].__isFold) return true;\n  });\n\n  CodeMirror.commands.toggleFold = function(cm) {\n    cm.foldCode(cm.getCursor());\n  };\n  CodeMirror.commands.fold = function(cm) {\n    cm.foldCode(cm.getCursor(), null, \"fold\");\n  };\n  CodeMirror.commands.unfold = function(cm) {\n    cm.foldCode(cm.getCursor(), null, \"unfold\");\n  };\n  CodeMirror.commands.foldAll = function(cm) {\n    cm.operation(function() {\n      for (var i = cm.firstLine(), e = cm.lastLine(); i <= e; i++)\n        cm.foldCode(CodeMirror.Pos(i, 0), null, \"fold\");\n    });\n  };\n  CodeMirror.commands.unfoldAll = function(cm) {\n    cm.operation(function() {\n      for (var i = cm.firstLine(), e = cm.lastLine(); i <= e; i++)\n        cm.foldCode(CodeMirror.Pos(i, 0), null, \"unfold\");\n    });\n  };\n\n  CodeMirror.registerHelper(\"fold\", \"combine\", function() {\n    var funcs = Array.prototype.slice.call(arguments, 0);\n    return function(cm, start) {\n      for (var i = 0; i < funcs.length; ++i) {\n        var found = funcs[i](cm, start);\n        if (found) return found;\n      }\n    };\n  });\n\n  CodeMirror.registerHelper(\"fold\", \"auto\", function(cm, start) {\n    var helpers = cm.getHelpers(start, \"fold\");\n    for (var i = 0; i < helpers.length; i++) {\n      var cur = helpers[i](cm, start);\n      if (cur) return cur;\n    }\n  });\n\n  var defaultOptions = {\n    rangeFinder: CodeMirror.fold.auto,\n    widget: \"\\u2194\",\n    minFoldSize: 0,\n    scanUp: false,\n    clearOnEnter: true\n  };\n\n  CodeMirror.defineOption(\"foldOptions\", null);\n\n  function getOption(cm, options, name) {\n    if (options && options[name] !== undefined)\n      return options[name];\n    var editorOptions = cm.options.foldOptions;\n    if (editorOptions && editorOptions[name] !== undefined)\n      return editorOptions[name];\n    return defaultOptions[name];\n  }\n\n  CodeMirror.defineExtension(\"foldOption\", function(options, name) {\n    return getOption(this, options, name);\n  });\n});\n","// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: https://codemirror.net/LICENSE\n\n(function(mod) {\n  if (typeof exports == \"object\" && typeof module == \"object\") // CommonJS\n    mod(require(\"../../lib/codemirror\"));\n  else if (typeof define == \"function\" && define.amd) // AMD\n    define([\"../../lib/codemirror\"], mod);\n  else // Plain browser env\n    mod(CodeMirror);\n})(function(CodeMirror) {\n\"use strict\";\n\nfunction lineIndent(cm, lineNo) {\n  var text = cm.getLine(lineNo)\n  var spaceTo = text.search(/\\S/)\n  if (spaceTo == -1 || /\\bcomment\\b/.test(cm.getTokenTypeAt(CodeMirror.Pos(lineNo, spaceTo + 1))))\n    return -1\n  return CodeMirror.countColumn(text, null, cm.getOption(\"tabSize\"))\n}\n\nCodeMirror.registerHelper(\"fold\", \"indent\", function(cm, start) {\n  var myIndent = lineIndent(cm, start.line)\n  if (myIndent < 0) return\n  var lastLineInFold = null\n\n  // Go through lines until we find a line that definitely doesn't belong in\n  // the block we're folding, or to the end.\n  for (var i = start.line + 1, end = cm.lastLine(); i <= end; ++i) {\n    var indent = lineIndent(cm, i)\n    if (indent == -1) {\n    } else if (indent > myIndent) {\n      // Lines with a greater indent are considered part of the block.\n      lastLineInFold = i;\n    } else {\n      // If this line has non-space, non-comment content, and is\n      // indented less or equal to the start line, it is the start of\n      // another block.\n      break;\n    }\n  }\n  if (lastLineInFold) return {\n    from: CodeMirror.Pos(start.line, cm.getLine(start.line).length),\n    to: CodeMirror.Pos(lastLineInFold, cm.getLine(lastLineInFold).length)\n  };\n});\n\n});\n","// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: https://codemirror.net/LICENSE\n\n// Defines jumpToLine command. Uses dialog.js if present.\n\n(function(mod) {\n  if (typeof exports == \"object\" && typeof module == \"object\") // CommonJS\n    mod(require(\"../../lib/codemirror\"), require(\"../dialog/dialog\"));\n  else if (typeof define == \"function\" && define.amd) // AMD\n    define([\"../../lib/codemirror\", \"../dialog/dialog\"], mod);\n  else // Plain browser env\n    mod(CodeMirror);\n})(function(CodeMirror) {\n  \"use strict\";\n\n  // default search panel location\n  CodeMirror.defineOption(\"search\", {bottom: false});\n\n  function dialog(cm, text, shortText, deflt, f) {\n    if (cm.openDialog) cm.openDialog(text, f, {value: deflt, selectValueOnOpen: true, bottom: cm.options.search.bottom});\n    else f(prompt(shortText, deflt));\n  }\n\n  function getJumpDialog(cm) {\n    return cm.phrase(\"Jump to line:\") + ' <input type=\"text\" style=\"width: 10em\" class=\"CodeMirror-search-field\"/> <span style=\"color: #888\" class=\"CodeMirror-search-hint\">' + cm.phrase(\"(Use line:column or scroll% syntax)\") + '</span>';\n  }\n\n  function interpretLine(cm, string) {\n    var num = Number(string)\n    if (/^[-+]/.test(string)) return cm.getCursor().line + num\n    else return num - 1\n  }\n\n  CodeMirror.commands.jumpToLine = function(cm) {\n    var cur = cm.getCursor();\n    dialog(cm, getJumpDialog(cm), cm.phrase(\"Jump to line:\"), (cur.line + 1) + \":\" + cur.ch, function(posStr) {\n      if (!posStr) return;\n\n      var match;\n      if (match = /^\\s*([\\+\\-]?\\d+)\\s*\\:\\s*(\\d+)\\s*$/.exec(posStr)) {\n        cm.setCursor(interpretLine(cm, match[1]), Number(match[2]))\n      } else if (match = /^\\s*([\\+\\-]?\\d+(\\.\\d+)?)\\%\\s*/.exec(posStr)) {\n        var line = Math.round(cm.lineCount() * Number(match[1]) / 100);\n        if (/^[-+]/.test(match[1])) line = cur.line + line + 1;\n        cm.setCursor(line - 1, cur.ch);\n      } else if (match = /^\\s*\\:?\\s*([\\+\\-]?\\d+)\\s*/.exec(posStr)) {\n        cm.setCursor(interpretLine(cm, match[1]), cur.ch);\n      }\n    });\n  };\n\n  CodeMirror.keyMap[\"default\"][\"Alt-G\"] = \"jumpToLine\";\n});\n","// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: https://codemirror.net/LICENSE\n\n// A rough approximation of Sublime Text's keybindings\n// Depends on addon/search/searchcursor.js and optionally addon/dialog/dialogs.js\n\n(function(mod) {\n  if (typeof exports == \"object\" && typeof module == \"object\") // CommonJS\n    mod(require(\"../lib/codemirror\"), require(\"../addon/search/searchcursor\"), require(\"../addon/edit/matchbrackets\"));\n  else if (typeof define == \"function\" && define.amd) // AMD\n    define([\"../lib/codemirror\", \"../addon/search/searchcursor\", \"../addon/edit/matchbrackets\"], mod);\n  else // Plain browser env\n    mod(CodeMirror);\n})(function(CodeMirror) {\n  \"use strict\";\n\n  var cmds = CodeMirror.commands;\n  var Pos = CodeMirror.Pos;\n\n  // This is not exactly Sublime's algorithm. I couldn't make heads or tails of that.\n  function findPosSubword(doc, start, dir) {\n    if (dir < 0 && start.ch == 0) return doc.clipPos(Pos(start.line - 1));\n    var line = doc.getLine(start.line);\n    if (dir > 0 && start.ch >= line.length) return doc.clipPos(Pos(start.line + 1, 0));\n    var state = \"start\", type, startPos = start.ch;\n    for (var pos = startPos, e = dir < 0 ? 0 : line.length, i = 0; pos != e; pos += dir, i++) {\n      var next = line.charAt(dir < 0 ? pos - 1 : pos);\n      var cat = next != \"_\" && CodeMirror.isWordChar(next) ? \"w\" : \"o\";\n      if (cat == \"w\" && next.toUpperCase() == next) cat = \"W\";\n      if (state == \"start\") {\n        if (cat != \"o\") { state = \"in\"; type = cat; }\n        else startPos = pos + dir\n      } else if (state == \"in\") {\n        if (type != cat) {\n          if (type == \"w\" && cat == \"W\" && dir < 0) pos--;\n          if (type == \"W\" && cat == \"w\" && dir > 0) { // From uppercase to lowercase\n            if (pos == startPos + 1) { type = \"w\"; continue; }\n            else pos--;\n          }\n          break;\n        }\n      }\n    }\n    return Pos(start.line, pos);\n  }\n\n  function moveSubword(cm, dir) {\n    cm.extendSelectionsBy(function(range) {\n      if (cm.display.shift || cm.doc.extend || range.empty())\n        return findPosSubword(cm.doc, range.head, dir);\n      else\n        return dir < 0 ? range.from() : range.to();\n    });\n  }\n\n  cmds.goSubwordLeft = function(cm) { moveSubword(cm, -1); };\n  cmds.goSubwordRight = function(cm) { moveSubword(cm, 1); };\n\n  cmds.scrollLineUp = function(cm) {\n    var info = cm.getScrollInfo();\n    if (!cm.somethingSelected()) {\n      var visibleBottomLine = cm.lineAtHeight(info.top + info.clientHeight, \"local\");\n      if (cm.getCursor().line >= visibleBottomLine)\n        cm.execCommand(\"goLineUp\");\n    }\n    cm.scrollTo(null, info.top - cm.defaultTextHeight());\n  };\n  cmds.scrollLineDown = function(cm) {\n    var info = cm.getScrollInfo();\n    if (!cm.somethingSelected()) {\n      var visibleTopLine = cm.lineAtHeight(info.top, \"local\")+1;\n      if (cm.getCursor().line <= visibleTopLine)\n        cm.execCommand(\"goLineDown\");\n    }\n    cm.scrollTo(null, info.top + cm.defaultTextHeight());\n  };\n\n  cmds.splitSelectionByLine = function(cm) {\n    var ranges = cm.listSelections(), lineRanges = [];\n    for (var i = 0; i < ranges.length; i++) {\n      var from = ranges[i].from(), to = ranges[i].to();\n      for (var line = from.line; line <= to.line; ++line)\n        if (!(to.line > from.line && line == to.line && to.ch == 0))\n          lineRanges.push({anchor: line == from.line ? from : Pos(line, 0),\n                           head: line == to.line ? to : Pos(line)});\n    }\n    cm.setSelections(lineRanges, 0);\n  };\n\n  cmds.singleSelectionTop = function(cm) {\n    var range = cm.listSelections()[0];\n    cm.setSelection(range.anchor, range.head, {scroll: false});\n  };\n\n  cmds.selectLine = function(cm) {\n    var ranges = cm.listSelections(), extended = [];\n    for (var i = 0; i < ranges.length; i++) {\n      var range = ranges[i];\n      extended.push({anchor: Pos(range.from().line, 0),\n                     head: Pos(range.to().line + 1, 0)});\n    }\n    cm.setSelections(extended);\n  };\n\n  function insertLine(cm, above) {\n    if (cm.isReadOnly()) return CodeMirror.Pass\n    cm.operation(function() {\n      var len = cm.listSelections().length, newSelection = [], last = -1;\n      for (var i = 0; i < len; i++) {\n        var head = cm.listSelections()[i].head;\n        if (head.line <= last) continue;\n        var at = Pos(head.line + (above ? 0 : 1), 0);\n        cm.replaceRange(\"\\n\", at, null, \"+insertLine\");\n        cm.indentLine(at.line, null, true);\n        newSelection.push({head: at, anchor: at});\n        last = head.line + 1;\n      }\n      cm.setSelections(newSelection);\n    });\n    cm.execCommand(\"indentAuto\");\n  }\n\n  cmds.insertLineAfter = function(cm) { return insertLine(cm, false); };\n\n  cmds.insertLineBefore = function(cm) { return insertLine(cm, true); };\n\n  function wordAt(cm, pos) {\n    var start = pos.ch, end = start, line = cm.getLine(pos.line);\n    while (start && CodeMirror.isWordChar(line.charAt(start - 1))) --start;\n    while (end < line.length && CodeMirror.isWordChar(line.charAt(end))) ++end;\n    return {from: Pos(pos.line, start), to: Pos(pos.line, end), word: line.slice(start, end)};\n  }\n\n  cmds.selectNextOccurrence = function(cm) {\n    var from = cm.getCursor(\"from\"), to = cm.getCursor(\"to\");\n    var fullWord = cm.state.sublimeFindFullWord == cm.doc.sel;\n    if (CodeMirror.cmpPos(from, to) == 0) {\n      var word = wordAt(cm, from);\n      if (!word.word) return;\n      cm.setSelection(word.from, word.to);\n      fullWord = true;\n    } else {\n      var text = cm.getRange(from, to);\n      var query = fullWord ? new RegExp(\"\\\\b\" + text + \"\\\\b\") : text;\n      var cur = cm.getSearchCursor(query, to);\n      var found = cur.findNext();\n      if (!found) {\n        cur = cm.getSearchCursor(query, Pos(cm.firstLine(), 0));\n        found = cur.findNext();\n      }\n      if (!found || isSelectedRange(cm.listSelections(), cur.from(), cur.to())) return\n      cm.addSelection(cur.from(), cur.to());\n    }\n    if (fullWord)\n      cm.state.sublimeFindFullWord = cm.doc.sel;\n  };\n\n  cmds.skipAndSelectNextOccurrence = function(cm) {\n    var prevAnchor = cm.getCursor(\"anchor\"), prevHead = cm.getCursor(\"head\");\n    cmds.selectNextOccurrence(cm);\n    if (CodeMirror.cmpPos(prevAnchor, prevHead) != 0) {\n      cm.doc.setSelections(cm.doc.listSelections()\n          .filter(function (sel) {\n            return sel.anchor != prevAnchor || sel.head != prevHead;\n          }));\n    }\n  }\n\n  function addCursorToSelection(cm, dir) {\n    var ranges = cm.listSelections(), newRanges = [];\n    for (var i = 0; i < ranges.length; i++) {\n      var range = ranges[i];\n      var newAnchor = cm.findPosV(\n          range.anchor, dir, \"line\", range.anchor.goalColumn);\n      var newHead = cm.findPosV(\n          range.head, dir, \"line\", range.head.goalColumn);\n      newAnchor.goalColumn = range.anchor.goalColumn != null ?\n          range.anchor.goalColumn : cm.cursorCoords(range.anchor, \"div\").left;\n      newHead.goalColumn = range.head.goalColumn != null ?\n          range.head.goalColumn : cm.cursorCoords(range.head, \"div\").left;\n      var newRange = {anchor: newAnchor, head: newHead};\n      newRanges.push(range);\n      newRanges.push(newRange);\n    }\n    cm.setSelections(newRanges);\n  }\n  cmds.addCursorToPrevLine = function(cm) { addCursorToSelection(cm, -1); };\n  cmds.addCursorToNextLine = function(cm) { addCursorToSelection(cm, 1); };\n\n  function isSelectedRange(ranges, from, to) {\n    for (var i = 0; i < ranges.length; i++)\n      if (CodeMirror.cmpPos(ranges[i].from(), from) == 0 &&\n          CodeMirror.cmpPos(ranges[i].to(), to) == 0) return true\n    return false\n  }\n\n  var mirror = \"(){}[]\";\n  function selectBetweenBrackets(cm) {\n    var ranges = cm.listSelections(), newRanges = []\n    for (var i = 0; i < ranges.length; i++) {\n      var range = ranges[i], pos = range.head, opening = cm.scanForBracket(pos, -1);\n      if (!opening) return false;\n      for (;;) {\n        var closing = cm.scanForBracket(pos, 1);\n        if (!closing) return false;\n        if (closing.ch == mirror.charAt(mirror.indexOf(opening.ch) + 1)) {\n          var startPos = Pos(opening.pos.line, opening.pos.ch + 1);\n          if (CodeMirror.cmpPos(startPos, range.from()) == 0 &&\n              CodeMirror.cmpPos(closing.pos, range.to()) == 0) {\n            opening = cm.scanForBracket(opening.pos, -1);\n            if (!opening) return false;\n          } else {\n            newRanges.push({anchor: startPos, head: closing.pos});\n            break;\n          }\n        }\n        pos = Pos(closing.pos.line, closing.pos.ch + 1);\n      }\n    }\n    cm.setSelections(newRanges);\n    return true;\n  }\n\n  cmds.selectScope = function(cm) {\n    selectBetweenBrackets(cm) || cm.execCommand(\"selectAll\");\n  };\n  cmds.selectBetweenBrackets = function(cm) {\n    if (!selectBetweenBrackets(cm)) return CodeMirror.Pass;\n  };\n\n  function puncType(type) {\n    return !type ? null : /\\bpunctuation\\b/.test(type) ? type : undefined\n  }\n\n  cmds.goToBracket = function(cm) {\n    cm.extendSelectionsBy(function(range) {\n      var next = cm.scanForBracket(range.head, 1, puncType(cm.getTokenTypeAt(range.head)));\n      if (next && CodeMirror.cmpPos(next.pos, range.head) != 0) return next.pos;\n      var prev = cm.scanForBracket(range.head, -1, puncType(cm.getTokenTypeAt(Pos(range.head.line, range.head.ch + 1))));\n      return prev && Pos(prev.pos.line, prev.pos.ch + 1) || range.head;\n    });\n  };\n\n  cmds.swapLineUp = function(cm) {\n    if (cm.isReadOnly()) return CodeMirror.Pass\n    var ranges = cm.listSelections(), linesToMove = [], at = cm.firstLine() - 1, newSels = [];\n    for (var i = 0; i < ranges.length; i++) {\n      var range = ranges[i], from = range.from().line - 1, to = range.to().line;\n      newSels.push({anchor: Pos(range.anchor.line - 1, range.anchor.ch),\n                    head: Pos(range.head.line - 1, range.head.ch)});\n      if (range.to().ch == 0 && !range.empty()) --to;\n      if (from > at) linesToMove.push(from, to);\n      else if (linesToMove.length) linesToMove[linesToMove.length - 1] = to;\n      at = to;\n    }\n    cm.operation(function() {\n      for (var i = 0; i < linesToMove.length; i += 2) {\n        var from = linesToMove[i], to = linesToMove[i + 1];\n        var line = cm.getLine(from);\n        cm.replaceRange(\"\", Pos(from, 0), Pos(from + 1, 0), \"+swapLine\");\n        if (to > cm.lastLine())\n          cm.replaceRange(\"\\n\" + line, Pos(cm.lastLine()), null, \"+swapLine\");\n        else\n          cm.replaceRange(line + \"\\n\", Pos(to, 0), null, \"+swapLine\");\n      }\n      cm.setSelections(newSels);\n      cm.scrollIntoView();\n    });\n  };\n\n  cmds.swapLineDown = function(cm) {\n    if (cm.isReadOnly()) return CodeMirror.Pass\n    var ranges = cm.listSelections(), linesToMove = [], at = cm.lastLine() + 1;\n    for (var i = ranges.length - 1; i >= 0; i--) {\n      var range = ranges[i], from = range.to().line + 1, to = range.from().line;\n      if (range.to().ch == 0 && !range.empty()) from--;\n      if (from < at) linesToMove.push(from, to);\n      else if (linesToMove.length) linesToMove[linesToMove.length - 1] = to;\n      at = to;\n    }\n    cm.operation(function() {\n      for (var i = linesToMove.length - 2; i >= 0; i -= 2) {\n        var from = linesToMove[i], to = linesToMove[i + 1];\n        var line = cm.getLine(from);\n        if (from == cm.lastLine())\n          cm.replaceRange(\"\", Pos(from - 1), Pos(from), \"+swapLine\");\n        else\n          cm.replaceRange(\"\", Pos(from, 0), Pos(from + 1, 0), \"+swapLine\");\n        cm.replaceRange(line + \"\\n\", Pos(to, 0), null, \"+swapLine\");\n      }\n      cm.scrollIntoView();\n    });\n  };\n\n  cmds.toggleCommentIndented = function(cm) {\n    cm.toggleComment({ indent: true });\n  }\n\n  cmds.joinLines = function(cm) {\n    var ranges = cm.listSelections(), joined = [];\n    for (var i = 0; i < ranges.length; i++) {\n      var range = ranges[i], from = range.from();\n      var start = from.line, end = range.to().line;\n      while (i < ranges.length - 1 && ranges[i + 1].from().line == end)\n        end = ranges[++i].to().line;\n      joined.push({start: start, end: end, anchor: !range.empty() && from});\n    }\n    cm.operation(function() {\n      var offset = 0, ranges = [];\n      for (var i = 0; i < joined.length; i++) {\n        var obj = joined[i];\n        var anchor = obj.anchor && Pos(obj.anchor.line - offset, obj.anchor.ch), head;\n        for (var line = obj.start; line <= obj.end; line++) {\n          var actual = line - offset;\n          if (line == obj.end) head = Pos(actual, cm.getLine(actual).length + 1);\n          if (actual < cm.lastLine()) {\n            cm.replaceRange(\" \", Pos(actual), Pos(actual + 1, /^\\s*/.exec(cm.getLine(actual + 1))[0].length));\n            ++offset;\n          }\n        }\n        ranges.push({anchor: anchor || head, head: head});\n      }\n      cm.setSelections(ranges, 0);\n    });\n  };\n\n  cmds.duplicateLine = function(cm) {\n    cm.operation(function() {\n      var rangeCount = cm.listSelections().length;\n      for (var i = 0; i < rangeCount; i++) {\n        var range = cm.listSelections()[i];\n        if (range.empty())\n          cm.replaceRange(cm.getLine(range.head.line) + \"\\n\", Pos(range.head.line, 0));\n        else\n          cm.replaceRange(cm.getRange(range.from(), range.to()), range.from());\n      }\n      cm.scrollIntoView();\n    });\n  };\n\n\n  function sortLines(cm, caseSensitive, direction) {\n    if (cm.isReadOnly()) return CodeMirror.Pass\n    var ranges = cm.listSelections(), toSort = [], selected;\n    for (var i = 0; i < ranges.length; i++) {\n      var range = ranges[i];\n      if (range.empty()) continue;\n      var from = range.from().line, to = range.to().line;\n      while (i < ranges.length - 1 && ranges[i + 1].from().line == to)\n        to = ranges[++i].to().line;\n      if (!ranges[i].to().ch) to--;\n      toSort.push(from, to);\n    }\n    if (toSort.length) selected = true;\n    else toSort.push(cm.firstLine(), cm.lastLine());\n\n    cm.operation(function() {\n      var ranges = [];\n      for (var i = 0; i < toSort.length; i += 2) {\n        var from = toSort[i], to = toSort[i + 1];\n        var start = Pos(from, 0), end = Pos(to);\n        var lines = cm.getRange(start, end, false);\n        if (caseSensitive)\n          lines.sort(function(a, b) { return a < b ? -direction : a == b ? 0 : direction; });\n        else\n          lines.sort(function(a, b) {\n            var au = a.toUpperCase(), bu = b.toUpperCase();\n            if (au != bu) { a = au; b = bu; }\n            return a < b ? -direction : a == b ? 0 : direction;\n          });\n        cm.replaceRange(lines, start, end);\n        if (selected) ranges.push({anchor: start, head: Pos(to + 1, 0)});\n      }\n      if (selected) cm.setSelections(ranges, 0);\n    });\n  }\n\n  cmds.sortLines = function(cm) { sortLines(cm, true, 1); };\n  cmds.reverseSortLines = function(cm) { sortLines(cm, true, -1); };\n  cmds.sortLinesInsensitive = function(cm) { sortLines(cm, false, 1); };\n  cmds.reverseSortLinesInsensitive = function(cm) { sortLines(cm, false, -1); };\n\n  cmds.nextBookmark = function(cm) {\n    var marks = cm.state.sublimeBookmarks;\n    if (marks) while (marks.length) {\n      var current = marks.shift();\n      var found = current.find();\n      if (found) {\n        marks.push(current);\n        return cm.setSelection(found.from, found.to);\n      }\n    }\n  };\n\n  cmds.prevBookmark = function(cm) {\n    var marks = cm.state.sublimeBookmarks;\n    if (marks) while (marks.length) {\n      marks.unshift(marks.pop());\n      var found = marks[marks.length - 1].find();\n      if (!found)\n        marks.pop();\n      else\n        return cm.setSelection(found.from, found.to);\n    }\n  };\n\n  cmds.toggleBookmark = function(cm) {\n    var ranges = cm.listSelections();\n    var marks = cm.state.sublimeBookmarks || (cm.state.sublimeBookmarks = []);\n    for (var i = 0; i < ranges.length; i++) {\n      var from = ranges[i].from(), to = ranges[i].to();\n      var found = ranges[i].empty() ? cm.findMarksAt(from) : cm.findMarks(from, to);\n      for (var j = 0; j < found.length; j++) {\n        if (found[j].sublimeBookmark) {\n          found[j].clear();\n          for (var k = 0; k < marks.length; k++)\n            if (marks[k] == found[j])\n              marks.splice(k--, 1);\n          break;\n        }\n      }\n      if (j == found.length)\n        marks.push(cm.markText(from, to, {sublimeBookmark: true, clearWhenEmpty: false}));\n    }\n  };\n\n  cmds.clearBookmarks = function(cm) {\n    var marks = cm.state.sublimeBookmarks;\n    if (marks) for (var i = 0; i < marks.length; i++) marks[i].clear();\n    marks.length = 0;\n  };\n\n  cmds.selectBookmarks = function(cm) {\n    var marks = cm.state.sublimeBookmarks, ranges = [];\n    if (marks) for (var i = 0; i < marks.length; i++) {\n      var found = marks[i].find();\n      if (!found)\n        marks.splice(i--, 0);\n      else\n        ranges.push({anchor: found.from, head: found.to});\n    }\n    if (ranges.length)\n      cm.setSelections(ranges, 0);\n  };\n\n  function modifyWordOrSelection(cm, mod) {\n    cm.operation(function() {\n      var ranges = cm.listSelections(), indices = [], replacements = [];\n      for (var i = 0; i < ranges.length; i++) {\n        var range = ranges[i];\n        if (range.empty()) { indices.push(i); replacements.push(\"\"); }\n        else replacements.push(mod(cm.getRange(range.from(), range.to())));\n      }\n      cm.replaceSelections(replacements, \"around\", \"case\");\n      for (var i = indices.length - 1, at; i >= 0; i--) {\n        var range = ranges[indices[i]];\n        if (at && CodeMirror.cmpPos(range.head, at) > 0) continue;\n        var word = wordAt(cm, range.head);\n        at = word.from;\n        cm.replaceRange(mod(word.word), word.from, word.to);\n      }\n    });\n  }\n\n  cmds.smartBackspace = function(cm) {\n    if (cm.somethingSelected()) return CodeMirror.Pass;\n\n    cm.operation(function() {\n      var cursors = cm.listSelections();\n      var indentUnit = cm.getOption(\"indentUnit\");\n\n      for (var i = cursors.length - 1; i >= 0; i--) {\n        var cursor = cursors[i].head;\n        var toStartOfLine = cm.getRange({line: cursor.line, ch: 0}, cursor);\n        var column = CodeMirror.countColumn(toStartOfLine, null, cm.getOption(\"tabSize\"));\n\n        // Delete by one character by default\n        var deletePos = cm.findPosH(cursor, -1, \"char\", false);\n\n        if (toStartOfLine && !/\\S/.test(toStartOfLine) && column % indentUnit == 0) {\n          var prevIndent = new Pos(cursor.line,\n            CodeMirror.findColumn(toStartOfLine, column - indentUnit, indentUnit));\n\n          // Smart delete only if we found a valid prevIndent location\n          if (prevIndent.ch != cursor.ch) deletePos = prevIndent;\n        }\n\n        cm.replaceRange(\"\", deletePos, cursor, \"+delete\");\n      }\n    });\n  };\n\n  cmds.delLineRight = function(cm) {\n    cm.operation(function() {\n      var ranges = cm.listSelections();\n      for (var i = ranges.length - 1; i >= 0; i--)\n        cm.replaceRange(\"\", ranges[i].anchor, Pos(ranges[i].to().line), \"+delete\");\n      cm.scrollIntoView();\n    });\n  };\n\n  cmds.upcaseAtCursor = function(cm) {\n    modifyWordOrSelection(cm, function(str) { return str.toUpperCase(); });\n  };\n  cmds.downcaseAtCursor = function(cm) {\n    modifyWordOrSelection(cm, function(str) { return str.toLowerCase(); });\n  };\n\n  cmds.setSublimeMark = function(cm) {\n    if (cm.state.sublimeMark) cm.state.sublimeMark.clear();\n    cm.state.sublimeMark = cm.setBookmark(cm.getCursor());\n  };\n  cmds.selectToSublimeMark = function(cm) {\n    var found = cm.state.sublimeMark && cm.state.sublimeMark.find();\n    if (found) cm.setSelection(cm.getCursor(), found);\n  };\n  cmds.deleteToSublimeMark = function(cm) {\n    var found = cm.state.sublimeMark && cm.state.sublimeMark.find();\n    if (found) {\n      var from = cm.getCursor(), to = found;\n      if (CodeMirror.cmpPos(from, to) > 0) { var tmp = to; to = from; from = tmp; }\n      cm.state.sublimeKilled = cm.getRange(from, to);\n      cm.replaceRange(\"\", from, to);\n    }\n  };\n  cmds.swapWithSublimeMark = function(cm) {\n    var found = cm.state.sublimeMark && cm.state.sublimeMark.find();\n    if (found) {\n      cm.state.sublimeMark.clear();\n      cm.state.sublimeMark = cm.setBookmark(cm.getCursor());\n      cm.setCursor(found);\n    }\n  };\n  cmds.sublimeYank = function(cm) {\n    if (cm.state.sublimeKilled != null)\n      cm.replaceSelection(cm.state.sublimeKilled, null, \"paste\");\n  };\n\n  cmds.showInCenter = function(cm) {\n    var pos = cm.cursorCoords(null, \"local\");\n    cm.scrollTo(null, (pos.top + pos.bottom) / 2 - cm.getScrollInfo().clientHeight / 2);\n  };\n\n  function getTarget(cm) {\n    var from = cm.getCursor(\"from\"), to = cm.getCursor(\"to\");\n    if (CodeMirror.cmpPos(from, to) == 0) {\n      var word = wordAt(cm, from);\n      if (!word.word) return;\n      from = word.from;\n      to = word.to;\n    }\n    return {from: from, to: to, query: cm.getRange(from, to), word: word};\n  }\n\n  function findAndGoTo(cm, forward) {\n    var target = getTarget(cm);\n    if (!target) return;\n    var query = target.query;\n    var cur = cm.getSearchCursor(query, forward ? target.to : target.from);\n\n    if (forward ? cur.findNext() : cur.findPrevious()) {\n      cm.setSelection(cur.from(), cur.to());\n    } else {\n      cur = cm.getSearchCursor(query, forward ? Pos(cm.firstLine(), 0)\n                                              : cm.clipPos(Pos(cm.lastLine())));\n      if (forward ? cur.findNext() : cur.findPrevious())\n        cm.setSelection(cur.from(), cur.to());\n      else if (target.word)\n        cm.setSelection(target.from, target.to);\n    }\n  };\n  cmds.findUnder = function(cm) { findAndGoTo(cm, true); };\n  cmds.findUnderPrevious = function(cm) { findAndGoTo(cm,false); };\n  cmds.findAllUnder = function(cm) {\n    var target = getTarget(cm);\n    if (!target) return;\n    var cur = cm.getSearchCursor(target.query);\n    var matches = [];\n    var primaryIndex = -1;\n    while (cur.findNext()) {\n      matches.push({anchor: cur.from(), head: cur.to()});\n      if (cur.from().line <= target.from.line && cur.from().ch <= target.from.ch)\n        primaryIndex++;\n    }\n    cm.setSelections(matches, primaryIndex);\n  };\n\n\n  var keyMap = CodeMirror.keyMap;\n  keyMap.macSublime = {\n    \"Cmd-Left\": \"goLineStartSmart\",\n    \"Shift-Tab\": \"indentLess\",\n    \"Shift-Ctrl-K\": \"deleteLine\",\n    \"Alt-Q\": \"wrapLines\",\n    \"Ctrl-Left\": \"goSubwordLeft\",\n    \"Ctrl-Right\": \"goSubwordRight\",\n    \"Ctrl-Alt-Up\": \"scrollLineUp\",\n    \"Ctrl-Alt-Down\": \"scrollLineDown\",\n    \"Cmd-L\": \"selectLine\",\n    \"Shift-Cmd-L\": \"splitSelectionByLine\",\n    \"Esc\": \"singleSelectionTop\",\n    \"Cmd-Enter\": \"insertLineAfter\",\n    \"Shift-Cmd-Enter\": \"insertLineBefore\",\n    \"Cmd-D\": \"selectNextOccurrence\",\n    \"Shift-Cmd-Space\": \"selectScope\",\n    \"Shift-Cmd-M\": \"selectBetweenBrackets\",\n    \"Cmd-M\": \"goToBracket\",\n    \"Cmd-Ctrl-Up\": \"swapLineUp\",\n    \"Cmd-Ctrl-Down\": \"swapLineDown\",\n    \"Cmd-/\": \"toggleCommentIndented\",\n    \"Cmd-J\": \"joinLines\",\n    \"Shift-Cmd-D\": \"duplicateLine\",\n    \"F5\": \"sortLines\",\n    \"Shift-F5\": \"reverseSortLines\",\n    \"Cmd-F5\": \"sortLinesInsensitive\",\n    \"Shift-Cmd-F5\": \"reverseSortLinesInsensitive\",\n    \"F2\": \"nextBookmark\",\n    \"Shift-F2\": \"prevBookmark\",\n    \"Cmd-F2\": \"toggleBookmark\",\n    \"Shift-Cmd-F2\": \"clearBookmarks\",\n    \"Alt-F2\": \"selectBookmarks\",\n    \"Backspace\": \"smartBackspace\",\n    \"Cmd-K Cmd-D\": \"skipAndSelectNextOccurrence\",\n    \"Cmd-K Cmd-K\": \"delLineRight\",\n    \"Cmd-K Cmd-U\": \"upcaseAtCursor\",\n    \"Cmd-K Cmd-L\": \"downcaseAtCursor\",\n    \"Cmd-K Cmd-Space\": \"setSublimeMark\",\n    \"Cmd-K Cmd-A\": \"selectToSublimeMark\",\n    \"Cmd-K Cmd-W\": \"deleteToSublimeMark\",\n    \"Cmd-K Cmd-X\": \"swapWithSublimeMark\",\n    \"Cmd-K Cmd-Y\": \"sublimeYank\",\n    \"Cmd-K Cmd-C\": \"showInCenter\",\n    \"Cmd-K Cmd-G\": \"clearBookmarks\",\n    \"Cmd-K Cmd-Backspace\": \"delLineLeft\",\n    \"Cmd-K Cmd-1\": \"foldAll\",\n    \"Cmd-K Cmd-0\": \"unfoldAll\",\n    \"Cmd-K Cmd-J\": \"unfoldAll\",\n    \"Ctrl-Shift-Up\": \"addCursorToPrevLine\",\n    \"Ctrl-Shift-Down\": \"addCursorToNextLine\",\n    \"Cmd-F3\": \"findUnder\",\n    \"Shift-Cmd-F3\": \"findUnderPrevious\",\n    \"Alt-F3\": \"findAllUnder\",\n    \"Shift-Cmd-[\": \"fold\",\n    \"Shift-Cmd-]\": \"unfold\",\n    \"Cmd-I\": \"findIncremental\",\n    \"Shift-Cmd-I\": \"findIncrementalReverse\",\n    \"Cmd-H\": \"replace\",\n    \"F3\": \"findNext\",\n    \"Shift-F3\": \"findPrev\",\n    \"fallthrough\": \"macDefault\"\n  };\n  CodeMirror.normalizeKeyMap(keyMap.macSublime);\n\n  keyMap.pcSublime = {\n    \"Shift-Tab\": \"indentLess\",\n    \"Shift-Ctrl-K\": \"deleteLine\",\n    \"Alt-Q\": \"wrapLines\",\n    \"Ctrl-T\": \"transposeChars\",\n    \"Alt-Left\": \"goSubwordLeft\",\n    \"Alt-Right\": \"goSubwordRight\",\n    \"Ctrl-Up\": \"scrollLineUp\",\n    \"Ctrl-Down\": \"scrollLineDown\",\n    \"Ctrl-L\": \"selectLine\",\n    \"Shift-Ctrl-L\": \"splitSelectionByLine\",\n    \"Esc\": \"singleSelectionTop\",\n    \"Ctrl-Enter\": \"insertLineAfter\",\n    \"Shift-Ctrl-Enter\": \"insertLineBefore\",\n    \"Ctrl-D\": \"selectNextOccurrence\",\n    \"Shift-Ctrl-Space\": \"selectScope\",\n    \"Shift-Ctrl-M\": \"selectBetweenBrackets\",\n    \"Ctrl-M\": \"goToBracket\",\n    \"Shift-Ctrl-Up\": \"swapLineUp\",\n    \"Shift-Ctrl-Down\": \"swapLineDown\",\n    \"Ctrl-/\": \"toggleCommentIndented\",\n    \"Ctrl-J\": \"joinLines\",\n    \"Shift-Ctrl-D\": \"duplicateLine\",\n    \"F9\": \"sortLines\",\n    \"Shift-F9\": \"reverseSortLines\",\n    \"Ctrl-F9\": \"sortLinesInsensitive\",\n    \"Shift-Ctrl-F9\": \"reverseSortLinesInsensitive\",\n    \"F2\": \"nextBookmark\",\n    \"Shift-F2\": \"prevBookmark\",\n    \"Ctrl-F2\": \"toggleBookmark\",\n    \"Shift-Ctrl-F2\": \"clearBookmarks\",\n    \"Alt-F2\": \"selectBookmarks\",\n    \"Backspace\": \"smartBackspace\",\n    \"Ctrl-K Ctrl-D\": \"skipAndSelectNextOccurrence\",\n    \"Ctrl-K Ctrl-K\": \"delLineRight\",\n    \"Ctrl-K Ctrl-U\": \"upcaseAtCursor\",\n    \"Ctrl-K Ctrl-L\": \"downcaseAtCursor\",\n    \"Ctrl-K Ctrl-Space\": \"setSublimeMark\",\n    \"Ctrl-K Ctrl-A\": \"selectToSublimeMark\",\n    \"Ctrl-K Ctrl-W\": \"deleteToSublimeMark\",\n    \"Ctrl-K Ctrl-X\": \"swapWithSublimeMark\",\n    \"Ctrl-K Ctrl-Y\": \"sublimeYank\",\n    \"Ctrl-K Ctrl-C\": \"showInCenter\",\n    \"Ctrl-K Ctrl-G\": \"clearBookmarks\",\n    \"Ctrl-K Ctrl-Backspace\": \"delLineLeft\",\n    \"Ctrl-K Ctrl-1\": \"foldAll\",\n    \"Ctrl-K Ctrl-0\": \"unfoldAll\",\n    \"Ctrl-K Ctrl-J\": \"unfoldAll\",\n    \"Ctrl-Alt-Up\": \"addCursorToPrevLine\",\n    \"Ctrl-Alt-Down\": \"addCursorToNextLine\",\n    \"Ctrl-F3\": \"findUnder\",\n    \"Shift-Ctrl-F3\": \"findUnderPrevious\",\n    \"Alt-F3\": \"findAllUnder\",\n    \"Shift-Ctrl-[\": \"fold\",\n    \"Shift-Ctrl-]\": \"unfold\",\n    \"Ctrl-I\": \"findIncremental\",\n    \"Shift-Ctrl-I\": \"findIncrementalReverse\",\n    \"Ctrl-H\": \"replace\",\n    \"F3\": \"findNext\",\n    \"Shift-F3\": \"findPrev\",\n    \"fallthrough\": \"pcDefault\"\n  };\n  CodeMirror.normalizeKeyMap(keyMap.pcSublime);\n\n  var mac = keyMap.default == keyMap.macDefault;\n  keyMap.sublime = mac ? keyMap.macSublime : keyMap.pcSublime;\n});\n","// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: https://codemirror.net/LICENSE\n\n(function(mod) {\n  if (typeof exports == \"object\" && typeof module == \"object\") // CommonJS\n    mod(require(\"../../lib/codemirror\"));\n  else if (typeof define == \"function\" && define.amd) // AMD\n    define([\"../../lib/codemirror\"], mod);\n  else // Plain browser env\n    mod(CodeMirror);\n})(function(CodeMirror) {\n  var ie_lt8 = /MSIE \\d/.test(navigator.userAgent) &&\n    (document.documentMode == null || document.documentMode < 8);\n\n  var Pos = CodeMirror.Pos;\n\n  var matching = {\"(\": \")>\", \")\": \"(<\", \"[\": \"]>\", \"]\": \"[<\", \"{\": \"}>\", \"}\": \"{<\", \"<\": \">>\", \">\": \"<<\"};\n\n  function bracketRegex(config) {\n    return config && config.bracketRegex || /[(){}[\\]]/\n  }\n\n  function findMatchingBracket(cm, where, config) {\n    var line = cm.getLineHandle(where.line), pos = where.ch - 1;\n    var afterCursor = config && config.afterCursor\n    if (afterCursor == null)\n      afterCursor = /(^| )cm-fat-cursor($| )/.test(cm.getWrapperElement().className)\n    var re = bracketRegex(config)\n\n    // A cursor is defined as between two characters, but in in vim command mode\n    // (i.e. not insert mode), the cursor is visually represented as a\n    // highlighted box on top of the 2nd character. Otherwise, we allow matches\n    // from before or after the cursor.\n    var match = (!afterCursor && pos >= 0 && re.test(line.text.charAt(pos)) && matching[line.text.charAt(pos)]) ||\n        re.test(line.text.charAt(pos + 1)) && matching[line.text.charAt(++pos)];\n    if (!match) return null;\n    var dir = match.charAt(1) == \">\" ? 1 : -1;\n    if (config && config.strict && (dir > 0) != (pos == where.ch)) return null;\n    var style = cm.getTokenTypeAt(Pos(where.line, pos + 1));\n\n    var found = scanForBracket(cm, Pos(where.line, pos + (dir > 0 ? 1 : 0)), dir, style, config);\n    if (found == null) return null;\n    return {from: Pos(where.line, pos), to: found && found.pos,\n            match: found && found.ch == match.charAt(0), forward: dir > 0};\n  }\n\n  // bracketRegex is used to specify which type of bracket to scan\n  // should be a regexp, e.g. /[[\\]]/\n  //\n  // Note: If \"where\" is on an open bracket, then this bracket is ignored.\n  //\n  // Returns false when no bracket was found, null when it reached\n  // maxScanLines and gave up\n  function scanForBracket(cm, where, dir, style, config) {\n    var maxScanLen = (config && config.maxScanLineLength) || 10000;\n    var maxScanLines = (config && config.maxScanLines) || 1000;\n\n    var stack = [];\n    var re = bracketRegex(config)\n    var lineEnd = dir > 0 ? Math.min(where.line + maxScanLines, cm.lastLine() + 1)\n                          : Math.max(cm.firstLine() - 1, where.line - maxScanLines);\n    for (var lineNo = where.line; lineNo != lineEnd; lineNo += dir) {\n      var line = cm.getLine(lineNo);\n      if (!line) continue;\n      var pos = dir > 0 ? 0 : line.length - 1, end = dir > 0 ? line.length : -1;\n      if (line.length > maxScanLen) continue;\n      if (lineNo == where.line) pos = where.ch - (dir < 0 ? 1 : 0);\n      for (; pos != end; pos += dir) {\n        var ch = line.charAt(pos);\n        if (re.test(ch) && (style === undefined ||\n                            (cm.getTokenTypeAt(Pos(lineNo, pos + 1)) || \"\") == (style || \"\"))) {\n          var match = matching[ch];\n          if (match && (match.charAt(1) == \">\") == (dir > 0)) stack.push(ch);\n          else if (!stack.length) return {pos: Pos(lineNo, pos), ch: ch};\n          else stack.pop();\n        }\n      }\n    }\n    return lineNo - dir == (dir > 0 ? cm.lastLine() : cm.firstLine()) ? false : null;\n  }\n\n  function matchBrackets(cm, autoclear, config) {\n    // Disable brace matching in long lines, since it'll cause hugely slow updates\n    var maxHighlightLen = cm.state.matchBrackets.maxHighlightLineLength || 1000,\n      highlightNonMatching = config && config.highlightNonMatching;\n    var marks = [], ranges = cm.listSelections();\n    for (var i = 0; i < ranges.length; i++) {\n      var match = ranges[i].empty() && findMatchingBracket(cm, ranges[i].head, config);\n      if (match && (match.match || highlightNonMatching !== false) && cm.getLine(match.from.line).length <= maxHighlightLen) {\n        var style = match.match ? \"CodeMirror-matchingbracket\" : \"CodeMirror-nonmatchingbracket\";\n        marks.push(cm.markText(match.from, Pos(match.from.line, match.from.ch + 1), {className: style}));\n        if (match.to && cm.getLine(match.to.line).length <= maxHighlightLen)\n          marks.push(cm.markText(match.to, Pos(match.to.line, match.to.ch + 1), {className: style}));\n      }\n    }\n\n    if (marks.length) {\n      // Kludge to work around the IE bug from issue #1193, where text\n      // input stops going to the textarea whenever this fires.\n      if (ie_lt8 && cm.state.focused) cm.focus();\n\n      var clear = function() {\n        cm.operation(function() {\n          for (var i = 0; i < marks.length; i++) marks[i].clear();\n        });\n      };\n      if (autoclear) setTimeout(clear, 800);\n      else return clear;\n    }\n  }\n\n  function doMatchBrackets(cm) {\n    cm.operation(function() {\n      if (cm.state.matchBrackets.currentlyHighlighted) {\n        cm.state.matchBrackets.currentlyHighlighted();\n        cm.state.matchBrackets.currentlyHighlighted = null;\n      }\n      cm.state.matchBrackets.currentlyHighlighted = matchBrackets(cm, false, cm.state.matchBrackets);\n    });\n  }\n\n  function clearHighlighted(cm) {\n    if (cm.state.matchBrackets && cm.state.matchBrackets.currentlyHighlighted) {\n      cm.state.matchBrackets.currentlyHighlighted();\n      cm.state.matchBrackets.currentlyHighlighted = null;\n    }\n  }\n\n  CodeMirror.defineOption(\"matchBrackets\", false, function(cm, val, old) {\n    if (old && old != CodeMirror.Init) {\n      cm.off(\"cursorActivity\", doMatchBrackets);\n      cm.off(\"focus\", doMatchBrackets)\n      cm.off(\"blur\", clearHighlighted)\n      clearHighlighted(cm);\n    }\n    if (val) {\n      cm.state.matchBrackets = typeof val == \"object\" ? val : {};\n      cm.on(\"cursorActivity\", doMatchBrackets);\n      cm.on(\"focus\", doMatchBrackets)\n      cm.on(\"blur\", clearHighlighted)\n    }\n  });\n\n  CodeMirror.defineExtension(\"matchBrackets\", function() {matchBrackets(this, true);});\n  CodeMirror.defineExtension(\"findMatchingBracket\", function(pos, config, oldConfig){\n    // Backwards-compatibility kludge\n    if (oldConfig || typeof config == \"boolean\") {\n      if (!oldConfig) {\n        config = config ? {strict: true} : null\n      } else {\n        oldConfig.strict = config\n        config = oldConfig\n      }\n    }\n    return findMatchingBracket(this, pos, config)\n  });\n  CodeMirror.defineExtension(\"scanForBracket\", function(pos, dir, style, config){\n    return scanForBracket(this, pos, dir, style, config);\n  });\n});\n","'use strict';\n\nfunction _extends() {\n  _extends = Object.assign || function(target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n    return target;\n  };\n  return _extends.apply(this, arguments);\n}\n\nfunction _typeof(obj) {\n  \"@babel/helpers - typeof\";\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n  return _typeof(obj);\n}\n\nvar __extends = void 0 && (void 0).__extends || function() {\n  var _extendStatics = function extendStatics(d, b) {\n    _extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    }\n    instanceof Array && function(d, b) {\n      d.__proto__ = b;\n    } || function(d, b) {\n      for (var p in b) {\n        if (b.hasOwnProperty(p)) d[p] = b[p];\n      }\n    };\n\n    return _extendStatics(d, b);\n  };\n\n  return function(d, b) {\n    _extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\nexports.UnControlled = exports.Controlled = void 0;\n\nvar React = require('react');\n\nvar SERVER_RENDERED = typeof navigator === 'undefined' || global['PREVENT_CODEMIRROR_RENDER'] === true;\nvar cm;\n\nif (!SERVER_RENDERED) {\n  cm = require('codemirror');\n}\n\nvar Helper = function() {\n  function Helper() {}\n\n  Helper.equals = function(x, y) {\n    var _this = this;\n\n    var ok = Object.keys,\n      tx = _typeof(x),\n      ty = _typeof(y);\n\n    return x && y && tx === 'object' && tx === ty ? ok(x).length === ok(y).length && ok(x).every(function(key) {\n      return _this.equals(x[key], y[key]);\n    }) : x === y;\n  };\n\n  return Helper;\n}();\n\nvar Shared = function() {\n  function Shared(editor, props) {\n    this.editor = editor;\n    this.props = props;\n  }\n\n  Shared.prototype.delegateCursor = function(position, scroll, focus) {\n    var doc = this.editor.getDoc();\n\n    if (focus) {\n      this.editor.focus();\n    }\n\n    scroll ? doc.setCursor(position) : doc.setCursor(position, null, {\n      scroll: false\n    });\n  };\n\n  Shared.prototype.delegateScroll = function(coordinates) {\n    this.editor.scrollTo(coordinates.x, coordinates.y);\n  };\n\n  Shared.prototype.delegateSelection = function(ranges, focus) {\n    var doc = this.editor.getDoc();\n    doc.setSelections(ranges);\n\n    if (focus) {\n      this.editor.focus();\n    }\n  };\n\n  Shared.prototype.apply = function(props) {\n    if (props && props.selection && props.selection.ranges) {\n      this.delegateSelection(props.selection.ranges, props.selection.focus || false);\n    }\n\n    if (props && props.cursor) {\n      this.delegateCursor(props.cursor, props.autoScroll || false, this.editor.getOption('autofocus') || false);\n    }\n\n    if (props && props.scroll) {\n      this.delegateScroll(props.scroll);\n    }\n  };\n\n  Shared.prototype.applyNext = function(props, next, preserved) {\n    if (props && props.selection && props.selection.ranges) {\n      if (next && next.selection && next.selection.ranges && !Helper.equals(props.selection.ranges, next.selection.ranges)) {\n        this.delegateSelection(next.selection.ranges, next.selection.focus || false);\n      }\n    }\n\n    if (props && props.cursor) {\n      if (next && next.cursor && !Helper.equals(props.cursor, next.cursor)) {\n        this.delegateCursor(preserved.cursor || next.cursor, next.autoScroll || false, next.autoCursor || false);\n      }\n    }\n\n    if (props && props.scroll) {\n      if (next && next.scroll && !Helper.equals(props.scroll, next.scroll)) {\n        this.delegateScroll(next.scroll);\n      }\n    }\n  };\n\n  Shared.prototype.applyUserDefined = function(props, preserved) {\n    if (preserved && preserved.cursor) {\n      this.delegateCursor(preserved.cursor, props.autoScroll || false, this.editor.getOption('autofocus') || false);\n    }\n  };\n\n  Shared.prototype.wire = function(props) {\n    var _this = this;\n\n    Object.keys(props || {}).filter(function(p) {\n      return /^on/.test(p);\n    }).forEach(function(prop) {\n      switch (prop) {\n        case 'onBlur': {\n          _this.editor.on('blur', function(cm, event) {\n            _this.props.onBlur(_this.editor, event);\n          });\n        }\n        break;\n\n      case 'onContextMenu': {\n        _this.editor.on('contextmenu', function(cm, event) {\n          _this.props.onContextMenu(_this.editor, event);\n        });\n\n        break;\n      }\n\n      case 'onCopy': {\n        _this.editor.on('copy', function(cm, event) {\n          _this.props.onCopy(_this.editor, event);\n        });\n\n        break;\n      }\n\n      case 'onCursor': {\n        _this.editor.on('cursorActivity', function(cm) {\n          _this.props.onCursor(_this.editor, _this.editor.getDoc().getCursor());\n        });\n      }\n      break;\n\n      case 'onCursorActivity': {\n        _this.editor.on('cursorActivity', function(cm) {\n          _this.props.onCursorActivity(_this.editor);\n        });\n      }\n      break;\n\n      case 'onCut': {\n        _this.editor.on('cut', function(cm, event) {\n          _this.props.onCut(_this.editor, event);\n        });\n\n        break;\n      }\n\n      case 'onDblClick': {\n        _this.editor.on('dblclick', function(cm, event) {\n          _this.props.onDblClick(_this.editor, event);\n        });\n\n        break;\n      }\n\n      case 'onDragEnter': {\n        _this.editor.on('dragenter', function(cm, event) {\n          _this.props.onDragEnter(_this.editor, event);\n        });\n      }\n      break;\n\n      case 'onDragLeave': {\n        _this.editor.on('dragleave', function(cm, event) {\n          _this.props.onDragLeave(_this.editor, event);\n        });\n\n        break;\n      }\n\n      case 'onDragOver': {\n        _this.editor.on('dragover', function(cm, event) {\n          _this.props.onDragOver(_this.editor, event);\n        });\n      }\n      break;\n\n      case 'onDragStart': {\n        _this.editor.on('dragstart', function(cm, event) {\n          _this.props.onDragStart(_this.editor, event);\n        });\n\n        break;\n      }\n\n      case 'onDrop': {\n        _this.editor.on('drop', function(cm, event) {\n          _this.props.onDrop(_this.editor, event);\n        });\n      }\n      break;\n\n      case 'onFocus': {\n        _this.editor.on('focus', function(cm, event) {\n          _this.props.onFocus(_this.editor, event);\n        });\n      }\n      break;\n\n      case 'onGutterClick': {\n        _this.editor.on('gutterClick', function(cm, lineNumber, gutter, event) {\n          _this.props.onGutterClick(_this.editor, lineNumber, gutter, event);\n        });\n      }\n      break;\n\n      case 'onInputRead': {\n        _this.editor.on('inputRead', function(cm, EditorChangeEvent) {\n          _this.props.onInputRead(_this.editor, EditorChangeEvent);\n        });\n      }\n      break;\n\n      case 'onKeyDown': {\n        _this.editor.on('keydown', function(cm, event) {\n          _this.props.onKeyDown(_this.editor, event);\n        });\n      }\n      break;\n\n      case 'onKeyHandled': {\n        _this.editor.on('keyHandled', function(cm, key, event) {\n          _this.props.onKeyHandled(_this.editor, key, event);\n        });\n      }\n      break;\n\n      case 'onKeyPress': {\n        _this.editor.on('keypress', function(cm, event) {\n          _this.props.onKeyPress(_this.editor, event);\n        });\n      }\n      break;\n\n      case 'onKeyUp': {\n        _this.editor.on('keyup', function(cm, event) {\n          _this.props.onKeyUp(_this.editor, event);\n        });\n      }\n      break;\n\n      case 'onMouseDown': {\n        _this.editor.on('mousedown', function(cm, event) {\n          _this.props.onMouseDown(_this.editor, event);\n        });\n\n        break;\n      }\n\n      case 'onPaste': {\n        _this.editor.on('paste', function(cm, event) {\n          _this.props.onPaste(_this.editor, event);\n        });\n\n        break;\n      }\n\n      case 'onRenderLine': {\n        _this.editor.on('renderLine', function(cm, line, element) {\n          _this.props.onRenderLine(_this.editor, line, element);\n        });\n\n        break;\n      }\n\n      case 'onScroll': {\n        _this.editor.on('scroll', function(cm) {\n          _this.props.onScroll(_this.editor, _this.editor.getScrollInfo());\n        });\n      }\n      break;\n\n      case 'onSelection': {\n        _this.editor.on('beforeSelectionChange', function(cm, data) {\n          _this.props.onSelection(_this.editor, data);\n        });\n      }\n      break;\n\n      case 'onTouchStart': {\n        _this.editor.on('touchstart', function(cm, event) {\n          _this.props.onTouchStart(_this.editor, event);\n        });\n\n        break;\n      }\n\n      case 'onUpdate': {\n        _this.editor.on('update', function(cm) {\n          _this.props.onUpdate(_this.editor);\n        });\n      }\n      break;\n\n      case 'onViewportChange': {\n        _this.editor.on('viewportChange', function(cm, from, to) {\n          _this.props.onViewportChange(_this.editor, from, to);\n        });\n      }\n      break;\n      }\n    });\n  };\n\n  return Shared;\n}();\n\nvar Controlled = function(_super) {\n  __extends(Controlled, _super);\n\n  function Controlled(props) {\n    var _this = _super.call(this, props) || this;\n\n    if (SERVER_RENDERED) return _this;\n    _this.applied = false;\n    _this.appliedNext = false;\n    _this.appliedUserDefined = false;\n    _this.deferred = null;\n    _this.emulating = false;\n    _this.hydrated = false;\n\n    _this.initCb = function() {\n      if (_this.props.editorDidConfigure) {\n        _this.props.editorDidConfigure(_this.editor);\n      }\n    };\n\n    _this.mounted = false;\n    return _this;\n  }\n\n  Controlled.prototype.hydrate = function(props) {\n    var _this = this;\n\n    var _options = props && props.options ? props.options : {};\n\n    var userDefinedOptions = _extends({}, cm.defaults, this.editor.options, _options);\n\n    var optionDelta = Object.keys(userDefinedOptions).some(function(key) {\n      return _this.editor.getOption(key) !== userDefinedOptions[key];\n    });\n\n    if (optionDelta) {\n      Object.keys(userDefinedOptions).forEach(function(key) {\n        if (_options.hasOwnProperty(key)) {\n          if (_this.editor.getOption(key) !== userDefinedOptions[key]) {\n            _this.editor.setOption(key, userDefinedOptions[key]);\n\n            _this.mirror.setOption(key, userDefinedOptions[key]);\n          }\n        }\n      });\n    }\n\n    if (!this.hydrated) {\n      this.deferred ? this.resolveChange(props.value) : this.initChange(props.value || '');\n    }\n\n    this.hydrated = true;\n  };\n\n  Controlled.prototype.initChange = function(value) {\n    this.emulating = true;\n    var doc = this.editor.getDoc();\n    var lastLine = doc.lastLine();\n    var lastChar = doc.getLine(doc.lastLine()).length;\n    doc.replaceRange(value || '', {\n      line: 0,\n      ch: 0\n    }, {\n      line: lastLine,\n      ch: lastChar\n    });\n    this.mirror.setValue(value);\n    doc.clearHistory();\n    this.mirror.clearHistory();\n    this.emulating = false;\n  };\n\n  Controlled.prototype.resolveChange = function(value) {\n    this.emulating = true;\n    var doc = this.editor.getDoc();\n\n    if (this.deferred.origin === 'undo') {\n      doc.undo();\n    } else if (this.deferred.origin === 'redo') {\n      doc.redo();\n    } else {\n      doc.replaceRange(this.deferred.text, this.deferred.from, this.deferred.to, this.deferred.origin);\n    }\n\n    if (value && value !== doc.getValue()) {\n      var cursor = doc.getCursor();\n      doc.setValue(value);\n      doc.setCursor(cursor);\n    }\n\n    this.emulating = false;\n    this.deferred = null;\n  };\n\n  Controlled.prototype.mirrorChange = function(deferred) {\n    var doc = this.editor.getDoc();\n\n    if (deferred.origin === 'undo') {\n      doc.setHistory(this.mirror.getHistory());\n      this.mirror.undo();\n    } else if (deferred.origin === 'redo') {\n      doc.setHistory(this.mirror.getHistory());\n      this.mirror.redo();\n    } else {\n      this.mirror.replaceRange(deferred.text, deferred.from, deferred.to, deferred.origin);\n    }\n\n    return this.mirror.getValue();\n  };\n\n  Controlled.prototype.componentDidMount = function() {\n    var _this = this;\n\n    if (SERVER_RENDERED) return;\n\n    if (this.props.defineMode) {\n      if (this.props.defineMode.name && this.props.defineMode.fn) {\n        cm.defineMode(this.props.defineMode.name, this.props.defineMode.fn);\n      }\n    }\n\n    this.editor = cm(this.ref, this.props.options);\n    this.shared = new Shared(this.editor, this.props);\n    this.mirror = cm(function() {}, this.props.options);\n    this.editor.on('electricInput', function() {\n      _this.mirror.setHistory(_this.editor.getDoc().getHistory());\n    });\n    this.editor.on('cursorActivity', function() {\n      _this.mirror.setCursor(_this.editor.getDoc().getCursor());\n    });\n    this.editor.on('beforeChange', function(cm, data) {\n      if (_this.emulating) {\n        return;\n      }\n\n      data.cancel();\n      _this.deferred = data;\n\n      var phantomChange = _this.mirrorChange(_this.deferred);\n\n      if (_this.props.onBeforeChange) _this.props.onBeforeChange(_this.editor, _this.deferred, phantomChange);\n    });\n    this.editor.on('change', function(cm, data) {\n      if (!_this.mounted) {\n        return;\n      }\n\n      if (_this.props.onChange) {\n        _this.props.onChange(_this.editor, data, _this.editor.getValue());\n      }\n    });\n    this.hydrate(this.props);\n    this.shared.apply(this.props);\n    this.applied = true;\n    this.mounted = true;\n    this.shared.wire(this.props);\n\n    if (this.editor.getOption('autofocus')) {\n      this.editor.focus();\n    }\n\n    if (this.props.editorDidMount) {\n      this.props.editorDidMount(this.editor, this.editor.getValue(), this.initCb);\n    }\n  };\n\n  Controlled.prototype.componentDidUpdate = function(prevProps) {\n    if (SERVER_RENDERED) return;\n    var preserved = {\n      cursor: null\n    };\n\n    if (this.props.value !== prevProps.value) {\n      this.hydrated = false;\n    }\n\n    if (!this.props.autoCursor && this.props.autoCursor !== undefined) {\n      preserved.cursor = this.editor.getDoc().getCursor();\n    }\n\n    this.hydrate(this.props);\n\n    if (!this.appliedNext) {\n      this.shared.applyNext(prevProps, this.props, preserved);\n      this.appliedNext = true;\n    }\n\n    this.shared.applyUserDefined(prevProps, preserved);\n    this.appliedUserDefined = true;\n  };\n\n  Controlled.prototype.componentWillUnmount = function() {\n    if (SERVER_RENDERED) return;\n\n    if (this.props.editorWillUnmount) {\n      this.props.editorWillUnmount(cm);\n    }\n  };\n\n  Controlled.prototype.shouldComponentUpdate = function(nextProps, nextState) {\n    return !SERVER_RENDERED;\n  };\n\n  Controlled.prototype.render = function() {\n    var _this = this;\n\n    if (SERVER_RENDERED) return null;\n    var className = this.props.className ? 'react-codemirror2 ' + this.props.className : 'react-codemirror2';\n    return React.createElement('div', {\n      className: className,\n      ref: function ref(self) {\n        return _this.ref = self;\n      }\n    });\n  };\n\n  return Controlled;\n}(React.Component);\n\nexports.Controlled = Controlled;\n\nvar UnControlled = function(_super) {\n  __extends(UnControlled, _super);\n\n  function UnControlled(props) {\n    var _this = _super.call(this, props) || this;\n\n    if (SERVER_RENDERED) return _this;\n    _this.applied = false;\n    _this.appliedUserDefined = false;\n    _this.continueChange = false;\n    _this.detached = false;\n    _this.hydrated = false;\n\n    _this.initCb = function() {\n      if (_this.props.editorDidConfigure) {\n        _this.props.editorDidConfigure(_this.editor);\n      }\n    };\n\n    _this.mounted = false;\n\n    _this.onBeforeChangeCb = function() {\n      _this.continueChange = true;\n    };\n\n    return _this;\n  }\n\n  UnControlled.prototype.hydrate = function(props) {\n    var _this = this;\n\n    var _options = props && props.options ? props.options : {};\n\n    var userDefinedOptions = _extends({}, cm.defaults, this.editor.options, _options);\n\n    var optionDelta = Object.keys(userDefinedOptions).some(function(key) {\n      return _this.editor.getOption(key) !== userDefinedOptions[key];\n    });\n\n    if (optionDelta) {\n      Object.keys(userDefinedOptions).forEach(function(key) {\n        if (_options.hasOwnProperty(key)) {\n          if (_this.editor.getOption(key) !== userDefinedOptions[key]) {\n            _this.editor.setOption(key, userDefinedOptions[key]);\n          }\n        }\n      });\n    }\n\n    if (!this.hydrated) {\n      var doc = this.editor.getDoc();\n      var lastLine = doc.lastLine();\n      var lastChar = doc.getLine(doc.lastLine()).length;\n      doc.replaceRange(props.value || '', {\n        line: 0,\n        ch: 0\n      }, {\n        line: lastLine,\n        ch: lastChar\n      });\n    }\n\n    this.hydrated = true;\n  };\n\n  UnControlled.prototype.componentDidMount = function() {\n    var _this = this;\n\n    if (SERVER_RENDERED) return;\n    this.detached = this.props.detach === true;\n\n    if (this.props.defineMode) {\n      if (this.props.defineMode.name && this.props.defineMode.fn) {\n        cm.defineMode(this.props.defineMode.name, this.props.defineMode.fn);\n      }\n    }\n\n    this.editor = cm(this.ref, this.props.options);\n    this.shared = new Shared(this.editor, this.props);\n    this.editor.on('beforeChange', function(cm, data) {\n      if (_this.props.onBeforeChange) {\n        _this.props.onBeforeChange(_this.editor, data, _this.editor.getValue(), _this.onBeforeChangeCb);\n      }\n    });\n    this.editor.on('change', function(cm, data) {\n      if (!_this.mounted || !_this.props.onChange) {\n        return;\n      }\n\n      if (_this.props.onBeforeChange) {\n        if (_this.continueChange) {\n          _this.props.onChange(_this.editor, data, _this.editor.getValue());\n        }\n      } else {\n        _this.props.onChange(_this.editor, data, _this.editor.getValue());\n      }\n    });\n    this.hydrate(this.props);\n    this.shared.apply(this.props);\n    this.applied = true;\n    this.mounted = true;\n    this.shared.wire(this.props);\n    this.editor.getDoc().clearHistory();\n\n    if (this.props.editorDidMount) {\n      this.props.editorDidMount(this.editor, this.editor.getValue(), this.initCb);\n    }\n  };\n\n  UnControlled.prototype.componentDidUpdate = function(prevProps) {\n    if (this.detached && this.props.detach === false) {\n      this.detached = false;\n\n      if (prevProps.editorDidAttach) {\n        prevProps.editorDidAttach(this.editor);\n      }\n    }\n\n    if (!this.detached && this.props.detach === true) {\n      this.detached = true;\n\n      if (prevProps.editorDidDetach) {\n        prevProps.editorDidDetach(this.editor);\n      }\n    }\n\n    if (SERVER_RENDERED || this.detached) return;\n    var preserved = {\n      cursor: null\n    };\n\n    if (this.props.value !== prevProps.value) {\n      this.hydrated = false;\n      this.applied = false;\n      this.appliedUserDefined = false;\n    }\n\n    if (!prevProps.autoCursor && prevProps.autoCursor !== undefined) {\n      preserved.cursor = this.editor.getDoc().getCursor();\n    }\n\n    this.hydrate(this.props);\n\n    if (!this.applied) {\n      this.shared.apply(prevProps);\n      this.applied = true;\n    }\n\n    if (!this.appliedUserDefined) {\n      this.shared.applyUserDefined(prevProps, preserved);\n      this.appliedUserDefined = true;\n    }\n  };\n\n  UnControlled.prototype.componentWillUnmount = function() {\n    if (SERVER_RENDERED) return;\n\n    if (this.props.editorWillUnmount) {\n      this.props.editorWillUnmount(cm);\n    }\n  };\n\n  UnControlled.prototype.shouldComponentUpdate = function(nextProps, nextState) {\n    var update = true;\n    if (SERVER_RENDERED) update = false;\n    if (this.detached && nextProps.detach) update = false;\n    return update;\n  };\n\n  UnControlled.prototype.render = function() {\n    var _this = this;\n\n    if (SERVER_RENDERED) return null;\n    var className = this.props.className ? 'react-codemirror2 ' + this.props.className : 'react-codemirror2';\n    return React.createElement('div', {\n      className: className,\n      ref: function ref(self) {\n        return _this.ref = self;\n      }\n    });\n  };\n\n  return UnControlled;\n}(React.Component);\n\nexports.UnControlled = UnControlled;","// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: https://codemirror.net/LICENSE\n\n// This is CodeMirror (https://codemirror.net), a code editor\n// implemented in JavaScript on top of the browser's DOM.\n//\n// You can find some technical background for some of the code below\n// at http://marijnhaverbeke.nl/blog/#cm-internals .\n\n(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n  typeof define === 'function' && define.amd ? define(factory) :\n  (global = global || self, global.CodeMirror = factory());\n}(this, (function () { 'use strict';\n\n  // Kludges for bugs and behavior differences that can't be feature\n  // detected are enabled based on userAgent etc sniffing.\n  var userAgent = navigator.userAgent;\n  var platform = navigator.platform;\n\n  var gecko = /gecko\\/\\d/i.test(userAgent);\n  var ie_upto10 = /MSIE \\d/.test(userAgent);\n  var ie_11up = /Trident\\/(?:[7-9]|\\d{2,})\\..*rv:(\\d+)/.exec(userAgent);\n  var edge = /Edge\\/(\\d+)/.exec(userAgent);\n  var ie = ie_upto10 || ie_11up || edge;\n  var ie_version = ie && (ie_upto10 ? document.documentMode || 6 : +(edge || ie_11up)[1]);\n  var webkit = !edge && /WebKit\\//.test(userAgent);\n  var qtwebkit = webkit && /Qt\\/\\d+\\.\\d+/.test(userAgent);\n  var chrome = !edge && /Chrome\\//.test(userAgent);\n  var presto = /Opera\\//.test(userAgent);\n  var safari = /Apple Computer/.test(navigator.vendor);\n  var mac_geMountainLion = /Mac OS X 1\\d\\D([8-9]|\\d\\d)\\D/.test(userAgent);\n  var phantom = /PhantomJS/.test(userAgent);\n\n  var ios = safari && (/Mobile\\/\\w+/.test(userAgent) || navigator.maxTouchPoints > 2);\n  var android = /Android/.test(userAgent);\n  // This is woefully incomplete. Suggestions for alternative methods welcome.\n  var mobile = ios || android || /webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(userAgent);\n  var mac = ios || /Mac/.test(platform);\n  var chromeOS = /\\bCrOS\\b/.test(userAgent);\n  var windows = /win/i.test(platform);\n\n  var presto_version = presto && userAgent.match(/Version\\/(\\d*\\.\\d*)/);\n  if (presto_version) { presto_version = Number(presto_version[1]); }\n  if (presto_version && presto_version >= 15) { presto = false; webkit = true; }\n  // Some browsers use the wrong event properties to signal cmd/ctrl on OS X\n  var flipCtrlCmd = mac && (qtwebkit || presto && (presto_version == null || presto_version < 12.11));\n  var captureRightClick = gecko || (ie && ie_version >= 9);\n\n  function classTest(cls) { return new RegExp(\"(^|\\\\s)\" + cls + \"(?:$|\\\\s)\\\\s*\") }\n\n  var rmClass = function(node, cls) {\n    var current = node.className;\n    var match = classTest(cls).exec(current);\n    if (match) {\n      var after = current.slice(match.index + match[0].length);\n      node.className = current.slice(0, match.index) + (after ? match[1] + after : \"\");\n    }\n  };\n\n  function removeChildren(e) {\n    for (var count = e.childNodes.length; count > 0; --count)\n      { e.removeChild(e.firstChild); }\n    return e\n  }\n\n  function removeChildrenAndAdd(parent, e) {\n    return removeChildren(parent).appendChild(e)\n  }\n\n  function elt(tag, content, className, style) {\n    var e = document.createElement(tag);\n    if (className) { e.className = className; }\n    if (style) { e.style.cssText = style; }\n    if (typeof content == \"string\") { e.appendChild(document.createTextNode(content)); }\n    else if (content) { for (var i = 0; i < content.length; ++i) { e.appendChild(content[i]); } }\n    return e\n  }\n  // wrapper for elt, which removes the elt from the accessibility tree\n  function eltP(tag, content, className, style) {\n    var e = elt(tag, content, className, style);\n    e.setAttribute(\"role\", \"presentation\");\n    return e\n  }\n\n  var range;\n  if (document.createRange) { range = function(node, start, end, endNode) {\n    var r = document.createRange();\n    r.setEnd(endNode || node, end);\n    r.setStart(node, start);\n    return r\n  }; }\n  else { range = function(node, start, end) {\n    var r = document.body.createTextRange();\n    try { r.moveToElementText(node.parentNode); }\n    catch(e) { return r }\n    r.collapse(true);\n    r.moveEnd(\"character\", end);\n    r.moveStart(\"character\", start);\n    return r\n  }; }\n\n  function contains(parent, child) {\n    if (child.nodeType == 3) // Android browser always returns false when child is a textnode\n      { child = child.parentNode; }\n    if (parent.contains)\n      { return parent.contains(child) }\n    do {\n      if (child.nodeType == 11) { child = child.host; }\n      if (child == parent) { return true }\n    } while (child = child.parentNode)\n  }\n\n  function activeElt() {\n    // IE and Edge may throw an \"Unspecified Error\" when accessing document.activeElement.\n    // IE < 10 will throw when accessed while the page is loading or in an iframe.\n    // IE > 9 and Edge will throw when accessed in an iframe if document.body is unavailable.\n    var activeElement;\n    try {\n      activeElement = document.activeElement;\n    } catch(e) {\n      activeElement = document.body || null;\n    }\n    while (activeElement && activeElement.shadowRoot && activeElement.shadowRoot.activeElement)\n      { activeElement = activeElement.shadowRoot.activeElement; }\n    return activeElement\n  }\n\n  function addClass(node, cls) {\n    var current = node.className;\n    if (!classTest(cls).test(current)) { node.className += (current ? \" \" : \"\") + cls; }\n  }\n  function joinClasses(a, b) {\n    var as = a.split(\" \");\n    for (var i = 0; i < as.length; i++)\n      { if (as[i] && !classTest(as[i]).test(b)) { b += \" \" + as[i]; } }\n    return b\n  }\n\n  var selectInput = function(node) { node.select(); };\n  if (ios) // Mobile Safari apparently has a bug where select() is broken.\n    { selectInput = function(node) { node.selectionStart = 0; node.selectionEnd = node.value.length; }; }\n  else if (ie) // Suppress mysterious IE10 errors\n    { selectInput = function(node) { try { node.select(); } catch(_e) {} }; }\n\n  function bind(f) {\n    var args = Array.prototype.slice.call(arguments, 1);\n    return function(){return f.apply(null, args)}\n  }\n\n  function copyObj(obj, target, overwrite) {\n    if (!target) { target = {}; }\n    for (var prop in obj)\n      { if (obj.hasOwnProperty(prop) && (overwrite !== false || !target.hasOwnProperty(prop)))\n        { target[prop] = obj[prop]; } }\n    return target\n  }\n\n  // Counts the column offset in a string, taking tabs into account.\n  // Used mostly to find indentation.\n  function countColumn(string, end, tabSize, startIndex, startValue) {\n    if (end == null) {\n      end = string.search(/[^\\s\\u00a0]/);\n      if (end == -1) { end = string.length; }\n    }\n    for (var i = startIndex || 0, n = startValue || 0;;) {\n      var nextTab = string.indexOf(\"\\t\", i);\n      if (nextTab < 0 || nextTab >= end)\n        { return n + (end - i) }\n      n += nextTab - i;\n      n += tabSize - (n % tabSize);\n      i = nextTab + 1;\n    }\n  }\n\n  var Delayed = function() {\n    this.id = null;\n    this.f = null;\n    this.time = 0;\n    this.handler = bind(this.onTimeout, this);\n  };\n  Delayed.prototype.onTimeout = function (self) {\n    self.id = 0;\n    if (self.time <= +new Date) {\n      self.f();\n    } else {\n      setTimeout(self.handler, self.time - +new Date);\n    }\n  };\n  Delayed.prototype.set = function (ms, f) {\n    this.f = f;\n    var time = +new Date + ms;\n    if (!this.id || time < this.time) {\n      clearTimeout(this.id);\n      this.id = setTimeout(this.handler, ms);\n      this.time = time;\n    }\n  };\n\n  function indexOf(array, elt) {\n    for (var i = 0; i < array.length; ++i)\n      { if (array[i] == elt) { return i } }\n    return -1\n  }\n\n  // Number of pixels added to scroller and sizer to hide scrollbar\n  var scrollerGap = 50;\n\n  // Returned or thrown by various protocols to signal 'I'm not\n  // handling this'.\n  var Pass = {toString: function(){return \"CodeMirror.Pass\"}};\n\n  // Reused option objects for setSelection & friends\n  var sel_dontScroll = {scroll: false}, sel_mouse = {origin: \"*mouse\"}, sel_move = {origin: \"+move\"};\n\n  // The inverse of countColumn -- find the offset that corresponds to\n  // a particular column.\n  function findColumn(string, goal, tabSize) {\n    for (var pos = 0, col = 0;;) {\n      var nextTab = string.indexOf(\"\\t\", pos);\n      if (nextTab == -1) { nextTab = string.length; }\n      var skipped = nextTab - pos;\n      if (nextTab == string.length || col + skipped >= goal)\n        { return pos + Math.min(skipped, goal - col) }\n      col += nextTab - pos;\n      col += tabSize - (col % tabSize);\n      pos = nextTab + 1;\n      if (col >= goal) { return pos }\n    }\n  }\n\n  var spaceStrs = [\"\"];\n  function spaceStr(n) {\n    while (spaceStrs.length <= n)\n      { spaceStrs.push(lst(spaceStrs) + \" \"); }\n    return spaceStrs[n]\n  }\n\n  function lst(arr) { return arr[arr.length-1] }\n\n  function map(array, f) {\n    var out = [];\n    for (var i = 0; i < array.length; i++) { out[i] = f(array[i], i); }\n    return out\n  }\n\n  function insertSorted(array, value, score) {\n    var pos = 0, priority = score(value);\n    while (pos < array.length && score(array[pos]) <= priority) { pos++; }\n    array.splice(pos, 0, value);\n  }\n\n  function nothing() {}\n\n  function createObj(base, props) {\n    var inst;\n    if (Object.create) {\n      inst = Object.create(base);\n    } else {\n      nothing.prototype = base;\n      inst = new nothing();\n    }\n    if (props) { copyObj(props, inst); }\n    return inst\n  }\n\n  var nonASCIISingleCaseWordChar = /[\\u00df\\u0587\\u0590-\\u05f4\\u0600-\\u06ff\\u3040-\\u309f\\u30a0-\\u30ff\\u3400-\\u4db5\\u4e00-\\u9fcc\\uac00-\\ud7af]/;\n  function isWordCharBasic(ch) {\n    return /\\w/.test(ch) || ch > \"\\x80\" &&\n      (ch.toUpperCase() != ch.toLowerCase() || nonASCIISingleCaseWordChar.test(ch))\n  }\n  function isWordChar(ch, helper) {\n    if (!helper) { return isWordCharBasic(ch) }\n    if (helper.source.indexOf(\"\\\\w\") > -1 && isWordCharBasic(ch)) { return true }\n    return helper.test(ch)\n  }\n\n  function isEmpty(obj) {\n    for (var n in obj) { if (obj.hasOwnProperty(n) && obj[n]) { return false } }\n    return true\n  }\n\n  // Extending unicode characters. A series of a non-extending char +\n  // any number of extending chars is treated as a single unit as far\n  // as editing and measuring is concerned. This is not fully correct,\n  // since some scripts/fonts/browsers also treat other configurations\n  // of code points as a group.\n  var extendingChars = /[\\u0300-\\u036f\\u0483-\\u0489\\u0591-\\u05bd\\u05bf\\u05c1\\u05c2\\u05c4\\u05c5\\u05c7\\u0610-\\u061a\\u064b-\\u065e\\u0670\\u06d6-\\u06dc\\u06de-\\u06e4\\u06e7\\u06e8\\u06ea-\\u06ed\\u0711\\u0730-\\u074a\\u07a6-\\u07b0\\u07eb-\\u07f3\\u0816-\\u0819\\u081b-\\u0823\\u0825-\\u0827\\u0829-\\u082d\\u0900-\\u0902\\u093c\\u0941-\\u0948\\u094d\\u0951-\\u0955\\u0962\\u0963\\u0981\\u09bc\\u09be\\u09c1-\\u09c4\\u09cd\\u09d7\\u09e2\\u09e3\\u0a01\\u0a02\\u0a3c\\u0a41\\u0a42\\u0a47\\u0a48\\u0a4b-\\u0a4d\\u0a51\\u0a70\\u0a71\\u0a75\\u0a81\\u0a82\\u0abc\\u0ac1-\\u0ac5\\u0ac7\\u0ac8\\u0acd\\u0ae2\\u0ae3\\u0b01\\u0b3c\\u0b3e\\u0b3f\\u0b41-\\u0b44\\u0b4d\\u0b56\\u0b57\\u0b62\\u0b63\\u0b82\\u0bbe\\u0bc0\\u0bcd\\u0bd7\\u0c3e-\\u0c40\\u0c46-\\u0c48\\u0c4a-\\u0c4d\\u0c55\\u0c56\\u0c62\\u0c63\\u0cbc\\u0cbf\\u0cc2\\u0cc6\\u0ccc\\u0ccd\\u0cd5\\u0cd6\\u0ce2\\u0ce3\\u0d3e\\u0d41-\\u0d44\\u0d4d\\u0d57\\u0d62\\u0d63\\u0dca\\u0dcf\\u0dd2-\\u0dd4\\u0dd6\\u0ddf\\u0e31\\u0e34-\\u0e3a\\u0e47-\\u0e4e\\u0eb1\\u0eb4-\\u0eb9\\u0ebb\\u0ebc\\u0ec8-\\u0ecd\\u0f18\\u0f19\\u0f35\\u0f37\\u0f39\\u0f71-\\u0f7e\\u0f80-\\u0f84\\u0f86\\u0f87\\u0f90-\\u0f97\\u0f99-\\u0fbc\\u0fc6\\u102d-\\u1030\\u1032-\\u1037\\u1039\\u103a\\u103d\\u103e\\u1058\\u1059\\u105e-\\u1060\\u1071-\\u1074\\u1082\\u1085\\u1086\\u108d\\u109d\\u135f\\u1712-\\u1714\\u1732-\\u1734\\u1752\\u1753\\u1772\\u1773\\u17b7-\\u17bd\\u17c6\\u17c9-\\u17d3\\u17dd\\u180b-\\u180d\\u18a9\\u1920-\\u1922\\u1927\\u1928\\u1932\\u1939-\\u193b\\u1a17\\u1a18\\u1a56\\u1a58-\\u1a5e\\u1a60\\u1a62\\u1a65-\\u1a6c\\u1a73-\\u1a7c\\u1a7f\\u1b00-\\u1b03\\u1b34\\u1b36-\\u1b3a\\u1b3c\\u1b42\\u1b6b-\\u1b73\\u1b80\\u1b81\\u1ba2-\\u1ba5\\u1ba8\\u1ba9\\u1c2c-\\u1c33\\u1c36\\u1c37\\u1cd0-\\u1cd2\\u1cd4-\\u1ce0\\u1ce2-\\u1ce8\\u1ced\\u1dc0-\\u1de6\\u1dfd-\\u1dff\\u200c\\u200d\\u20d0-\\u20f0\\u2cef-\\u2cf1\\u2de0-\\u2dff\\u302a-\\u302f\\u3099\\u309a\\ua66f-\\ua672\\ua67c\\ua67d\\ua6f0\\ua6f1\\ua802\\ua806\\ua80b\\ua825\\ua826\\ua8c4\\ua8e0-\\ua8f1\\ua926-\\ua92d\\ua947-\\ua951\\ua980-\\ua982\\ua9b3\\ua9b6-\\ua9b9\\ua9bc\\uaa29-\\uaa2e\\uaa31\\uaa32\\uaa35\\uaa36\\uaa43\\uaa4c\\uaab0\\uaab2-\\uaab4\\uaab7\\uaab8\\uaabe\\uaabf\\uaac1\\uabe5\\uabe8\\uabed\\udc00-\\udfff\\ufb1e\\ufe00-\\ufe0f\\ufe20-\\ufe26\\uff9e\\uff9f]/;\n  function isExtendingChar(ch) { return ch.charCodeAt(0) >= 768 && extendingChars.test(ch) }\n\n  // Returns a number from the range [`0`; `str.length`] unless `pos` is outside that range.\n  function skipExtendingChars(str, pos, dir) {\n    while ((dir < 0 ? pos > 0 : pos < str.length) && isExtendingChar(str.charAt(pos))) { pos += dir; }\n    return pos\n  }\n\n  // Returns the value from the range [`from`; `to`] that satisfies\n  // `pred` and is closest to `from`. Assumes that at least `to`\n  // satisfies `pred`. Supports `from` being greater than `to`.\n  function findFirst(pred, from, to) {\n    // At any point we are certain `to` satisfies `pred`, don't know\n    // whether `from` does.\n    var dir = from > to ? -1 : 1;\n    for (;;) {\n      if (from == to) { return from }\n      var midF = (from + to) / 2, mid = dir < 0 ? Math.ceil(midF) : Math.floor(midF);\n      if (mid == from) { return pred(mid) ? from : to }\n      if (pred(mid)) { to = mid; }\n      else { from = mid + dir; }\n    }\n  }\n\n  // BIDI HELPERS\n\n  function iterateBidiSections(order, from, to, f) {\n    if (!order) { return f(from, to, \"ltr\", 0) }\n    var found = false;\n    for (var i = 0; i < order.length; ++i) {\n      var part = order[i];\n      if (part.from < to && part.to > from || from == to && part.to == from) {\n        f(Math.max(part.from, from), Math.min(part.to, to), part.level == 1 ? \"rtl\" : \"ltr\", i);\n        found = true;\n      }\n    }\n    if (!found) { f(from, to, \"ltr\"); }\n  }\n\n  var bidiOther = null;\n  function getBidiPartAt(order, ch, sticky) {\n    var found;\n    bidiOther = null;\n    for (var i = 0; i < order.length; ++i) {\n      var cur = order[i];\n      if (cur.from < ch && cur.to > ch) { return i }\n      if (cur.to == ch) {\n        if (cur.from != cur.to && sticky == \"before\") { found = i; }\n        else { bidiOther = i; }\n      }\n      if (cur.from == ch) {\n        if (cur.from != cur.to && sticky != \"before\") { found = i; }\n        else { bidiOther = i; }\n      }\n    }\n    return found != null ? found : bidiOther\n  }\n\n  // Bidirectional ordering algorithm\n  // See http://unicode.org/reports/tr9/tr9-13.html for the algorithm\n  // that this (partially) implements.\n\n  // One-char codes used for character types:\n  // L (L):   Left-to-Right\n  // R (R):   Right-to-Left\n  // r (AL):  Right-to-Left Arabic\n  // 1 (EN):  European Number\n  // + (ES):  European Number Separator\n  // % (ET):  European Number Terminator\n  // n (AN):  Arabic Number\n  // , (CS):  Common Number Separator\n  // m (NSM): Non-Spacing Mark\n  // b (BN):  Boundary Neutral\n  // s (B):   Paragraph Separator\n  // t (S):   Segment Separator\n  // w (WS):  Whitespace\n  // N (ON):  Other Neutrals\n\n  // Returns null if characters are ordered as they appear\n  // (left-to-right), or an array of sections ({from, to, level}\n  // objects) in the order in which they occur visually.\n  var bidiOrdering = (function() {\n    // Character types for codepoints 0 to 0xff\n    var lowTypes = \"bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLN\";\n    // Character types for codepoints 0x600 to 0x6f9\n    var arabicTypes = \"nnnnnnNNr%%r,rNNmmmmmmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmmmnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmnNmmmmmmrrmmNmmmmrr1111111111\";\n    function charType(code) {\n      if (code <= 0xf7) { return lowTypes.charAt(code) }\n      else if (0x590 <= code && code <= 0x5f4) { return \"R\" }\n      else if (0x600 <= code && code <= 0x6f9) { return arabicTypes.charAt(code - 0x600) }\n      else if (0x6ee <= code && code <= 0x8ac) { return \"r\" }\n      else if (0x2000 <= code && code <= 0x200b) { return \"w\" }\n      else if (code == 0x200c) { return \"b\" }\n      else { return \"L\" }\n    }\n\n    var bidiRE = /[\\u0590-\\u05f4\\u0600-\\u06ff\\u0700-\\u08ac]/;\n    var isNeutral = /[stwN]/, isStrong = /[LRr]/, countsAsLeft = /[Lb1n]/, countsAsNum = /[1n]/;\n\n    function BidiSpan(level, from, to) {\n      this.level = level;\n      this.from = from; this.to = to;\n    }\n\n    return function(str, direction) {\n      var outerType = direction == \"ltr\" ? \"L\" : \"R\";\n\n      if (str.length == 0 || direction == \"ltr\" && !bidiRE.test(str)) { return false }\n      var len = str.length, types = [];\n      for (var i = 0; i < len; ++i)\n        { types.push(charType(str.charCodeAt(i))); }\n\n      // W1. Examine each non-spacing mark (NSM) in the level run, and\n      // change the type of the NSM to the type of the previous\n      // character. If the NSM is at the start of the level run, it will\n      // get the type of sor.\n      for (var i$1 = 0, prev = outerType; i$1 < len; ++i$1) {\n        var type = types[i$1];\n        if (type == \"m\") { types[i$1] = prev; }\n        else { prev = type; }\n      }\n\n      // W2. Search backwards from each instance of a European number\n      // until the first strong type (R, L, AL, or sor) is found. If an\n      // AL is found, change the type of the European number to Arabic\n      // number.\n      // W3. Change all ALs to R.\n      for (var i$2 = 0, cur = outerType; i$2 < len; ++i$2) {\n        var type$1 = types[i$2];\n        if (type$1 == \"1\" && cur == \"r\") { types[i$2] = \"n\"; }\n        else if (isStrong.test(type$1)) { cur = type$1; if (type$1 == \"r\") { types[i$2] = \"R\"; } }\n      }\n\n      // W4. A single European separator between two European numbers\n      // changes to a European number. A single common separator between\n      // two numbers of the same type changes to that type.\n      for (var i$3 = 1, prev$1 = types[0]; i$3 < len - 1; ++i$3) {\n        var type$2 = types[i$3];\n        if (type$2 == \"+\" && prev$1 == \"1\" && types[i$3+1] == \"1\") { types[i$3] = \"1\"; }\n        else if (type$2 == \",\" && prev$1 == types[i$3+1] &&\n                 (prev$1 == \"1\" || prev$1 == \"n\")) { types[i$3] = prev$1; }\n        prev$1 = type$2;\n      }\n\n      // W5. A sequence of European terminators adjacent to European\n      // numbers changes to all European numbers.\n      // W6. Otherwise, separators and terminators change to Other\n      // Neutral.\n      for (var i$4 = 0; i$4 < len; ++i$4) {\n        var type$3 = types[i$4];\n        if (type$3 == \",\") { types[i$4] = \"N\"; }\n        else if (type$3 == \"%\") {\n          var end = (void 0);\n          for (end = i$4 + 1; end < len && types[end] == \"%\"; ++end) {}\n          var replace = (i$4 && types[i$4-1] == \"!\") || (end < len && types[end] == \"1\") ? \"1\" : \"N\";\n          for (var j = i$4; j < end; ++j) { types[j] = replace; }\n          i$4 = end - 1;\n        }\n      }\n\n      // W7. Search backwards from each instance of a European number\n      // until the first strong type (R, L, or sor) is found. If an L is\n      // found, then change the type of the European number to L.\n      for (var i$5 = 0, cur$1 = outerType; i$5 < len; ++i$5) {\n        var type$4 = types[i$5];\n        if (cur$1 == \"L\" && type$4 == \"1\") { types[i$5] = \"L\"; }\n        else if (isStrong.test(type$4)) { cur$1 = type$4; }\n      }\n\n      // N1. A sequence of neutrals takes the direction of the\n      // surrounding strong text if the text on both sides has the same\n      // direction. European and Arabic numbers act as if they were R in\n      // terms of their influence on neutrals. Start-of-level-run (sor)\n      // and end-of-level-run (eor) are used at level run boundaries.\n      // N2. Any remaining neutrals take the embedding direction.\n      for (var i$6 = 0; i$6 < len; ++i$6) {\n        if (isNeutral.test(types[i$6])) {\n          var end$1 = (void 0);\n          for (end$1 = i$6 + 1; end$1 < len && isNeutral.test(types[end$1]); ++end$1) {}\n          var before = (i$6 ? types[i$6-1] : outerType) == \"L\";\n          var after = (end$1 < len ? types[end$1] : outerType) == \"L\";\n          var replace$1 = before == after ? (before ? \"L\" : \"R\") : outerType;\n          for (var j$1 = i$6; j$1 < end$1; ++j$1) { types[j$1] = replace$1; }\n          i$6 = end$1 - 1;\n        }\n      }\n\n      // Here we depart from the documented algorithm, in order to avoid\n      // building up an actual levels array. Since there are only three\n      // levels (0, 1, 2) in an implementation that doesn't take\n      // explicit embedding into account, we can build up the order on\n      // the fly, without following the level-based algorithm.\n      var order = [], m;\n      for (var i$7 = 0; i$7 < len;) {\n        if (countsAsLeft.test(types[i$7])) {\n          var start = i$7;\n          for (++i$7; i$7 < len && countsAsLeft.test(types[i$7]); ++i$7) {}\n          order.push(new BidiSpan(0, start, i$7));\n        } else {\n          var pos = i$7, at = order.length, isRTL = direction == \"rtl\" ? 1 : 0;\n          for (++i$7; i$7 < len && types[i$7] != \"L\"; ++i$7) {}\n          for (var j$2 = pos; j$2 < i$7;) {\n            if (countsAsNum.test(types[j$2])) {\n              if (pos < j$2) { order.splice(at, 0, new BidiSpan(1, pos, j$2)); at += isRTL; }\n              var nstart = j$2;\n              for (++j$2; j$2 < i$7 && countsAsNum.test(types[j$2]); ++j$2) {}\n              order.splice(at, 0, new BidiSpan(2, nstart, j$2));\n              at += isRTL;\n              pos = j$2;\n            } else { ++j$2; }\n          }\n          if (pos < i$7) { order.splice(at, 0, new BidiSpan(1, pos, i$7)); }\n        }\n      }\n      if (direction == \"ltr\") {\n        if (order[0].level == 1 && (m = str.match(/^\\s+/))) {\n          order[0].from = m[0].length;\n          order.unshift(new BidiSpan(0, 0, m[0].length));\n        }\n        if (lst(order).level == 1 && (m = str.match(/\\s+$/))) {\n          lst(order).to -= m[0].length;\n          order.push(new BidiSpan(0, len - m[0].length, len));\n        }\n      }\n\n      return direction == \"rtl\" ? order.reverse() : order\n    }\n  })();\n\n  // Get the bidi ordering for the given line (and cache it). Returns\n  // false for lines that are fully left-to-right, and an array of\n  // BidiSpan objects otherwise.\n  function getOrder(line, direction) {\n    var order = line.order;\n    if (order == null) { order = line.order = bidiOrdering(line.text, direction); }\n    return order\n  }\n\n  // EVENT HANDLING\n\n  // Lightweight event framework. on/off also work on DOM nodes,\n  // registering native DOM handlers.\n\n  var noHandlers = [];\n\n  var on = function(emitter, type, f) {\n    if (emitter.addEventListener) {\n      emitter.addEventListener(type, f, false);\n    } else if (emitter.attachEvent) {\n      emitter.attachEvent(\"on\" + type, f);\n    } else {\n      var map = emitter._handlers || (emitter._handlers = {});\n      map[type] = (map[type] || noHandlers).concat(f);\n    }\n  };\n\n  function getHandlers(emitter, type) {\n    return emitter._handlers && emitter._handlers[type] || noHandlers\n  }\n\n  function off(emitter, type, f) {\n    if (emitter.removeEventListener) {\n      emitter.removeEventListener(type, f, false);\n    } else if (emitter.detachEvent) {\n      emitter.detachEvent(\"on\" + type, f);\n    } else {\n      var map = emitter._handlers, arr = map && map[type];\n      if (arr) {\n        var index = indexOf(arr, f);\n        if (index > -1)\n          { map[type] = arr.slice(0, index).concat(arr.slice(index + 1)); }\n      }\n    }\n  }\n\n  function signal(emitter, type /*, values...*/) {\n    var handlers = getHandlers(emitter, type);\n    if (!handlers.length) { return }\n    var args = Array.prototype.slice.call(arguments, 2);\n    for (var i = 0; i < handlers.length; ++i) { handlers[i].apply(null, args); }\n  }\n\n  // The DOM events that CodeMirror handles can be overridden by\n  // registering a (non-DOM) handler on the editor for the event name,\n  // and preventDefault-ing the event in that handler.\n  function signalDOMEvent(cm, e, override) {\n    if (typeof e == \"string\")\n      { e = {type: e, preventDefault: function() { this.defaultPrevented = true; }}; }\n    signal(cm, override || e.type, cm, e);\n    return e_defaultPrevented(e) || e.codemirrorIgnore\n  }\n\n  function signalCursorActivity(cm) {\n    var arr = cm._handlers && cm._handlers.cursorActivity;\n    if (!arr) { return }\n    var set = cm.curOp.cursorActivityHandlers || (cm.curOp.cursorActivityHandlers = []);\n    for (var i = 0; i < arr.length; ++i) { if (indexOf(set, arr[i]) == -1)\n      { set.push(arr[i]); } }\n  }\n\n  function hasHandler(emitter, type) {\n    return getHandlers(emitter, type).length > 0\n  }\n\n  // Add on and off methods to a constructor's prototype, to make\n  // registering events on such objects more convenient.\n  function eventMixin(ctor) {\n    ctor.prototype.on = function(type, f) {on(this, type, f);};\n    ctor.prototype.off = function(type, f) {off(this, type, f);};\n  }\n\n  // Due to the fact that we still support jurassic IE versions, some\n  // compatibility wrappers are needed.\n\n  function e_preventDefault(e) {\n    if (e.preventDefault) { e.preventDefault(); }\n    else { e.returnValue = false; }\n  }\n  function e_stopPropagation(e) {\n    if (e.stopPropagation) { e.stopPropagation(); }\n    else { e.cancelBubble = true; }\n  }\n  function e_defaultPrevented(e) {\n    return e.defaultPrevented != null ? e.defaultPrevented : e.returnValue == false\n  }\n  function e_stop(e) {e_preventDefault(e); e_stopPropagation(e);}\n\n  function e_target(e) {return e.target || e.srcElement}\n  function e_button(e) {\n    var b = e.which;\n    if (b == null) {\n      if (e.button & 1) { b = 1; }\n      else if (e.button & 2) { b = 3; }\n      else if (e.button & 4) { b = 2; }\n    }\n    if (mac && e.ctrlKey && b == 1) { b = 3; }\n    return b\n  }\n\n  // Detect drag-and-drop\n  var dragAndDrop = function() {\n    // There is *some* kind of drag-and-drop support in IE6-8, but I\n    // couldn't get it to work yet.\n    if (ie && ie_version < 9) { return false }\n    var div = elt('div');\n    return \"draggable\" in div || \"dragDrop\" in div\n  }();\n\n  var zwspSupported;\n  function zeroWidthElement(measure) {\n    if (zwspSupported == null) {\n      var test = elt(\"span\", \"\\u200b\");\n      removeChildrenAndAdd(measure, elt(\"span\", [test, document.createTextNode(\"x\")]));\n      if (measure.firstChild.offsetHeight != 0)\n        { zwspSupported = test.offsetWidth <= 1 && test.offsetHeight > 2 && !(ie && ie_version < 8); }\n    }\n    var node = zwspSupported ? elt(\"span\", \"\\u200b\") :\n      elt(\"span\", \"\\u00a0\", null, \"display: inline-block; width: 1px; margin-right: -1px\");\n    node.setAttribute(\"cm-text\", \"\");\n    return node\n  }\n\n  // Feature-detect IE's crummy client rect reporting for bidi text\n  var badBidiRects;\n  function hasBadBidiRects(measure) {\n    if (badBidiRects != null) { return badBidiRects }\n    var txt = removeChildrenAndAdd(measure, document.createTextNode(\"A\\u062eA\"));\n    var r0 = range(txt, 0, 1).getBoundingClientRect();\n    var r1 = range(txt, 1, 2).getBoundingClientRect();\n    removeChildren(measure);\n    if (!r0 || r0.left == r0.right) { return false } // Safari returns null in some cases (#2780)\n    return badBidiRects = (r1.right - r0.right < 3)\n  }\n\n  // See if \"\".split is the broken IE version, if so, provide an\n  // alternative way to split lines.\n  var splitLinesAuto = \"\\n\\nb\".split(/\\n/).length != 3 ? function (string) {\n    var pos = 0, result = [], l = string.length;\n    while (pos <= l) {\n      var nl = string.indexOf(\"\\n\", pos);\n      if (nl == -1) { nl = string.length; }\n      var line = string.slice(pos, string.charAt(nl - 1) == \"\\r\" ? nl - 1 : nl);\n      var rt = line.indexOf(\"\\r\");\n      if (rt != -1) {\n        result.push(line.slice(0, rt));\n        pos += rt + 1;\n      } else {\n        result.push(line);\n        pos = nl + 1;\n      }\n    }\n    return result\n  } : function (string) { return string.split(/\\r\\n?|\\n/); };\n\n  var hasSelection = window.getSelection ? function (te) {\n    try { return te.selectionStart != te.selectionEnd }\n    catch(e) { return false }\n  } : function (te) {\n    var range;\n    try {range = te.ownerDocument.selection.createRange();}\n    catch(e) {}\n    if (!range || range.parentElement() != te) { return false }\n    return range.compareEndPoints(\"StartToEnd\", range) != 0\n  };\n\n  var hasCopyEvent = (function () {\n    var e = elt(\"div\");\n    if (\"oncopy\" in e) { return true }\n    e.setAttribute(\"oncopy\", \"return;\");\n    return typeof e.oncopy == \"function\"\n  })();\n\n  var badZoomedRects = null;\n  function hasBadZoomedRects(measure) {\n    if (badZoomedRects != null) { return badZoomedRects }\n    var node = removeChildrenAndAdd(measure, elt(\"span\", \"x\"));\n    var normal = node.getBoundingClientRect();\n    var fromRange = range(node, 0, 1).getBoundingClientRect();\n    return badZoomedRects = Math.abs(normal.left - fromRange.left) > 1\n  }\n\n  // Known modes, by name and by MIME\n  var modes = {}, mimeModes = {};\n\n  // Extra arguments are stored as the mode's dependencies, which is\n  // used by (legacy) mechanisms like loadmode.js to automatically\n  // load a mode. (Preferred mechanism is the require/define calls.)\n  function defineMode(name, mode) {\n    if (arguments.length > 2)\n      { mode.dependencies = Array.prototype.slice.call(arguments, 2); }\n    modes[name] = mode;\n  }\n\n  function defineMIME(mime, spec) {\n    mimeModes[mime] = spec;\n  }\n\n  // Given a MIME type, a {name, ...options} config object, or a name\n  // string, return a mode config object.\n  function resolveMode(spec) {\n    if (typeof spec == \"string\" && mimeModes.hasOwnProperty(spec)) {\n      spec = mimeModes[spec];\n    } else if (spec && typeof spec.name == \"string\" && mimeModes.hasOwnProperty(spec.name)) {\n      var found = mimeModes[spec.name];\n      if (typeof found == \"string\") { found = {name: found}; }\n      spec = createObj(found, spec);\n      spec.name = found.name;\n    } else if (typeof spec == \"string\" && /^[\\w\\-]+\\/[\\w\\-]+\\+xml$/.test(spec)) {\n      return resolveMode(\"application/xml\")\n    } else if (typeof spec == \"string\" && /^[\\w\\-]+\\/[\\w\\-]+\\+json$/.test(spec)) {\n      return resolveMode(\"application/json\")\n    }\n    if (typeof spec == \"string\") { return {name: spec} }\n    else { return spec || {name: \"null\"} }\n  }\n\n  // Given a mode spec (anything that resolveMode accepts), find and\n  // initialize an actual mode object.\n  function getMode(options, spec) {\n    spec = resolveMode(spec);\n    var mfactory = modes[spec.name];\n    if (!mfactory) { return getMode(options, \"text/plain\") }\n    var modeObj = mfactory(options, spec);\n    if (modeExtensions.hasOwnProperty(spec.name)) {\n      var exts = modeExtensions[spec.name];\n      for (var prop in exts) {\n        if (!exts.hasOwnProperty(prop)) { continue }\n        if (modeObj.hasOwnProperty(prop)) { modeObj[\"_\" + prop] = modeObj[prop]; }\n        modeObj[prop] = exts[prop];\n      }\n    }\n    modeObj.name = spec.name;\n    if (spec.helperType) { modeObj.helperType = spec.helperType; }\n    if (spec.modeProps) { for (var prop$1 in spec.modeProps)\n      { modeObj[prop$1] = spec.modeProps[prop$1]; } }\n\n    return modeObj\n  }\n\n  // This can be used to attach properties to mode objects from\n  // outside the actual mode definition.\n  var modeExtensions = {};\n  function extendMode(mode, properties) {\n    var exts = modeExtensions.hasOwnProperty(mode) ? modeExtensions[mode] : (modeExtensions[mode] = {});\n    copyObj(properties, exts);\n  }\n\n  function copyState(mode, state) {\n    if (state === true) { return state }\n    if (mode.copyState) { return mode.copyState(state) }\n    var nstate = {};\n    for (var n in state) {\n      var val = state[n];\n      if (val instanceof Array) { val = val.concat([]); }\n      nstate[n] = val;\n    }\n    return nstate\n  }\n\n  // Given a mode and a state (for that mode), find the inner mode and\n  // state at the position that the state refers to.\n  function innerMode(mode, state) {\n    var info;\n    while (mode.innerMode) {\n      info = mode.innerMode(state);\n      if (!info || info.mode == mode) { break }\n      state = info.state;\n      mode = info.mode;\n    }\n    return info || {mode: mode, state: state}\n  }\n\n  function startState(mode, a1, a2) {\n    return mode.startState ? mode.startState(a1, a2) : true\n  }\n\n  // STRING STREAM\n\n  // Fed to the mode parsers, provides helper functions to make\n  // parsers more succinct.\n\n  var StringStream = function(string, tabSize, lineOracle) {\n    this.pos = this.start = 0;\n    this.string = string;\n    this.tabSize = tabSize || 8;\n    this.lastColumnPos = this.lastColumnValue = 0;\n    this.lineStart = 0;\n    this.lineOracle = lineOracle;\n  };\n\n  StringStream.prototype.eol = function () {return this.pos >= this.string.length};\n  StringStream.prototype.sol = function () {return this.pos == this.lineStart};\n  StringStream.prototype.peek = function () {return this.string.charAt(this.pos) || undefined};\n  StringStream.prototype.next = function () {\n    if (this.pos < this.string.length)\n      { return this.string.charAt(this.pos++) }\n  };\n  StringStream.prototype.eat = function (match) {\n    var ch = this.string.charAt(this.pos);\n    var ok;\n    if (typeof match == \"string\") { ok = ch == match; }\n    else { ok = ch && (match.test ? match.test(ch) : match(ch)); }\n    if (ok) {++this.pos; return ch}\n  };\n  StringStream.prototype.eatWhile = function (match) {\n    var start = this.pos;\n    while (this.eat(match)){}\n    return this.pos > start\n  };\n  StringStream.prototype.eatSpace = function () {\n    var start = this.pos;\n    while (/[\\s\\u00a0]/.test(this.string.charAt(this.pos))) { ++this.pos; }\n    return this.pos > start\n  };\n  StringStream.prototype.skipToEnd = function () {this.pos = this.string.length;};\n  StringStream.prototype.skipTo = function (ch) {\n    var found = this.string.indexOf(ch, this.pos);\n    if (found > -1) {this.pos = found; return true}\n  };\n  StringStream.prototype.backUp = function (n) {this.pos -= n;};\n  StringStream.prototype.column = function () {\n    if (this.lastColumnPos < this.start) {\n      this.lastColumnValue = countColumn(this.string, this.start, this.tabSize, this.lastColumnPos, this.lastColumnValue);\n      this.lastColumnPos = this.start;\n    }\n    return this.lastColumnValue - (this.lineStart ? countColumn(this.string, this.lineStart, this.tabSize) : 0)\n  };\n  StringStream.prototype.indentation = function () {\n    return countColumn(this.string, null, this.tabSize) -\n      (this.lineStart ? countColumn(this.string, this.lineStart, this.tabSize) : 0)\n  };\n  StringStream.prototype.match = function (pattern, consume, caseInsensitive) {\n    if (typeof pattern == \"string\") {\n      var cased = function (str) { return caseInsensitive ? str.toLowerCase() : str; };\n      var substr = this.string.substr(this.pos, pattern.length);\n      if (cased(substr) == cased(pattern)) {\n        if (consume !== false) { this.pos += pattern.length; }\n        return true\n      }\n    } else {\n      var match = this.string.slice(this.pos).match(pattern);\n      if (match && match.index > 0) { return null }\n      if (match && consume !== false) { this.pos += match[0].length; }\n      return match\n    }\n  };\n  StringStream.prototype.current = function (){return this.string.slice(this.start, this.pos)};\n  StringStream.prototype.hideFirstChars = function (n, inner) {\n    this.lineStart += n;\n    try { return inner() }\n    finally { this.lineStart -= n; }\n  };\n  StringStream.prototype.lookAhead = function (n) {\n    var oracle = this.lineOracle;\n    return oracle && oracle.lookAhead(n)\n  };\n  StringStream.prototype.baseToken = function () {\n    var oracle = this.lineOracle;\n    return oracle && oracle.baseToken(this.pos)\n  };\n\n  // Find the line object corresponding to the given line number.\n  function getLine(doc, n) {\n    n -= doc.first;\n    if (n < 0 || n >= doc.size) { throw new Error(\"There is no line \" + (n + doc.first) + \" in the document.\") }\n    var chunk = doc;\n    while (!chunk.lines) {\n      for (var i = 0;; ++i) {\n        var child = chunk.children[i], sz = child.chunkSize();\n        if (n < sz) { chunk = child; break }\n        n -= sz;\n      }\n    }\n    return chunk.lines[n]\n  }\n\n  // Get the part of a document between two positions, as an array of\n  // strings.\n  function getBetween(doc, start, end) {\n    var out = [], n = start.line;\n    doc.iter(start.line, end.line + 1, function (line) {\n      var text = line.text;\n      if (n == end.line) { text = text.slice(0, end.ch); }\n      if (n == start.line) { text = text.slice(start.ch); }\n      out.push(text);\n      ++n;\n    });\n    return out\n  }\n  // Get the lines between from and to, as array of strings.\n  function getLines(doc, from, to) {\n    var out = [];\n    doc.iter(from, to, function (line) { out.push(line.text); }); // iter aborts when callback returns truthy value\n    return out\n  }\n\n  // Update the height of a line, propagating the height change\n  // upwards to parent nodes.\n  function updateLineHeight(line, height) {\n    var diff = height - line.height;\n    if (diff) { for (var n = line; n; n = n.parent) { n.height += diff; } }\n  }\n\n  // Given a line object, find its line number by walking up through\n  // its parent links.\n  function lineNo(line) {\n    if (line.parent == null) { return null }\n    var cur = line.parent, no = indexOf(cur.lines, line);\n    for (var chunk = cur.parent; chunk; cur = chunk, chunk = chunk.parent) {\n      for (var i = 0;; ++i) {\n        if (chunk.children[i] == cur) { break }\n        no += chunk.children[i].chunkSize();\n      }\n    }\n    return no + cur.first\n  }\n\n  // Find the line at the given vertical position, using the height\n  // information in the document tree.\n  function lineAtHeight(chunk, h) {\n    var n = chunk.first;\n    outer: do {\n      for (var i$1 = 0; i$1 < chunk.children.length; ++i$1) {\n        var child = chunk.children[i$1], ch = child.height;\n        if (h < ch) { chunk = child; continue outer }\n        h -= ch;\n        n += child.chunkSize();\n      }\n      return n\n    } while (!chunk.lines)\n    var i = 0;\n    for (; i < chunk.lines.length; ++i) {\n      var line = chunk.lines[i], lh = line.height;\n      if (h < lh) { break }\n      h -= lh;\n    }\n    return n + i\n  }\n\n  function isLine(doc, l) {return l >= doc.first && l < doc.first + doc.size}\n\n  function lineNumberFor(options, i) {\n    return String(options.lineNumberFormatter(i + options.firstLineNumber))\n  }\n\n  // A Pos instance represents a position within the text.\n  function Pos(line, ch, sticky) {\n    if ( sticky === void 0 ) sticky = null;\n\n    if (!(this instanceof Pos)) { return new Pos(line, ch, sticky) }\n    this.line = line;\n    this.ch = ch;\n    this.sticky = sticky;\n  }\n\n  // Compare two positions, return 0 if they are the same, a negative\n  // number when a is less, and a positive number otherwise.\n  function cmp(a, b) { return a.line - b.line || a.ch - b.ch }\n\n  function equalCursorPos(a, b) { return a.sticky == b.sticky && cmp(a, b) == 0 }\n\n  function copyPos(x) {return Pos(x.line, x.ch)}\n  function maxPos(a, b) { return cmp(a, b) < 0 ? b : a }\n  function minPos(a, b) { return cmp(a, b) < 0 ? a : b }\n\n  // Most of the external API clips given positions to make sure they\n  // actually exist within the document.\n  function clipLine(doc, n) {return Math.max(doc.first, Math.min(n, doc.first + doc.size - 1))}\n  function clipPos(doc, pos) {\n    if (pos.line < doc.first) { return Pos(doc.first, 0) }\n    var last = doc.first + doc.size - 1;\n    if (pos.line > last) { return Pos(last, getLine(doc, last).text.length) }\n    return clipToLen(pos, getLine(doc, pos.line).text.length)\n  }\n  function clipToLen(pos, linelen) {\n    var ch = pos.ch;\n    if (ch == null || ch > linelen) { return Pos(pos.line, linelen) }\n    else if (ch < 0) { return Pos(pos.line, 0) }\n    else { return pos }\n  }\n  function clipPosArray(doc, array) {\n    var out = [];\n    for (var i = 0; i < array.length; i++) { out[i] = clipPos(doc, array[i]); }\n    return out\n  }\n\n  var SavedContext = function(state, lookAhead) {\n    this.state = state;\n    this.lookAhead = lookAhead;\n  };\n\n  var Context = function(doc, state, line, lookAhead) {\n    this.state = state;\n    this.doc = doc;\n    this.line = line;\n    this.maxLookAhead = lookAhead || 0;\n    this.baseTokens = null;\n    this.baseTokenPos = 1;\n  };\n\n  Context.prototype.lookAhead = function (n) {\n    var line = this.doc.getLine(this.line + n);\n    if (line != null && n > this.maxLookAhead) { this.maxLookAhead = n; }\n    return line\n  };\n\n  Context.prototype.baseToken = function (n) {\n    if (!this.baseTokens) { return null }\n    while (this.baseTokens[this.baseTokenPos] <= n)\n      { this.baseTokenPos += 2; }\n    var type = this.baseTokens[this.baseTokenPos + 1];\n    return {type: type && type.replace(/( |^)overlay .*/, \"\"),\n            size: this.baseTokens[this.baseTokenPos] - n}\n  };\n\n  Context.prototype.nextLine = function () {\n    this.line++;\n    if (this.maxLookAhead > 0) { this.maxLookAhead--; }\n  };\n\n  Context.fromSaved = function (doc, saved, line) {\n    if (saved instanceof SavedContext)\n      { return new Context(doc, copyState(doc.mode, saved.state), line, saved.lookAhead) }\n    else\n      { return new Context(doc, copyState(doc.mode, saved), line) }\n  };\n\n  Context.prototype.save = function (copy) {\n    var state = copy !== false ? copyState(this.doc.mode, this.state) : this.state;\n    return this.maxLookAhead > 0 ? new SavedContext(state, this.maxLookAhead) : state\n  };\n\n\n  // Compute a style array (an array starting with a mode generation\n  // -- for invalidation -- followed by pairs of end positions and\n  // style strings), which is used to highlight the tokens on the\n  // line.\n  function highlightLine(cm, line, context, forceToEnd) {\n    // A styles array always starts with a number identifying the\n    // mode/overlays that it is based on (for easy invalidation).\n    var st = [cm.state.modeGen], lineClasses = {};\n    // Compute the base array of styles\n    runMode(cm, line.text, cm.doc.mode, context, function (end, style) { return st.push(end, style); },\n            lineClasses, forceToEnd);\n    var state = context.state;\n\n    // Run overlays, adjust style array.\n    var loop = function ( o ) {\n      context.baseTokens = st;\n      var overlay = cm.state.overlays[o], i = 1, at = 0;\n      context.state = true;\n      runMode(cm, line.text, overlay.mode, context, function (end, style) {\n        var start = i;\n        // Ensure there's a token end at the current position, and that i points at it\n        while (at < end) {\n          var i_end = st[i];\n          if (i_end > end)\n            { st.splice(i, 1, end, st[i+1], i_end); }\n          i += 2;\n          at = Math.min(end, i_end);\n        }\n        if (!style) { return }\n        if (overlay.opaque) {\n          st.splice(start, i - start, end, \"overlay \" + style);\n          i = start + 2;\n        } else {\n          for (; start < i; start += 2) {\n            var cur = st[start+1];\n            st[start+1] = (cur ? cur + \" \" : \"\") + \"overlay \" + style;\n          }\n        }\n      }, lineClasses);\n      context.state = state;\n      context.baseTokens = null;\n      context.baseTokenPos = 1;\n    };\n\n    for (var o = 0; o < cm.state.overlays.length; ++o) loop( o );\n\n    return {styles: st, classes: lineClasses.bgClass || lineClasses.textClass ? lineClasses : null}\n  }\n\n  function getLineStyles(cm, line, updateFrontier) {\n    if (!line.styles || line.styles[0] != cm.state.modeGen) {\n      var context = getContextBefore(cm, lineNo(line));\n      var resetState = line.text.length > cm.options.maxHighlightLength && copyState(cm.doc.mode, context.state);\n      var result = highlightLine(cm, line, context);\n      if (resetState) { context.state = resetState; }\n      line.stateAfter = context.save(!resetState);\n      line.styles = result.styles;\n      if (result.classes) { line.styleClasses = result.classes; }\n      else if (line.styleClasses) { line.styleClasses = null; }\n      if (updateFrontier === cm.doc.highlightFrontier)\n        { cm.doc.modeFrontier = Math.max(cm.doc.modeFrontier, ++cm.doc.highlightFrontier); }\n    }\n    return line.styles\n  }\n\n  function getContextBefore(cm, n, precise) {\n    var doc = cm.doc, display = cm.display;\n    if (!doc.mode.startState) { return new Context(doc, true, n) }\n    var start = findStartLine(cm, n, precise);\n    var saved = start > doc.first && getLine(doc, start - 1).stateAfter;\n    var context = saved ? Context.fromSaved(doc, saved, start) : new Context(doc, startState(doc.mode), start);\n\n    doc.iter(start, n, function (line) {\n      processLine(cm, line.text, context);\n      var pos = context.line;\n      line.stateAfter = pos == n - 1 || pos % 5 == 0 || pos >= display.viewFrom && pos < display.viewTo ? context.save() : null;\n      context.nextLine();\n    });\n    if (precise) { doc.modeFrontier = context.line; }\n    return context\n  }\n\n  // Lightweight form of highlight -- proceed over this line and\n  // update state, but don't save a style array. Used for lines that\n  // aren't currently visible.\n  function processLine(cm, text, context, startAt) {\n    var mode = cm.doc.mode;\n    var stream = new StringStream(text, cm.options.tabSize, context);\n    stream.start = stream.pos = startAt || 0;\n    if (text == \"\") { callBlankLine(mode, context.state); }\n    while (!stream.eol()) {\n      readToken(mode, stream, context.state);\n      stream.start = stream.pos;\n    }\n  }\n\n  function callBlankLine(mode, state) {\n    if (mode.blankLine) { return mode.blankLine(state) }\n    if (!mode.innerMode) { return }\n    var inner = innerMode(mode, state);\n    if (inner.mode.blankLine) { return inner.mode.blankLine(inner.state) }\n  }\n\n  function readToken(mode, stream, state, inner) {\n    for (var i = 0; i < 10; i++) {\n      if (inner) { inner[0] = innerMode(mode, state).mode; }\n      var style = mode.token(stream, state);\n      if (stream.pos > stream.start) { return style }\n    }\n    throw new Error(\"Mode \" + mode.name + \" failed to advance stream.\")\n  }\n\n  var Token = function(stream, type, state) {\n    this.start = stream.start; this.end = stream.pos;\n    this.string = stream.current();\n    this.type = type || null;\n    this.state = state;\n  };\n\n  // Utility for getTokenAt and getLineTokens\n  function takeToken(cm, pos, precise, asArray) {\n    var doc = cm.doc, mode = doc.mode, style;\n    pos = clipPos(doc, pos);\n    var line = getLine(doc, pos.line), context = getContextBefore(cm, pos.line, precise);\n    var stream = new StringStream(line.text, cm.options.tabSize, context), tokens;\n    if (asArray) { tokens = []; }\n    while ((asArray || stream.pos < pos.ch) && !stream.eol()) {\n      stream.start = stream.pos;\n      style = readToken(mode, stream, context.state);\n      if (asArray) { tokens.push(new Token(stream, style, copyState(doc.mode, context.state))); }\n    }\n    return asArray ? tokens : new Token(stream, style, context.state)\n  }\n\n  function extractLineClasses(type, output) {\n    if (type) { for (;;) {\n      var lineClass = type.match(/(?:^|\\s+)line-(background-)?(\\S+)/);\n      if (!lineClass) { break }\n      type = type.slice(0, lineClass.index) + type.slice(lineClass.index + lineClass[0].length);\n      var prop = lineClass[1] ? \"bgClass\" : \"textClass\";\n      if (output[prop] == null)\n        { output[prop] = lineClass[2]; }\n      else if (!(new RegExp(\"(?:^|\\\\s)\" + lineClass[2] + \"(?:$|\\\\s)\")).test(output[prop]))\n        { output[prop] += \" \" + lineClass[2]; }\n    } }\n    return type\n  }\n\n  // Run the given mode's parser over a line, calling f for each token.\n  function runMode(cm, text, mode, context, f, lineClasses, forceToEnd) {\n    var flattenSpans = mode.flattenSpans;\n    if (flattenSpans == null) { flattenSpans = cm.options.flattenSpans; }\n    var curStart = 0, curStyle = null;\n    var stream = new StringStream(text, cm.options.tabSize, context), style;\n    var inner = cm.options.addModeClass && [null];\n    if (text == \"\") { extractLineClasses(callBlankLine(mode, context.state), lineClasses); }\n    while (!stream.eol()) {\n      if (stream.pos > cm.options.maxHighlightLength) {\n        flattenSpans = false;\n        if (forceToEnd) { processLine(cm, text, context, stream.pos); }\n        stream.pos = text.length;\n        style = null;\n      } else {\n        style = extractLineClasses(readToken(mode, stream, context.state, inner), lineClasses);\n      }\n      if (inner) {\n        var mName = inner[0].name;\n        if (mName) { style = \"m-\" + (style ? mName + \" \" + style : mName); }\n      }\n      if (!flattenSpans || curStyle != style) {\n        while (curStart < stream.start) {\n          curStart = Math.min(stream.start, curStart + 5000);\n          f(curStart, curStyle);\n        }\n        curStyle = style;\n      }\n      stream.start = stream.pos;\n    }\n    while (curStart < stream.pos) {\n      // Webkit seems to refuse to render text nodes longer than 57444\n      // characters, and returns inaccurate measurements in nodes\n      // starting around 5000 chars.\n      var pos = Math.min(stream.pos, curStart + 5000);\n      f(pos, curStyle);\n      curStart = pos;\n    }\n  }\n\n  // Finds the line to start with when starting a parse. Tries to\n  // find a line with a stateAfter, so that it can start with a\n  // valid state. If that fails, it returns the line with the\n  // smallest indentation, which tends to need the least context to\n  // parse correctly.\n  function findStartLine(cm, n, precise) {\n    var minindent, minline, doc = cm.doc;\n    var lim = precise ? -1 : n - (cm.doc.mode.innerMode ? 1000 : 100);\n    for (var search = n; search > lim; --search) {\n      if (search <= doc.first) { return doc.first }\n      var line = getLine(doc, search - 1), after = line.stateAfter;\n      if (after && (!precise || search + (after instanceof SavedContext ? after.lookAhead : 0) <= doc.modeFrontier))\n        { return search }\n      var indented = countColumn(line.text, null, cm.options.tabSize);\n      if (minline == null || minindent > indented) {\n        minline = search - 1;\n        minindent = indented;\n      }\n    }\n    return minline\n  }\n\n  function retreatFrontier(doc, n) {\n    doc.modeFrontier = Math.min(doc.modeFrontier, n);\n    if (doc.highlightFrontier < n - 10) { return }\n    var start = doc.first;\n    for (var line = n - 1; line > start; line--) {\n      var saved = getLine(doc, line).stateAfter;\n      // change is on 3\n      // state on line 1 looked ahead 2 -- so saw 3\n      // test 1 + 2 < 3 should cover this\n      if (saved && (!(saved instanceof SavedContext) || line + saved.lookAhead < n)) {\n        start = line + 1;\n        break\n      }\n    }\n    doc.highlightFrontier = Math.min(doc.highlightFrontier, start);\n  }\n\n  // Optimize some code when these features are not used.\n  var sawReadOnlySpans = false, sawCollapsedSpans = false;\n\n  function seeReadOnlySpans() {\n    sawReadOnlySpans = true;\n  }\n\n  function seeCollapsedSpans() {\n    sawCollapsedSpans = true;\n  }\n\n  // TEXTMARKER SPANS\n\n  function MarkedSpan(marker, from, to) {\n    this.marker = marker;\n    this.from = from; this.to = to;\n  }\n\n  // Search an array of spans for a span matching the given marker.\n  function getMarkedSpanFor(spans, marker) {\n    if (spans) { for (var i = 0; i < spans.length; ++i) {\n      var span = spans[i];\n      if (span.marker == marker) { return span }\n    } }\n  }\n  // Remove a span from an array, returning undefined if no spans are\n  // left (we don't store arrays for lines without spans).\n  function removeMarkedSpan(spans, span) {\n    var r;\n    for (var i = 0; i < spans.length; ++i)\n      { if (spans[i] != span) { (r || (r = [])).push(spans[i]); } }\n    return r\n  }\n  // Add a span to a line.\n  function addMarkedSpan(line, span) {\n    line.markedSpans = line.markedSpans ? line.markedSpans.concat([span]) : [span];\n    span.marker.attachLine(line);\n  }\n\n  // Used for the algorithm that adjusts markers for a change in the\n  // document. These functions cut an array of spans at a given\n  // character position, returning an array of remaining chunks (or\n  // undefined if nothing remains).\n  function markedSpansBefore(old, startCh, isInsert) {\n    var nw;\n    if (old) { for (var i = 0; i < old.length; ++i) {\n      var span = old[i], marker = span.marker;\n      var startsBefore = span.from == null || (marker.inclusiveLeft ? span.from <= startCh : span.from < startCh);\n      if (startsBefore || span.from == startCh && marker.type == \"bookmark\" && (!isInsert || !span.marker.insertLeft)) {\n        var endsAfter = span.to == null || (marker.inclusiveRight ? span.to >= startCh : span.to > startCh)\n        ;(nw || (nw = [])).push(new MarkedSpan(marker, span.from, endsAfter ? null : span.to));\n      }\n    } }\n    return nw\n  }\n  function markedSpansAfter(old, endCh, isInsert) {\n    var nw;\n    if (old) { for (var i = 0; i < old.length; ++i) {\n      var span = old[i], marker = span.marker;\n      var endsAfter = span.to == null || (marker.inclusiveRight ? span.to >= endCh : span.to > endCh);\n      if (endsAfter || span.from == endCh && marker.type == \"bookmark\" && (!isInsert || span.marker.insertLeft)) {\n        var startsBefore = span.from == null || (marker.inclusiveLeft ? span.from <= endCh : span.from < endCh)\n        ;(nw || (nw = [])).push(new MarkedSpan(marker, startsBefore ? null : span.from - endCh,\n                                              span.to == null ? null : span.to - endCh));\n      }\n    } }\n    return nw\n  }\n\n  // Given a change object, compute the new set of marker spans that\n  // cover the line in which the change took place. Removes spans\n  // entirely within the change, reconnects spans belonging to the\n  // same marker that appear on both sides of the change, and cuts off\n  // spans partially within the change. Returns an array of span\n  // arrays with one element for each line in (after) the change.\n  function stretchSpansOverChange(doc, change) {\n    if (change.full) { return null }\n    var oldFirst = isLine(doc, change.from.line) && getLine(doc, change.from.line).markedSpans;\n    var oldLast = isLine(doc, change.to.line) && getLine(doc, change.to.line).markedSpans;\n    if (!oldFirst && !oldLast) { return null }\n\n    var startCh = change.from.ch, endCh = change.to.ch, isInsert = cmp(change.from, change.to) == 0;\n    // Get the spans that 'stick out' on both sides\n    var first = markedSpansBefore(oldFirst, startCh, isInsert);\n    var last = markedSpansAfter(oldLast, endCh, isInsert);\n\n    // Next, merge those two ends\n    var sameLine = change.text.length == 1, offset = lst(change.text).length + (sameLine ? startCh : 0);\n    if (first) {\n      // Fix up .to properties of first\n      for (var i = 0; i < first.length; ++i) {\n        var span = first[i];\n        if (span.to == null) {\n          var found = getMarkedSpanFor(last, span.marker);\n          if (!found) { span.to = startCh; }\n          else if (sameLine) { span.to = found.to == null ? null : found.to + offset; }\n        }\n      }\n    }\n    if (last) {\n      // Fix up .from in last (or move them into first in case of sameLine)\n      for (var i$1 = 0; i$1 < last.length; ++i$1) {\n        var span$1 = last[i$1];\n        if (span$1.to != null) { span$1.to += offset; }\n        if (span$1.from == null) {\n          var found$1 = getMarkedSpanFor(first, span$1.marker);\n          if (!found$1) {\n            span$1.from = offset;\n            if (sameLine) { (first || (first = [])).push(span$1); }\n          }\n        } else {\n          span$1.from += offset;\n          if (sameLine) { (first || (first = [])).push(span$1); }\n        }\n      }\n    }\n    // Make sure we didn't create any zero-length spans\n    if (first) { first = clearEmptySpans(first); }\n    if (last && last != first) { last = clearEmptySpans(last); }\n\n    var newMarkers = [first];\n    if (!sameLine) {\n      // Fill gap with whole-line-spans\n      var gap = change.text.length - 2, gapMarkers;\n      if (gap > 0 && first)\n        { for (var i$2 = 0; i$2 < first.length; ++i$2)\n          { if (first[i$2].to == null)\n            { (gapMarkers || (gapMarkers = [])).push(new MarkedSpan(first[i$2].marker, null, null)); } } }\n      for (var i$3 = 0; i$3 < gap; ++i$3)\n        { newMarkers.push(gapMarkers); }\n      newMarkers.push(last);\n    }\n    return newMarkers\n  }\n\n  // Remove spans that are empty and don't have a clearWhenEmpty\n  // option of false.\n  function clearEmptySpans(spans) {\n    for (var i = 0; i < spans.length; ++i) {\n      var span = spans[i];\n      if (span.from != null && span.from == span.to && span.marker.clearWhenEmpty !== false)\n        { spans.splice(i--, 1); }\n    }\n    if (!spans.length) { return null }\n    return spans\n  }\n\n  // Used to 'clip' out readOnly ranges when making a change.\n  function removeReadOnlyRanges(doc, from, to) {\n    var markers = null;\n    doc.iter(from.line, to.line + 1, function (line) {\n      if (line.markedSpans) { for (var i = 0; i < line.markedSpans.length; ++i) {\n        var mark = line.markedSpans[i].marker;\n        if (mark.readOnly && (!markers || indexOf(markers, mark) == -1))\n          { (markers || (markers = [])).push(mark); }\n      } }\n    });\n    if (!markers) { return null }\n    var parts = [{from: from, to: to}];\n    for (var i = 0; i < markers.length; ++i) {\n      var mk = markers[i], m = mk.find(0);\n      for (var j = 0; j < parts.length; ++j) {\n        var p = parts[j];\n        if (cmp(p.to, m.from) < 0 || cmp(p.from, m.to) > 0) { continue }\n        var newParts = [j, 1], dfrom = cmp(p.from, m.from), dto = cmp(p.to, m.to);\n        if (dfrom < 0 || !mk.inclusiveLeft && !dfrom)\n          { newParts.push({from: p.from, to: m.from}); }\n        if (dto > 0 || !mk.inclusiveRight && !dto)\n          { newParts.push({from: m.to, to: p.to}); }\n        parts.splice.apply(parts, newParts);\n        j += newParts.length - 3;\n      }\n    }\n    return parts\n  }\n\n  // Connect or disconnect spans from a line.\n  function detachMarkedSpans(line) {\n    var spans = line.markedSpans;\n    if (!spans) { return }\n    for (var i = 0; i < spans.length; ++i)\n      { spans[i].marker.detachLine(line); }\n    line.markedSpans = null;\n  }\n  function attachMarkedSpans(line, spans) {\n    if (!spans) { return }\n    for (var i = 0; i < spans.length; ++i)\n      { spans[i].marker.attachLine(line); }\n    line.markedSpans = spans;\n  }\n\n  // Helpers used when computing which overlapping collapsed span\n  // counts as the larger one.\n  function extraLeft(marker) { return marker.inclusiveLeft ? -1 : 0 }\n  function extraRight(marker) { return marker.inclusiveRight ? 1 : 0 }\n\n  // Returns a number indicating which of two overlapping collapsed\n  // spans is larger (and thus includes the other). Falls back to\n  // comparing ids when the spans cover exactly the same range.\n  function compareCollapsedMarkers(a, b) {\n    var lenDiff = a.lines.length - b.lines.length;\n    if (lenDiff != 0) { return lenDiff }\n    var aPos = a.find(), bPos = b.find();\n    var fromCmp = cmp(aPos.from, bPos.from) || extraLeft(a) - extraLeft(b);\n    if (fromCmp) { return -fromCmp }\n    var toCmp = cmp(aPos.to, bPos.to) || extraRight(a) - extraRight(b);\n    if (toCmp) { return toCmp }\n    return b.id - a.id\n  }\n\n  // Find out whether a line ends or starts in a collapsed span. If\n  // so, return the marker for that span.\n  function collapsedSpanAtSide(line, start) {\n    var sps = sawCollapsedSpans && line.markedSpans, found;\n    if (sps) { for (var sp = (void 0), i = 0; i < sps.length; ++i) {\n      sp = sps[i];\n      if (sp.marker.collapsed && (start ? sp.from : sp.to) == null &&\n          (!found || compareCollapsedMarkers(found, sp.marker) < 0))\n        { found = sp.marker; }\n    } }\n    return found\n  }\n  function collapsedSpanAtStart(line) { return collapsedSpanAtSide(line, true) }\n  function collapsedSpanAtEnd(line) { return collapsedSpanAtSide(line, false) }\n\n  function collapsedSpanAround(line, ch) {\n    var sps = sawCollapsedSpans && line.markedSpans, found;\n    if (sps) { for (var i = 0; i < sps.length; ++i) {\n      var sp = sps[i];\n      if (sp.marker.collapsed && (sp.from == null || sp.from < ch) && (sp.to == null || sp.to > ch) &&\n          (!found || compareCollapsedMarkers(found, sp.marker) < 0)) { found = sp.marker; }\n    } }\n    return found\n  }\n\n  // Test whether there exists a collapsed span that partially\n  // overlaps (covers the start or end, but not both) of a new span.\n  // Such overlap is not allowed.\n  function conflictingCollapsedRange(doc, lineNo, from, to, marker) {\n    var line = getLine(doc, lineNo);\n    var sps = sawCollapsedSpans && line.markedSpans;\n    if (sps) { for (var i = 0; i < sps.length; ++i) {\n      var sp = sps[i];\n      if (!sp.marker.collapsed) { continue }\n      var found = sp.marker.find(0);\n      var fromCmp = cmp(found.from, from) || extraLeft(sp.marker) - extraLeft(marker);\n      var toCmp = cmp(found.to, to) || extraRight(sp.marker) - extraRight(marker);\n      if (fromCmp >= 0 && toCmp <= 0 || fromCmp <= 0 && toCmp >= 0) { continue }\n      if (fromCmp <= 0 && (sp.marker.inclusiveRight && marker.inclusiveLeft ? cmp(found.to, from) >= 0 : cmp(found.to, from) > 0) ||\n          fromCmp >= 0 && (sp.marker.inclusiveRight && marker.inclusiveLeft ? cmp(found.from, to) <= 0 : cmp(found.from, to) < 0))\n        { return true }\n    } }\n  }\n\n  // A visual line is a line as drawn on the screen. Folding, for\n  // example, can cause multiple logical lines to appear on the same\n  // visual line. This finds the start of the visual line that the\n  // given line is part of (usually that is the line itself).\n  function visualLine(line) {\n    var merged;\n    while (merged = collapsedSpanAtStart(line))\n      { line = merged.find(-1, true).line; }\n    return line\n  }\n\n  function visualLineEnd(line) {\n    var merged;\n    while (merged = collapsedSpanAtEnd(line))\n      { line = merged.find(1, true).line; }\n    return line\n  }\n\n  // Returns an array of logical lines that continue the visual line\n  // started by the argument, or undefined if there are no such lines.\n  function visualLineContinued(line) {\n    var merged, lines;\n    while (merged = collapsedSpanAtEnd(line)) {\n      line = merged.find(1, true).line\n      ;(lines || (lines = [])).push(line);\n    }\n    return lines\n  }\n\n  // Get the line number of the start of the visual line that the\n  // given line number is part of.\n  function visualLineNo(doc, lineN) {\n    var line = getLine(doc, lineN), vis = visualLine(line);\n    if (line == vis) { return lineN }\n    return lineNo(vis)\n  }\n\n  // Get the line number of the start of the next visual line after\n  // the given line.\n  function visualLineEndNo(doc, lineN) {\n    if (lineN > doc.lastLine()) { return lineN }\n    var line = getLine(doc, lineN), merged;\n    if (!lineIsHidden(doc, line)) { return lineN }\n    while (merged = collapsedSpanAtEnd(line))\n      { line = merged.find(1, true).line; }\n    return lineNo(line) + 1\n  }\n\n  // Compute whether a line is hidden. Lines count as hidden when they\n  // are part of a visual line that starts with another line, or when\n  // they are entirely covered by collapsed, non-widget span.\n  function lineIsHidden(doc, line) {\n    var sps = sawCollapsedSpans && line.markedSpans;\n    if (sps) { for (var sp = (void 0), i = 0; i < sps.length; ++i) {\n      sp = sps[i];\n      if (!sp.marker.collapsed) { continue }\n      if (sp.from == null) { return true }\n      if (sp.marker.widgetNode) { continue }\n      if (sp.from == 0 && sp.marker.inclusiveLeft && lineIsHiddenInner(doc, line, sp))\n        { return true }\n    } }\n  }\n  function lineIsHiddenInner(doc, line, span) {\n    if (span.to == null) {\n      var end = span.marker.find(1, true);\n      return lineIsHiddenInner(doc, end.line, getMarkedSpanFor(end.line.markedSpans, span.marker))\n    }\n    if (span.marker.inclusiveRight && span.to == line.text.length)\n      { return true }\n    for (var sp = (void 0), i = 0; i < line.markedSpans.length; ++i) {\n      sp = line.markedSpans[i];\n      if (sp.marker.collapsed && !sp.marker.widgetNode && sp.from == span.to &&\n          (sp.to == null || sp.to != span.from) &&\n          (sp.marker.inclusiveLeft || span.marker.inclusiveRight) &&\n          lineIsHiddenInner(doc, line, sp)) { return true }\n    }\n  }\n\n  // Find the height above the given line.\n  function heightAtLine(lineObj) {\n    lineObj = visualLine(lineObj);\n\n    var h = 0, chunk = lineObj.parent;\n    for (var i = 0; i < chunk.lines.length; ++i) {\n      var line = chunk.lines[i];\n      if (line == lineObj) { break }\n      else { h += line.height; }\n    }\n    for (var p = chunk.parent; p; chunk = p, p = chunk.parent) {\n      for (var i$1 = 0; i$1 < p.children.length; ++i$1) {\n        var cur = p.children[i$1];\n        if (cur == chunk) { break }\n        else { h += cur.height; }\n      }\n    }\n    return h\n  }\n\n  // Compute the character length of a line, taking into account\n  // collapsed ranges (see markText) that might hide parts, and join\n  // other lines onto it.\n  function lineLength(line) {\n    if (line.height == 0) { return 0 }\n    var len = line.text.length, merged, cur = line;\n    while (merged = collapsedSpanAtStart(cur)) {\n      var found = merged.find(0, true);\n      cur = found.from.line;\n      len += found.from.ch - found.to.ch;\n    }\n    cur = line;\n    while (merged = collapsedSpanAtEnd(cur)) {\n      var found$1 = merged.find(0, true);\n      len -= cur.text.length - found$1.from.ch;\n      cur = found$1.to.line;\n      len += cur.text.length - found$1.to.ch;\n    }\n    return len\n  }\n\n  // Find the longest line in the document.\n  function findMaxLine(cm) {\n    var d = cm.display, doc = cm.doc;\n    d.maxLine = getLine(doc, doc.first);\n    d.maxLineLength = lineLength(d.maxLine);\n    d.maxLineChanged = true;\n    doc.iter(function (line) {\n      var len = lineLength(line);\n      if (len > d.maxLineLength) {\n        d.maxLineLength = len;\n        d.maxLine = line;\n      }\n    });\n  }\n\n  // LINE DATA STRUCTURE\n\n  // Line objects. These hold state related to a line, including\n  // highlighting info (the styles array).\n  var Line = function(text, markedSpans, estimateHeight) {\n    this.text = text;\n    attachMarkedSpans(this, markedSpans);\n    this.height = estimateHeight ? estimateHeight(this) : 1;\n  };\n\n  Line.prototype.lineNo = function () { return lineNo(this) };\n  eventMixin(Line);\n\n  // Change the content (text, markers) of a line. Automatically\n  // invalidates cached information and tries to re-estimate the\n  // line's height.\n  function updateLine(line, text, markedSpans, estimateHeight) {\n    line.text = text;\n    if (line.stateAfter) { line.stateAfter = null; }\n    if (line.styles) { line.styles = null; }\n    if (line.order != null) { line.order = null; }\n    detachMarkedSpans(line);\n    attachMarkedSpans(line, markedSpans);\n    var estHeight = estimateHeight ? estimateHeight(line) : 1;\n    if (estHeight != line.height) { updateLineHeight(line, estHeight); }\n  }\n\n  // Detach a line from the document tree and its markers.\n  function cleanUpLine(line) {\n    line.parent = null;\n    detachMarkedSpans(line);\n  }\n\n  // Convert a style as returned by a mode (either null, or a string\n  // containing one or more styles) to a CSS style. This is cached,\n  // and also looks for line-wide styles.\n  var styleToClassCache = {}, styleToClassCacheWithMode = {};\n  function interpretTokenStyle(style, options) {\n    if (!style || /^\\s*$/.test(style)) { return null }\n    var cache = options.addModeClass ? styleToClassCacheWithMode : styleToClassCache;\n    return cache[style] ||\n      (cache[style] = style.replace(/\\S+/g, \"cm-$&\"))\n  }\n\n  // Render the DOM representation of the text of a line. Also builds\n  // up a 'line map', which points at the DOM nodes that represent\n  // specific stretches of text, and is used by the measuring code.\n  // The returned object contains the DOM node, this map, and\n  // information about line-wide styles that were set by the mode.\n  function buildLineContent(cm, lineView) {\n    // The padding-right forces the element to have a 'border', which\n    // is needed on Webkit to be able to get line-level bounding\n    // rectangles for it (in measureChar).\n    var content = eltP(\"span\", null, null, webkit ? \"padding-right: .1px\" : null);\n    var builder = {pre: eltP(\"pre\", [content], \"CodeMirror-line\"), content: content,\n                   col: 0, pos: 0, cm: cm,\n                   trailingSpace: false,\n                   splitSpaces: cm.getOption(\"lineWrapping\")};\n    lineView.measure = {};\n\n    // Iterate over the logical lines that make up this visual line.\n    for (var i = 0; i <= (lineView.rest ? lineView.rest.length : 0); i++) {\n      var line = i ? lineView.rest[i - 1] : lineView.line, order = (void 0);\n      builder.pos = 0;\n      builder.addToken = buildToken;\n      // Optionally wire in some hacks into the token-rendering\n      // algorithm, to deal with browser quirks.\n      if (hasBadBidiRects(cm.display.measure) && (order = getOrder(line, cm.doc.direction)))\n        { builder.addToken = buildTokenBadBidi(builder.addToken, order); }\n      builder.map = [];\n      var allowFrontierUpdate = lineView != cm.display.externalMeasured && lineNo(line);\n      insertLineContent(line, builder, getLineStyles(cm, line, allowFrontierUpdate));\n      if (line.styleClasses) {\n        if (line.styleClasses.bgClass)\n          { builder.bgClass = joinClasses(line.styleClasses.bgClass, builder.bgClass || \"\"); }\n        if (line.styleClasses.textClass)\n          { builder.textClass = joinClasses(line.styleClasses.textClass, builder.textClass || \"\"); }\n      }\n\n      // Ensure at least a single node is present, for measuring.\n      if (builder.map.length == 0)\n        { builder.map.push(0, 0, builder.content.appendChild(zeroWidthElement(cm.display.measure))); }\n\n      // Store the map and a cache object for the current logical line\n      if (i == 0) {\n        lineView.measure.map = builder.map;\n        lineView.measure.cache = {};\n      } else {\n  (lineView.measure.maps || (lineView.measure.maps = [])).push(builder.map)\n        ;(lineView.measure.caches || (lineView.measure.caches = [])).push({});\n      }\n    }\n\n    // See issue #2901\n    if (webkit) {\n      var last = builder.content.lastChild;\n      if (/\\bcm-tab\\b/.test(last.className) || (last.querySelector && last.querySelector(\".cm-tab\")))\n        { builder.content.className = \"cm-tab-wrap-hack\"; }\n    }\n\n    signal(cm, \"renderLine\", cm, lineView.line, builder.pre);\n    if (builder.pre.className)\n      { builder.textClass = joinClasses(builder.pre.className, builder.textClass || \"\"); }\n\n    return builder\n  }\n\n  function defaultSpecialCharPlaceholder(ch) {\n    var token = elt(\"span\", \"\\u2022\", \"cm-invalidchar\");\n    token.title = \"\\\\u\" + ch.charCodeAt(0).toString(16);\n    token.setAttribute(\"aria-label\", token.title);\n    return token\n  }\n\n  // Build up the DOM representation for a single token, and add it to\n  // the line map. Takes care to render special characters separately.\n  function buildToken(builder, text, style, startStyle, endStyle, css, attributes) {\n    if (!text) { return }\n    var displayText = builder.splitSpaces ? splitSpaces(text, builder.trailingSpace) : text;\n    var special = builder.cm.state.specialChars, mustWrap = false;\n    var content;\n    if (!special.test(text)) {\n      builder.col += text.length;\n      content = document.createTextNode(displayText);\n      builder.map.push(builder.pos, builder.pos + text.length, content);\n      if (ie && ie_version < 9) { mustWrap = true; }\n      builder.pos += text.length;\n    } else {\n      content = document.createDocumentFragment();\n      var pos = 0;\n      while (true) {\n        special.lastIndex = pos;\n        var m = special.exec(text);\n        var skipped = m ? m.index - pos : text.length - pos;\n        if (skipped) {\n          var txt = document.createTextNode(displayText.slice(pos, pos + skipped));\n          if (ie && ie_version < 9) { content.appendChild(elt(\"span\", [txt])); }\n          else { content.appendChild(txt); }\n          builder.map.push(builder.pos, builder.pos + skipped, txt);\n          builder.col += skipped;\n          builder.pos += skipped;\n        }\n        if (!m) { break }\n        pos += skipped + 1;\n        var txt$1 = (void 0);\n        if (m[0] == \"\\t\") {\n          var tabSize = builder.cm.options.tabSize, tabWidth = tabSize - builder.col % tabSize;\n          txt$1 = content.appendChild(elt(\"span\", spaceStr(tabWidth), \"cm-tab\"));\n          txt$1.setAttribute(\"role\", \"presentation\");\n          txt$1.setAttribute(\"cm-text\", \"\\t\");\n          builder.col += tabWidth;\n        } else if (m[0] == \"\\r\" || m[0] == \"\\n\") {\n          txt$1 = content.appendChild(elt(\"span\", m[0] == \"\\r\" ? \"\\u240d\" : \"\\u2424\", \"cm-invalidchar\"));\n          txt$1.setAttribute(\"cm-text\", m[0]);\n          builder.col += 1;\n        } else {\n          txt$1 = builder.cm.options.specialCharPlaceholder(m[0]);\n          txt$1.setAttribute(\"cm-text\", m[0]);\n          if (ie && ie_version < 9) { content.appendChild(elt(\"span\", [txt$1])); }\n          else { content.appendChild(txt$1); }\n          builder.col += 1;\n        }\n        builder.map.push(builder.pos, builder.pos + 1, txt$1);\n        builder.pos++;\n      }\n    }\n    builder.trailingSpace = displayText.charCodeAt(text.length - 1) == 32;\n    if (style || startStyle || endStyle || mustWrap || css || attributes) {\n      var fullStyle = style || \"\";\n      if (startStyle) { fullStyle += startStyle; }\n      if (endStyle) { fullStyle += endStyle; }\n      var token = elt(\"span\", [content], fullStyle, css);\n      if (attributes) {\n        for (var attr in attributes) { if (attributes.hasOwnProperty(attr) && attr != \"style\" && attr != \"class\")\n          { token.setAttribute(attr, attributes[attr]); } }\n      }\n      return builder.content.appendChild(token)\n    }\n    builder.content.appendChild(content);\n  }\n\n  // Change some spaces to NBSP to prevent the browser from collapsing\n  // trailing spaces at the end of a line when rendering text (issue #1362).\n  function splitSpaces(text, trailingBefore) {\n    if (text.length > 1 && !/  /.test(text)) { return text }\n    var spaceBefore = trailingBefore, result = \"\";\n    for (var i = 0; i < text.length; i++) {\n      var ch = text.charAt(i);\n      if (ch == \" \" && spaceBefore && (i == text.length - 1 || text.charCodeAt(i + 1) == 32))\n        { ch = \"\\u00a0\"; }\n      result += ch;\n      spaceBefore = ch == \" \";\n    }\n    return result\n  }\n\n  // Work around nonsense dimensions being reported for stretches of\n  // right-to-left text.\n  function buildTokenBadBidi(inner, order) {\n    return function (builder, text, style, startStyle, endStyle, css, attributes) {\n      style = style ? style + \" cm-force-border\" : \"cm-force-border\";\n      var start = builder.pos, end = start + text.length;\n      for (;;) {\n        // Find the part that overlaps with the start of this text\n        var part = (void 0);\n        for (var i = 0; i < order.length; i++) {\n          part = order[i];\n          if (part.to > start && part.from <= start) { break }\n        }\n        if (part.to >= end) { return inner(builder, text, style, startStyle, endStyle, css, attributes) }\n        inner(builder, text.slice(0, part.to - start), style, startStyle, null, css, attributes);\n        startStyle = null;\n        text = text.slice(part.to - start);\n        start = part.to;\n      }\n    }\n  }\n\n  function buildCollapsedSpan(builder, size, marker, ignoreWidget) {\n    var widget = !ignoreWidget && marker.widgetNode;\n    if (widget) { builder.map.push(builder.pos, builder.pos + size, widget); }\n    if (!ignoreWidget && builder.cm.display.input.needsContentAttribute) {\n      if (!widget)\n        { widget = builder.content.appendChild(document.createElement(\"span\")); }\n      widget.setAttribute(\"cm-marker\", marker.id);\n    }\n    if (widget) {\n      builder.cm.display.input.setUneditable(widget);\n      builder.content.appendChild(widget);\n    }\n    builder.pos += size;\n    builder.trailingSpace = false;\n  }\n\n  // Outputs a number of spans to make up a line, taking highlighting\n  // and marked text into account.\n  function insertLineContent(line, builder, styles) {\n    var spans = line.markedSpans, allText = line.text, at = 0;\n    if (!spans) {\n      for (var i$1 = 1; i$1 < styles.length; i$1+=2)\n        { builder.addToken(builder, allText.slice(at, at = styles[i$1]), interpretTokenStyle(styles[i$1+1], builder.cm.options)); }\n      return\n    }\n\n    var len = allText.length, pos = 0, i = 1, text = \"\", style, css;\n    var nextChange = 0, spanStyle, spanEndStyle, spanStartStyle, collapsed, attributes;\n    for (;;) {\n      if (nextChange == pos) { // Update current marker set\n        spanStyle = spanEndStyle = spanStartStyle = css = \"\";\n        attributes = null;\n        collapsed = null; nextChange = Infinity;\n        var foundBookmarks = [], endStyles = (void 0);\n        for (var j = 0; j < spans.length; ++j) {\n          var sp = spans[j], m = sp.marker;\n          if (m.type == \"bookmark\" && sp.from == pos && m.widgetNode) {\n            foundBookmarks.push(m);\n          } else if (sp.from <= pos && (sp.to == null || sp.to > pos || m.collapsed && sp.to == pos && sp.from == pos)) {\n            if (sp.to != null && sp.to != pos && nextChange > sp.to) {\n              nextChange = sp.to;\n              spanEndStyle = \"\";\n            }\n            if (m.className) { spanStyle += \" \" + m.className; }\n            if (m.css) { css = (css ? css + \";\" : \"\") + m.css; }\n            if (m.startStyle && sp.from == pos) { spanStartStyle += \" \" + m.startStyle; }\n            if (m.endStyle && sp.to == nextChange) { (endStyles || (endStyles = [])).push(m.endStyle, sp.to); }\n            // support for the old title property\n            // https://github.com/codemirror/CodeMirror/pull/5673\n            if (m.title) { (attributes || (attributes = {})).title = m.title; }\n            if (m.attributes) {\n              for (var attr in m.attributes)\n                { (attributes || (attributes = {}))[attr] = m.attributes[attr]; }\n            }\n            if (m.collapsed && (!collapsed || compareCollapsedMarkers(collapsed.marker, m) < 0))\n              { collapsed = sp; }\n          } else if (sp.from > pos && nextChange > sp.from) {\n            nextChange = sp.from;\n          }\n        }\n        if (endStyles) { for (var j$1 = 0; j$1 < endStyles.length; j$1 += 2)\n          { if (endStyles[j$1 + 1] == nextChange) { spanEndStyle += \" \" + endStyles[j$1]; } } }\n\n        if (!collapsed || collapsed.from == pos) { for (var j$2 = 0; j$2 < foundBookmarks.length; ++j$2)\n          { buildCollapsedSpan(builder, 0, foundBookmarks[j$2]); } }\n        if (collapsed && (collapsed.from || 0) == pos) {\n          buildCollapsedSpan(builder, (collapsed.to == null ? len + 1 : collapsed.to) - pos,\n                             collapsed.marker, collapsed.from == null);\n          if (collapsed.to == null) { return }\n          if (collapsed.to == pos) { collapsed = false; }\n        }\n      }\n      if (pos >= len) { break }\n\n      var upto = Math.min(len, nextChange);\n      while (true) {\n        if (text) {\n          var end = pos + text.length;\n          if (!collapsed) {\n            var tokenText = end > upto ? text.slice(0, upto - pos) : text;\n            builder.addToken(builder, tokenText, style ? style + spanStyle : spanStyle,\n                             spanStartStyle, pos + tokenText.length == nextChange ? spanEndStyle : \"\", css, attributes);\n          }\n          if (end >= upto) {text = text.slice(upto - pos); pos = upto; break}\n          pos = end;\n          spanStartStyle = \"\";\n        }\n        text = allText.slice(at, at = styles[i++]);\n        style = interpretTokenStyle(styles[i++], builder.cm.options);\n      }\n    }\n  }\n\n\n  // These objects are used to represent the visible (currently drawn)\n  // part of the document. A LineView may correspond to multiple\n  // logical lines, if those are connected by collapsed ranges.\n  function LineView(doc, line, lineN) {\n    // The starting line\n    this.line = line;\n    // Continuing lines, if any\n    this.rest = visualLineContinued(line);\n    // Number of logical lines in this visual line\n    this.size = this.rest ? lineNo(lst(this.rest)) - lineN + 1 : 1;\n    this.node = this.text = null;\n    this.hidden = lineIsHidden(doc, line);\n  }\n\n  // Create a range of LineView objects for the given lines.\n  function buildViewArray(cm, from, to) {\n    var array = [], nextPos;\n    for (var pos = from; pos < to; pos = nextPos) {\n      var view = new LineView(cm.doc, getLine(cm.doc, pos), pos);\n      nextPos = pos + view.size;\n      array.push(view);\n    }\n    return array\n  }\n\n  var operationGroup = null;\n\n  function pushOperation(op) {\n    if (operationGroup) {\n      operationGroup.ops.push(op);\n    } else {\n      op.ownsGroup = operationGroup = {\n        ops: [op],\n        delayedCallbacks: []\n      };\n    }\n  }\n\n  function fireCallbacksForOps(group) {\n    // Calls delayed callbacks and cursorActivity handlers until no\n    // new ones appear\n    var callbacks = group.delayedCallbacks, i = 0;\n    do {\n      for (; i < callbacks.length; i++)\n        { callbacks[i].call(null); }\n      for (var j = 0; j < group.ops.length; j++) {\n        var op = group.ops[j];\n        if (op.cursorActivityHandlers)\n          { while (op.cursorActivityCalled < op.cursorActivityHandlers.length)\n            { op.cursorActivityHandlers[op.cursorActivityCalled++].call(null, op.cm); } }\n      }\n    } while (i < callbacks.length)\n  }\n\n  function finishOperation(op, endCb) {\n    var group = op.ownsGroup;\n    if (!group) { return }\n\n    try { fireCallbacksForOps(group); }\n    finally {\n      operationGroup = null;\n      endCb(group);\n    }\n  }\n\n  var orphanDelayedCallbacks = null;\n\n  // Often, we want to signal events at a point where we are in the\n  // middle of some work, but don't want the handler to start calling\n  // other methods on the editor, which might be in an inconsistent\n  // state or simply not expect any other events to happen.\n  // signalLater looks whether there are any handlers, and schedules\n  // them to be executed when the last operation ends, or, if no\n  // operation is active, when a timeout fires.\n  function signalLater(emitter, type /*, values...*/) {\n    var arr = getHandlers(emitter, type);\n    if (!arr.length) { return }\n    var args = Array.prototype.slice.call(arguments, 2), list;\n    if (operationGroup) {\n      list = operationGroup.delayedCallbacks;\n    } else if (orphanDelayedCallbacks) {\n      list = orphanDelayedCallbacks;\n    } else {\n      list = orphanDelayedCallbacks = [];\n      setTimeout(fireOrphanDelayed, 0);\n    }\n    var loop = function ( i ) {\n      list.push(function () { return arr[i].apply(null, args); });\n    };\n\n    for (var i = 0; i < arr.length; ++i)\n      loop( i );\n  }\n\n  function fireOrphanDelayed() {\n    var delayed = orphanDelayedCallbacks;\n    orphanDelayedCallbacks = null;\n    for (var i = 0; i < delayed.length; ++i) { delayed[i](); }\n  }\n\n  // When an aspect of a line changes, a string is added to\n  // lineView.changes. This updates the relevant part of the line's\n  // DOM structure.\n  function updateLineForChanges(cm, lineView, lineN, dims) {\n    for (var j = 0; j < lineView.changes.length; j++) {\n      var type = lineView.changes[j];\n      if (type == \"text\") { updateLineText(cm, lineView); }\n      else if (type == \"gutter\") { updateLineGutter(cm, lineView, lineN, dims); }\n      else if (type == \"class\") { updateLineClasses(cm, lineView); }\n      else if (type == \"widget\") { updateLineWidgets(cm, lineView, dims); }\n    }\n    lineView.changes = null;\n  }\n\n  // Lines with gutter elements, widgets or a background class need to\n  // be wrapped, and have the extra elements added to the wrapper div\n  function ensureLineWrapped(lineView) {\n    if (lineView.node == lineView.text) {\n      lineView.node = elt(\"div\", null, null, \"position: relative\");\n      if (lineView.text.parentNode)\n        { lineView.text.parentNode.replaceChild(lineView.node, lineView.text); }\n      lineView.node.appendChild(lineView.text);\n      if (ie && ie_version < 8) { lineView.node.style.zIndex = 2; }\n    }\n    return lineView.node\n  }\n\n  function updateLineBackground(cm, lineView) {\n    var cls = lineView.bgClass ? lineView.bgClass + \" \" + (lineView.line.bgClass || \"\") : lineView.line.bgClass;\n    if (cls) { cls += \" CodeMirror-linebackground\"; }\n    if (lineView.background) {\n      if (cls) { lineView.background.className = cls; }\n      else { lineView.background.parentNode.removeChild(lineView.background); lineView.background = null; }\n    } else if (cls) {\n      var wrap = ensureLineWrapped(lineView);\n      lineView.background = wrap.insertBefore(elt(\"div\", null, cls), wrap.firstChild);\n      cm.display.input.setUneditable(lineView.background);\n    }\n  }\n\n  // Wrapper around buildLineContent which will reuse the structure\n  // in display.externalMeasured when possible.\n  function getLineContent(cm, lineView) {\n    var ext = cm.display.externalMeasured;\n    if (ext && ext.line == lineView.line) {\n      cm.display.externalMeasured = null;\n      lineView.measure = ext.measure;\n      return ext.built\n    }\n    return buildLineContent(cm, lineView)\n  }\n\n  // Redraw the line's text. Interacts with the background and text\n  // classes because the mode may output tokens that influence these\n  // classes.\n  function updateLineText(cm, lineView) {\n    var cls = lineView.text.className;\n    var built = getLineContent(cm, lineView);\n    if (lineView.text == lineView.node) { lineView.node = built.pre; }\n    lineView.text.parentNode.replaceChild(built.pre, lineView.text);\n    lineView.text = built.pre;\n    if (built.bgClass != lineView.bgClass || built.textClass != lineView.textClass) {\n      lineView.bgClass = built.bgClass;\n      lineView.textClass = built.textClass;\n      updateLineClasses(cm, lineView);\n    } else if (cls) {\n      lineView.text.className = cls;\n    }\n  }\n\n  function updateLineClasses(cm, lineView) {\n    updateLineBackground(cm, lineView);\n    if (lineView.line.wrapClass)\n      { ensureLineWrapped(lineView).className = lineView.line.wrapClass; }\n    else if (lineView.node != lineView.text)\n      { lineView.node.className = \"\"; }\n    var textClass = lineView.textClass ? lineView.textClass + \" \" + (lineView.line.textClass || \"\") : lineView.line.textClass;\n    lineView.text.className = textClass || \"\";\n  }\n\n  function updateLineGutter(cm, lineView, lineN, dims) {\n    if (lineView.gutter) {\n      lineView.node.removeChild(lineView.gutter);\n      lineView.gutter = null;\n    }\n    if (lineView.gutterBackground) {\n      lineView.node.removeChild(lineView.gutterBackground);\n      lineView.gutterBackground = null;\n    }\n    if (lineView.line.gutterClass) {\n      var wrap = ensureLineWrapped(lineView);\n      lineView.gutterBackground = elt(\"div\", null, \"CodeMirror-gutter-background \" + lineView.line.gutterClass,\n                                      (\"left: \" + (cm.options.fixedGutter ? dims.fixedPos : -dims.gutterTotalWidth) + \"px; width: \" + (dims.gutterTotalWidth) + \"px\"));\n      cm.display.input.setUneditable(lineView.gutterBackground);\n      wrap.insertBefore(lineView.gutterBackground, lineView.text);\n    }\n    var markers = lineView.line.gutterMarkers;\n    if (cm.options.lineNumbers || markers) {\n      var wrap$1 = ensureLineWrapped(lineView);\n      var gutterWrap = lineView.gutter = elt(\"div\", null, \"CodeMirror-gutter-wrapper\", (\"left: \" + (cm.options.fixedGutter ? dims.fixedPos : -dims.gutterTotalWidth) + \"px\"));\n      gutterWrap.setAttribute(\"aria-hidden\", \"true\");\n      cm.display.input.setUneditable(gutterWrap);\n      wrap$1.insertBefore(gutterWrap, lineView.text);\n      if (lineView.line.gutterClass)\n        { gutterWrap.className += \" \" + lineView.line.gutterClass; }\n      if (cm.options.lineNumbers && (!markers || !markers[\"CodeMirror-linenumbers\"]))\n        { lineView.lineNumber = gutterWrap.appendChild(\n          elt(\"div\", lineNumberFor(cm.options, lineN),\n              \"CodeMirror-linenumber CodeMirror-gutter-elt\",\n              (\"left: \" + (dims.gutterLeft[\"CodeMirror-linenumbers\"]) + \"px; width: \" + (cm.display.lineNumInnerWidth) + \"px\"))); }\n      if (markers) { for (var k = 0; k < cm.display.gutterSpecs.length; ++k) {\n        var id = cm.display.gutterSpecs[k].className, found = markers.hasOwnProperty(id) && markers[id];\n        if (found)\n          { gutterWrap.appendChild(elt(\"div\", [found], \"CodeMirror-gutter-elt\",\n                                     (\"left: \" + (dims.gutterLeft[id]) + \"px; width: \" + (dims.gutterWidth[id]) + \"px\"))); }\n      } }\n    }\n  }\n\n  function updateLineWidgets(cm, lineView, dims) {\n    if (lineView.alignable) { lineView.alignable = null; }\n    var isWidget = classTest(\"CodeMirror-linewidget\");\n    for (var node = lineView.node.firstChild, next = (void 0); node; node = next) {\n      next = node.nextSibling;\n      if (isWidget.test(node.className)) { lineView.node.removeChild(node); }\n    }\n    insertLineWidgets(cm, lineView, dims);\n  }\n\n  // Build a line's DOM representation from scratch\n  function buildLineElement(cm, lineView, lineN, dims) {\n    var built = getLineContent(cm, lineView);\n    lineView.text = lineView.node = built.pre;\n    if (built.bgClass) { lineView.bgClass = built.bgClass; }\n    if (built.textClass) { lineView.textClass = built.textClass; }\n\n    updateLineClasses(cm, lineView);\n    updateLineGutter(cm, lineView, lineN, dims);\n    insertLineWidgets(cm, lineView, dims);\n    return lineView.node\n  }\n\n  // A lineView may contain multiple logical lines (when merged by\n  // collapsed spans). The widgets for all of them need to be drawn.\n  function insertLineWidgets(cm, lineView, dims) {\n    insertLineWidgetsFor(cm, lineView.line, lineView, dims, true);\n    if (lineView.rest) { for (var i = 0; i < lineView.rest.length; i++)\n      { insertLineWidgetsFor(cm, lineView.rest[i], lineView, dims, false); } }\n  }\n\n  function insertLineWidgetsFor(cm, line, lineView, dims, allowAbove) {\n    if (!line.widgets) { return }\n    var wrap = ensureLineWrapped(lineView);\n    for (var i = 0, ws = line.widgets; i < ws.length; ++i) {\n      var widget = ws[i], node = elt(\"div\", [widget.node], \"CodeMirror-linewidget\" + (widget.className ? \" \" + widget.className : \"\"));\n      if (!widget.handleMouseEvents) { node.setAttribute(\"cm-ignore-events\", \"true\"); }\n      positionLineWidget(widget, node, lineView, dims);\n      cm.display.input.setUneditable(node);\n      if (allowAbove && widget.above)\n        { wrap.insertBefore(node, lineView.gutter || lineView.text); }\n      else\n        { wrap.appendChild(node); }\n      signalLater(widget, \"redraw\");\n    }\n  }\n\n  function positionLineWidget(widget, node, lineView, dims) {\n    if (widget.noHScroll) {\n  (lineView.alignable || (lineView.alignable = [])).push(node);\n      var width = dims.wrapperWidth;\n      node.style.left = dims.fixedPos + \"px\";\n      if (!widget.coverGutter) {\n        width -= dims.gutterTotalWidth;\n        node.style.paddingLeft = dims.gutterTotalWidth + \"px\";\n      }\n      node.style.width = width + \"px\";\n    }\n    if (widget.coverGutter) {\n      node.style.zIndex = 5;\n      node.style.position = \"relative\";\n      if (!widget.noHScroll) { node.style.marginLeft = -dims.gutterTotalWidth + \"px\"; }\n    }\n  }\n\n  function widgetHeight(widget) {\n    if (widget.height != null) { return widget.height }\n    var cm = widget.doc.cm;\n    if (!cm) { return 0 }\n    if (!contains(document.body, widget.node)) {\n      var parentStyle = \"position: relative;\";\n      if (widget.coverGutter)\n        { parentStyle += \"margin-left: -\" + cm.display.gutters.offsetWidth + \"px;\"; }\n      if (widget.noHScroll)\n        { parentStyle += \"width: \" + cm.display.wrapper.clientWidth + \"px;\"; }\n      removeChildrenAndAdd(cm.display.measure, elt(\"div\", [widget.node], null, parentStyle));\n    }\n    return widget.height = widget.node.parentNode.offsetHeight\n  }\n\n  // Return true when the given mouse event happened in a widget\n  function eventInWidget(display, e) {\n    for (var n = e_target(e); n != display.wrapper; n = n.parentNode) {\n      if (!n || (n.nodeType == 1 && n.getAttribute(\"cm-ignore-events\") == \"true\") ||\n          (n.parentNode == display.sizer && n != display.mover))\n        { return true }\n    }\n  }\n\n  // POSITION MEASUREMENT\n\n  function paddingTop(display) {return display.lineSpace.offsetTop}\n  function paddingVert(display) {return display.mover.offsetHeight - display.lineSpace.offsetHeight}\n  function paddingH(display) {\n    if (display.cachedPaddingH) { return display.cachedPaddingH }\n    var e = removeChildrenAndAdd(display.measure, elt(\"pre\", \"x\", \"CodeMirror-line-like\"));\n    var style = window.getComputedStyle ? window.getComputedStyle(e) : e.currentStyle;\n    var data = {left: parseInt(style.paddingLeft), right: parseInt(style.paddingRight)};\n    if (!isNaN(data.left) && !isNaN(data.right)) { display.cachedPaddingH = data; }\n    return data\n  }\n\n  function scrollGap(cm) { return scrollerGap - cm.display.nativeBarWidth }\n  function displayWidth(cm) {\n    return cm.display.scroller.clientWidth - scrollGap(cm) - cm.display.barWidth\n  }\n  function displayHeight(cm) {\n    return cm.display.scroller.clientHeight - scrollGap(cm) - cm.display.barHeight\n  }\n\n  // Ensure the lineView.wrapping.heights array is populated. This is\n  // an array of bottom offsets for the lines that make up a drawn\n  // line. When lineWrapping is on, there might be more than one\n  // height.\n  function ensureLineHeights(cm, lineView, rect) {\n    var wrapping = cm.options.lineWrapping;\n    var curWidth = wrapping && displayWidth(cm);\n    if (!lineView.measure.heights || wrapping && lineView.measure.width != curWidth) {\n      var heights = lineView.measure.heights = [];\n      if (wrapping) {\n        lineView.measure.width = curWidth;\n        var rects = lineView.text.firstChild.getClientRects();\n        for (var i = 0; i < rects.length - 1; i++) {\n          var cur = rects[i], next = rects[i + 1];\n          if (Math.abs(cur.bottom - next.bottom) > 2)\n            { heights.push((cur.bottom + next.top) / 2 - rect.top); }\n        }\n      }\n      heights.push(rect.bottom - rect.top);\n    }\n  }\n\n  // Find a line map (mapping character offsets to text nodes) and a\n  // measurement cache for the given line number. (A line view might\n  // contain multiple lines when collapsed ranges are present.)\n  function mapFromLineView(lineView, line, lineN) {\n    if (lineView.line == line)\n      { return {map: lineView.measure.map, cache: lineView.measure.cache} }\n    for (var i = 0; i < lineView.rest.length; i++)\n      { if (lineView.rest[i] == line)\n        { return {map: lineView.measure.maps[i], cache: lineView.measure.caches[i]} } }\n    for (var i$1 = 0; i$1 < lineView.rest.length; i$1++)\n      { if (lineNo(lineView.rest[i$1]) > lineN)\n        { return {map: lineView.measure.maps[i$1], cache: lineView.measure.caches[i$1], before: true} } }\n  }\n\n  // Render a line into the hidden node display.externalMeasured. Used\n  // when measurement is needed for a line that's not in the viewport.\n  function updateExternalMeasurement(cm, line) {\n    line = visualLine(line);\n    var lineN = lineNo(line);\n    var view = cm.display.externalMeasured = new LineView(cm.doc, line, lineN);\n    view.lineN = lineN;\n    var built = view.built = buildLineContent(cm, view);\n    view.text = built.pre;\n    removeChildrenAndAdd(cm.display.lineMeasure, built.pre);\n    return view\n  }\n\n  // Get a {top, bottom, left, right} box (in line-local coordinates)\n  // for a given character.\n  function measureChar(cm, line, ch, bias) {\n    return measureCharPrepared(cm, prepareMeasureForLine(cm, line), ch, bias)\n  }\n\n  // Find a line view that corresponds to the given line number.\n  function findViewForLine(cm, lineN) {\n    if (lineN >= cm.display.viewFrom && lineN < cm.display.viewTo)\n      { return cm.display.view[findViewIndex(cm, lineN)] }\n    var ext = cm.display.externalMeasured;\n    if (ext && lineN >= ext.lineN && lineN < ext.lineN + ext.size)\n      { return ext }\n  }\n\n  // Measurement can be split in two steps, the set-up work that\n  // applies to the whole line, and the measurement of the actual\n  // character. Functions like coordsChar, that need to do a lot of\n  // measurements in a row, can thus ensure that the set-up work is\n  // only done once.\n  function prepareMeasureForLine(cm, line) {\n    var lineN = lineNo(line);\n    var view = findViewForLine(cm, lineN);\n    if (view && !view.text) {\n      view = null;\n    } else if (view && view.changes) {\n      updateLineForChanges(cm, view, lineN, getDimensions(cm));\n      cm.curOp.forceUpdate = true;\n    }\n    if (!view)\n      { view = updateExternalMeasurement(cm, line); }\n\n    var info = mapFromLineView(view, line, lineN);\n    return {\n      line: line, view: view, rect: null,\n      map: info.map, cache: info.cache, before: info.before,\n      hasHeights: false\n    }\n  }\n\n  // Given a prepared measurement object, measures the position of an\n  // actual character (or fetches it from the cache).\n  function measureCharPrepared(cm, prepared, ch, bias, varHeight) {\n    if (prepared.before) { ch = -1; }\n    var key = ch + (bias || \"\"), found;\n    if (prepared.cache.hasOwnProperty(key)) {\n      found = prepared.cache[key];\n    } else {\n      if (!prepared.rect)\n        { prepared.rect = prepared.view.text.getBoundingClientRect(); }\n      if (!prepared.hasHeights) {\n        ensureLineHeights(cm, prepared.view, prepared.rect);\n        prepared.hasHeights = true;\n      }\n      found = measureCharInner(cm, prepared, ch, bias);\n      if (!found.bogus) { prepared.cache[key] = found; }\n    }\n    return {left: found.left, right: found.right,\n            top: varHeight ? found.rtop : found.top,\n            bottom: varHeight ? found.rbottom : found.bottom}\n  }\n\n  var nullRect = {left: 0, right: 0, top: 0, bottom: 0};\n\n  function nodeAndOffsetInLineMap(map, ch, bias) {\n    var node, start, end, collapse, mStart, mEnd;\n    // First, search the line map for the text node corresponding to,\n    // or closest to, the target character.\n    for (var i = 0; i < map.length; i += 3) {\n      mStart = map[i];\n      mEnd = map[i + 1];\n      if (ch < mStart) {\n        start = 0; end = 1;\n        collapse = \"left\";\n      } else if (ch < mEnd) {\n        start = ch - mStart;\n        end = start + 1;\n      } else if (i == map.length - 3 || ch == mEnd && map[i + 3] > ch) {\n        end = mEnd - mStart;\n        start = end - 1;\n        if (ch >= mEnd) { collapse = \"right\"; }\n      }\n      if (start != null) {\n        node = map[i + 2];\n        if (mStart == mEnd && bias == (node.insertLeft ? \"left\" : \"right\"))\n          { collapse = bias; }\n        if (bias == \"left\" && start == 0)\n          { while (i && map[i - 2] == map[i - 3] && map[i - 1].insertLeft) {\n            node = map[(i -= 3) + 2];\n            collapse = \"left\";\n          } }\n        if (bias == \"right\" && start == mEnd - mStart)\n          { while (i < map.length - 3 && map[i + 3] == map[i + 4] && !map[i + 5].insertLeft) {\n            node = map[(i += 3) + 2];\n            collapse = \"right\";\n          } }\n        break\n      }\n    }\n    return {node: node, start: start, end: end, collapse: collapse, coverStart: mStart, coverEnd: mEnd}\n  }\n\n  function getUsefulRect(rects, bias) {\n    var rect = nullRect;\n    if (bias == \"left\") { for (var i = 0; i < rects.length; i++) {\n      if ((rect = rects[i]).left != rect.right) { break }\n    } } else { for (var i$1 = rects.length - 1; i$1 >= 0; i$1--) {\n      if ((rect = rects[i$1]).left != rect.right) { break }\n    } }\n    return rect\n  }\n\n  function measureCharInner(cm, prepared, ch, bias) {\n    var place = nodeAndOffsetInLineMap(prepared.map, ch, bias);\n    var node = place.node, start = place.start, end = place.end, collapse = place.collapse;\n\n    var rect;\n    if (node.nodeType == 3) { // If it is a text node, use a range to retrieve the coordinates.\n      for (var i$1 = 0; i$1 < 4; i$1++) { // Retry a maximum of 4 times when nonsense rectangles are returned\n        while (start && isExtendingChar(prepared.line.text.charAt(place.coverStart + start))) { --start; }\n        while (place.coverStart + end < place.coverEnd && isExtendingChar(prepared.line.text.charAt(place.coverStart + end))) { ++end; }\n        if (ie && ie_version < 9 && start == 0 && end == place.coverEnd - place.coverStart)\n          { rect = node.parentNode.getBoundingClientRect(); }\n        else\n          { rect = getUsefulRect(range(node, start, end).getClientRects(), bias); }\n        if (rect.left || rect.right || start == 0) { break }\n        end = start;\n        start = start - 1;\n        collapse = \"right\";\n      }\n      if (ie && ie_version < 11) { rect = maybeUpdateRectForZooming(cm.display.measure, rect); }\n    } else { // If it is a widget, simply get the box for the whole widget.\n      if (start > 0) { collapse = bias = \"right\"; }\n      var rects;\n      if (cm.options.lineWrapping && (rects = node.getClientRects()).length > 1)\n        { rect = rects[bias == \"right\" ? rects.length - 1 : 0]; }\n      else\n        { rect = node.getBoundingClientRect(); }\n    }\n    if (ie && ie_version < 9 && !start && (!rect || !rect.left && !rect.right)) {\n      var rSpan = node.parentNode.getClientRects()[0];\n      if (rSpan)\n        { rect = {left: rSpan.left, right: rSpan.left + charWidth(cm.display), top: rSpan.top, bottom: rSpan.bottom}; }\n      else\n        { rect = nullRect; }\n    }\n\n    var rtop = rect.top - prepared.rect.top, rbot = rect.bottom - prepared.rect.top;\n    var mid = (rtop + rbot) / 2;\n    var heights = prepared.view.measure.heights;\n    var i = 0;\n    for (; i < heights.length - 1; i++)\n      { if (mid < heights[i]) { break } }\n    var top = i ? heights[i - 1] : 0, bot = heights[i];\n    var result = {left: (collapse == \"right\" ? rect.right : rect.left) - prepared.rect.left,\n                  right: (collapse == \"left\" ? rect.left : rect.right) - prepared.rect.left,\n                  top: top, bottom: bot};\n    if (!rect.left && !rect.right) { result.bogus = true; }\n    if (!cm.options.singleCursorHeightPerLine) { result.rtop = rtop; result.rbottom = rbot; }\n\n    return result\n  }\n\n  // Work around problem with bounding client rects on ranges being\n  // returned incorrectly when zoomed on IE10 and below.\n  function maybeUpdateRectForZooming(measure, rect) {\n    if (!window.screen || screen.logicalXDPI == null ||\n        screen.logicalXDPI == screen.deviceXDPI || !hasBadZoomedRects(measure))\n      { return rect }\n    var scaleX = screen.logicalXDPI / screen.deviceXDPI;\n    var scaleY = screen.logicalYDPI / screen.deviceYDPI;\n    return {left: rect.left * scaleX, right: rect.right * scaleX,\n            top: rect.top * scaleY, bottom: rect.bottom * scaleY}\n  }\n\n  function clearLineMeasurementCacheFor(lineView) {\n    if (lineView.measure) {\n      lineView.measure.cache = {};\n      lineView.measure.heights = null;\n      if (lineView.rest) { for (var i = 0; i < lineView.rest.length; i++)\n        { lineView.measure.caches[i] = {}; } }\n    }\n  }\n\n  function clearLineMeasurementCache(cm) {\n    cm.display.externalMeasure = null;\n    removeChildren(cm.display.lineMeasure);\n    for (var i = 0; i < cm.display.view.length; i++)\n      { clearLineMeasurementCacheFor(cm.display.view[i]); }\n  }\n\n  function clearCaches(cm) {\n    clearLineMeasurementCache(cm);\n    cm.display.cachedCharWidth = cm.display.cachedTextHeight = cm.display.cachedPaddingH = null;\n    if (!cm.options.lineWrapping) { cm.display.maxLineChanged = true; }\n    cm.display.lineNumChars = null;\n  }\n\n  function pageScrollX() {\n    // Work around https://bugs.chromium.org/p/chromium/issues/detail?id=489206\n    // which causes page_Offset and bounding client rects to use\n    // different reference viewports and invalidate our calculations.\n    if (chrome && android) { return -(document.body.getBoundingClientRect().left - parseInt(getComputedStyle(document.body).marginLeft)) }\n    return window.pageXOffset || (document.documentElement || document.body).scrollLeft\n  }\n  function pageScrollY() {\n    if (chrome && android) { return -(document.body.getBoundingClientRect().top - parseInt(getComputedStyle(document.body).marginTop)) }\n    return window.pageYOffset || (document.documentElement || document.body).scrollTop\n  }\n\n  function widgetTopHeight(lineObj) {\n    var height = 0;\n    if (lineObj.widgets) { for (var i = 0; i < lineObj.widgets.length; ++i) { if (lineObj.widgets[i].above)\n      { height += widgetHeight(lineObj.widgets[i]); } } }\n    return height\n  }\n\n  // Converts a {top, bottom, left, right} box from line-local\n  // coordinates into another coordinate system. Context may be one of\n  // \"line\", \"div\" (display.lineDiv), \"local\"./null (editor), \"window\",\n  // or \"page\".\n  function intoCoordSystem(cm, lineObj, rect, context, includeWidgets) {\n    if (!includeWidgets) {\n      var height = widgetTopHeight(lineObj);\n      rect.top += height; rect.bottom += height;\n    }\n    if (context == \"line\") { return rect }\n    if (!context) { context = \"local\"; }\n    var yOff = heightAtLine(lineObj);\n    if (context == \"local\") { yOff += paddingTop(cm.display); }\n    else { yOff -= cm.display.viewOffset; }\n    if (context == \"page\" || context == \"window\") {\n      var lOff = cm.display.lineSpace.getBoundingClientRect();\n      yOff += lOff.top + (context == \"window\" ? 0 : pageScrollY());\n      var xOff = lOff.left + (context == \"window\" ? 0 : pageScrollX());\n      rect.left += xOff; rect.right += xOff;\n    }\n    rect.top += yOff; rect.bottom += yOff;\n    return rect\n  }\n\n  // Coverts a box from \"div\" coords to another coordinate system.\n  // Context may be \"window\", \"page\", \"div\", or \"local\"./null.\n  function fromCoordSystem(cm, coords, context) {\n    if (context == \"div\") { return coords }\n    var left = coords.left, top = coords.top;\n    // First move into \"page\" coordinate system\n    if (context == \"page\") {\n      left -= pageScrollX();\n      top -= pageScrollY();\n    } else if (context == \"local\" || !context) {\n      var localBox = cm.display.sizer.getBoundingClientRect();\n      left += localBox.left;\n      top += localBox.top;\n    }\n\n    var lineSpaceBox = cm.display.lineSpace.getBoundingClientRect();\n    return {left: left - lineSpaceBox.left, top: top - lineSpaceBox.top}\n  }\n\n  function charCoords(cm, pos, context, lineObj, bias) {\n    if (!lineObj) { lineObj = getLine(cm.doc, pos.line); }\n    return intoCoordSystem(cm, lineObj, measureChar(cm, lineObj, pos.ch, bias), context)\n  }\n\n  // Returns a box for a given cursor position, which may have an\n  // 'other' property containing the position of the secondary cursor\n  // on a bidi boundary.\n  // A cursor Pos(line, char, \"before\") is on the same visual line as `char - 1`\n  // and after `char - 1` in writing order of `char - 1`\n  // A cursor Pos(line, char, \"after\") is on the same visual line as `char`\n  // and before `char` in writing order of `char`\n  // Examples (upper-case letters are RTL, lower-case are LTR):\n  //     Pos(0, 1, ...)\n  //     before   after\n  // ab     a|b     a|b\n  // aB     a|B     aB|\n  // Ab     |Ab     A|b\n  // AB     B|A     B|A\n  // Every position after the last character on a line is considered to stick\n  // to the last character on the line.\n  function cursorCoords(cm, pos, context, lineObj, preparedMeasure, varHeight) {\n    lineObj = lineObj || getLine(cm.doc, pos.line);\n    if (!preparedMeasure) { preparedMeasure = prepareMeasureForLine(cm, lineObj); }\n    function get(ch, right) {\n      var m = measureCharPrepared(cm, preparedMeasure, ch, right ? \"right\" : \"left\", varHeight);\n      if (right) { m.left = m.right; } else { m.right = m.left; }\n      return intoCoordSystem(cm, lineObj, m, context)\n    }\n    var order = getOrder(lineObj, cm.doc.direction), ch = pos.ch, sticky = pos.sticky;\n    if (ch >= lineObj.text.length) {\n      ch = lineObj.text.length;\n      sticky = \"before\";\n    } else if (ch <= 0) {\n      ch = 0;\n      sticky = \"after\";\n    }\n    if (!order) { return get(sticky == \"before\" ? ch - 1 : ch, sticky == \"before\") }\n\n    function getBidi(ch, partPos, invert) {\n      var part = order[partPos], right = part.level == 1;\n      return get(invert ? ch - 1 : ch, right != invert)\n    }\n    var partPos = getBidiPartAt(order, ch, sticky);\n    var other = bidiOther;\n    var val = getBidi(ch, partPos, sticky == \"before\");\n    if (other != null) { val.other = getBidi(ch, other, sticky != \"before\"); }\n    return val\n  }\n\n  // Used to cheaply estimate the coordinates for a position. Used for\n  // intermediate scroll updates.\n  function estimateCoords(cm, pos) {\n    var left = 0;\n    pos = clipPos(cm.doc, pos);\n    if (!cm.options.lineWrapping) { left = charWidth(cm.display) * pos.ch; }\n    var lineObj = getLine(cm.doc, pos.line);\n    var top = heightAtLine(lineObj) + paddingTop(cm.display);\n    return {left: left, right: left, top: top, bottom: top + lineObj.height}\n  }\n\n  // Positions returned by coordsChar contain some extra information.\n  // xRel is the relative x position of the input coordinates compared\n  // to the found position (so xRel > 0 means the coordinates are to\n  // the right of the character position, for example). When outside\n  // is true, that means the coordinates lie outside the line's\n  // vertical range.\n  function PosWithInfo(line, ch, sticky, outside, xRel) {\n    var pos = Pos(line, ch, sticky);\n    pos.xRel = xRel;\n    if (outside) { pos.outside = outside; }\n    return pos\n  }\n\n  // Compute the character position closest to the given coordinates.\n  // Input must be lineSpace-local (\"div\" coordinate system).\n  function coordsChar(cm, x, y) {\n    var doc = cm.doc;\n    y += cm.display.viewOffset;\n    if (y < 0) { return PosWithInfo(doc.first, 0, null, -1, -1) }\n    var lineN = lineAtHeight(doc, y), last = doc.first + doc.size - 1;\n    if (lineN > last)\n      { return PosWithInfo(doc.first + doc.size - 1, getLine(doc, last).text.length, null, 1, 1) }\n    if (x < 0) { x = 0; }\n\n    var lineObj = getLine(doc, lineN);\n    for (;;) {\n      var found = coordsCharInner(cm, lineObj, lineN, x, y);\n      var collapsed = collapsedSpanAround(lineObj, found.ch + (found.xRel > 0 || found.outside > 0 ? 1 : 0));\n      if (!collapsed) { return found }\n      var rangeEnd = collapsed.find(1);\n      if (rangeEnd.line == lineN) { return rangeEnd }\n      lineObj = getLine(doc, lineN = rangeEnd.line);\n    }\n  }\n\n  function wrappedLineExtent(cm, lineObj, preparedMeasure, y) {\n    y -= widgetTopHeight(lineObj);\n    var end = lineObj.text.length;\n    var begin = findFirst(function (ch) { return measureCharPrepared(cm, preparedMeasure, ch - 1).bottom <= y; }, end, 0);\n    end = findFirst(function (ch) { return measureCharPrepared(cm, preparedMeasure, ch).top > y; }, begin, end);\n    return {begin: begin, end: end}\n  }\n\n  function wrappedLineExtentChar(cm, lineObj, preparedMeasure, target) {\n    if (!preparedMeasure) { preparedMeasure = prepareMeasureForLine(cm, lineObj); }\n    var targetTop = intoCoordSystem(cm, lineObj, measureCharPrepared(cm, preparedMeasure, target), \"line\").top;\n    return wrappedLineExtent(cm, lineObj, preparedMeasure, targetTop)\n  }\n\n  // Returns true if the given side of a box is after the given\n  // coordinates, in top-to-bottom, left-to-right order.\n  function boxIsAfter(box, x, y, left) {\n    return box.bottom <= y ? false : box.top > y ? true : (left ? box.left : box.right) > x\n  }\n\n  function coordsCharInner(cm, lineObj, lineNo, x, y) {\n    // Move y into line-local coordinate space\n    y -= heightAtLine(lineObj);\n    var preparedMeasure = prepareMeasureForLine(cm, lineObj);\n    // When directly calling `measureCharPrepared`, we have to adjust\n    // for the widgets at this line.\n    var widgetHeight = widgetTopHeight(lineObj);\n    var begin = 0, end = lineObj.text.length, ltr = true;\n\n    var order = getOrder(lineObj, cm.doc.direction);\n    // If the line isn't plain left-to-right text, first figure out\n    // which bidi section the coordinates fall into.\n    if (order) {\n      var part = (cm.options.lineWrapping ? coordsBidiPartWrapped : coordsBidiPart)\n                   (cm, lineObj, lineNo, preparedMeasure, order, x, y);\n      ltr = part.level != 1;\n      // The awkward -1 offsets are needed because findFirst (called\n      // on these below) will treat its first bound as inclusive,\n      // second as exclusive, but we want to actually address the\n      // characters in the part's range\n      begin = ltr ? part.from : part.to - 1;\n      end = ltr ? part.to : part.from - 1;\n    }\n\n    // A binary search to find the first character whose bounding box\n    // starts after the coordinates. If we run across any whose box wrap\n    // the coordinates, store that.\n    var chAround = null, boxAround = null;\n    var ch = findFirst(function (ch) {\n      var box = measureCharPrepared(cm, preparedMeasure, ch);\n      box.top += widgetHeight; box.bottom += widgetHeight;\n      if (!boxIsAfter(box, x, y, false)) { return false }\n      if (box.top <= y && box.left <= x) {\n        chAround = ch;\n        boxAround = box;\n      }\n      return true\n    }, begin, end);\n\n    var baseX, sticky, outside = false;\n    // If a box around the coordinates was found, use that\n    if (boxAround) {\n      // Distinguish coordinates nearer to the left or right side of the box\n      var atLeft = x - boxAround.left < boxAround.right - x, atStart = atLeft == ltr;\n      ch = chAround + (atStart ? 0 : 1);\n      sticky = atStart ? \"after\" : \"before\";\n      baseX = atLeft ? boxAround.left : boxAround.right;\n    } else {\n      // (Adjust for extended bound, if necessary.)\n      if (!ltr && (ch == end || ch == begin)) { ch++; }\n      // To determine which side to associate with, get the box to the\n      // left of the character and compare it's vertical position to the\n      // coordinates\n      sticky = ch == 0 ? \"after\" : ch == lineObj.text.length ? \"before\" :\n        (measureCharPrepared(cm, preparedMeasure, ch - (ltr ? 1 : 0)).bottom + widgetHeight <= y) == ltr ?\n        \"after\" : \"before\";\n      // Now get accurate coordinates for this place, in order to get a\n      // base X position\n      var coords = cursorCoords(cm, Pos(lineNo, ch, sticky), \"line\", lineObj, preparedMeasure);\n      baseX = coords.left;\n      outside = y < coords.top ? -1 : y >= coords.bottom ? 1 : 0;\n    }\n\n    ch = skipExtendingChars(lineObj.text, ch, 1);\n    return PosWithInfo(lineNo, ch, sticky, outside, x - baseX)\n  }\n\n  function coordsBidiPart(cm, lineObj, lineNo, preparedMeasure, order, x, y) {\n    // Bidi parts are sorted left-to-right, and in a non-line-wrapping\n    // situation, we can take this ordering to correspond to the visual\n    // ordering. This finds the first part whose end is after the given\n    // coordinates.\n    var index = findFirst(function (i) {\n      var part = order[i], ltr = part.level != 1;\n      return boxIsAfter(cursorCoords(cm, Pos(lineNo, ltr ? part.to : part.from, ltr ? \"before\" : \"after\"),\n                                     \"line\", lineObj, preparedMeasure), x, y, true)\n    }, 0, order.length - 1);\n    var part = order[index];\n    // If this isn't the first part, the part's start is also after\n    // the coordinates, and the coordinates aren't on the same line as\n    // that start, move one part back.\n    if (index > 0) {\n      var ltr = part.level != 1;\n      var start = cursorCoords(cm, Pos(lineNo, ltr ? part.from : part.to, ltr ? \"after\" : \"before\"),\n                               \"line\", lineObj, preparedMeasure);\n      if (boxIsAfter(start, x, y, true) && start.top > y)\n        { part = order[index - 1]; }\n    }\n    return part\n  }\n\n  function coordsBidiPartWrapped(cm, lineObj, _lineNo, preparedMeasure, order, x, y) {\n    // In a wrapped line, rtl text on wrapping boundaries can do things\n    // that don't correspond to the ordering in our `order` array at\n    // all, so a binary search doesn't work, and we want to return a\n    // part that only spans one line so that the binary search in\n    // coordsCharInner is safe. As such, we first find the extent of the\n    // wrapped line, and then do a flat search in which we discard any\n    // spans that aren't on the line.\n    var ref = wrappedLineExtent(cm, lineObj, preparedMeasure, y);\n    var begin = ref.begin;\n    var end = ref.end;\n    if (/\\s/.test(lineObj.text.charAt(end - 1))) { end--; }\n    var part = null, closestDist = null;\n    for (var i = 0; i < order.length; i++) {\n      var p = order[i];\n      if (p.from >= end || p.to <= begin) { continue }\n      var ltr = p.level != 1;\n      var endX = measureCharPrepared(cm, preparedMeasure, ltr ? Math.min(end, p.to) - 1 : Math.max(begin, p.from)).right;\n      // Weigh against spans ending before this, so that they are only\n      // picked if nothing ends after\n      var dist = endX < x ? x - endX + 1e9 : endX - x;\n      if (!part || closestDist > dist) {\n        part = p;\n        closestDist = dist;\n      }\n    }\n    if (!part) { part = order[order.length - 1]; }\n    // Clip the part to the wrapped line.\n    if (part.from < begin) { part = {from: begin, to: part.to, level: part.level}; }\n    if (part.to > end) { part = {from: part.from, to: end, level: part.level}; }\n    return part\n  }\n\n  var measureText;\n  // Compute the default text height.\n  function textHeight(display) {\n    if (display.cachedTextHeight != null) { return display.cachedTextHeight }\n    if (measureText == null) {\n      measureText = elt(\"pre\", null, \"CodeMirror-line-like\");\n      // Measure a bunch of lines, for browsers that compute\n      // fractional heights.\n      for (var i = 0; i < 49; ++i) {\n        measureText.appendChild(document.createTextNode(\"x\"));\n        measureText.appendChild(elt(\"br\"));\n      }\n      measureText.appendChild(document.createTextNode(\"x\"));\n    }\n    removeChildrenAndAdd(display.measure, measureText);\n    var height = measureText.offsetHeight / 50;\n    if (height > 3) { display.cachedTextHeight = height; }\n    removeChildren(display.measure);\n    return height || 1\n  }\n\n  // Compute the default character width.\n  function charWidth(display) {\n    if (display.cachedCharWidth != null) { return display.cachedCharWidth }\n    var anchor = elt(\"span\", \"xxxxxxxxxx\");\n    var pre = elt(\"pre\", [anchor], \"CodeMirror-line-like\");\n    removeChildrenAndAdd(display.measure, pre);\n    var rect = anchor.getBoundingClientRect(), width = (rect.right - rect.left) / 10;\n    if (width > 2) { display.cachedCharWidth = width; }\n    return width || 10\n  }\n\n  // Do a bulk-read of the DOM positions and sizes needed to draw the\n  // view, so that we don't interleave reading and writing to the DOM.\n  function getDimensions(cm) {\n    var d = cm.display, left = {}, width = {};\n    var gutterLeft = d.gutters.clientLeft;\n    for (var n = d.gutters.firstChild, i = 0; n; n = n.nextSibling, ++i) {\n      var id = cm.display.gutterSpecs[i].className;\n      left[id] = n.offsetLeft + n.clientLeft + gutterLeft;\n      width[id] = n.clientWidth;\n    }\n    return {fixedPos: compensateForHScroll(d),\n            gutterTotalWidth: d.gutters.offsetWidth,\n            gutterLeft: left,\n            gutterWidth: width,\n            wrapperWidth: d.wrapper.clientWidth}\n  }\n\n  // Computes display.scroller.scrollLeft + display.gutters.offsetWidth,\n  // but using getBoundingClientRect to get a sub-pixel-accurate\n  // result.\n  function compensateForHScroll(display) {\n    return display.scroller.getBoundingClientRect().left - display.sizer.getBoundingClientRect().left\n  }\n\n  // Returns a function that estimates the height of a line, to use as\n  // first approximation until the line becomes visible (and is thus\n  // properly measurable).\n  function estimateHeight(cm) {\n    var th = textHeight(cm.display), wrapping = cm.options.lineWrapping;\n    var perLine = wrapping && Math.max(5, cm.display.scroller.clientWidth / charWidth(cm.display) - 3);\n    return function (line) {\n      if (lineIsHidden(cm.doc, line)) { return 0 }\n\n      var widgetsHeight = 0;\n      if (line.widgets) { for (var i = 0; i < line.widgets.length; i++) {\n        if (line.widgets[i].height) { widgetsHeight += line.widgets[i].height; }\n      } }\n\n      if (wrapping)\n        { return widgetsHeight + (Math.ceil(line.text.length / perLine) || 1) * th }\n      else\n        { return widgetsHeight + th }\n    }\n  }\n\n  function estimateLineHeights(cm) {\n    var doc = cm.doc, est = estimateHeight(cm);\n    doc.iter(function (line) {\n      var estHeight = est(line);\n      if (estHeight != line.height) { updateLineHeight(line, estHeight); }\n    });\n  }\n\n  // Given a mouse event, find the corresponding position. If liberal\n  // is false, it checks whether a gutter or scrollbar was clicked,\n  // and returns null if it was. forRect is used by rectangular\n  // selections, and tries to estimate a character position even for\n  // coordinates beyond the right of the text.\n  function posFromMouse(cm, e, liberal, forRect) {\n    var display = cm.display;\n    if (!liberal && e_target(e).getAttribute(\"cm-not-content\") == \"true\") { return null }\n\n    var x, y, space = display.lineSpace.getBoundingClientRect();\n    // Fails unpredictably on IE[67] when mouse is dragged around quickly.\n    try { x = e.clientX - space.left; y = e.clientY - space.top; }\n    catch (e$1) { return null }\n    var coords = coordsChar(cm, x, y), line;\n    if (forRect && coords.xRel > 0 && (line = getLine(cm.doc, coords.line).text).length == coords.ch) {\n      var colDiff = countColumn(line, line.length, cm.options.tabSize) - line.length;\n      coords = Pos(coords.line, Math.max(0, Math.round((x - paddingH(cm.display).left) / charWidth(cm.display)) - colDiff));\n    }\n    return coords\n  }\n\n  // Find the view element corresponding to a given line. Return null\n  // when the line isn't visible.\n  function findViewIndex(cm, n) {\n    if (n >= cm.display.viewTo) { return null }\n    n -= cm.display.viewFrom;\n    if (n < 0) { return null }\n    var view = cm.display.view;\n    for (var i = 0; i < view.length; i++) {\n      n -= view[i].size;\n      if (n < 0) { return i }\n    }\n  }\n\n  // Updates the display.view data structure for a given change to the\n  // document. From and to are in pre-change coordinates. Lendiff is\n  // the amount of lines added or subtracted by the change. This is\n  // used for changes that span multiple lines, or change the way\n  // lines are divided into visual lines. regLineChange (below)\n  // registers single-line changes.\n  function regChange(cm, from, to, lendiff) {\n    if (from == null) { from = cm.doc.first; }\n    if (to == null) { to = cm.doc.first + cm.doc.size; }\n    if (!lendiff) { lendiff = 0; }\n\n    var display = cm.display;\n    if (lendiff && to < display.viewTo &&\n        (display.updateLineNumbers == null || display.updateLineNumbers > from))\n      { display.updateLineNumbers = from; }\n\n    cm.curOp.viewChanged = true;\n\n    if (from >= display.viewTo) { // Change after\n      if (sawCollapsedSpans && visualLineNo(cm.doc, from) < display.viewTo)\n        { resetView(cm); }\n    } else if (to <= display.viewFrom) { // Change before\n      if (sawCollapsedSpans && visualLineEndNo(cm.doc, to + lendiff) > display.viewFrom) {\n        resetView(cm);\n      } else {\n        display.viewFrom += lendiff;\n        display.viewTo += lendiff;\n      }\n    } else if (from <= display.viewFrom && to >= display.viewTo) { // Full overlap\n      resetView(cm);\n    } else if (from <= display.viewFrom) { // Top overlap\n      var cut = viewCuttingPoint(cm, to, to + lendiff, 1);\n      if (cut) {\n        display.view = display.view.slice(cut.index);\n        display.viewFrom = cut.lineN;\n        display.viewTo += lendiff;\n      } else {\n        resetView(cm);\n      }\n    } else if (to >= display.viewTo) { // Bottom overlap\n      var cut$1 = viewCuttingPoint(cm, from, from, -1);\n      if (cut$1) {\n        display.view = display.view.slice(0, cut$1.index);\n        display.viewTo = cut$1.lineN;\n      } else {\n        resetView(cm);\n      }\n    } else { // Gap in the middle\n      var cutTop = viewCuttingPoint(cm, from, from, -1);\n      var cutBot = viewCuttingPoint(cm, to, to + lendiff, 1);\n      if (cutTop && cutBot) {\n        display.view = display.view.slice(0, cutTop.index)\n          .concat(buildViewArray(cm, cutTop.lineN, cutBot.lineN))\n          .concat(display.view.slice(cutBot.index));\n        display.viewTo += lendiff;\n      } else {\n        resetView(cm);\n      }\n    }\n\n    var ext = display.externalMeasured;\n    if (ext) {\n      if (to < ext.lineN)\n        { ext.lineN += lendiff; }\n      else if (from < ext.lineN + ext.size)\n        { display.externalMeasured = null; }\n    }\n  }\n\n  // Register a change to a single line. Type must be one of \"text\",\n  // \"gutter\", \"class\", \"widget\"\n  function regLineChange(cm, line, type) {\n    cm.curOp.viewChanged = true;\n    var display = cm.display, ext = cm.display.externalMeasured;\n    if (ext && line >= ext.lineN && line < ext.lineN + ext.size)\n      { display.externalMeasured = null; }\n\n    if (line < display.viewFrom || line >= display.viewTo) { return }\n    var lineView = display.view[findViewIndex(cm, line)];\n    if (lineView.node == null) { return }\n    var arr = lineView.changes || (lineView.changes = []);\n    if (indexOf(arr, type) == -1) { arr.push(type); }\n  }\n\n  // Clear the view.\n  function resetView(cm) {\n    cm.display.viewFrom = cm.display.viewTo = cm.doc.first;\n    cm.display.view = [];\n    cm.display.viewOffset = 0;\n  }\n\n  function viewCuttingPoint(cm, oldN, newN, dir) {\n    var index = findViewIndex(cm, oldN), diff, view = cm.display.view;\n    if (!sawCollapsedSpans || newN == cm.doc.first + cm.doc.size)\n      { return {index: index, lineN: newN} }\n    var n = cm.display.viewFrom;\n    for (var i = 0; i < index; i++)\n      { n += view[i].size; }\n    if (n != oldN) {\n      if (dir > 0) {\n        if (index == view.length - 1) { return null }\n        diff = (n + view[index].size) - oldN;\n        index++;\n      } else {\n        diff = n - oldN;\n      }\n      oldN += diff; newN += diff;\n    }\n    while (visualLineNo(cm.doc, newN) != newN) {\n      if (index == (dir < 0 ? 0 : view.length - 1)) { return null }\n      newN += dir * view[index - (dir < 0 ? 1 : 0)].size;\n      index += dir;\n    }\n    return {index: index, lineN: newN}\n  }\n\n  // Force the view to cover a given range, adding empty view element\n  // or clipping off existing ones as needed.\n  function adjustView(cm, from, to) {\n    var display = cm.display, view = display.view;\n    if (view.length == 0 || from >= display.viewTo || to <= display.viewFrom) {\n      display.view = buildViewArray(cm, from, to);\n      display.viewFrom = from;\n    } else {\n      if (display.viewFrom > from)\n        { display.view = buildViewArray(cm, from, display.viewFrom).concat(display.view); }\n      else if (display.viewFrom < from)\n        { display.view = display.view.slice(findViewIndex(cm, from)); }\n      display.viewFrom = from;\n      if (display.viewTo < to)\n        { display.view = display.view.concat(buildViewArray(cm, display.viewTo, to)); }\n      else if (display.viewTo > to)\n        { display.view = display.view.slice(0, findViewIndex(cm, to)); }\n    }\n    display.viewTo = to;\n  }\n\n  // Count the number of lines in the view whose DOM representation is\n  // out of date (or nonexistent).\n  function countDirtyView(cm) {\n    var view = cm.display.view, dirty = 0;\n    for (var i = 0; i < view.length; i++) {\n      var lineView = view[i];\n      if (!lineView.hidden && (!lineView.node || lineView.changes)) { ++dirty; }\n    }\n    return dirty\n  }\n\n  function updateSelection(cm) {\n    cm.display.input.showSelection(cm.display.input.prepareSelection());\n  }\n\n  function prepareSelection(cm, primary) {\n    if ( primary === void 0 ) primary = true;\n\n    var doc = cm.doc, result = {};\n    var curFragment = result.cursors = document.createDocumentFragment();\n    var selFragment = result.selection = document.createDocumentFragment();\n\n    for (var i = 0; i < doc.sel.ranges.length; i++) {\n      if (!primary && i == doc.sel.primIndex) { continue }\n      var range = doc.sel.ranges[i];\n      if (range.from().line >= cm.display.viewTo || range.to().line < cm.display.viewFrom) { continue }\n      var collapsed = range.empty();\n      if (collapsed || cm.options.showCursorWhenSelecting)\n        { drawSelectionCursor(cm, range.head, curFragment); }\n      if (!collapsed)\n        { drawSelectionRange(cm, range, selFragment); }\n    }\n    return result\n  }\n\n  // Draws a cursor for the given range\n  function drawSelectionCursor(cm, head, output) {\n    var pos = cursorCoords(cm, head, \"div\", null, null, !cm.options.singleCursorHeightPerLine);\n\n    var cursor = output.appendChild(elt(\"div\", \"\\u00a0\", \"CodeMirror-cursor\"));\n    cursor.style.left = pos.left + \"px\";\n    cursor.style.top = pos.top + \"px\";\n    cursor.style.height = Math.max(0, pos.bottom - pos.top) * cm.options.cursorHeight + \"px\";\n\n    if (pos.other) {\n      // Secondary cursor, shown when on a 'jump' in bi-directional text\n      var otherCursor = output.appendChild(elt(\"div\", \"\\u00a0\", \"CodeMirror-cursor CodeMirror-secondarycursor\"));\n      otherCursor.style.display = \"\";\n      otherCursor.style.left = pos.other.left + \"px\";\n      otherCursor.style.top = pos.other.top + \"px\";\n      otherCursor.style.height = (pos.other.bottom - pos.other.top) * .85 + \"px\";\n    }\n  }\n\n  function cmpCoords(a, b) { return a.top - b.top || a.left - b.left }\n\n  // Draws the given range as a highlighted selection\n  function drawSelectionRange(cm, range, output) {\n    var display = cm.display, doc = cm.doc;\n    var fragment = document.createDocumentFragment();\n    var padding = paddingH(cm.display), leftSide = padding.left;\n    var rightSide = Math.max(display.sizerWidth, displayWidth(cm) - display.sizer.offsetLeft) - padding.right;\n    var docLTR = doc.direction == \"ltr\";\n\n    function add(left, top, width, bottom) {\n      if (top < 0) { top = 0; }\n      top = Math.round(top);\n      bottom = Math.round(bottom);\n      fragment.appendChild(elt(\"div\", null, \"CodeMirror-selected\", (\"position: absolute; left: \" + left + \"px;\\n                             top: \" + top + \"px; width: \" + (width == null ? rightSide - left : width) + \"px;\\n                             height: \" + (bottom - top) + \"px\")));\n    }\n\n    function drawForLine(line, fromArg, toArg) {\n      var lineObj = getLine(doc, line);\n      var lineLen = lineObj.text.length;\n      var start, end;\n      function coords(ch, bias) {\n        return charCoords(cm, Pos(line, ch), \"div\", lineObj, bias)\n      }\n\n      function wrapX(pos, dir, side) {\n        var extent = wrappedLineExtentChar(cm, lineObj, null, pos);\n        var prop = (dir == \"ltr\") == (side == \"after\") ? \"left\" : \"right\";\n        var ch = side == \"after\" ? extent.begin : extent.end - (/\\s/.test(lineObj.text.charAt(extent.end - 1)) ? 2 : 1);\n        return coords(ch, prop)[prop]\n      }\n\n      var order = getOrder(lineObj, doc.direction);\n      iterateBidiSections(order, fromArg || 0, toArg == null ? lineLen : toArg, function (from, to, dir, i) {\n        var ltr = dir == \"ltr\";\n        var fromPos = coords(from, ltr ? \"left\" : \"right\");\n        var toPos = coords(to - 1, ltr ? \"right\" : \"left\");\n\n        var openStart = fromArg == null && from == 0, openEnd = toArg == null && to == lineLen;\n        var first = i == 0, last = !order || i == order.length - 1;\n        if (toPos.top - fromPos.top <= 3) { // Single line\n          var openLeft = (docLTR ? openStart : openEnd) && first;\n          var openRight = (docLTR ? openEnd : openStart) && last;\n          var left = openLeft ? leftSide : (ltr ? fromPos : toPos).left;\n          var right = openRight ? rightSide : (ltr ? toPos : fromPos).right;\n          add(left, fromPos.top, right - left, fromPos.bottom);\n        } else { // Multiple lines\n          var topLeft, topRight, botLeft, botRight;\n          if (ltr) {\n            topLeft = docLTR && openStart && first ? leftSide : fromPos.left;\n            topRight = docLTR ? rightSide : wrapX(from, dir, \"before\");\n            botLeft = docLTR ? leftSide : wrapX(to, dir, \"after\");\n            botRight = docLTR && openEnd && last ? rightSide : toPos.right;\n          } else {\n            topLeft = !docLTR ? leftSide : wrapX(from, dir, \"before\");\n            topRight = !docLTR && openStart && first ? rightSide : fromPos.right;\n            botLeft = !docLTR && openEnd && last ? leftSide : toPos.left;\n            botRight = !docLTR ? rightSide : wrapX(to, dir, \"after\");\n          }\n          add(topLeft, fromPos.top, topRight - topLeft, fromPos.bottom);\n          if (fromPos.bottom < toPos.top) { add(leftSide, fromPos.bottom, null, toPos.top); }\n          add(botLeft, toPos.top, botRight - botLeft, toPos.bottom);\n        }\n\n        if (!start || cmpCoords(fromPos, start) < 0) { start = fromPos; }\n        if (cmpCoords(toPos, start) < 0) { start = toPos; }\n        if (!end || cmpCoords(fromPos, end) < 0) { end = fromPos; }\n        if (cmpCoords(toPos, end) < 0) { end = toPos; }\n      });\n      return {start: start, end: end}\n    }\n\n    var sFrom = range.from(), sTo = range.to();\n    if (sFrom.line == sTo.line) {\n      drawForLine(sFrom.line, sFrom.ch, sTo.ch);\n    } else {\n      var fromLine = getLine(doc, sFrom.line), toLine = getLine(doc, sTo.line);\n      var singleVLine = visualLine(fromLine) == visualLine(toLine);\n      var leftEnd = drawForLine(sFrom.line, sFrom.ch, singleVLine ? fromLine.text.length + 1 : null).end;\n      var rightStart = drawForLine(sTo.line, singleVLine ? 0 : null, sTo.ch).start;\n      if (singleVLine) {\n        if (leftEnd.top < rightStart.top - 2) {\n          add(leftEnd.right, leftEnd.top, null, leftEnd.bottom);\n          add(leftSide, rightStart.top, rightStart.left, rightStart.bottom);\n        } else {\n          add(leftEnd.right, leftEnd.top, rightStart.left - leftEnd.right, leftEnd.bottom);\n        }\n      }\n      if (leftEnd.bottom < rightStart.top)\n        { add(leftSide, leftEnd.bottom, null, rightStart.top); }\n    }\n\n    output.appendChild(fragment);\n  }\n\n  // Cursor-blinking\n  function restartBlink(cm) {\n    if (!cm.state.focused) { return }\n    var display = cm.display;\n    clearInterval(display.blinker);\n    var on = true;\n    display.cursorDiv.style.visibility = \"\";\n    if (cm.options.cursorBlinkRate > 0)\n      { display.blinker = setInterval(function () {\n        if (!cm.hasFocus()) { onBlur(cm); }\n        display.cursorDiv.style.visibility = (on = !on) ? \"\" : \"hidden\";\n      }, cm.options.cursorBlinkRate); }\n    else if (cm.options.cursorBlinkRate < 0)\n      { display.cursorDiv.style.visibility = \"hidden\"; }\n  }\n\n  function ensureFocus(cm) {\n    if (!cm.hasFocus()) {\n      cm.display.input.focus();\n      if (!cm.state.focused) { onFocus(cm); }\n    }\n  }\n\n  function delayBlurEvent(cm) {\n    cm.state.delayingBlurEvent = true;\n    setTimeout(function () { if (cm.state.delayingBlurEvent) {\n      cm.state.delayingBlurEvent = false;\n      if (cm.state.focused) { onBlur(cm); }\n    } }, 100);\n  }\n\n  function onFocus(cm, e) {\n    if (cm.state.delayingBlurEvent && !cm.state.draggingText) { cm.state.delayingBlurEvent = false; }\n\n    if (cm.options.readOnly == \"nocursor\") { return }\n    if (!cm.state.focused) {\n      signal(cm, \"focus\", cm, e);\n      cm.state.focused = true;\n      addClass(cm.display.wrapper, \"CodeMirror-focused\");\n      // This test prevents this from firing when a context\n      // menu is closed (since the input reset would kill the\n      // select-all detection hack)\n      if (!cm.curOp && cm.display.selForContextMenu != cm.doc.sel) {\n        cm.display.input.reset();\n        if (webkit) { setTimeout(function () { return cm.display.input.reset(true); }, 20); } // Issue #1730\n      }\n      cm.display.input.receivedFocus();\n    }\n    restartBlink(cm);\n  }\n  function onBlur(cm, e) {\n    if (cm.state.delayingBlurEvent) { return }\n\n    if (cm.state.focused) {\n      signal(cm, \"blur\", cm, e);\n      cm.state.focused = false;\n      rmClass(cm.display.wrapper, \"CodeMirror-focused\");\n    }\n    clearInterval(cm.display.blinker);\n    setTimeout(function () { if (!cm.state.focused) { cm.display.shift = false; } }, 150);\n  }\n\n  // Read the actual heights of the rendered lines, and update their\n  // stored heights to match.\n  function updateHeightsInViewport(cm) {\n    var display = cm.display;\n    var prevBottom = display.lineDiv.offsetTop;\n    for (var i = 0; i < display.view.length; i++) {\n      var cur = display.view[i], wrapping = cm.options.lineWrapping;\n      var height = (void 0), width = 0;\n      if (cur.hidden) { continue }\n      if (ie && ie_version < 8) {\n        var bot = cur.node.offsetTop + cur.node.offsetHeight;\n        height = bot - prevBottom;\n        prevBottom = bot;\n      } else {\n        var box = cur.node.getBoundingClientRect();\n        height = box.bottom - box.top;\n        // Check that lines don't extend past the right of the current\n        // editor width\n        if (!wrapping && cur.text.firstChild)\n          { width = cur.text.firstChild.getBoundingClientRect().right - box.left - 1; }\n      }\n      var diff = cur.line.height - height;\n      if (diff > .005 || diff < -.005) {\n        updateLineHeight(cur.line, height);\n        updateWidgetHeight(cur.line);\n        if (cur.rest) { for (var j = 0; j < cur.rest.length; j++)\n          { updateWidgetHeight(cur.rest[j]); } }\n      }\n      if (width > cm.display.sizerWidth) {\n        var chWidth = Math.ceil(width / charWidth(cm.display));\n        if (chWidth > cm.display.maxLineLength) {\n          cm.display.maxLineLength = chWidth;\n          cm.display.maxLine = cur.line;\n          cm.display.maxLineChanged = true;\n        }\n      }\n    }\n  }\n\n  // Read and store the height of line widgets associated with the\n  // given line.\n  function updateWidgetHeight(line) {\n    if (line.widgets) { for (var i = 0; i < line.widgets.length; ++i) {\n      var w = line.widgets[i], parent = w.node.parentNode;\n      if (parent) { w.height = parent.offsetHeight; }\n    } }\n  }\n\n  // Compute the lines that are visible in a given viewport (defaults\n  // the the current scroll position). viewport may contain top,\n  // height, and ensure (see op.scrollToPos) properties.\n  function visibleLines(display, doc, viewport) {\n    var top = viewport && viewport.top != null ? Math.max(0, viewport.top) : display.scroller.scrollTop;\n    top = Math.floor(top - paddingTop(display));\n    var bottom = viewport && viewport.bottom != null ? viewport.bottom : top + display.wrapper.clientHeight;\n\n    var from = lineAtHeight(doc, top), to = lineAtHeight(doc, bottom);\n    // Ensure is a {from: {line, ch}, to: {line, ch}} object, and\n    // forces those lines into the viewport (if possible).\n    if (viewport && viewport.ensure) {\n      var ensureFrom = viewport.ensure.from.line, ensureTo = viewport.ensure.to.line;\n      if (ensureFrom < from) {\n        from = ensureFrom;\n        to = lineAtHeight(doc, heightAtLine(getLine(doc, ensureFrom)) + display.wrapper.clientHeight);\n      } else if (Math.min(ensureTo, doc.lastLine()) >= to) {\n        from = lineAtHeight(doc, heightAtLine(getLine(doc, ensureTo)) - display.wrapper.clientHeight);\n        to = ensureTo;\n      }\n    }\n    return {from: from, to: Math.max(to, from + 1)}\n  }\n\n  // SCROLLING THINGS INTO VIEW\n\n  // If an editor sits on the top or bottom of the window, partially\n  // scrolled out of view, this ensures that the cursor is visible.\n  function maybeScrollWindow(cm, rect) {\n    if (signalDOMEvent(cm, \"scrollCursorIntoView\")) { return }\n\n    var display = cm.display, box = display.sizer.getBoundingClientRect(), doScroll = null;\n    if (rect.top + box.top < 0) { doScroll = true; }\n    else if (rect.bottom + box.top > (window.innerHeight || document.documentElement.clientHeight)) { doScroll = false; }\n    if (doScroll != null && !phantom) {\n      var scrollNode = elt(\"div\", \"\\u200b\", null, (\"position: absolute;\\n                         top: \" + (rect.top - display.viewOffset - paddingTop(cm.display)) + \"px;\\n                         height: \" + (rect.bottom - rect.top + scrollGap(cm) + display.barHeight) + \"px;\\n                         left: \" + (rect.left) + \"px; width: \" + (Math.max(2, rect.right - rect.left)) + \"px;\"));\n      cm.display.lineSpace.appendChild(scrollNode);\n      scrollNode.scrollIntoView(doScroll);\n      cm.display.lineSpace.removeChild(scrollNode);\n    }\n  }\n\n  // Scroll a given position into view (immediately), verifying that\n  // it actually became visible (as line heights are accurately\n  // measured, the position of something may 'drift' during drawing).\n  function scrollPosIntoView(cm, pos, end, margin) {\n    if (margin == null) { margin = 0; }\n    var rect;\n    if (!cm.options.lineWrapping && pos == end) {\n      // Set pos and end to the cursor positions around the character pos sticks to\n      // If pos.sticky == \"before\", that is around pos.ch - 1, otherwise around pos.ch\n      // If pos == Pos(_, 0, \"before\"), pos and end are unchanged\n      pos = pos.ch ? Pos(pos.line, pos.sticky == \"before\" ? pos.ch - 1 : pos.ch, \"after\") : pos;\n      end = pos.sticky == \"before\" ? Pos(pos.line, pos.ch + 1, \"before\") : pos;\n    }\n    for (var limit = 0; limit < 5; limit++) {\n      var changed = false;\n      var coords = cursorCoords(cm, pos);\n      var endCoords = !end || end == pos ? coords : cursorCoords(cm, end);\n      rect = {left: Math.min(coords.left, endCoords.left),\n              top: Math.min(coords.top, endCoords.top) - margin,\n              right: Math.max(coords.left, endCoords.left),\n              bottom: Math.max(coords.bottom, endCoords.bottom) + margin};\n      var scrollPos = calculateScrollPos(cm, rect);\n      var startTop = cm.doc.scrollTop, startLeft = cm.doc.scrollLeft;\n      if (scrollPos.scrollTop != null) {\n        updateScrollTop(cm, scrollPos.scrollTop);\n        if (Math.abs(cm.doc.scrollTop - startTop) > 1) { changed = true; }\n      }\n      if (scrollPos.scrollLeft != null) {\n        setScrollLeft(cm, scrollPos.scrollLeft);\n        if (Math.abs(cm.doc.scrollLeft - startLeft) > 1) { changed = true; }\n      }\n      if (!changed) { break }\n    }\n    return rect\n  }\n\n  // Scroll a given set of coordinates into view (immediately).\n  function scrollIntoView(cm, rect) {\n    var scrollPos = calculateScrollPos(cm, rect);\n    if (scrollPos.scrollTop != null) { updateScrollTop(cm, scrollPos.scrollTop); }\n    if (scrollPos.scrollLeft != null) { setScrollLeft(cm, scrollPos.scrollLeft); }\n  }\n\n  // Calculate a new scroll position needed to scroll the given\n  // rectangle into view. Returns an object with scrollTop and\n  // scrollLeft properties. When these are undefined, the\n  // vertical/horizontal position does not need to be adjusted.\n  function calculateScrollPos(cm, rect) {\n    var display = cm.display, snapMargin = textHeight(cm.display);\n    if (rect.top < 0) { rect.top = 0; }\n    var screentop = cm.curOp && cm.curOp.scrollTop != null ? cm.curOp.scrollTop : display.scroller.scrollTop;\n    var screen = displayHeight(cm), result = {};\n    if (rect.bottom - rect.top > screen) { rect.bottom = rect.top + screen; }\n    var docBottom = cm.doc.height + paddingVert(display);\n    var atTop = rect.top < snapMargin, atBottom = rect.bottom > docBottom - snapMargin;\n    if (rect.top < screentop) {\n      result.scrollTop = atTop ? 0 : rect.top;\n    } else if (rect.bottom > screentop + screen) {\n      var newTop = Math.min(rect.top, (atBottom ? docBottom : rect.bottom) - screen);\n      if (newTop != screentop) { result.scrollTop = newTop; }\n    }\n\n    var gutterSpace = cm.options.fixedGutter ? 0 : display.gutters.offsetWidth;\n    var screenleft = cm.curOp && cm.curOp.scrollLeft != null ? cm.curOp.scrollLeft : display.scroller.scrollLeft - gutterSpace;\n    var screenw = displayWidth(cm) - display.gutters.offsetWidth;\n    var tooWide = rect.right - rect.left > screenw;\n    if (tooWide) { rect.right = rect.left + screenw; }\n    if (rect.left < 10)\n      { result.scrollLeft = 0; }\n    else if (rect.left < screenleft)\n      { result.scrollLeft = Math.max(0, rect.left + gutterSpace - (tooWide ? 0 : 10)); }\n    else if (rect.right > screenw + screenleft - 3)\n      { result.scrollLeft = rect.right + (tooWide ? 0 : 10) - screenw; }\n    return result\n  }\n\n  // Store a relative adjustment to the scroll position in the current\n  // operation (to be applied when the operation finishes).\n  function addToScrollTop(cm, top) {\n    if (top == null) { return }\n    resolveScrollToPos(cm);\n    cm.curOp.scrollTop = (cm.curOp.scrollTop == null ? cm.doc.scrollTop : cm.curOp.scrollTop) + top;\n  }\n\n  // Make sure that at the end of the operation the current cursor is\n  // shown.\n  function ensureCursorVisible(cm) {\n    resolveScrollToPos(cm);\n    var cur = cm.getCursor();\n    cm.curOp.scrollToPos = {from: cur, to: cur, margin: cm.options.cursorScrollMargin};\n  }\n\n  function scrollToCoords(cm, x, y) {\n    if (x != null || y != null) { resolveScrollToPos(cm); }\n    if (x != null) { cm.curOp.scrollLeft = x; }\n    if (y != null) { cm.curOp.scrollTop = y; }\n  }\n\n  function scrollToRange(cm, range) {\n    resolveScrollToPos(cm);\n    cm.curOp.scrollToPos = range;\n  }\n\n  // When an operation has its scrollToPos property set, and another\n  // scroll action is applied before the end of the operation, this\n  // 'simulates' scrolling that position into view in a cheap way, so\n  // that the effect of intermediate scroll commands is not ignored.\n  function resolveScrollToPos(cm) {\n    var range = cm.curOp.scrollToPos;\n    if (range) {\n      cm.curOp.scrollToPos = null;\n      var from = estimateCoords(cm, range.from), to = estimateCoords(cm, range.to);\n      scrollToCoordsRange(cm, from, to, range.margin);\n    }\n  }\n\n  function scrollToCoordsRange(cm, from, to, margin) {\n    var sPos = calculateScrollPos(cm, {\n      left: Math.min(from.left, to.left),\n      top: Math.min(from.top, to.top) - margin,\n      right: Math.max(from.right, to.right),\n      bottom: Math.max(from.bottom, to.bottom) + margin\n    });\n    scrollToCoords(cm, sPos.scrollLeft, sPos.scrollTop);\n  }\n\n  // Sync the scrollable area and scrollbars, ensure the viewport\n  // covers the visible area.\n  function updateScrollTop(cm, val) {\n    if (Math.abs(cm.doc.scrollTop - val) < 2) { return }\n    if (!gecko) { updateDisplaySimple(cm, {top: val}); }\n    setScrollTop(cm, val, true);\n    if (gecko) { updateDisplaySimple(cm); }\n    startWorker(cm, 100);\n  }\n\n  function setScrollTop(cm, val, forceScroll) {\n    val = Math.max(0, Math.min(cm.display.scroller.scrollHeight - cm.display.scroller.clientHeight, val));\n    if (cm.display.scroller.scrollTop == val && !forceScroll) { return }\n    cm.doc.scrollTop = val;\n    cm.display.scrollbars.setScrollTop(val);\n    if (cm.display.scroller.scrollTop != val) { cm.display.scroller.scrollTop = val; }\n  }\n\n  // Sync scroller and scrollbar, ensure the gutter elements are\n  // aligned.\n  function setScrollLeft(cm, val, isScroller, forceScroll) {\n    val = Math.max(0, Math.min(val, cm.display.scroller.scrollWidth - cm.display.scroller.clientWidth));\n    if ((isScroller ? val == cm.doc.scrollLeft : Math.abs(cm.doc.scrollLeft - val) < 2) && !forceScroll) { return }\n    cm.doc.scrollLeft = val;\n    alignHorizontally(cm);\n    if (cm.display.scroller.scrollLeft != val) { cm.display.scroller.scrollLeft = val; }\n    cm.display.scrollbars.setScrollLeft(val);\n  }\n\n  // SCROLLBARS\n\n  // Prepare DOM reads needed to update the scrollbars. Done in one\n  // shot to minimize update/measure roundtrips.\n  function measureForScrollbars(cm) {\n    var d = cm.display, gutterW = d.gutters.offsetWidth;\n    var docH = Math.round(cm.doc.height + paddingVert(cm.display));\n    return {\n      clientHeight: d.scroller.clientHeight,\n      viewHeight: d.wrapper.clientHeight,\n      scrollWidth: d.scroller.scrollWidth, clientWidth: d.scroller.clientWidth,\n      viewWidth: d.wrapper.clientWidth,\n      barLeft: cm.options.fixedGutter ? gutterW : 0,\n      docHeight: docH,\n      scrollHeight: docH + scrollGap(cm) + d.barHeight,\n      nativeBarWidth: d.nativeBarWidth,\n      gutterWidth: gutterW\n    }\n  }\n\n  var NativeScrollbars = function(place, scroll, cm) {\n    this.cm = cm;\n    var vert = this.vert = elt(\"div\", [elt(\"div\", null, null, \"min-width: 1px\")], \"CodeMirror-vscrollbar\");\n    var horiz = this.horiz = elt(\"div\", [elt(\"div\", null, null, \"height: 100%; min-height: 1px\")], \"CodeMirror-hscrollbar\");\n    vert.tabIndex = horiz.tabIndex = -1;\n    place(vert); place(horiz);\n\n    on(vert, \"scroll\", function () {\n      if (vert.clientHeight) { scroll(vert.scrollTop, \"vertical\"); }\n    });\n    on(horiz, \"scroll\", function () {\n      if (horiz.clientWidth) { scroll(horiz.scrollLeft, \"horizontal\"); }\n    });\n\n    this.checkedZeroWidth = false;\n    // Need to set a minimum width to see the scrollbar on IE7 (but must not set it on IE8).\n    if (ie && ie_version < 8) { this.horiz.style.minHeight = this.vert.style.minWidth = \"18px\"; }\n  };\n\n  NativeScrollbars.prototype.update = function (measure) {\n    var needsH = measure.scrollWidth > measure.clientWidth + 1;\n    var needsV = measure.scrollHeight > measure.clientHeight + 1;\n    var sWidth = measure.nativeBarWidth;\n\n    if (needsV) {\n      this.vert.style.display = \"block\";\n      this.vert.style.bottom = needsH ? sWidth + \"px\" : \"0\";\n      var totalHeight = measure.viewHeight - (needsH ? sWidth : 0);\n      // A bug in IE8 can cause this value to be negative, so guard it.\n      this.vert.firstChild.style.height =\n        Math.max(0, measure.scrollHeight - measure.clientHeight + totalHeight) + \"px\";\n    } else {\n      this.vert.style.display = \"\";\n      this.vert.firstChild.style.height = \"0\";\n    }\n\n    if (needsH) {\n      this.horiz.style.display = \"block\";\n      this.horiz.style.right = needsV ? sWidth + \"px\" : \"0\";\n      this.horiz.style.left = measure.barLeft + \"px\";\n      var totalWidth = measure.viewWidth - measure.barLeft - (needsV ? sWidth : 0);\n      this.horiz.firstChild.style.width =\n        Math.max(0, measure.scrollWidth - measure.clientWidth + totalWidth) + \"px\";\n    } else {\n      this.horiz.style.display = \"\";\n      this.horiz.firstChild.style.width = \"0\";\n    }\n\n    if (!this.checkedZeroWidth && measure.clientHeight > 0) {\n      if (sWidth == 0) { this.zeroWidthHack(); }\n      this.checkedZeroWidth = true;\n    }\n\n    return {right: needsV ? sWidth : 0, bottom: needsH ? sWidth : 0}\n  };\n\n  NativeScrollbars.prototype.setScrollLeft = function (pos) {\n    if (this.horiz.scrollLeft != pos) { this.horiz.scrollLeft = pos; }\n    if (this.disableHoriz) { this.enableZeroWidthBar(this.horiz, this.disableHoriz, \"horiz\"); }\n  };\n\n  NativeScrollbars.prototype.setScrollTop = function (pos) {\n    if (this.vert.scrollTop != pos) { this.vert.scrollTop = pos; }\n    if (this.disableVert) { this.enableZeroWidthBar(this.vert, this.disableVert, \"vert\"); }\n  };\n\n  NativeScrollbars.prototype.zeroWidthHack = function () {\n    var w = mac && !mac_geMountainLion ? \"12px\" : \"18px\";\n    this.horiz.style.height = this.vert.style.width = w;\n    this.horiz.style.pointerEvents = this.vert.style.pointerEvents = \"none\";\n    this.disableHoriz = new Delayed;\n    this.disableVert = new Delayed;\n  };\n\n  NativeScrollbars.prototype.enableZeroWidthBar = function (bar, delay, type) {\n    bar.style.pointerEvents = \"auto\";\n    function maybeDisable() {\n      // To find out whether the scrollbar is still visible, we\n      // check whether the element under the pixel in the bottom\n      // right corner of the scrollbar box is the scrollbar box\n      // itself (when the bar is still visible) or its filler child\n      // (when the bar is hidden). If it is still visible, we keep\n      // it enabled, if it's hidden, we disable pointer events.\n      var box = bar.getBoundingClientRect();\n      var elt = type == \"vert\" ? document.elementFromPoint(box.right - 1, (box.top + box.bottom) / 2)\n          : document.elementFromPoint((box.right + box.left) / 2, box.bottom - 1);\n      if (elt != bar) { bar.style.pointerEvents = \"none\"; }\n      else { delay.set(1000, maybeDisable); }\n    }\n    delay.set(1000, maybeDisable);\n  };\n\n  NativeScrollbars.prototype.clear = function () {\n    var parent = this.horiz.parentNode;\n    parent.removeChild(this.horiz);\n    parent.removeChild(this.vert);\n  };\n\n  var NullScrollbars = function () {};\n\n  NullScrollbars.prototype.update = function () { return {bottom: 0, right: 0} };\n  NullScrollbars.prototype.setScrollLeft = function () {};\n  NullScrollbars.prototype.setScrollTop = function () {};\n  NullScrollbars.prototype.clear = function () {};\n\n  function updateScrollbars(cm, measure) {\n    if (!measure) { measure = measureForScrollbars(cm); }\n    var startWidth = cm.display.barWidth, startHeight = cm.display.barHeight;\n    updateScrollbarsInner(cm, measure);\n    for (var i = 0; i < 4 && startWidth != cm.display.barWidth || startHeight != cm.display.barHeight; i++) {\n      if (startWidth != cm.display.barWidth && cm.options.lineWrapping)\n        { updateHeightsInViewport(cm); }\n      updateScrollbarsInner(cm, measureForScrollbars(cm));\n      startWidth = cm.display.barWidth; startHeight = cm.display.barHeight;\n    }\n  }\n\n  // Re-synchronize the fake scrollbars with the actual size of the\n  // content.\n  function updateScrollbarsInner(cm, measure) {\n    var d = cm.display;\n    var sizes = d.scrollbars.update(measure);\n\n    d.sizer.style.paddingRight = (d.barWidth = sizes.right) + \"px\";\n    d.sizer.style.paddingBottom = (d.barHeight = sizes.bottom) + \"px\";\n    d.heightForcer.style.borderBottom = sizes.bottom + \"px solid transparent\";\n\n    if (sizes.right && sizes.bottom) {\n      d.scrollbarFiller.style.display = \"block\";\n      d.scrollbarFiller.style.height = sizes.bottom + \"px\";\n      d.scrollbarFiller.style.width = sizes.right + \"px\";\n    } else { d.scrollbarFiller.style.display = \"\"; }\n    if (sizes.bottom && cm.options.coverGutterNextToScrollbar && cm.options.fixedGutter) {\n      d.gutterFiller.style.display = \"block\";\n      d.gutterFiller.style.height = sizes.bottom + \"px\";\n      d.gutterFiller.style.width = measure.gutterWidth + \"px\";\n    } else { d.gutterFiller.style.display = \"\"; }\n  }\n\n  var scrollbarModel = {\"native\": NativeScrollbars, \"null\": NullScrollbars};\n\n  function initScrollbars(cm) {\n    if (cm.display.scrollbars) {\n      cm.display.scrollbars.clear();\n      if (cm.display.scrollbars.addClass)\n        { rmClass(cm.display.wrapper, cm.display.scrollbars.addClass); }\n    }\n\n    cm.display.scrollbars = new scrollbarModel[cm.options.scrollbarStyle](function (node) {\n      cm.display.wrapper.insertBefore(node, cm.display.scrollbarFiller);\n      // Prevent clicks in the scrollbars from killing focus\n      on(node, \"mousedown\", function () {\n        if (cm.state.focused) { setTimeout(function () { return cm.display.input.focus(); }, 0); }\n      });\n      node.setAttribute(\"cm-not-content\", \"true\");\n    }, function (pos, axis) {\n      if (axis == \"horizontal\") { setScrollLeft(cm, pos); }\n      else { updateScrollTop(cm, pos); }\n    }, cm);\n    if (cm.display.scrollbars.addClass)\n      { addClass(cm.display.wrapper, cm.display.scrollbars.addClass); }\n  }\n\n  // Operations are used to wrap a series of changes to the editor\n  // state in such a way that each change won't have to update the\n  // cursor and display (which would be awkward, slow, and\n  // error-prone). Instead, display updates are batched and then all\n  // combined and executed at once.\n\n  var nextOpId = 0;\n  // Start a new operation.\n  function startOperation(cm) {\n    cm.curOp = {\n      cm: cm,\n      viewChanged: false,      // Flag that indicates that lines might need to be redrawn\n      startHeight: cm.doc.height, // Used to detect need to update scrollbar\n      forceUpdate: false,      // Used to force a redraw\n      updateInput: 0,       // Whether to reset the input textarea\n      typing: false,           // Whether this reset should be careful to leave existing text (for compositing)\n      changeObjs: null,        // Accumulated changes, for firing change events\n      cursorActivityHandlers: null, // Set of handlers to fire cursorActivity on\n      cursorActivityCalled: 0, // Tracks which cursorActivity handlers have been called already\n      selectionChanged: false, // Whether the selection needs to be redrawn\n      updateMaxLine: false,    // Set when the widest line needs to be determined anew\n      scrollLeft: null, scrollTop: null, // Intermediate scroll position, not pushed to DOM yet\n      scrollToPos: null,       // Used to scroll to a specific position\n      focus: false,\n      id: ++nextOpId           // Unique ID\n    };\n    pushOperation(cm.curOp);\n  }\n\n  // Finish an operation, updating the display and signalling delayed events\n  function endOperation(cm) {\n    var op = cm.curOp;\n    if (op) { finishOperation(op, function (group) {\n      for (var i = 0; i < group.ops.length; i++)\n        { group.ops[i].cm.curOp = null; }\n      endOperations(group);\n    }); }\n  }\n\n  // The DOM updates done when an operation finishes are batched so\n  // that the minimum number of relayouts are required.\n  function endOperations(group) {\n    var ops = group.ops;\n    for (var i = 0; i < ops.length; i++) // Read DOM\n      { endOperation_R1(ops[i]); }\n    for (var i$1 = 0; i$1 < ops.length; i$1++) // Write DOM (maybe)\n      { endOperation_W1(ops[i$1]); }\n    for (var i$2 = 0; i$2 < ops.length; i$2++) // Read DOM\n      { endOperation_R2(ops[i$2]); }\n    for (var i$3 = 0; i$3 < ops.length; i$3++) // Write DOM (maybe)\n      { endOperation_W2(ops[i$3]); }\n    for (var i$4 = 0; i$4 < ops.length; i$4++) // Read DOM\n      { endOperation_finish(ops[i$4]); }\n  }\n\n  function endOperation_R1(op) {\n    var cm = op.cm, display = cm.display;\n    maybeClipScrollbars(cm);\n    if (op.updateMaxLine) { findMaxLine(cm); }\n\n    op.mustUpdate = op.viewChanged || op.forceUpdate || op.scrollTop != null ||\n      op.scrollToPos && (op.scrollToPos.from.line < display.viewFrom ||\n                         op.scrollToPos.to.line >= display.viewTo) ||\n      display.maxLineChanged && cm.options.lineWrapping;\n    op.update = op.mustUpdate &&\n      new DisplayUpdate(cm, op.mustUpdate && {top: op.scrollTop, ensure: op.scrollToPos}, op.forceUpdate);\n  }\n\n  function endOperation_W1(op) {\n    op.updatedDisplay = op.mustUpdate && updateDisplayIfNeeded(op.cm, op.update);\n  }\n\n  function endOperation_R2(op) {\n    var cm = op.cm, display = cm.display;\n    if (op.updatedDisplay) { updateHeightsInViewport(cm); }\n\n    op.barMeasure = measureForScrollbars(cm);\n\n    // If the max line changed since it was last measured, measure it,\n    // and ensure the document's width matches it.\n    // updateDisplay_W2 will use these properties to do the actual resizing\n    if (display.maxLineChanged && !cm.options.lineWrapping) {\n      op.adjustWidthTo = measureChar(cm, display.maxLine, display.maxLine.text.length).left + 3;\n      cm.display.sizerWidth = op.adjustWidthTo;\n      op.barMeasure.scrollWidth =\n        Math.max(display.scroller.clientWidth, display.sizer.offsetLeft + op.adjustWidthTo + scrollGap(cm) + cm.display.barWidth);\n      op.maxScrollLeft = Math.max(0, display.sizer.offsetLeft + op.adjustWidthTo - displayWidth(cm));\n    }\n\n    if (op.updatedDisplay || op.selectionChanged)\n      { op.preparedSelection = display.input.prepareSelection(); }\n  }\n\n  function endOperation_W2(op) {\n    var cm = op.cm;\n\n    if (op.adjustWidthTo != null) {\n      cm.display.sizer.style.minWidth = op.adjustWidthTo + \"px\";\n      if (op.maxScrollLeft < cm.doc.scrollLeft)\n        { setScrollLeft(cm, Math.min(cm.display.scroller.scrollLeft, op.maxScrollLeft), true); }\n      cm.display.maxLineChanged = false;\n    }\n\n    var takeFocus = op.focus && op.focus == activeElt();\n    if (op.preparedSelection)\n      { cm.display.input.showSelection(op.preparedSelection, takeFocus); }\n    if (op.updatedDisplay || op.startHeight != cm.doc.height)\n      { updateScrollbars(cm, op.barMeasure); }\n    if (op.updatedDisplay)\n      { setDocumentHeight(cm, op.barMeasure); }\n\n    if (op.selectionChanged) { restartBlink(cm); }\n\n    if (cm.state.focused && op.updateInput)\n      { cm.display.input.reset(op.typing); }\n    if (takeFocus) { ensureFocus(op.cm); }\n  }\n\n  function endOperation_finish(op) {\n    var cm = op.cm, display = cm.display, doc = cm.doc;\n\n    if (op.updatedDisplay) { postUpdateDisplay(cm, op.update); }\n\n    // Abort mouse wheel delta measurement, when scrolling explicitly\n    if (display.wheelStartX != null && (op.scrollTop != null || op.scrollLeft != null || op.scrollToPos))\n      { display.wheelStartX = display.wheelStartY = null; }\n\n    // Propagate the scroll position to the actual DOM scroller\n    if (op.scrollTop != null) { setScrollTop(cm, op.scrollTop, op.forceScroll); }\n\n    if (op.scrollLeft != null) { setScrollLeft(cm, op.scrollLeft, true, true); }\n    // If we need to scroll a specific position into view, do so.\n    if (op.scrollToPos) {\n      var rect = scrollPosIntoView(cm, clipPos(doc, op.scrollToPos.from),\n                                   clipPos(doc, op.scrollToPos.to), op.scrollToPos.margin);\n      maybeScrollWindow(cm, rect);\n    }\n\n    // Fire events for markers that are hidden/unidden by editing or\n    // undoing\n    var hidden = op.maybeHiddenMarkers, unhidden = op.maybeUnhiddenMarkers;\n    if (hidden) { for (var i = 0; i < hidden.length; ++i)\n      { if (!hidden[i].lines.length) { signal(hidden[i], \"hide\"); } } }\n    if (unhidden) { for (var i$1 = 0; i$1 < unhidden.length; ++i$1)\n      { if (unhidden[i$1].lines.length) { signal(unhidden[i$1], \"unhide\"); } } }\n\n    if (display.wrapper.offsetHeight)\n      { doc.scrollTop = cm.display.scroller.scrollTop; }\n\n    // Fire change events, and delayed event handlers\n    if (op.changeObjs)\n      { signal(cm, \"changes\", cm, op.changeObjs); }\n    if (op.update)\n      { op.update.finish(); }\n  }\n\n  // Run the given function in an operation\n  function runInOp(cm, f) {\n    if (cm.curOp) { return f() }\n    startOperation(cm);\n    try { return f() }\n    finally { endOperation(cm); }\n  }\n  // Wraps a function in an operation. Returns the wrapped function.\n  function operation(cm, f) {\n    return function() {\n      if (cm.curOp) { return f.apply(cm, arguments) }\n      startOperation(cm);\n      try { return f.apply(cm, arguments) }\n      finally { endOperation(cm); }\n    }\n  }\n  // Used to add methods to editor and doc instances, wrapping them in\n  // operations.\n  function methodOp(f) {\n    return function() {\n      if (this.curOp) { return f.apply(this, arguments) }\n      startOperation(this);\n      try { return f.apply(this, arguments) }\n      finally { endOperation(this); }\n    }\n  }\n  function docMethodOp(f) {\n    return function() {\n      var cm = this.cm;\n      if (!cm || cm.curOp) { return f.apply(this, arguments) }\n      startOperation(cm);\n      try { return f.apply(this, arguments) }\n      finally { endOperation(cm); }\n    }\n  }\n\n  // HIGHLIGHT WORKER\n\n  function startWorker(cm, time) {\n    if (cm.doc.highlightFrontier < cm.display.viewTo)\n      { cm.state.highlight.set(time, bind(highlightWorker, cm)); }\n  }\n\n  function highlightWorker(cm) {\n    var doc = cm.doc;\n    if (doc.highlightFrontier >= cm.display.viewTo) { return }\n    var end = +new Date + cm.options.workTime;\n    var context = getContextBefore(cm, doc.highlightFrontier);\n    var changedLines = [];\n\n    doc.iter(context.line, Math.min(doc.first + doc.size, cm.display.viewTo + 500), function (line) {\n      if (context.line >= cm.display.viewFrom) { // Visible\n        var oldStyles = line.styles;\n        var resetState = line.text.length > cm.options.maxHighlightLength ? copyState(doc.mode, context.state) : null;\n        var highlighted = highlightLine(cm, line, context, true);\n        if (resetState) { context.state = resetState; }\n        line.styles = highlighted.styles;\n        var oldCls = line.styleClasses, newCls = highlighted.classes;\n        if (newCls) { line.styleClasses = newCls; }\n        else if (oldCls) { line.styleClasses = null; }\n        var ischange = !oldStyles || oldStyles.length != line.styles.length ||\n          oldCls != newCls && (!oldCls || !newCls || oldCls.bgClass != newCls.bgClass || oldCls.textClass != newCls.textClass);\n        for (var i = 0; !ischange && i < oldStyles.length; ++i) { ischange = oldStyles[i] != line.styles[i]; }\n        if (ischange) { changedLines.push(context.line); }\n        line.stateAfter = context.save();\n        context.nextLine();\n      } else {\n        if (line.text.length <= cm.options.maxHighlightLength)\n          { processLine(cm, line.text, context); }\n        line.stateAfter = context.line % 5 == 0 ? context.save() : null;\n        context.nextLine();\n      }\n      if (+new Date > end) {\n        startWorker(cm, cm.options.workDelay);\n        return true\n      }\n    });\n    doc.highlightFrontier = context.line;\n    doc.modeFrontier = Math.max(doc.modeFrontier, context.line);\n    if (changedLines.length) { runInOp(cm, function () {\n      for (var i = 0; i < changedLines.length; i++)\n        { regLineChange(cm, changedLines[i], \"text\"); }\n    }); }\n  }\n\n  // DISPLAY DRAWING\n\n  var DisplayUpdate = function(cm, viewport, force) {\n    var display = cm.display;\n\n    this.viewport = viewport;\n    // Store some values that we'll need later (but don't want to force a relayout for)\n    this.visible = visibleLines(display, cm.doc, viewport);\n    this.editorIsHidden = !display.wrapper.offsetWidth;\n    this.wrapperHeight = display.wrapper.clientHeight;\n    this.wrapperWidth = display.wrapper.clientWidth;\n    this.oldDisplayWidth = displayWidth(cm);\n    this.force = force;\n    this.dims = getDimensions(cm);\n    this.events = [];\n  };\n\n  DisplayUpdate.prototype.signal = function (emitter, type) {\n    if (hasHandler(emitter, type))\n      { this.events.push(arguments); }\n  };\n  DisplayUpdate.prototype.finish = function () {\n    for (var i = 0; i < this.events.length; i++)\n      { signal.apply(null, this.events[i]); }\n  };\n\n  function maybeClipScrollbars(cm) {\n    var display = cm.display;\n    if (!display.scrollbarsClipped && display.scroller.offsetWidth) {\n      display.nativeBarWidth = display.scroller.offsetWidth - display.scroller.clientWidth;\n      display.heightForcer.style.height = scrollGap(cm) + \"px\";\n      display.sizer.style.marginBottom = -display.nativeBarWidth + \"px\";\n      display.sizer.style.borderRightWidth = scrollGap(cm) + \"px\";\n      display.scrollbarsClipped = true;\n    }\n  }\n\n  function selectionSnapshot(cm) {\n    if (cm.hasFocus()) { return null }\n    var active = activeElt();\n    if (!active || !contains(cm.display.lineDiv, active)) { return null }\n    var result = {activeElt: active};\n    if (window.getSelection) {\n      var sel = window.getSelection();\n      if (sel.anchorNode && sel.extend && contains(cm.display.lineDiv, sel.anchorNode)) {\n        result.anchorNode = sel.anchorNode;\n        result.anchorOffset = sel.anchorOffset;\n        result.focusNode = sel.focusNode;\n        result.focusOffset = sel.focusOffset;\n      }\n    }\n    return result\n  }\n\n  function restoreSelection(snapshot) {\n    if (!snapshot || !snapshot.activeElt || snapshot.activeElt == activeElt()) { return }\n    snapshot.activeElt.focus();\n    if (!/^(INPUT|TEXTAREA)$/.test(snapshot.activeElt.nodeName) &&\n        snapshot.anchorNode && contains(document.body, snapshot.anchorNode) && contains(document.body, snapshot.focusNode)) {\n      var sel = window.getSelection(), range = document.createRange();\n      range.setEnd(snapshot.anchorNode, snapshot.anchorOffset);\n      range.collapse(false);\n      sel.removeAllRanges();\n      sel.addRange(range);\n      sel.extend(snapshot.focusNode, snapshot.focusOffset);\n    }\n  }\n\n  // Does the actual updating of the line display. Bails out\n  // (returning false) when there is nothing to be done and forced is\n  // false.\n  function updateDisplayIfNeeded(cm, update) {\n    var display = cm.display, doc = cm.doc;\n\n    if (update.editorIsHidden) {\n      resetView(cm);\n      return false\n    }\n\n    // Bail out if the visible area is already rendered and nothing changed.\n    if (!update.force &&\n        update.visible.from >= display.viewFrom && update.visible.to <= display.viewTo &&\n        (display.updateLineNumbers == null || display.updateLineNumbers >= display.viewTo) &&\n        display.renderedView == display.view && countDirtyView(cm) == 0)\n      { return false }\n\n    if (maybeUpdateLineNumberWidth(cm)) {\n      resetView(cm);\n      update.dims = getDimensions(cm);\n    }\n\n    // Compute a suitable new viewport (from & to)\n    var end = doc.first + doc.size;\n    var from = Math.max(update.visible.from - cm.options.viewportMargin, doc.first);\n    var to = Math.min(end, update.visible.to + cm.options.viewportMargin);\n    if (display.viewFrom < from && from - display.viewFrom < 20) { from = Math.max(doc.first, display.viewFrom); }\n    if (display.viewTo > to && display.viewTo - to < 20) { to = Math.min(end, display.viewTo); }\n    if (sawCollapsedSpans) {\n      from = visualLineNo(cm.doc, from);\n      to = visualLineEndNo(cm.doc, to);\n    }\n\n    var different = from != display.viewFrom || to != display.viewTo ||\n      display.lastWrapHeight != update.wrapperHeight || display.lastWrapWidth != update.wrapperWidth;\n    adjustView(cm, from, to);\n\n    display.viewOffset = heightAtLine(getLine(cm.doc, display.viewFrom));\n    // Position the mover div to align with the current scroll position\n    cm.display.mover.style.top = display.viewOffset + \"px\";\n\n    var toUpdate = countDirtyView(cm);\n    if (!different && toUpdate == 0 && !update.force && display.renderedView == display.view &&\n        (display.updateLineNumbers == null || display.updateLineNumbers >= display.viewTo))\n      { return false }\n\n    // For big changes, we hide the enclosing element during the\n    // update, since that speeds up the operations on most browsers.\n    var selSnapshot = selectionSnapshot(cm);\n    if (toUpdate > 4) { display.lineDiv.style.display = \"none\"; }\n    patchDisplay(cm, display.updateLineNumbers, update.dims);\n    if (toUpdate > 4) { display.lineDiv.style.display = \"\"; }\n    display.renderedView = display.view;\n    // There might have been a widget with a focused element that got\n    // hidden or updated, if so re-focus it.\n    restoreSelection(selSnapshot);\n\n    // Prevent selection and cursors from interfering with the scroll\n    // width and height.\n    removeChildren(display.cursorDiv);\n    removeChildren(display.selectionDiv);\n    display.gutters.style.height = display.sizer.style.minHeight = 0;\n\n    if (different) {\n      display.lastWrapHeight = update.wrapperHeight;\n      display.lastWrapWidth = update.wrapperWidth;\n      startWorker(cm, 400);\n    }\n\n    display.updateLineNumbers = null;\n\n    return true\n  }\n\n  function postUpdateDisplay(cm, update) {\n    var viewport = update.viewport;\n\n    for (var first = true;; first = false) {\n      if (!first || !cm.options.lineWrapping || update.oldDisplayWidth == displayWidth(cm)) {\n        // Clip forced viewport to actual scrollable area.\n        if (viewport && viewport.top != null)\n          { viewport = {top: Math.min(cm.doc.height + paddingVert(cm.display) - displayHeight(cm), viewport.top)}; }\n        // Updated line heights might result in the drawn area not\n        // actually covering the viewport. Keep looping until it does.\n        update.visible = visibleLines(cm.display, cm.doc, viewport);\n        if (update.visible.from >= cm.display.viewFrom && update.visible.to <= cm.display.viewTo)\n          { break }\n      } else if (first) {\n        update.visible = visibleLines(cm.display, cm.doc, viewport);\n      }\n      if (!updateDisplayIfNeeded(cm, update)) { break }\n      updateHeightsInViewport(cm);\n      var barMeasure = measureForScrollbars(cm);\n      updateSelection(cm);\n      updateScrollbars(cm, barMeasure);\n      setDocumentHeight(cm, barMeasure);\n      update.force = false;\n    }\n\n    update.signal(cm, \"update\", cm);\n    if (cm.display.viewFrom != cm.display.reportedViewFrom || cm.display.viewTo != cm.display.reportedViewTo) {\n      update.signal(cm, \"viewportChange\", cm, cm.display.viewFrom, cm.display.viewTo);\n      cm.display.reportedViewFrom = cm.display.viewFrom; cm.display.reportedViewTo = cm.display.viewTo;\n    }\n  }\n\n  function updateDisplaySimple(cm, viewport) {\n    var update = new DisplayUpdate(cm, viewport);\n    if (updateDisplayIfNeeded(cm, update)) {\n      updateHeightsInViewport(cm);\n      postUpdateDisplay(cm, update);\n      var barMeasure = measureForScrollbars(cm);\n      updateSelection(cm);\n      updateScrollbars(cm, barMeasure);\n      setDocumentHeight(cm, barMeasure);\n      update.finish();\n    }\n  }\n\n  // Sync the actual display DOM structure with display.view, removing\n  // nodes for lines that are no longer in view, and creating the ones\n  // that are not there yet, and updating the ones that are out of\n  // date.\n  function patchDisplay(cm, updateNumbersFrom, dims) {\n    var display = cm.display, lineNumbers = cm.options.lineNumbers;\n    var container = display.lineDiv, cur = container.firstChild;\n\n    function rm(node) {\n      var next = node.nextSibling;\n      // Works around a throw-scroll bug in OS X Webkit\n      if (webkit && mac && cm.display.currentWheelTarget == node)\n        { node.style.display = \"none\"; }\n      else\n        { node.parentNode.removeChild(node); }\n      return next\n    }\n\n    var view = display.view, lineN = display.viewFrom;\n    // Loop over the elements in the view, syncing cur (the DOM nodes\n    // in display.lineDiv) with the view as we go.\n    for (var i = 0; i < view.length; i++) {\n      var lineView = view[i];\n      if (lineView.hidden) ; else if (!lineView.node || lineView.node.parentNode != container) { // Not drawn yet\n        var node = buildLineElement(cm, lineView, lineN, dims);\n        container.insertBefore(node, cur);\n      } else { // Already drawn\n        while (cur != lineView.node) { cur = rm(cur); }\n        var updateNumber = lineNumbers && updateNumbersFrom != null &&\n          updateNumbersFrom <= lineN && lineView.lineNumber;\n        if (lineView.changes) {\n          if (indexOf(lineView.changes, \"gutter\") > -1) { updateNumber = false; }\n          updateLineForChanges(cm, lineView, lineN, dims);\n        }\n        if (updateNumber) {\n          removeChildren(lineView.lineNumber);\n          lineView.lineNumber.appendChild(document.createTextNode(lineNumberFor(cm.options, lineN)));\n        }\n        cur = lineView.node.nextSibling;\n      }\n      lineN += lineView.size;\n    }\n    while (cur) { cur = rm(cur); }\n  }\n\n  function updateGutterSpace(display) {\n    var width = display.gutters.offsetWidth;\n    display.sizer.style.marginLeft = width + \"px\";\n    // Send an event to consumers responding to changes in gutter width.\n    signalLater(display, \"gutterChanged\", display);\n  }\n\n  function setDocumentHeight(cm, measure) {\n    cm.display.sizer.style.minHeight = measure.docHeight + \"px\";\n    cm.display.heightForcer.style.top = measure.docHeight + \"px\";\n    cm.display.gutters.style.height = (measure.docHeight + cm.display.barHeight + scrollGap(cm)) + \"px\";\n  }\n\n  // Re-align line numbers and gutter marks to compensate for\n  // horizontal scrolling.\n  function alignHorizontally(cm) {\n    var display = cm.display, view = display.view;\n    if (!display.alignWidgets && (!display.gutters.firstChild || !cm.options.fixedGutter)) { return }\n    var comp = compensateForHScroll(display) - display.scroller.scrollLeft + cm.doc.scrollLeft;\n    var gutterW = display.gutters.offsetWidth, left = comp + \"px\";\n    for (var i = 0; i < view.length; i++) { if (!view[i].hidden) {\n      if (cm.options.fixedGutter) {\n        if (view[i].gutter)\n          { view[i].gutter.style.left = left; }\n        if (view[i].gutterBackground)\n          { view[i].gutterBackground.style.left = left; }\n      }\n      var align = view[i].alignable;\n      if (align) { for (var j = 0; j < align.length; j++)\n        { align[j].style.left = left; } }\n    } }\n    if (cm.options.fixedGutter)\n      { display.gutters.style.left = (comp + gutterW) + \"px\"; }\n  }\n\n  // Used to ensure that the line number gutter is still the right\n  // size for the current document size. Returns true when an update\n  // is needed.\n  function maybeUpdateLineNumberWidth(cm) {\n    if (!cm.options.lineNumbers) { return false }\n    var doc = cm.doc, last = lineNumberFor(cm.options, doc.first + doc.size - 1), display = cm.display;\n    if (last.length != display.lineNumChars) {\n      var test = display.measure.appendChild(elt(\"div\", [elt(\"div\", last)],\n                                                 \"CodeMirror-linenumber CodeMirror-gutter-elt\"));\n      var innerW = test.firstChild.offsetWidth, padding = test.offsetWidth - innerW;\n      display.lineGutter.style.width = \"\";\n      display.lineNumInnerWidth = Math.max(innerW, display.lineGutter.offsetWidth - padding) + 1;\n      display.lineNumWidth = display.lineNumInnerWidth + padding;\n      display.lineNumChars = display.lineNumInnerWidth ? last.length : -1;\n      display.lineGutter.style.width = display.lineNumWidth + \"px\";\n      updateGutterSpace(cm.display);\n      return true\n    }\n    return false\n  }\n\n  function getGutters(gutters, lineNumbers) {\n    var result = [], sawLineNumbers = false;\n    for (var i = 0; i < gutters.length; i++) {\n      var name = gutters[i], style = null;\n      if (typeof name != \"string\") { style = name.style; name = name.className; }\n      if (name == \"CodeMirror-linenumbers\") {\n        if (!lineNumbers) { continue }\n        else { sawLineNumbers = true; }\n      }\n      result.push({className: name, style: style});\n    }\n    if (lineNumbers && !sawLineNumbers) { result.push({className: \"CodeMirror-linenumbers\", style: null}); }\n    return result\n  }\n\n  // Rebuild the gutter elements, ensure the margin to the left of the\n  // code matches their width.\n  function renderGutters(display) {\n    var gutters = display.gutters, specs = display.gutterSpecs;\n    removeChildren(gutters);\n    display.lineGutter = null;\n    for (var i = 0; i < specs.length; ++i) {\n      var ref = specs[i];\n      var className = ref.className;\n      var style = ref.style;\n      var gElt = gutters.appendChild(elt(\"div\", null, \"CodeMirror-gutter \" + className));\n      if (style) { gElt.style.cssText = style; }\n      if (className == \"CodeMirror-linenumbers\") {\n        display.lineGutter = gElt;\n        gElt.style.width = (display.lineNumWidth || 1) + \"px\";\n      }\n    }\n    gutters.style.display = specs.length ? \"\" : \"none\";\n    updateGutterSpace(display);\n  }\n\n  function updateGutters(cm) {\n    renderGutters(cm.display);\n    regChange(cm);\n    alignHorizontally(cm);\n  }\n\n  // The display handles the DOM integration, both for input reading\n  // and content drawing. It holds references to DOM nodes and\n  // display-related state.\n\n  function Display(place, doc, input, options) {\n    var d = this;\n    this.input = input;\n\n    // Covers bottom-right square when both scrollbars are present.\n    d.scrollbarFiller = elt(\"div\", null, \"CodeMirror-scrollbar-filler\");\n    d.scrollbarFiller.setAttribute(\"cm-not-content\", \"true\");\n    // Covers bottom of gutter when coverGutterNextToScrollbar is on\n    // and h scrollbar is present.\n    d.gutterFiller = elt(\"div\", null, \"CodeMirror-gutter-filler\");\n    d.gutterFiller.setAttribute(\"cm-not-content\", \"true\");\n    // Will contain the actual code, positioned to cover the viewport.\n    d.lineDiv = eltP(\"div\", null, \"CodeMirror-code\");\n    // Elements are added to these to represent selection and cursors.\n    d.selectionDiv = elt(\"div\", null, null, \"position: relative; z-index: 1\");\n    d.cursorDiv = elt(\"div\", null, \"CodeMirror-cursors\");\n    // A visibility: hidden element used to find the size of things.\n    d.measure = elt(\"div\", null, \"CodeMirror-measure\");\n    // When lines outside of the viewport are measured, they are drawn in this.\n    d.lineMeasure = elt(\"div\", null, \"CodeMirror-measure\");\n    // Wraps everything that needs to exist inside the vertically-padded coordinate system\n    d.lineSpace = eltP(\"div\", [d.measure, d.lineMeasure, d.selectionDiv, d.cursorDiv, d.lineDiv],\n                      null, \"position: relative; outline: none\");\n    var lines = eltP(\"div\", [d.lineSpace], \"CodeMirror-lines\");\n    // Moved around its parent to cover visible view.\n    d.mover = elt(\"div\", [lines], null, \"position: relative\");\n    // Set to the height of the document, allowing scrolling.\n    d.sizer = elt(\"div\", [d.mover], \"CodeMirror-sizer\");\n    d.sizerWidth = null;\n    // Behavior of elts with overflow: auto and padding is\n    // inconsistent across browsers. This is used to ensure the\n    // scrollable area is big enough.\n    d.heightForcer = elt(\"div\", null, null, \"position: absolute; height: \" + scrollerGap + \"px; width: 1px;\");\n    // Will contain the gutters, if any.\n    d.gutters = elt(\"div\", null, \"CodeMirror-gutters\");\n    d.lineGutter = null;\n    // Actual scrollable element.\n    d.scroller = elt(\"div\", [d.sizer, d.heightForcer, d.gutters], \"CodeMirror-scroll\");\n    d.scroller.setAttribute(\"tabIndex\", \"-1\");\n    // The element in which the editor lives.\n    d.wrapper = elt(\"div\", [d.scrollbarFiller, d.gutterFiller, d.scroller], \"CodeMirror\");\n\n    // Work around IE7 z-index bug (not perfect, hence IE7 not really being supported)\n    if (ie && ie_version < 8) { d.gutters.style.zIndex = -1; d.scroller.style.paddingRight = 0; }\n    if (!webkit && !(gecko && mobile)) { d.scroller.draggable = true; }\n\n    if (place) {\n      if (place.appendChild) { place.appendChild(d.wrapper); }\n      else { place(d.wrapper); }\n    }\n\n    // Current rendered range (may be bigger than the view window).\n    d.viewFrom = d.viewTo = doc.first;\n    d.reportedViewFrom = d.reportedViewTo = doc.first;\n    // Information about the rendered lines.\n    d.view = [];\n    d.renderedView = null;\n    // Holds info about a single rendered line when it was rendered\n    // for measurement, while not in view.\n    d.externalMeasured = null;\n    // Empty space (in pixels) above the view\n    d.viewOffset = 0;\n    d.lastWrapHeight = d.lastWrapWidth = 0;\n    d.updateLineNumbers = null;\n\n    d.nativeBarWidth = d.barHeight = d.barWidth = 0;\n    d.scrollbarsClipped = false;\n\n    // Used to only resize the line number gutter when necessary (when\n    // the amount of lines crosses a boundary that makes its width change)\n    d.lineNumWidth = d.lineNumInnerWidth = d.lineNumChars = null;\n    // Set to true when a non-horizontal-scrolling line widget is\n    // added. As an optimization, line widget aligning is skipped when\n    // this is false.\n    d.alignWidgets = false;\n\n    d.cachedCharWidth = d.cachedTextHeight = d.cachedPaddingH = null;\n\n    // Tracks the maximum line length so that the horizontal scrollbar\n    // can be kept static when scrolling.\n    d.maxLine = null;\n    d.maxLineLength = 0;\n    d.maxLineChanged = false;\n\n    // Used for measuring wheel scrolling granularity\n    d.wheelDX = d.wheelDY = d.wheelStartX = d.wheelStartY = null;\n\n    // True when shift is held down.\n    d.shift = false;\n\n    // Used to track whether anything happened since the context menu\n    // was opened.\n    d.selForContextMenu = null;\n\n    d.activeTouch = null;\n\n    d.gutterSpecs = getGutters(options.gutters, options.lineNumbers);\n    renderGutters(d);\n\n    input.init(d);\n  }\n\n  // Since the delta values reported on mouse wheel events are\n  // unstandardized between browsers and even browser versions, and\n  // generally horribly unpredictable, this code starts by measuring\n  // the scroll effect that the first few mouse wheel events have,\n  // and, from that, detects the way it can convert deltas to pixel\n  // offsets afterwards.\n  //\n  // The reason we want to know the amount a wheel event will scroll\n  // is that it gives us a chance to update the display before the\n  // actual scrolling happens, reducing flickering.\n\n  var wheelSamples = 0, wheelPixelsPerUnit = null;\n  // Fill in a browser-detected starting value on browsers where we\n  // know one. These don't have to be accurate -- the result of them\n  // being wrong would just be a slight flicker on the first wheel\n  // scroll (if it is large enough).\n  if (ie) { wheelPixelsPerUnit = -.53; }\n  else if (gecko) { wheelPixelsPerUnit = 15; }\n  else if (chrome) { wheelPixelsPerUnit = -.7; }\n  else if (safari) { wheelPixelsPerUnit = -1/3; }\n\n  function wheelEventDelta(e) {\n    var dx = e.wheelDeltaX, dy = e.wheelDeltaY;\n    if (dx == null && e.detail && e.axis == e.HORIZONTAL_AXIS) { dx = e.detail; }\n    if (dy == null && e.detail && e.axis == e.VERTICAL_AXIS) { dy = e.detail; }\n    else if (dy == null) { dy = e.wheelDelta; }\n    return {x: dx, y: dy}\n  }\n  function wheelEventPixels(e) {\n    var delta = wheelEventDelta(e);\n    delta.x *= wheelPixelsPerUnit;\n    delta.y *= wheelPixelsPerUnit;\n    return delta\n  }\n\n  function onScrollWheel(cm, e) {\n    var delta = wheelEventDelta(e), dx = delta.x, dy = delta.y;\n\n    var display = cm.display, scroll = display.scroller;\n    // Quit if there's nothing to scroll here\n    var canScrollX = scroll.scrollWidth > scroll.clientWidth;\n    var canScrollY = scroll.scrollHeight > scroll.clientHeight;\n    if (!(dx && canScrollX || dy && canScrollY)) { return }\n\n    // Webkit browsers on OS X abort momentum scrolls when the target\n    // of the scroll event is removed from the scrollable element.\n    // This hack (see related code in patchDisplay) makes sure the\n    // element is kept around.\n    if (dy && mac && webkit) {\n      outer: for (var cur = e.target, view = display.view; cur != scroll; cur = cur.parentNode) {\n        for (var i = 0; i < view.length; i++) {\n          if (view[i].node == cur) {\n            cm.display.currentWheelTarget = cur;\n            break outer\n          }\n        }\n      }\n    }\n\n    // On some browsers, horizontal scrolling will cause redraws to\n    // happen before the gutter has been realigned, causing it to\n    // wriggle around in a most unseemly way. When we have an\n    // estimated pixels/delta value, we just handle horizontal\n    // scrolling entirely here. It'll be slightly off from native, but\n    // better than glitching out.\n    if (dx && !gecko && !presto && wheelPixelsPerUnit != null) {\n      if (dy && canScrollY)\n        { updateScrollTop(cm, Math.max(0, scroll.scrollTop + dy * wheelPixelsPerUnit)); }\n      setScrollLeft(cm, Math.max(0, scroll.scrollLeft + dx * wheelPixelsPerUnit));\n      // Only prevent default scrolling if vertical scrolling is\n      // actually possible. Otherwise, it causes vertical scroll\n      // jitter on OSX trackpads when deltaX is small and deltaY\n      // is large (issue #3579)\n      if (!dy || (dy && canScrollY))\n        { e_preventDefault(e); }\n      display.wheelStartX = null; // Abort measurement, if in progress\n      return\n    }\n\n    // 'Project' the visible viewport to cover the area that is being\n    // scrolled into view (if we know enough to estimate it).\n    if (dy && wheelPixelsPerUnit != null) {\n      var pixels = dy * wheelPixelsPerUnit;\n      var top = cm.doc.scrollTop, bot = top + display.wrapper.clientHeight;\n      if (pixels < 0) { top = Math.max(0, top + pixels - 50); }\n      else { bot = Math.min(cm.doc.height, bot + pixels + 50); }\n      updateDisplaySimple(cm, {top: top, bottom: bot});\n    }\n\n    if (wheelSamples < 20) {\n      if (display.wheelStartX == null) {\n        display.wheelStartX = scroll.scrollLeft; display.wheelStartY = scroll.scrollTop;\n        display.wheelDX = dx; display.wheelDY = dy;\n        setTimeout(function () {\n          if (display.wheelStartX == null) { return }\n          var movedX = scroll.scrollLeft - display.wheelStartX;\n          var movedY = scroll.scrollTop - display.wheelStartY;\n          var sample = (movedY && display.wheelDY && movedY / display.wheelDY) ||\n            (movedX && display.wheelDX && movedX / display.wheelDX);\n          display.wheelStartX = display.wheelStartY = null;\n          if (!sample) { return }\n          wheelPixelsPerUnit = (wheelPixelsPerUnit * wheelSamples + sample) / (wheelSamples + 1);\n          ++wheelSamples;\n        }, 200);\n      } else {\n        display.wheelDX += dx; display.wheelDY += dy;\n      }\n    }\n  }\n\n  // Selection objects are immutable. A new one is created every time\n  // the selection changes. A selection is one or more non-overlapping\n  // (and non-touching) ranges, sorted, and an integer that indicates\n  // which one is the primary selection (the one that's scrolled into\n  // view, that getCursor returns, etc).\n  var Selection = function(ranges, primIndex) {\n    this.ranges = ranges;\n    this.primIndex = primIndex;\n  };\n\n  Selection.prototype.primary = function () { return this.ranges[this.primIndex] };\n\n  Selection.prototype.equals = function (other) {\n    if (other == this) { return true }\n    if (other.primIndex != this.primIndex || other.ranges.length != this.ranges.length) { return false }\n    for (var i = 0; i < this.ranges.length; i++) {\n      var here = this.ranges[i], there = other.ranges[i];\n      if (!equalCursorPos(here.anchor, there.anchor) || !equalCursorPos(here.head, there.head)) { return false }\n    }\n    return true\n  };\n\n  Selection.prototype.deepCopy = function () {\n    var out = [];\n    for (var i = 0; i < this.ranges.length; i++)\n      { out[i] = new Range(copyPos(this.ranges[i].anchor), copyPos(this.ranges[i].head)); }\n    return new Selection(out, this.primIndex)\n  };\n\n  Selection.prototype.somethingSelected = function () {\n    for (var i = 0; i < this.ranges.length; i++)\n      { if (!this.ranges[i].empty()) { return true } }\n    return false\n  };\n\n  Selection.prototype.contains = function (pos, end) {\n    if (!end) { end = pos; }\n    for (var i = 0; i < this.ranges.length; i++) {\n      var range = this.ranges[i];\n      if (cmp(end, range.from()) >= 0 && cmp(pos, range.to()) <= 0)\n        { return i }\n    }\n    return -1\n  };\n\n  var Range = function(anchor, head) {\n    this.anchor = anchor; this.head = head;\n  };\n\n  Range.prototype.from = function () { return minPos(this.anchor, this.head) };\n  Range.prototype.to = function () { return maxPos(this.anchor, this.head) };\n  Range.prototype.empty = function () { return this.head.line == this.anchor.line && this.head.ch == this.anchor.ch };\n\n  // Take an unsorted, potentially overlapping set of ranges, and\n  // build a selection out of it. 'Consumes' ranges array (modifying\n  // it).\n  function normalizeSelection(cm, ranges, primIndex) {\n    var mayTouch = cm && cm.options.selectionsMayTouch;\n    var prim = ranges[primIndex];\n    ranges.sort(function (a, b) { return cmp(a.from(), b.from()); });\n    primIndex = indexOf(ranges, prim);\n    for (var i = 1; i < ranges.length; i++) {\n      var cur = ranges[i], prev = ranges[i - 1];\n      var diff = cmp(prev.to(), cur.from());\n      if (mayTouch && !cur.empty() ? diff > 0 : diff >= 0) {\n        var from = minPos(prev.from(), cur.from()), to = maxPos(prev.to(), cur.to());\n        var inv = prev.empty() ? cur.from() == cur.head : prev.from() == prev.head;\n        if (i <= primIndex) { --primIndex; }\n        ranges.splice(--i, 2, new Range(inv ? to : from, inv ? from : to));\n      }\n    }\n    return new Selection(ranges, primIndex)\n  }\n\n  function simpleSelection(anchor, head) {\n    return new Selection([new Range(anchor, head || anchor)], 0)\n  }\n\n  // Compute the position of the end of a change (its 'to' property\n  // refers to the pre-change end).\n  function changeEnd(change) {\n    if (!change.text) { return change.to }\n    return Pos(change.from.line + change.text.length - 1,\n               lst(change.text).length + (change.text.length == 1 ? change.from.ch : 0))\n  }\n\n  // Adjust a position to refer to the post-change position of the\n  // same text, or the end of the change if the change covers it.\n  function adjustForChange(pos, change) {\n    if (cmp(pos, change.from) < 0) { return pos }\n    if (cmp(pos, change.to) <= 0) { return changeEnd(change) }\n\n    var line = pos.line + change.text.length - (change.to.line - change.from.line) - 1, ch = pos.ch;\n    if (pos.line == change.to.line) { ch += changeEnd(change).ch - change.to.ch; }\n    return Pos(line, ch)\n  }\n\n  function computeSelAfterChange(doc, change) {\n    var out = [];\n    for (var i = 0; i < doc.sel.ranges.length; i++) {\n      var range = doc.sel.ranges[i];\n      out.push(new Range(adjustForChange(range.anchor, change),\n                         adjustForChange(range.head, change)));\n    }\n    return normalizeSelection(doc.cm, out, doc.sel.primIndex)\n  }\n\n  function offsetPos(pos, old, nw) {\n    if (pos.line == old.line)\n      { return Pos(nw.line, pos.ch - old.ch + nw.ch) }\n    else\n      { return Pos(nw.line + (pos.line - old.line), pos.ch) }\n  }\n\n  // Used by replaceSelections to allow moving the selection to the\n  // start or around the replaced test. Hint may be \"start\" or \"around\".\n  function computeReplacedSel(doc, changes, hint) {\n    var out = [];\n    var oldPrev = Pos(doc.first, 0), newPrev = oldPrev;\n    for (var i = 0; i < changes.length; i++) {\n      var change = changes[i];\n      var from = offsetPos(change.from, oldPrev, newPrev);\n      var to = offsetPos(changeEnd(change), oldPrev, newPrev);\n      oldPrev = change.to;\n      newPrev = to;\n      if (hint == \"around\") {\n        var range = doc.sel.ranges[i], inv = cmp(range.head, range.anchor) < 0;\n        out[i] = new Range(inv ? to : from, inv ? from : to);\n      } else {\n        out[i] = new Range(from, from);\n      }\n    }\n    return new Selection(out, doc.sel.primIndex)\n  }\n\n  // Used to get the editor into a consistent state again when options change.\n\n  function loadMode(cm) {\n    cm.doc.mode = getMode(cm.options, cm.doc.modeOption);\n    resetModeState(cm);\n  }\n\n  function resetModeState(cm) {\n    cm.doc.iter(function (line) {\n      if (line.stateAfter) { line.stateAfter = null; }\n      if (line.styles) { line.styles = null; }\n    });\n    cm.doc.modeFrontier = cm.doc.highlightFrontier = cm.doc.first;\n    startWorker(cm, 100);\n    cm.state.modeGen++;\n    if (cm.curOp) { regChange(cm); }\n  }\n\n  // DOCUMENT DATA STRUCTURE\n\n  // By default, updates that start and end at the beginning of a line\n  // are treated specially, in order to make the association of line\n  // widgets and marker elements with the text behave more intuitive.\n  function isWholeLineUpdate(doc, change) {\n    return change.from.ch == 0 && change.to.ch == 0 && lst(change.text) == \"\" &&\n      (!doc.cm || doc.cm.options.wholeLineUpdateBefore)\n  }\n\n  // Perform a change on the document data structure.\n  function updateDoc(doc, change, markedSpans, estimateHeight) {\n    function spansFor(n) {return markedSpans ? markedSpans[n] : null}\n    function update(line, text, spans) {\n      updateLine(line, text, spans, estimateHeight);\n      signalLater(line, \"change\", line, change);\n    }\n    function linesFor(start, end) {\n      var result = [];\n      for (var i = start; i < end; ++i)\n        { result.push(new Line(text[i], spansFor(i), estimateHeight)); }\n      return result\n    }\n\n    var from = change.from, to = change.to, text = change.text;\n    var firstLine = getLine(doc, from.line), lastLine = getLine(doc, to.line);\n    var lastText = lst(text), lastSpans = spansFor(text.length - 1), nlines = to.line - from.line;\n\n    // Adjust the line structure\n    if (change.full) {\n      doc.insert(0, linesFor(0, text.length));\n      doc.remove(text.length, doc.size - text.length);\n    } else if (isWholeLineUpdate(doc, change)) {\n      // This is a whole-line replace. Treated specially to make\n      // sure line objects move the way they are supposed to.\n      var added = linesFor(0, text.length - 1);\n      update(lastLine, lastLine.text, lastSpans);\n      if (nlines) { doc.remove(from.line, nlines); }\n      if (added.length) { doc.insert(from.line, added); }\n    } else if (firstLine == lastLine) {\n      if (text.length == 1) {\n        update(firstLine, firstLine.text.slice(0, from.ch) + lastText + firstLine.text.slice(to.ch), lastSpans);\n      } else {\n        var added$1 = linesFor(1, text.length - 1);\n        added$1.push(new Line(lastText + firstLine.text.slice(to.ch), lastSpans, estimateHeight));\n        update(firstLine, firstLine.text.slice(0, from.ch) + text[0], spansFor(0));\n        doc.insert(from.line + 1, added$1);\n      }\n    } else if (text.length == 1) {\n      update(firstLine, firstLine.text.slice(0, from.ch) + text[0] + lastLine.text.slice(to.ch), spansFor(0));\n      doc.remove(from.line + 1, nlines);\n    } else {\n      update(firstLine, firstLine.text.slice(0, from.ch) + text[0], spansFor(0));\n      update(lastLine, lastText + lastLine.text.slice(to.ch), lastSpans);\n      var added$2 = linesFor(1, text.length - 1);\n      if (nlines > 1) { doc.remove(from.line + 1, nlines - 1); }\n      doc.insert(from.line + 1, added$2);\n    }\n\n    signalLater(doc, \"change\", doc, change);\n  }\n\n  // Call f for all linked documents.\n  function linkedDocs(doc, f, sharedHistOnly) {\n    function propagate(doc, skip, sharedHist) {\n      if (doc.linked) { for (var i = 0; i < doc.linked.length; ++i) {\n        var rel = doc.linked[i];\n        if (rel.doc == skip) { continue }\n        var shared = sharedHist && rel.sharedHist;\n        if (sharedHistOnly && !shared) { continue }\n        f(rel.doc, shared);\n        propagate(rel.doc, doc, shared);\n      } }\n    }\n    propagate(doc, null, true);\n  }\n\n  // Attach a document to an editor.\n  function attachDoc(cm, doc) {\n    if (doc.cm) { throw new Error(\"This document is already in use.\") }\n    cm.doc = doc;\n    doc.cm = cm;\n    estimateLineHeights(cm);\n    loadMode(cm);\n    setDirectionClass(cm);\n    if (!cm.options.lineWrapping) { findMaxLine(cm); }\n    cm.options.mode = doc.modeOption;\n    regChange(cm);\n  }\n\n  function setDirectionClass(cm) {\n  (cm.doc.direction == \"rtl\" ? addClass : rmClass)(cm.display.lineDiv, \"CodeMirror-rtl\");\n  }\n\n  function directionChanged(cm) {\n    runInOp(cm, function () {\n      setDirectionClass(cm);\n      regChange(cm);\n    });\n  }\n\n  function History(prev) {\n    // Arrays of change events and selections. Doing something adds an\n    // event to done and clears undo. Undoing moves events from done\n    // to undone, redoing moves them in the other direction.\n    this.done = []; this.undone = [];\n    this.undoDepth = prev ? prev.undoDepth : Infinity;\n    // Used to track when changes can be merged into a single undo\n    // event\n    this.lastModTime = this.lastSelTime = 0;\n    this.lastOp = this.lastSelOp = null;\n    this.lastOrigin = this.lastSelOrigin = null;\n    // Used by the isClean() method\n    this.generation = this.maxGeneration = prev ? prev.maxGeneration : 1;\n  }\n\n  // Create a history change event from an updateDoc-style change\n  // object.\n  function historyChangeFromChange(doc, change) {\n    var histChange = {from: copyPos(change.from), to: changeEnd(change), text: getBetween(doc, change.from, change.to)};\n    attachLocalSpans(doc, histChange, change.from.line, change.to.line + 1);\n    linkedDocs(doc, function (doc) { return attachLocalSpans(doc, histChange, change.from.line, change.to.line + 1); }, true);\n    return histChange\n  }\n\n  // Pop all selection events off the end of a history array. Stop at\n  // a change event.\n  function clearSelectionEvents(array) {\n    while (array.length) {\n      var last = lst(array);\n      if (last.ranges) { array.pop(); }\n      else { break }\n    }\n  }\n\n  // Find the top change event in the history. Pop off selection\n  // events that are in the way.\n  function lastChangeEvent(hist, force) {\n    if (force) {\n      clearSelectionEvents(hist.done);\n      return lst(hist.done)\n    } else if (hist.done.length && !lst(hist.done).ranges) {\n      return lst(hist.done)\n    } else if (hist.done.length > 1 && !hist.done[hist.done.length - 2].ranges) {\n      hist.done.pop();\n      return lst(hist.done)\n    }\n  }\n\n  // Register a change in the history. Merges changes that are within\n  // a single operation, or are close together with an origin that\n  // allows merging (starting with \"+\") into a single event.\n  function addChangeToHistory(doc, change, selAfter, opId) {\n    var hist = doc.history;\n    hist.undone.length = 0;\n    var time = +new Date, cur;\n    var last;\n\n    if ((hist.lastOp == opId ||\n         hist.lastOrigin == change.origin && change.origin &&\n         ((change.origin.charAt(0) == \"+\" && hist.lastModTime > time - (doc.cm ? doc.cm.options.historyEventDelay : 500)) ||\n          change.origin.charAt(0) == \"*\")) &&\n        (cur = lastChangeEvent(hist, hist.lastOp == opId))) {\n      // Merge this change into the last event\n      last = lst(cur.changes);\n      if (cmp(change.from, change.to) == 0 && cmp(change.from, last.to) == 0) {\n        // Optimized case for simple insertion -- don't want to add\n        // new changesets for every character typed\n        last.to = changeEnd(change);\n      } else {\n        // Add new sub-event\n        cur.changes.push(historyChangeFromChange(doc, change));\n      }\n    } else {\n      // Can not be merged, start a new event.\n      var before = lst(hist.done);\n      if (!before || !before.ranges)\n        { pushSelectionToHistory(doc.sel, hist.done); }\n      cur = {changes: [historyChangeFromChange(doc, change)],\n             generation: hist.generation};\n      hist.done.push(cur);\n      while (hist.done.length > hist.undoDepth) {\n        hist.done.shift();\n        if (!hist.done[0].ranges) { hist.done.shift(); }\n      }\n    }\n    hist.done.push(selAfter);\n    hist.generation = ++hist.maxGeneration;\n    hist.lastModTime = hist.lastSelTime = time;\n    hist.lastOp = hist.lastSelOp = opId;\n    hist.lastOrigin = hist.lastSelOrigin = change.origin;\n\n    if (!last) { signal(doc, \"historyAdded\"); }\n  }\n\n  function selectionEventCanBeMerged(doc, origin, prev, sel) {\n    var ch = origin.charAt(0);\n    return ch == \"*\" ||\n      ch == \"+\" &&\n      prev.ranges.length == sel.ranges.length &&\n      prev.somethingSelected() == sel.somethingSelected() &&\n      new Date - doc.history.lastSelTime <= (doc.cm ? doc.cm.options.historyEventDelay : 500)\n  }\n\n  // Called whenever the selection changes, sets the new selection as\n  // the pending selection in the history, and pushes the old pending\n  // selection into the 'done' array when it was significantly\n  // different (in number of selected ranges, emptiness, or time).\n  function addSelectionToHistory(doc, sel, opId, options) {\n    var hist = doc.history, origin = options && options.origin;\n\n    // A new event is started when the previous origin does not match\n    // the current, or the origins don't allow matching. Origins\n    // starting with * are always merged, those starting with + are\n    // merged when similar and close together in time.\n    if (opId == hist.lastSelOp ||\n        (origin && hist.lastSelOrigin == origin &&\n         (hist.lastModTime == hist.lastSelTime && hist.lastOrigin == origin ||\n          selectionEventCanBeMerged(doc, origin, lst(hist.done), sel))))\n      { hist.done[hist.done.length - 1] = sel; }\n    else\n      { pushSelectionToHistory(sel, hist.done); }\n\n    hist.lastSelTime = +new Date;\n    hist.lastSelOrigin = origin;\n    hist.lastSelOp = opId;\n    if (options && options.clearRedo !== false)\n      { clearSelectionEvents(hist.undone); }\n  }\n\n  function pushSelectionToHistory(sel, dest) {\n    var top = lst(dest);\n    if (!(top && top.ranges && top.equals(sel)))\n      { dest.push(sel); }\n  }\n\n  // Used to store marked span information in the history.\n  function attachLocalSpans(doc, change, from, to) {\n    var existing = change[\"spans_\" + doc.id], n = 0;\n    doc.iter(Math.max(doc.first, from), Math.min(doc.first + doc.size, to), function (line) {\n      if (line.markedSpans)\n        { (existing || (existing = change[\"spans_\" + doc.id] = {}))[n] = line.markedSpans; }\n      ++n;\n    });\n  }\n\n  // When un/re-doing restores text containing marked spans, those\n  // that have been explicitly cleared should not be restored.\n  function removeClearedSpans(spans) {\n    if (!spans) { return null }\n    var out;\n    for (var i = 0; i < spans.length; ++i) {\n      if (spans[i].marker.explicitlyCleared) { if (!out) { out = spans.slice(0, i); } }\n      else if (out) { out.push(spans[i]); }\n    }\n    return !out ? spans : out.length ? out : null\n  }\n\n  // Retrieve and filter the old marked spans stored in a change event.\n  function getOldSpans(doc, change) {\n    var found = change[\"spans_\" + doc.id];\n    if (!found) { return null }\n    var nw = [];\n    for (var i = 0; i < change.text.length; ++i)\n      { nw.push(removeClearedSpans(found[i])); }\n    return nw\n  }\n\n  // Used for un/re-doing changes from the history. Combines the\n  // result of computing the existing spans with the set of spans that\n  // existed in the history (so that deleting around a span and then\n  // undoing brings back the span).\n  function mergeOldSpans(doc, change) {\n    var old = getOldSpans(doc, change);\n    var stretched = stretchSpansOverChange(doc, change);\n    if (!old) { return stretched }\n    if (!stretched) { return old }\n\n    for (var i = 0; i < old.length; ++i) {\n      var oldCur = old[i], stretchCur = stretched[i];\n      if (oldCur && stretchCur) {\n        spans: for (var j = 0; j < stretchCur.length; ++j) {\n          var span = stretchCur[j];\n          for (var k = 0; k < oldCur.length; ++k)\n            { if (oldCur[k].marker == span.marker) { continue spans } }\n          oldCur.push(span);\n        }\n      } else if (stretchCur) {\n        old[i] = stretchCur;\n      }\n    }\n    return old\n  }\n\n  // Used both to provide a JSON-safe object in .getHistory, and, when\n  // detaching a document, to split the history in two\n  function copyHistoryArray(events, newGroup, instantiateSel) {\n    var copy = [];\n    for (var i = 0; i < events.length; ++i) {\n      var event = events[i];\n      if (event.ranges) {\n        copy.push(instantiateSel ? Selection.prototype.deepCopy.call(event) : event);\n        continue\n      }\n      var changes = event.changes, newChanges = [];\n      copy.push({changes: newChanges});\n      for (var j = 0; j < changes.length; ++j) {\n        var change = changes[j], m = (void 0);\n        newChanges.push({from: change.from, to: change.to, text: change.text});\n        if (newGroup) { for (var prop in change) { if (m = prop.match(/^spans_(\\d+)$/)) {\n          if (indexOf(newGroup, Number(m[1])) > -1) {\n            lst(newChanges)[prop] = change[prop];\n            delete change[prop];\n          }\n        } } }\n      }\n    }\n    return copy\n  }\n\n  // The 'scroll' parameter given to many of these indicated whether\n  // the new cursor position should be scrolled into view after\n  // modifying the selection.\n\n  // If shift is held or the extend flag is set, extends a range to\n  // include a given position (and optionally a second position).\n  // Otherwise, simply returns the range between the given positions.\n  // Used for cursor motion and such.\n  function extendRange(range, head, other, extend) {\n    if (extend) {\n      var anchor = range.anchor;\n      if (other) {\n        var posBefore = cmp(head, anchor) < 0;\n        if (posBefore != (cmp(other, anchor) < 0)) {\n          anchor = head;\n          head = other;\n        } else if (posBefore != (cmp(head, other) < 0)) {\n          head = other;\n        }\n      }\n      return new Range(anchor, head)\n    } else {\n      return new Range(other || head, head)\n    }\n  }\n\n  // Extend the primary selection range, discard the rest.\n  function extendSelection(doc, head, other, options, extend) {\n    if (extend == null) { extend = doc.cm && (doc.cm.display.shift || doc.extend); }\n    setSelection(doc, new Selection([extendRange(doc.sel.primary(), head, other, extend)], 0), options);\n  }\n\n  // Extend all selections (pos is an array of selections with length\n  // equal the number of selections)\n  function extendSelections(doc, heads, options) {\n    var out = [];\n    var extend = doc.cm && (doc.cm.display.shift || doc.extend);\n    for (var i = 0; i < doc.sel.ranges.length; i++)\n      { out[i] = extendRange(doc.sel.ranges[i], heads[i], null, extend); }\n    var newSel = normalizeSelection(doc.cm, out, doc.sel.primIndex);\n    setSelection(doc, newSel, options);\n  }\n\n  // Updates a single range in the selection.\n  function replaceOneSelection(doc, i, range, options) {\n    var ranges = doc.sel.ranges.slice(0);\n    ranges[i] = range;\n    setSelection(doc, normalizeSelection(doc.cm, ranges, doc.sel.primIndex), options);\n  }\n\n  // Reset the selection to a single range.\n  function setSimpleSelection(doc, anchor, head, options) {\n    setSelection(doc, simpleSelection(anchor, head), options);\n  }\n\n  // Give beforeSelectionChange handlers a change to influence a\n  // selection update.\n  function filterSelectionChange(doc, sel, options) {\n    var obj = {\n      ranges: sel.ranges,\n      update: function(ranges) {\n        this.ranges = [];\n        for (var i = 0; i < ranges.length; i++)\n          { this.ranges[i] = new Range(clipPos(doc, ranges[i].anchor),\n                                     clipPos(doc, ranges[i].head)); }\n      },\n      origin: options && options.origin\n    };\n    signal(doc, \"beforeSelectionChange\", doc, obj);\n    if (doc.cm) { signal(doc.cm, \"beforeSelectionChange\", doc.cm, obj); }\n    if (obj.ranges != sel.ranges) { return normalizeSelection(doc.cm, obj.ranges, obj.ranges.length - 1) }\n    else { return sel }\n  }\n\n  function setSelectionReplaceHistory(doc, sel, options) {\n    var done = doc.history.done, last = lst(done);\n    if (last && last.ranges) {\n      done[done.length - 1] = sel;\n      setSelectionNoUndo(doc, sel, options);\n    } else {\n      setSelection(doc, sel, options);\n    }\n  }\n\n  // Set a new selection.\n  function setSelection(doc, sel, options) {\n    setSelectionNoUndo(doc, sel, options);\n    addSelectionToHistory(doc, doc.sel, doc.cm ? doc.cm.curOp.id : NaN, options);\n  }\n\n  function setSelectionNoUndo(doc, sel, options) {\n    if (hasHandler(doc, \"beforeSelectionChange\") || doc.cm && hasHandler(doc.cm, \"beforeSelectionChange\"))\n      { sel = filterSelectionChange(doc, sel, options); }\n\n    var bias = options && options.bias ||\n      (cmp(sel.primary().head, doc.sel.primary().head) < 0 ? -1 : 1);\n    setSelectionInner(doc, skipAtomicInSelection(doc, sel, bias, true));\n\n    if (!(options && options.scroll === false) && doc.cm && doc.cm.getOption(\"readOnly\") != \"nocursor\")\n      { ensureCursorVisible(doc.cm); }\n  }\n\n  function setSelectionInner(doc, sel) {\n    if (sel.equals(doc.sel)) { return }\n\n    doc.sel = sel;\n\n    if (doc.cm) {\n      doc.cm.curOp.updateInput = 1;\n      doc.cm.curOp.selectionChanged = true;\n      signalCursorActivity(doc.cm);\n    }\n    signalLater(doc, \"cursorActivity\", doc);\n  }\n\n  // Verify that the selection does not partially select any atomic\n  // marked ranges.\n  function reCheckSelection(doc) {\n    setSelectionInner(doc, skipAtomicInSelection(doc, doc.sel, null, false));\n  }\n\n  // Return a selection that does not partially select any atomic\n  // ranges.\n  function skipAtomicInSelection(doc, sel, bias, mayClear) {\n    var out;\n    for (var i = 0; i < sel.ranges.length; i++) {\n      var range = sel.ranges[i];\n      var old = sel.ranges.length == doc.sel.ranges.length && doc.sel.ranges[i];\n      var newAnchor = skipAtomic(doc, range.anchor, old && old.anchor, bias, mayClear);\n      var newHead = skipAtomic(doc, range.head, old && old.head, bias, mayClear);\n      if (out || newAnchor != range.anchor || newHead != range.head) {\n        if (!out) { out = sel.ranges.slice(0, i); }\n        out[i] = new Range(newAnchor, newHead);\n      }\n    }\n    return out ? normalizeSelection(doc.cm, out, sel.primIndex) : sel\n  }\n\n  function skipAtomicInner(doc, pos, oldPos, dir, mayClear) {\n    var line = getLine(doc, pos.line);\n    if (line.markedSpans) { for (var i = 0; i < line.markedSpans.length; ++i) {\n      var sp = line.markedSpans[i], m = sp.marker;\n\n      // Determine if we should prevent the cursor being placed to the left/right of an atomic marker\n      // Historically this was determined using the inclusiveLeft/Right option, but the new way to control it\n      // is with selectLeft/Right\n      var preventCursorLeft = (\"selectLeft\" in m) ? !m.selectLeft : m.inclusiveLeft;\n      var preventCursorRight = (\"selectRight\" in m) ? !m.selectRight : m.inclusiveRight;\n\n      if ((sp.from == null || (preventCursorLeft ? sp.from <= pos.ch : sp.from < pos.ch)) &&\n          (sp.to == null || (preventCursorRight ? sp.to >= pos.ch : sp.to > pos.ch))) {\n        if (mayClear) {\n          signal(m, \"beforeCursorEnter\");\n          if (m.explicitlyCleared) {\n            if (!line.markedSpans) { break }\n            else {--i; continue}\n          }\n        }\n        if (!m.atomic) { continue }\n\n        if (oldPos) {\n          var near = m.find(dir < 0 ? 1 : -1), diff = (void 0);\n          if (dir < 0 ? preventCursorRight : preventCursorLeft)\n            { near = movePos(doc, near, -dir, near && near.line == pos.line ? line : null); }\n          if (near && near.line == pos.line && (diff = cmp(near, oldPos)) && (dir < 0 ? diff < 0 : diff > 0))\n            { return skipAtomicInner(doc, near, pos, dir, mayClear) }\n        }\n\n        var far = m.find(dir < 0 ? -1 : 1);\n        if (dir < 0 ? preventCursorLeft : preventCursorRight)\n          { far = movePos(doc, far, dir, far.line == pos.line ? line : null); }\n        return far ? skipAtomicInner(doc, far, pos, dir, mayClear) : null\n      }\n    } }\n    return pos\n  }\n\n  // Ensure a given position is not inside an atomic range.\n  function skipAtomic(doc, pos, oldPos, bias, mayClear) {\n    var dir = bias || 1;\n    var found = skipAtomicInner(doc, pos, oldPos, dir, mayClear) ||\n        (!mayClear && skipAtomicInner(doc, pos, oldPos, dir, true)) ||\n        skipAtomicInner(doc, pos, oldPos, -dir, mayClear) ||\n        (!mayClear && skipAtomicInner(doc, pos, oldPos, -dir, true));\n    if (!found) {\n      doc.cantEdit = true;\n      return Pos(doc.first, 0)\n    }\n    return found\n  }\n\n  function movePos(doc, pos, dir, line) {\n    if (dir < 0 && pos.ch == 0) {\n      if (pos.line > doc.first) { return clipPos(doc, Pos(pos.line - 1)) }\n      else { return null }\n    } else if (dir > 0 && pos.ch == (line || getLine(doc, pos.line)).text.length) {\n      if (pos.line < doc.first + doc.size - 1) { return Pos(pos.line + 1, 0) }\n      else { return null }\n    } else {\n      return new Pos(pos.line, pos.ch + dir)\n    }\n  }\n\n  function selectAll(cm) {\n    cm.setSelection(Pos(cm.firstLine(), 0), Pos(cm.lastLine()), sel_dontScroll);\n  }\n\n  // UPDATING\n\n  // Allow \"beforeChange\" event handlers to influence a change\n  function filterChange(doc, change, update) {\n    var obj = {\n      canceled: false,\n      from: change.from,\n      to: change.to,\n      text: change.text,\n      origin: change.origin,\n      cancel: function () { return obj.canceled = true; }\n    };\n    if (update) { obj.update = function (from, to, text, origin) {\n      if (from) { obj.from = clipPos(doc, from); }\n      if (to) { obj.to = clipPos(doc, to); }\n      if (text) { obj.text = text; }\n      if (origin !== undefined) { obj.origin = origin; }\n    }; }\n    signal(doc, \"beforeChange\", doc, obj);\n    if (doc.cm) { signal(doc.cm, \"beforeChange\", doc.cm, obj); }\n\n    if (obj.canceled) {\n      if (doc.cm) { doc.cm.curOp.updateInput = 2; }\n      return null\n    }\n    return {from: obj.from, to: obj.to, text: obj.text, origin: obj.origin}\n  }\n\n  // Apply a change to a document, and add it to the document's\n  // history, and propagating it to all linked documents.\n  function makeChange(doc, change, ignoreReadOnly) {\n    if (doc.cm) {\n      if (!doc.cm.curOp) { return operation(doc.cm, makeChange)(doc, change, ignoreReadOnly) }\n      if (doc.cm.state.suppressEdits) { return }\n    }\n\n    if (hasHandler(doc, \"beforeChange\") || doc.cm && hasHandler(doc.cm, \"beforeChange\")) {\n      change = filterChange(doc, change, true);\n      if (!change) { return }\n    }\n\n    // Possibly split or suppress the update based on the presence\n    // of read-only spans in its range.\n    var split = sawReadOnlySpans && !ignoreReadOnly && removeReadOnlyRanges(doc, change.from, change.to);\n    if (split) {\n      for (var i = split.length - 1; i >= 0; --i)\n        { makeChangeInner(doc, {from: split[i].from, to: split[i].to, text: i ? [\"\"] : change.text, origin: change.origin}); }\n    } else {\n      makeChangeInner(doc, change);\n    }\n  }\n\n  function makeChangeInner(doc, change) {\n    if (change.text.length == 1 && change.text[0] == \"\" && cmp(change.from, change.to) == 0) { return }\n    var selAfter = computeSelAfterChange(doc, change);\n    addChangeToHistory(doc, change, selAfter, doc.cm ? doc.cm.curOp.id : NaN);\n\n    makeChangeSingleDoc(doc, change, selAfter, stretchSpansOverChange(doc, change));\n    var rebased = [];\n\n    linkedDocs(doc, function (doc, sharedHist) {\n      if (!sharedHist && indexOf(rebased, doc.history) == -1) {\n        rebaseHist(doc.history, change);\n        rebased.push(doc.history);\n      }\n      makeChangeSingleDoc(doc, change, null, stretchSpansOverChange(doc, change));\n    });\n  }\n\n  // Revert a change stored in a document's history.\n  function makeChangeFromHistory(doc, type, allowSelectionOnly) {\n    var suppress = doc.cm && doc.cm.state.suppressEdits;\n    if (suppress && !allowSelectionOnly) { return }\n\n    var hist = doc.history, event, selAfter = doc.sel;\n    var source = type == \"undo\" ? hist.done : hist.undone, dest = type == \"undo\" ? hist.undone : hist.done;\n\n    // Verify that there is a useable event (so that ctrl-z won't\n    // needlessly clear selection events)\n    var i = 0;\n    for (; i < source.length; i++) {\n      event = source[i];\n      if (allowSelectionOnly ? event.ranges && !event.equals(doc.sel) : !event.ranges)\n        { break }\n    }\n    if (i == source.length) { return }\n    hist.lastOrigin = hist.lastSelOrigin = null;\n\n    for (;;) {\n      event = source.pop();\n      if (event.ranges) {\n        pushSelectionToHistory(event, dest);\n        if (allowSelectionOnly && !event.equals(doc.sel)) {\n          setSelection(doc, event, {clearRedo: false});\n          return\n        }\n        selAfter = event;\n      } else if (suppress) {\n        source.push(event);\n        return\n      } else { break }\n    }\n\n    // Build up a reverse change object to add to the opposite history\n    // stack (redo when undoing, and vice versa).\n    var antiChanges = [];\n    pushSelectionToHistory(selAfter, dest);\n    dest.push({changes: antiChanges, generation: hist.generation});\n    hist.generation = event.generation || ++hist.maxGeneration;\n\n    var filter = hasHandler(doc, \"beforeChange\") || doc.cm && hasHandler(doc.cm, \"beforeChange\");\n\n    var loop = function ( i ) {\n      var change = event.changes[i];\n      change.origin = type;\n      if (filter && !filterChange(doc, change, false)) {\n        source.length = 0;\n        return {}\n      }\n\n      antiChanges.push(historyChangeFromChange(doc, change));\n\n      var after = i ? computeSelAfterChange(doc, change) : lst(source);\n      makeChangeSingleDoc(doc, change, after, mergeOldSpans(doc, change));\n      if (!i && doc.cm) { doc.cm.scrollIntoView({from: change.from, to: changeEnd(change)}); }\n      var rebased = [];\n\n      // Propagate to the linked documents\n      linkedDocs(doc, function (doc, sharedHist) {\n        if (!sharedHist && indexOf(rebased, doc.history) == -1) {\n          rebaseHist(doc.history, change);\n          rebased.push(doc.history);\n        }\n        makeChangeSingleDoc(doc, change, null, mergeOldSpans(doc, change));\n      });\n    };\n\n    for (var i$1 = event.changes.length - 1; i$1 >= 0; --i$1) {\n      var returned = loop( i$1 );\n\n      if ( returned ) return returned.v;\n    }\n  }\n\n  // Sub-views need their line numbers shifted when text is added\n  // above or below them in the parent document.\n  function shiftDoc(doc, distance) {\n    if (distance == 0) { return }\n    doc.first += distance;\n    doc.sel = new Selection(map(doc.sel.ranges, function (range) { return new Range(\n      Pos(range.anchor.line + distance, range.anchor.ch),\n      Pos(range.head.line + distance, range.head.ch)\n    ); }), doc.sel.primIndex);\n    if (doc.cm) {\n      regChange(doc.cm, doc.first, doc.first - distance, distance);\n      for (var d = doc.cm.display, l = d.viewFrom; l < d.viewTo; l++)\n        { regLineChange(doc.cm, l, \"gutter\"); }\n    }\n  }\n\n  // More lower-level change function, handling only a single document\n  // (not linked ones).\n  function makeChangeSingleDoc(doc, change, selAfter, spans) {\n    if (doc.cm && !doc.cm.curOp)\n      { return operation(doc.cm, makeChangeSingleDoc)(doc, change, selAfter, spans) }\n\n    if (change.to.line < doc.first) {\n      shiftDoc(doc, change.text.length - 1 - (change.to.line - change.from.line));\n      return\n    }\n    if (change.from.line > doc.lastLine()) { return }\n\n    // Clip the change to the size of this doc\n    if (change.from.line < doc.first) {\n      var shift = change.text.length - 1 - (doc.first - change.from.line);\n      shiftDoc(doc, shift);\n      change = {from: Pos(doc.first, 0), to: Pos(change.to.line + shift, change.to.ch),\n                text: [lst(change.text)], origin: change.origin};\n    }\n    var last = doc.lastLine();\n    if (change.to.line > last) {\n      change = {from: change.from, to: Pos(last, getLine(doc, last).text.length),\n                text: [change.text[0]], origin: change.origin};\n    }\n\n    change.removed = getBetween(doc, change.from, change.to);\n\n    if (!selAfter) { selAfter = computeSelAfterChange(doc, change); }\n    if (doc.cm) { makeChangeSingleDocInEditor(doc.cm, change, spans); }\n    else { updateDoc(doc, change, spans); }\n    setSelectionNoUndo(doc, selAfter, sel_dontScroll);\n\n    if (doc.cantEdit && skipAtomic(doc, Pos(doc.firstLine(), 0)))\n      { doc.cantEdit = false; }\n  }\n\n  // Handle the interaction of a change to a document with the editor\n  // that this document is part of.\n  function makeChangeSingleDocInEditor(cm, change, spans) {\n    var doc = cm.doc, display = cm.display, from = change.from, to = change.to;\n\n    var recomputeMaxLength = false, checkWidthStart = from.line;\n    if (!cm.options.lineWrapping) {\n      checkWidthStart = lineNo(visualLine(getLine(doc, from.line)));\n      doc.iter(checkWidthStart, to.line + 1, function (line) {\n        if (line == display.maxLine) {\n          recomputeMaxLength = true;\n          return true\n        }\n      });\n    }\n\n    if (doc.sel.contains(change.from, change.to) > -1)\n      { signalCursorActivity(cm); }\n\n    updateDoc(doc, change, spans, estimateHeight(cm));\n\n    if (!cm.options.lineWrapping) {\n      doc.iter(checkWidthStart, from.line + change.text.length, function (line) {\n        var len = lineLength(line);\n        if (len > display.maxLineLength) {\n          display.maxLine = line;\n          display.maxLineLength = len;\n          display.maxLineChanged = true;\n          recomputeMaxLength = false;\n        }\n      });\n      if (recomputeMaxLength) { cm.curOp.updateMaxLine = true; }\n    }\n\n    retreatFrontier(doc, from.line);\n    startWorker(cm, 400);\n\n    var lendiff = change.text.length - (to.line - from.line) - 1;\n    // Remember that these lines changed, for updating the display\n    if (change.full)\n      { regChange(cm); }\n    else if (from.line == to.line && change.text.length == 1 && !isWholeLineUpdate(cm.doc, change))\n      { regLineChange(cm, from.line, \"text\"); }\n    else\n      { regChange(cm, from.line, to.line + 1, lendiff); }\n\n    var changesHandler = hasHandler(cm, \"changes\"), changeHandler = hasHandler(cm, \"change\");\n    if (changeHandler || changesHandler) {\n      var obj = {\n        from: from, to: to,\n        text: change.text,\n        removed: change.removed,\n        origin: change.origin\n      };\n      if (changeHandler) { signalLater(cm, \"change\", cm, obj); }\n      if (changesHandler) { (cm.curOp.changeObjs || (cm.curOp.changeObjs = [])).push(obj); }\n    }\n    cm.display.selForContextMenu = null;\n  }\n\n  function replaceRange(doc, code, from, to, origin) {\n    var assign;\n\n    if (!to) { to = from; }\n    if (cmp(to, from) < 0) { (assign = [to, from], from = assign[0], to = assign[1]); }\n    if (typeof code == \"string\") { code = doc.splitLines(code); }\n    makeChange(doc, {from: from, to: to, text: code, origin: origin});\n  }\n\n  // Rebasing/resetting history to deal with externally-sourced changes\n\n  function rebaseHistSelSingle(pos, from, to, diff) {\n    if (to < pos.line) {\n      pos.line += diff;\n    } else if (from < pos.line) {\n      pos.line = from;\n      pos.ch = 0;\n    }\n  }\n\n  // Tries to rebase an array of history events given a change in the\n  // document. If the change touches the same lines as the event, the\n  // event, and everything 'behind' it, is discarded. If the change is\n  // before the event, the event's positions are updated. Uses a\n  // copy-on-write scheme for the positions, to avoid having to\n  // reallocate them all on every rebase, but also avoid problems with\n  // shared position objects being unsafely updated.\n  function rebaseHistArray(array, from, to, diff) {\n    for (var i = 0; i < array.length; ++i) {\n      var sub = array[i], ok = true;\n      if (sub.ranges) {\n        if (!sub.copied) { sub = array[i] = sub.deepCopy(); sub.copied = true; }\n        for (var j = 0; j < sub.ranges.length; j++) {\n          rebaseHistSelSingle(sub.ranges[j].anchor, from, to, diff);\n          rebaseHistSelSingle(sub.ranges[j].head, from, to, diff);\n        }\n        continue\n      }\n      for (var j$1 = 0; j$1 < sub.changes.length; ++j$1) {\n        var cur = sub.changes[j$1];\n        if (to < cur.from.line) {\n          cur.from = Pos(cur.from.line + diff, cur.from.ch);\n          cur.to = Pos(cur.to.line + diff, cur.to.ch);\n        } else if (from <= cur.to.line) {\n          ok = false;\n          break\n        }\n      }\n      if (!ok) {\n        array.splice(0, i + 1);\n        i = 0;\n      }\n    }\n  }\n\n  function rebaseHist(hist, change) {\n    var from = change.from.line, to = change.to.line, diff = change.text.length - (to - from) - 1;\n    rebaseHistArray(hist.done, from, to, diff);\n    rebaseHistArray(hist.undone, from, to, diff);\n  }\n\n  // Utility for applying a change to a line by handle or number,\n  // returning the number and optionally registering the line as\n  // changed.\n  function changeLine(doc, handle, changeType, op) {\n    var no = handle, line = handle;\n    if (typeof handle == \"number\") { line = getLine(doc, clipLine(doc, handle)); }\n    else { no = lineNo(handle); }\n    if (no == null) { return null }\n    if (op(line, no) && doc.cm) { regLineChange(doc.cm, no, changeType); }\n    return line\n  }\n\n  // The document is represented as a BTree consisting of leaves, with\n  // chunk of lines in them, and branches, with up to ten leaves or\n  // other branch nodes below them. The top node is always a branch\n  // node, and is the document object itself (meaning it has\n  // additional methods and properties).\n  //\n  // All nodes have parent links. The tree is used both to go from\n  // line numbers to line objects, and to go from objects to numbers.\n  // It also indexes by height, and is used to convert between height\n  // and line object, and to find the total height of the document.\n  //\n  // See also http://marijnhaverbeke.nl/blog/codemirror-line-tree.html\n\n  function LeafChunk(lines) {\n    this.lines = lines;\n    this.parent = null;\n    var height = 0;\n    for (var i = 0; i < lines.length; ++i) {\n      lines[i].parent = this;\n      height += lines[i].height;\n    }\n    this.height = height;\n  }\n\n  LeafChunk.prototype = {\n    chunkSize: function() { return this.lines.length },\n\n    // Remove the n lines at offset 'at'.\n    removeInner: function(at, n) {\n      for (var i = at, e = at + n; i < e; ++i) {\n        var line = this.lines[i];\n        this.height -= line.height;\n        cleanUpLine(line);\n        signalLater(line, \"delete\");\n      }\n      this.lines.splice(at, n);\n    },\n\n    // Helper used to collapse a small branch into a single leaf.\n    collapse: function(lines) {\n      lines.push.apply(lines, this.lines);\n    },\n\n    // Insert the given array of lines at offset 'at', count them as\n    // having the given height.\n    insertInner: function(at, lines, height) {\n      this.height += height;\n      this.lines = this.lines.slice(0, at).concat(lines).concat(this.lines.slice(at));\n      for (var i = 0; i < lines.length; ++i) { lines[i].parent = this; }\n    },\n\n    // Used to iterate over a part of the tree.\n    iterN: function(at, n, op) {\n      for (var e = at + n; at < e; ++at)\n        { if (op(this.lines[at])) { return true } }\n    }\n  };\n\n  function BranchChunk(children) {\n    this.children = children;\n    var size = 0, height = 0;\n    for (var i = 0; i < children.length; ++i) {\n      var ch = children[i];\n      size += ch.chunkSize(); height += ch.height;\n      ch.parent = this;\n    }\n    this.size = size;\n    this.height = height;\n    this.parent = null;\n  }\n\n  BranchChunk.prototype = {\n    chunkSize: function() { return this.size },\n\n    removeInner: function(at, n) {\n      this.size -= n;\n      for (var i = 0; i < this.children.length; ++i) {\n        var child = this.children[i], sz = child.chunkSize();\n        if (at < sz) {\n          var rm = Math.min(n, sz - at), oldHeight = child.height;\n          child.removeInner(at, rm);\n          this.height -= oldHeight - child.height;\n          if (sz == rm) { this.children.splice(i--, 1); child.parent = null; }\n          if ((n -= rm) == 0) { break }\n          at = 0;\n        } else { at -= sz; }\n      }\n      // If the result is smaller than 25 lines, ensure that it is a\n      // single leaf node.\n      if (this.size - n < 25 &&\n          (this.children.length > 1 || !(this.children[0] instanceof LeafChunk))) {\n        var lines = [];\n        this.collapse(lines);\n        this.children = [new LeafChunk(lines)];\n        this.children[0].parent = this;\n      }\n    },\n\n    collapse: function(lines) {\n      for (var i = 0; i < this.children.length; ++i) { this.children[i].collapse(lines); }\n    },\n\n    insertInner: function(at, lines, height) {\n      this.size += lines.length;\n      this.height += height;\n      for (var i = 0; i < this.children.length; ++i) {\n        var child = this.children[i], sz = child.chunkSize();\n        if (at <= sz) {\n          child.insertInner(at, lines, height);\n          if (child.lines && child.lines.length > 50) {\n            // To avoid memory thrashing when child.lines is huge (e.g. first view of a large file), it's never spliced.\n            // Instead, small slices are taken. They're taken in order because sequential memory accesses are fastest.\n            var remaining = child.lines.length % 25 + 25;\n            for (var pos = remaining; pos < child.lines.length;) {\n              var leaf = new LeafChunk(child.lines.slice(pos, pos += 25));\n              child.height -= leaf.height;\n              this.children.splice(++i, 0, leaf);\n              leaf.parent = this;\n            }\n            child.lines = child.lines.slice(0, remaining);\n            this.maybeSpill();\n          }\n          break\n        }\n        at -= sz;\n      }\n    },\n\n    // When a node has grown, check whether it should be split.\n    maybeSpill: function() {\n      if (this.children.length <= 10) { return }\n      var me = this;\n      do {\n        var spilled = me.children.splice(me.children.length - 5, 5);\n        var sibling = new BranchChunk(spilled);\n        if (!me.parent) { // Become the parent node\n          var copy = new BranchChunk(me.children);\n          copy.parent = me;\n          me.children = [copy, sibling];\n          me = copy;\n       } else {\n          me.size -= sibling.size;\n          me.height -= sibling.height;\n          var myIndex = indexOf(me.parent.children, me);\n          me.parent.children.splice(myIndex + 1, 0, sibling);\n        }\n        sibling.parent = me.parent;\n      } while (me.children.length > 10)\n      me.parent.maybeSpill();\n    },\n\n    iterN: function(at, n, op) {\n      for (var i = 0; i < this.children.length; ++i) {\n        var child = this.children[i], sz = child.chunkSize();\n        if (at < sz) {\n          var used = Math.min(n, sz - at);\n          if (child.iterN(at, used, op)) { return true }\n          if ((n -= used) == 0) { break }\n          at = 0;\n        } else { at -= sz; }\n      }\n    }\n  };\n\n  // Line widgets are block elements displayed above or below a line.\n\n  var LineWidget = function(doc, node, options) {\n    if (options) { for (var opt in options) { if (options.hasOwnProperty(opt))\n      { this[opt] = options[opt]; } } }\n    this.doc = doc;\n    this.node = node;\n  };\n\n  LineWidget.prototype.clear = function () {\n    var cm = this.doc.cm, ws = this.line.widgets, line = this.line, no = lineNo(line);\n    if (no == null || !ws) { return }\n    for (var i = 0; i < ws.length; ++i) { if (ws[i] == this) { ws.splice(i--, 1); } }\n    if (!ws.length) { line.widgets = null; }\n    var height = widgetHeight(this);\n    updateLineHeight(line, Math.max(0, line.height - height));\n    if (cm) {\n      runInOp(cm, function () {\n        adjustScrollWhenAboveVisible(cm, line, -height);\n        regLineChange(cm, no, \"widget\");\n      });\n      signalLater(cm, \"lineWidgetCleared\", cm, this, no);\n    }\n  };\n\n  LineWidget.prototype.changed = function () {\n      var this$1 = this;\n\n    var oldH = this.height, cm = this.doc.cm, line = this.line;\n    this.height = null;\n    var diff = widgetHeight(this) - oldH;\n    if (!diff) { return }\n    if (!lineIsHidden(this.doc, line)) { updateLineHeight(line, line.height + diff); }\n    if (cm) {\n      runInOp(cm, function () {\n        cm.curOp.forceUpdate = true;\n        adjustScrollWhenAboveVisible(cm, line, diff);\n        signalLater(cm, \"lineWidgetChanged\", cm, this$1, lineNo(line));\n      });\n    }\n  };\n  eventMixin(LineWidget);\n\n  function adjustScrollWhenAboveVisible(cm, line, diff) {\n    if (heightAtLine(line) < ((cm.curOp && cm.curOp.scrollTop) || cm.doc.scrollTop))\n      { addToScrollTop(cm, diff); }\n  }\n\n  function addLineWidget(doc, handle, node, options) {\n    var widget = new LineWidget(doc, node, options);\n    var cm = doc.cm;\n    if (cm && widget.noHScroll) { cm.display.alignWidgets = true; }\n    changeLine(doc, handle, \"widget\", function (line) {\n      var widgets = line.widgets || (line.widgets = []);\n      if (widget.insertAt == null) { widgets.push(widget); }\n      else { widgets.splice(Math.min(widgets.length, Math.max(0, widget.insertAt)), 0, widget); }\n      widget.line = line;\n      if (cm && !lineIsHidden(doc, line)) {\n        var aboveVisible = heightAtLine(line) < doc.scrollTop;\n        updateLineHeight(line, line.height + widgetHeight(widget));\n        if (aboveVisible) { addToScrollTop(cm, widget.height); }\n        cm.curOp.forceUpdate = true;\n      }\n      return true\n    });\n    if (cm) { signalLater(cm, \"lineWidgetAdded\", cm, widget, typeof handle == \"number\" ? handle : lineNo(handle)); }\n    return widget\n  }\n\n  // TEXTMARKERS\n\n  // Created with markText and setBookmark methods. A TextMarker is a\n  // handle that can be used to clear or find a marked position in the\n  // document. Line objects hold arrays (markedSpans) containing\n  // {from, to, marker} object pointing to such marker objects, and\n  // indicating that such a marker is present on that line. Multiple\n  // lines may point to the same marker when it spans across lines.\n  // The spans will have null for their from/to properties when the\n  // marker continues beyond the start/end of the line. Markers have\n  // links back to the lines they currently touch.\n\n  // Collapsed markers have unique ids, in order to be able to order\n  // them, which is needed for uniquely determining an outer marker\n  // when they overlap (they may nest, but not partially overlap).\n  var nextMarkerId = 0;\n\n  var TextMarker = function(doc, type) {\n    this.lines = [];\n    this.type = type;\n    this.doc = doc;\n    this.id = ++nextMarkerId;\n  };\n\n  // Clear the marker.\n  TextMarker.prototype.clear = function () {\n    if (this.explicitlyCleared) { return }\n    var cm = this.doc.cm, withOp = cm && !cm.curOp;\n    if (withOp) { startOperation(cm); }\n    if (hasHandler(this, \"clear\")) {\n      var found = this.find();\n      if (found) { signalLater(this, \"clear\", found.from, found.to); }\n    }\n    var min = null, max = null;\n    for (var i = 0; i < this.lines.length; ++i) {\n      var line = this.lines[i];\n      var span = getMarkedSpanFor(line.markedSpans, this);\n      if (cm && !this.collapsed) { regLineChange(cm, lineNo(line), \"text\"); }\n      else if (cm) {\n        if (span.to != null) { max = lineNo(line); }\n        if (span.from != null) { min = lineNo(line); }\n      }\n      line.markedSpans = removeMarkedSpan(line.markedSpans, span);\n      if (span.from == null && this.collapsed && !lineIsHidden(this.doc, line) && cm)\n        { updateLineHeight(line, textHeight(cm.display)); }\n    }\n    if (cm && this.collapsed && !cm.options.lineWrapping) { for (var i$1 = 0; i$1 < this.lines.length; ++i$1) {\n      var visual = visualLine(this.lines[i$1]), len = lineLength(visual);\n      if (len > cm.display.maxLineLength) {\n        cm.display.maxLine = visual;\n        cm.display.maxLineLength = len;\n        cm.display.maxLineChanged = true;\n      }\n    } }\n\n    if (min != null && cm && this.collapsed) { regChange(cm, min, max + 1); }\n    this.lines.length = 0;\n    this.explicitlyCleared = true;\n    if (this.atomic && this.doc.cantEdit) {\n      this.doc.cantEdit = false;\n      if (cm) { reCheckSelection(cm.doc); }\n    }\n    if (cm) { signalLater(cm, \"markerCleared\", cm, this, min, max); }\n    if (withOp) { endOperation(cm); }\n    if (this.parent) { this.parent.clear(); }\n  };\n\n  // Find the position of the marker in the document. Returns a {from,\n  // to} object by default. Side can be passed to get a specific side\n  // -- 0 (both), -1 (left), or 1 (right). When lineObj is true, the\n  // Pos objects returned contain a line object, rather than a line\n  // number (used to prevent looking up the same line twice).\n  TextMarker.prototype.find = function (side, lineObj) {\n    if (side == null && this.type == \"bookmark\") { side = 1; }\n    var from, to;\n    for (var i = 0; i < this.lines.length; ++i) {\n      var line = this.lines[i];\n      var span = getMarkedSpanFor(line.markedSpans, this);\n      if (span.from != null) {\n        from = Pos(lineObj ? line : lineNo(line), span.from);\n        if (side == -1) { return from }\n      }\n      if (span.to != null) {\n        to = Pos(lineObj ? line : lineNo(line), span.to);\n        if (side == 1) { return to }\n      }\n    }\n    return from && {from: from, to: to}\n  };\n\n  // Signals that the marker's widget changed, and surrounding layout\n  // should be recomputed.\n  TextMarker.prototype.changed = function () {\n      var this$1 = this;\n\n    var pos = this.find(-1, true), widget = this, cm = this.doc.cm;\n    if (!pos || !cm) { return }\n    runInOp(cm, function () {\n      var line = pos.line, lineN = lineNo(pos.line);\n      var view = findViewForLine(cm, lineN);\n      if (view) {\n        clearLineMeasurementCacheFor(view);\n        cm.curOp.selectionChanged = cm.curOp.forceUpdate = true;\n      }\n      cm.curOp.updateMaxLine = true;\n      if (!lineIsHidden(widget.doc, line) && widget.height != null) {\n        var oldHeight = widget.height;\n        widget.height = null;\n        var dHeight = widgetHeight(widget) - oldHeight;\n        if (dHeight)\n          { updateLineHeight(line, line.height + dHeight); }\n      }\n      signalLater(cm, \"markerChanged\", cm, this$1);\n    });\n  };\n\n  TextMarker.prototype.attachLine = function (line) {\n    if (!this.lines.length && this.doc.cm) {\n      var op = this.doc.cm.curOp;\n      if (!op.maybeHiddenMarkers || indexOf(op.maybeHiddenMarkers, this) == -1)\n        { (op.maybeUnhiddenMarkers || (op.maybeUnhiddenMarkers = [])).push(this); }\n    }\n    this.lines.push(line);\n  };\n\n  TextMarker.prototype.detachLine = function (line) {\n    this.lines.splice(indexOf(this.lines, line), 1);\n    if (!this.lines.length && this.doc.cm) {\n      var op = this.doc.cm.curOp\n      ;(op.maybeHiddenMarkers || (op.maybeHiddenMarkers = [])).push(this);\n    }\n  };\n  eventMixin(TextMarker);\n\n  // Create a marker, wire it up to the right lines, and\n  function markText(doc, from, to, options, type) {\n    // Shared markers (across linked documents) are handled separately\n    // (markTextShared will call out to this again, once per\n    // document).\n    if (options && options.shared) { return markTextShared(doc, from, to, options, type) }\n    // Ensure we are in an operation.\n    if (doc.cm && !doc.cm.curOp) { return operation(doc.cm, markText)(doc, from, to, options, type) }\n\n    var marker = new TextMarker(doc, type), diff = cmp(from, to);\n    if (options) { copyObj(options, marker, false); }\n    // Don't connect empty markers unless clearWhenEmpty is false\n    if (diff > 0 || diff == 0 && marker.clearWhenEmpty !== false)\n      { return marker }\n    if (marker.replacedWith) {\n      // Showing up as a widget implies collapsed (widget replaces text)\n      marker.collapsed = true;\n      marker.widgetNode = eltP(\"span\", [marker.replacedWith], \"CodeMirror-widget\");\n      if (!options.handleMouseEvents) { marker.widgetNode.setAttribute(\"cm-ignore-events\", \"true\"); }\n      if (options.insertLeft) { marker.widgetNode.insertLeft = true; }\n    }\n    if (marker.collapsed) {\n      if (conflictingCollapsedRange(doc, from.line, from, to, marker) ||\n          from.line != to.line && conflictingCollapsedRange(doc, to.line, from, to, marker))\n        { throw new Error(\"Inserting collapsed marker partially overlapping an existing one\") }\n      seeCollapsedSpans();\n    }\n\n    if (marker.addToHistory)\n      { addChangeToHistory(doc, {from: from, to: to, origin: \"markText\"}, doc.sel, NaN); }\n\n    var curLine = from.line, cm = doc.cm, updateMaxLine;\n    doc.iter(curLine, to.line + 1, function (line) {\n      if (cm && marker.collapsed && !cm.options.lineWrapping && visualLine(line) == cm.display.maxLine)\n        { updateMaxLine = true; }\n      if (marker.collapsed && curLine != from.line) { updateLineHeight(line, 0); }\n      addMarkedSpan(line, new MarkedSpan(marker,\n                                         curLine == from.line ? from.ch : null,\n                                         curLine == to.line ? to.ch : null));\n      ++curLine;\n    });\n    // lineIsHidden depends on the presence of the spans, so needs a second pass\n    if (marker.collapsed) { doc.iter(from.line, to.line + 1, function (line) {\n      if (lineIsHidden(doc, line)) { updateLineHeight(line, 0); }\n    }); }\n\n    if (marker.clearOnEnter) { on(marker, \"beforeCursorEnter\", function () { return marker.clear(); }); }\n\n    if (marker.readOnly) {\n      seeReadOnlySpans();\n      if (doc.history.done.length || doc.history.undone.length)\n        { doc.clearHistory(); }\n    }\n    if (marker.collapsed) {\n      marker.id = ++nextMarkerId;\n      marker.atomic = true;\n    }\n    if (cm) {\n      // Sync editor state\n      if (updateMaxLine) { cm.curOp.updateMaxLine = true; }\n      if (marker.collapsed)\n        { regChange(cm, from.line, to.line + 1); }\n      else if (marker.className || marker.startStyle || marker.endStyle || marker.css ||\n               marker.attributes || marker.title)\n        { for (var i = from.line; i <= to.line; i++) { regLineChange(cm, i, \"text\"); } }\n      if (marker.atomic) { reCheckSelection(cm.doc); }\n      signalLater(cm, \"markerAdded\", cm, marker);\n    }\n    return marker\n  }\n\n  // SHARED TEXTMARKERS\n\n  // A shared marker spans multiple linked documents. It is\n  // implemented as a meta-marker-object controlling multiple normal\n  // markers.\n  var SharedTextMarker = function(markers, primary) {\n    this.markers = markers;\n    this.primary = primary;\n    for (var i = 0; i < markers.length; ++i)\n      { markers[i].parent = this; }\n  };\n\n  SharedTextMarker.prototype.clear = function () {\n    if (this.explicitlyCleared) { return }\n    this.explicitlyCleared = true;\n    for (var i = 0; i < this.markers.length; ++i)\n      { this.markers[i].clear(); }\n    signalLater(this, \"clear\");\n  };\n\n  SharedTextMarker.prototype.find = function (side, lineObj) {\n    return this.primary.find(side, lineObj)\n  };\n  eventMixin(SharedTextMarker);\n\n  function markTextShared(doc, from, to, options, type) {\n    options = copyObj(options);\n    options.shared = false;\n    var markers = [markText(doc, from, to, options, type)], primary = markers[0];\n    var widget = options.widgetNode;\n    linkedDocs(doc, function (doc) {\n      if (widget) { options.widgetNode = widget.cloneNode(true); }\n      markers.push(markText(doc, clipPos(doc, from), clipPos(doc, to), options, type));\n      for (var i = 0; i < doc.linked.length; ++i)\n        { if (doc.linked[i].isParent) { return } }\n      primary = lst(markers);\n    });\n    return new SharedTextMarker(markers, primary)\n  }\n\n  function findSharedMarkers(doc) {\n    return doc.findMarks(Pos(doc.first, 0), doc.clipPos(Pos(doc.lastLine())), function (m) { return m.parent; })\n  }\n\n  function copySharedMarkers(doc, markers) {\n    for (var i = 0; i < markers.length; i++) {\n      var marker = markers[i], pos = marker.find();\n      var mFrom = doc.clipPos(pos.from), mTo = doc.clipPos(pos.to);\n      if (cmp(mFrom, mTo)) {\n        var subMark = markText(doc, mFrom, mTo, marker.primary, marker.primary.type);\n        marker.markers.push(subMark);\n        subMark.parent = marker;\n      }\n    }\n  }\n\n  function detachSharedMarkers(markers) {\n    var loop = function ( i ) {\n      var marker = markers[i], linked = [marker.primary.doc];\n      linkedDocs(marker.primary.doc, function (d) { return linked.push(d); });\n      for (var j = 0; j < marker.markers.length; j++) {\n        var subMarker = marker.markers[j];\n        if (indexOf(linked, subMarker.doc) == -1) {\n          subMarker.parent = null;\n          marker.markers.splice(j--, 1);\n        }\n      }\n    };\n\n    for (var i = 0; i < markers.length; i++) loop( i );\n  }\n\n  var nextDocId = 0;\n  var Doc = function(text, mode, firstLine, lineSep, direction) {\n    if (!(this instanceof Doc)) { return new Doc(text, mode, firstLine, lineSep, direction) }\n    if (firstLine == null) { firstLine = 0; }\n\n    BranchChunk.call(this, [new LeafChunk([new Line(\"\", null)])]);\n    this.first = firstLine;\n    this.scrollTop = this.scrollLeft = 0;\n    this.cantEdit = false;\n    this.cleanGeneration = 1;\n    this.modeFrontier = this.highlightFrontier = firstLine;\n    var start = Pos(firstLine, 0);\n    this.sel = simpleSelection(start);\n    this.history = new History(null);\n    this.id = ++nextDocId;\n    this.modeOption = mode;\n    this.lineSep = lineSep;\n    this.direction = (direction == \"rtl\") ? \"rtl\" : \"ltr\";\n    this.extend = false;\n\n    if (typeof text == \"string\") { text = this.splitLines(text); }\n    updateDoc(this, {from: start, to: start, text: text});\n    setSelection(this, simpleSelection(start), sel_dontScroll);\n  };\n\n  Doc.prototype = createObj(BranchChunk.prototype, {\n    constructor: Doc,\n    // Iterate over the document. Supports two forms -- with only one\n    // argument, it calls that for each line in the document. With\n    // three, it iterates over the range given by the first two (with\n    // the second being non-inclusive).\n    iter: function(from, to, op) {\n      if (op) { this.iterN(from - this.first, to - from, op); }\n      else { this.iterN(this.first, this.first + this.size, from); }\n    },\n\n    // Non-public interface for adding and removing lines.\n    insert: function(at, lines) {\n      var height = 0;\n      for (var i = 0; i < lines.length; ++i) { height += lines[i].height; }\n      this.insertInner(at - this.first, lines, height);\n    },\n    remove: function(at, n) { this.removeInner(at - this.first, n); },\n\n    // From here, the methods are part of the public interface. Most\n    // are also available from CodeMirror (editor) instances.\n\n    getValue: function(lineSep) {\n      var lines = getLines(this, this.first, this.first + this.size);\n      if (lineSep === false) { return lines }\n      return lines.join(lineSep || this.lineSeparator())\n    },\n    setValue: docMethodOp(function(code) {\n      var top = Pos(this.first, 0), last = this.first + this.size - 1;\n      makeChange(this, {from: top, to: Pos(last, getLine(this, last).text.length),\n                        text: this.splitLines(code), origin: \"setValue\", full: true}, true);\n      if (this.cm) { scrollToCoords(this.cm, 0, 0); }\n      setSelection(this, simpleSelection(top), sel_dontScroll);\n    }),\n    replaceRange: function(code, from, to, origin) {\n      from = clipPos(this, from);\n      to = to ? clipPos(this, to) : from;\n      replaceRange(this, code, from, to, origin);\n    },\n    getRange: function(from, to, lineSep) {\n      var lines = getBetween(this, clipPos(this, from), clipPos(this, to));\n      if (lineSep === false) { return lines }\n      return lines.join(lineSep || this.lineSeparator())\n    },\n\n    getLine: function(line) {var l = this.getLineHandle(line); return l && l.text},\n\n    getLineHandle: function(line) {if (isLine(this, line)) { return getLine(this, line) }},\n    getLineNumber: function(line) {return lineNo(line)},\n\n    getLineHandleVisualStart: function(line) {\n      if (typeof line == \"number\") { line = getLine(this, line); }\n      return visualLine(line)\n    },\n\n    lineCount: function() {return this.size},\n    firstLine: function() {return this.first},\n    lastLine: function() {return this.first + this.size - 1},\n\n    clipPos: function(pos) {return clipPos(this, pos)},\n\n    getCursor: function(start) {\n      var range = this.sel.primary(), pos;\n      if (start == null || start == \"head\") { pos = range.head; }\n      else if (start == \"anchor\") { pos = range.anchor; }\n      else if (start == \"end\" || start == \"to\" || start === false) { pos = range.to(); }\n      else { pos = range.from(); }\n      return pos\n    },\n    listSelections: function() { return this.sel.ranges },\n    somethingSelected: function() {return this.sel.somethingSelected()},\n\n    setCursor: docMethodOp(function(line, ch, options) {\n      setSimpleSelection(this, clipPos(this, typeof line == \"number\" ? Pos(line, ch || 0) : line), null, options);\n    }),\n    setSelection: docMethodOp(function(anchor, head, options) {\n      setSimpleSelection(this, clipPos(this, anchor), clipPos(this, head || anchor), options);\n    }),\n    extendSelection: docMethodOp(function(head, other, options) {\n      extendSelection(this, clipPos(this, head), other && clipPos(this, other), options);\n    }),\n    extendSelections: docMethodOp(function(heads, options) {\n      extendSelections(this, clipPosArray(this, heads), options);\n    }),\n    extendSelectionsBy: docMethodOp(function(f, options) {\n      var heads = map(this.sel.ranges, f);\n      extendSelections(this, clipPosArray(this, heads), options);\n    }),\n    setSelections: docMethodOp(function(ranges, primary, options) {\n      if (!ranges.length) { return }\n      var out = [];\n      for (var i = 0; i < ranges.length; i++)\n        { out[i] = new Range(clipPos(this, ranges[i].anchor),\n                           clipPos(this, ranges[i].head || ranges[i].anchor)); }\n      if (primary == null) { primary = Math.min(ranges.length - 1, this.sel.primIndex); }\n      setSelection(this, normalizeSelection(this.cm, out, primary), options);\n    }),\n    addSelection: docMethodOp(function(anchor, head, options) {\n      var ranges = this.sel.ranges.slice(0);\n      ranges.push(new Range(clipPos(this, anchor), clipPos(this, head || anchor)));\n      setSelection(this, normalizeSelection(this.cm, ranges, ranges.length - 1), options);\n    }),\n\n    getSelection: function(lineSep) {\n      var ranges = this.sel.ranges, lines;\n      for (var i = 0; i < ranges.length; i++) {\n        var sel = getBetween(this, ranges[i].from(), ranges[i].to());\n        lines = lines ? lines.concat(sel) : sel;\n      }\n      if (lineSep === false) { return lines }\n      else { return lines.join(lineSep || this.lineSeparator()) }\n    },\n    getSelections: function(lineSep) {\n      var parts = [], ranges = this.sel.ranges;\n      for (var i = 0; i < ranges.length; i++) {\n        var sel = getBetween(this, ranges[i].from(), ranges[i].to());\n        if (lineSep !== false) { sel = sel.join(lineSep || this.lineSeparator()); }\n        parts[i] = sel;\n      }\n      return parts\n    },\n    replaceSelection: function(code, collapse, origin) {\n      var dup = [];\n      for (var i = 0; i < this.sel.ranges.length; i++)\n        { dup[i] = code; }\n      this.replaceSelections(dup, collapse, origin || \"+input\");\n    },\n    replaceSelections: docMethodOp(function(code, collapse, origin) {\n      var changes = [], sel = this.sel;\n      for (var i = 0; i < sel.ranges.length; i++) {\n        var range = sel.ranges[i];\n        changes[i] = {from: range.from(), to: range.to(), text: this.splitLines(code[i]), origin: origin};\n      }\n      var newSel = collapse && collapse != \"end\" && computeReplacedSel(this, changes, collapse);\n      for (var i$1 = changes.length - 1; i$1 >= 0; i$1--)\n        { makeChange(this, changes[i$1]); }\n      if (newSel) { setSelectionReplaceHistory(this, newSel); }\n      else if (this.cm) { ensureCursorVisible(this.cm); }\n    }),\n    undo: docMethodOp(function() {makeChangeFromHistory(this, \"undo\");}),\n    redo: docMethodOp(function() {makeChangeFromHistory(this, \"redo\");}),\n    undoSelection: docMethodOp(function() {makeChangeFromHistory(this, \"undo\", true);}),\n    redoSelection: docMethodOp(function() {makeChangeFromHistory(this, \"redo\", true);}),\n\n    setExtending: function(val) {this.extend = val;},\n    getExtending: function() {return this.extend},\n\n    historySize: function() {\n      var hist = this.history, done = 0, undone = 0;\n      for (var i = 0; i < hist.done.length; i++) { if (!hist.done[i].ranges) { ++done; } }\n      for (var i$1 = 0; i$1 < hist.undone.length; i$1++) { if (!hist.undone[i$1].ranges) { ++undone; } }\n      return {undo: done, redo: undone}\n    },\n    clearHistory: function() {\n      var this$1 = this;\n\n      this.history = new History(this.history);\n      linkedDocs(this, function (doc) { return doc.history = this$1.history; }, true);\n    },\n\n    markClean: function() {\n      this.cleanGeneration = this.changeGeneration(true);\n    },\n    changeGeneration: function(forceSplit) {\n      if (forceSplit)\n        { this.history.lastOp = this.history.lastSelOp = this.history.lastOrigin = null; }\n      return this.history.generation\n    },\n    isClean: function (gen) {\n      return this.history.generation == (gen || this.cleanGeneration)\n    },\n\n    getHistory: function() {\n      return {done: copyHistoryArray(this.history.done),\n              undone: copyHistoryArray(this.history.undone)}\n    },\n    setHistory: function(histData) {\n      var hist = this.history = new History(this.history);\n      hist.done = copyHistoryArray(histData.done.slice(0), null, true);\n      hist.undone = copyHistoryArray(histData.undone.slice(0), null, true);\n    },\n\n    setGutterMarker: docMethodOp(function(line, gutterID, value) {\n      return changeLine(this, line, \"gutter\", function (line) {\n        var markers = line.gutterMarkers || (line.gutterMarkers = {});\n        markers[gutterID] = value;\n        if (!value && isEmpty(markers)) { line.gutterMarkers = null; }\n        return true\n      })\n    }),\n\n    clearGutter: docMethodOp(function(gutterID) {\n      var this$1 = this;\n\n      this.iter(function (line) {\n        if (line.gutterMarkers && line.gutterMarkers[gutterID]) {\n          changeLine(this$1, line, \"gutter\", function () {\n            line.gutterMarkers[gutterID] = null;\n            if (isEmpty(line.gutterMarkers)) { line.gutterMarkers = null; }\n            return true\n          });\n        }\n      });\n    }),\n\n    lineInfo: function(line) {\n      var n;\n      if (typeof line == \"number\") {\n        if (!isLine(this, line)) { return null }\n        n = line;\n        line = getLine(this, line);\n        if (!line) { return null }\n      } else {\n        n = lineNo(line);\n        if (n == null) { return null }\n      }\n      return {line: n, handle: line, text: line.text, gutterMarkers: line.gutterMarkers,\n              textClass: line.textClass, bgClass: line.bgClass, wrapClass: line.wrapClass,\n              widgets: line.widgets}\n    },\n\n    addLineClass: docMethodOp(function(handle, where, cls) {\n      return changeLine(this, handle, where == \"gutter\" ? \"gutter\" : \"class\", function (line) {\n        var prop = where == \"text\" ? \"textClass\"\n                 : where == \"background\" ? \"bgClass\"\n                 : where == \"gutter\" ? \"gutterClass\" : \"wrapClass\";\n        if (!line[prop]) { line[prop] = cls; }\n        else if (classTest(cls).test(line[prop])) { return false }\n        else { line[prop] += \" \" + cls; }\n        return true\n      })\n    }),\n    removeLineClass: docMethodOp(function(handle, where, cls) {\n      return changeLine(this, handle, where == \"gutter\" ? \"gutter\" : \"class\", function (line) {\n        var prop = where == \"text\" ? \"textClass\"\n                 : where == \"background\" ? \"bgClass\"\n                 : where == \"gutter\" ? \"gutterClass\" : \"wrapClass\";\n        var cur = line[prop];\n        if (!cur) { return false }\n        else if (cls == null) { line[prop] = null; }\n        else {\n          var found = cur.match(classTest(cls));\n          if (!found) { return false }\n          var end = found.index + found[0].length;\n          line[prop] = cur.slice(0, found.index) + (!found.index || end == cur.length ? \"\" : \" \") + cur.slice(end) || null;\n        }\n        return true\n      })\n    }),\n\n    addLineWidget: docMethodOp(function(handle, node, options) {\n      return addLineWidget(this, handle, node, options)\n    }),\n    removeLineWidget: function(widget) { widget.clear(); },\n\n    markText: function(from, to, options) {\n      return markText(this, clipPos(this, from), clipPos(this, to), options, options && options.type || \"range\")\n    },\n    setBookmark: function(pos, options) {\n      var realOpts = {replacedWith: options && (options.nodeType == null ? options.widget : options),\n                      insertLeft: options && options.insertLeft,\n                      clearWhenEmpty: false, shared: options && options.shared,\n                      handleMouseEvents: options && options.handleMouseEvents};\n      pos = clipPos(this, pos);\n      return markText(this, pos, pos, realOpts, \"bookmark\")\n    },\n    findMarksAt: function(pos) {\n      pos = clipPos(this, pos);\n      var markers = [], spans = getLine(this, pos.line).markedSpans;\n      if (spans) { for (var i = 0; i < spans.length; ++i) {\n        var span = spans[i];\n        if ((span.from == null || span.from <= pos.ch) &&\n            (span.to == null || span.to >= pos.ch))\n          { markers.push(span.marker.parent || span.marker); }\n      } }\n      return markers\n    },\n    findMarks: function(from, to, filter) {\n      from = clipPos(this, from); to = clipPos(this, to);\n      var found = [], lineNo = from.line;\n      this.iter(from.line, to.line + 1, function (line) {\n        var spans = line.markedSpans;\n        if (spans) { for (var i = 0; i < spans.length; i++) {\n          var span = spans[i];\n          if (!(span.to != null && lineNo == from.line && from.ch >= span.to ||\n                span.from == null && lineNo != from.line ||\n                span.from != null && lineNo == to.line && span.from >= to.ch) &&\n              (!filter || filter(span.marker)))\n            { found.push(span.marker.parent || span.marker); }\n        } }\n        ++lineNo;\n      });\n      return found\n    },\n    getAllMarks: function() {\n      var markers = [];\n      this.iter(function (line) {\n        var sps = line.markedSpans;\n        if (sps) { for (var i = 0; i < sps.length; ++i)\n          { if (sps[i].from != null) { markers.push(sps[i].marker); } } }\n      });\n      return markers\n    },\n\n    posFromIndex: function(off) {\n      var ch, lineNo = this.first, sepSize = this.lineSeparator().length;\n      this.iter(function (line) {\n        var sz = line.text.length + sepSize;\n        if (sz > off) { ch = off; return true }\n        off -= sz;\n        ++lineNo;\n      });\n      return clipPos(this, Pos(lineNo, ch))\n    },\n    indexFromPos: function (coords) {\n      coords = clipPos(this, coords);\n      var index = coords.ch;\n      if (coords.line < this.first || coords.ch < 0) { return 0 }\n      var sepSize = this.lineSeparator().length;\n      this.iter(this.first, coords.line, function (line) { // iter aborts when callback returns a truthy value\n        index += line.text.length + sepSize;\n      });\n      return index\n    },\n\n    copy: function(copyHistory) {\n      var doc = new Doc(getLines(this, this.first, this.first + this.size),\n                        this.modeOption, this.first, this.lineSep, this.direction);\n      doc.scrollTop = this.scrollTop; doc.scrollLeft = this.scrollLeft;\n      doc.sel = this.sel;\n      doc.extend = false;\n      if (copyHistory) {\n        doc.history.undoDepth = this.history.undoDepth;\n        doc.setHistory(this.getHistory());\n      }\n      return doc\n    },\n\n    linkedDoc: function(options) {\n      if (!options) { options = {}; }\n      var from = this.first, to = this.first + this.size;\n      if (options.from != null && options.from > from) { from = options.from; }\n      if (options.to != null && options.to < to) { to = options.to; }\n      var copy = new Doc(getLines(this, from, to), options.mode || this.modeOption, from, this.lineSep, this.direction);\n      if (options.sharedHist) { copy.history = this.history\n      ; }(this.linked || (this.linked = [])).push({doc: copy, sharedHist: options.sharedHist});\n      copy.linked = [{doc: this, isParent: true, sharedHist: options.sharedHist}];\n      copySharedMarkers(copy, findSharedMarkers(this));\n      return copy\n    },\n    unlinkDoc: function(other) {\n      if (other instanceof CodeMirror) { other = other.doc; }\n      if (this.linked) { for (var i = 0; i < this.linked.length; ++i) {\n        var link = this.linked[i];\n        if (link.doc != other) { continue }\n        this.linked.splice(i, 1);\n        other.unlinkDoc(this);\n        detachSharedMarkers(findSharedMarkers(this));\n        break\n      } }\n      // If the histories were shared, split them again\n      if (other.history == this.history) {\n        var splitIds = [other.id];\n        linkedDocs(other, function (doc) { return splitIds.push(doc.id); }, true);\n        other.history = new History(null);\n        other.history.done = copyHistoryArray(this.history.done, splitIds);\n        other.history.undone = copyHistoryArray(this.history.undone, splitIds);\n      }\n    },\n    iterLinkedDocs: function(f) {linkedDocs(this, f);},\n\n    getMode: function() {return this.mode},\n    getEditor: function() {return this.cm},\n\n    splitLines: function(str) {\n      if (this.lineSep) { return str.split(this.lineSep) }\n      return splitLinesAuto(str)\n    },\n    lineSeparator: function() { return this.lineSep || \"\\n\" },\n\n    setDirection: docMethodOp(function (dir) {\n      if (dir != \"rtl\") { dir = \"ltr\"; }\n      if (dir == this.direction) { return }\n      this.direction = dir;\n      this.iter(function (line) { return line.order = null; });\n      if (this.cm) { directionChanged(this.cm); }\n    })\n  });\n\n  // Public alias.\n  Doc.prototype.eachLine = Doc.prototype.iter;\n\n  // Kludge to work around strange IE behavior where it'll sometimes\n  // re-fire a series of drag-related events right after the drop (#1551)\n  var lastDrop = 0;\n\n  function onDrop(e) {\n    var cm = this;\n    clearDragCursor(cm);\n    if (signalDOMEvent(cm, e) || eventInWidget(cm.display, e))\n      { return }\n    e_preventDefault(e);\n    if (ie) { lastDrop = +new Date; }\n    var pos = posFromMouse(cm, e, true), files = e.dataTransfer.files;\n    if (!pos || cm.isReadOnly()) { return }\n    // Might be a file drop, in which case we simply extract the text\n    // and insert it.\n    if (files && files.length && window.FileReader && window.File) {\n      var n = files.length, text = Array(n), read = 0;\n      var markAsReadAndPasteIfAllFilesAreRead = function () {\n        if (++read == n) {\n          operation(cm, function () {\n            pos = clipPos(cm.doc, pos);\n            var change = {from: pos, to: pos,\n                          text: cm.doc.splitLines(\n                              text.filter(function (t) { return t != null; }).join(cm.doc.lineSeparator())),\n                          origin: \"paste\"};\n            makeChange(cm.doc, change);\n            setSelectionReplaceHistory(cm.doc, simpleSelection(clipPos(cm.doc, pos), clipPos(cm.doc, changeEnd(change))));\n          })();\n        }\n      };\n      var readTextFromFile = function (file, i) {\n        if (cm.options.allowDropFileTypes &&\n            indexOf(cm.options.allowDropFileTypes, file.type) == -1) {\n          markAsReadAndPasteIfAllFilesAreRead();\n          return\n        }\n        var reader = new FileReader;\n        reader.onerror = function () { return markAsReadAndPasteIfAllFilesAreRead(); };\n        reader.onload = function () {\n          var content = reader.result;\n          if (/[\\x00-\\x08\\x0e-\\x1f]{2}/.test(content)) {\n            markAsReadAndPasteIfAllFilesAreRead();\n            return\n          }\n          text[i] = content;\n          markAsReadAndPasteIfAllFilesAreRead();\n        };\n        reader.readAsText(file);\n      };\n      for (var i = 0; i < files.length; i++) { readTextFromFile(files[i], i); }\n    } else { // Normal drop\n      // Don't do a replace if the drop happened inside of the selected text.\n      if (cm.state.draggingText && cm.doc.sel.contains(pos) > -1) {\n        cm.state.draggingText(e);\n        // Ensure the editor is re-focused\n        setTimeout(function () { return cm.display.input.focus(); }, 20);\n        return\n      }\n      try {\n        var text$1 = e.dataTransfer.getData(\"Text\");\n        if (text$1) {\n          var selected;\n          if (cm.state.draggingText && !cm.state.draggingText.copy)\n            { selected = cm.listSelections(); }\n          setSelectionNoUndo(cm.doc, simpleSelection(pos, pos));\n          if (selected) { for (var i$1 = 0; i$1 < selected.length; ++i$1)\n            { replaceRange(cm.doc, \"\", selected[i$1].anchor, selected[i$1].head, \"drag\"); } }\n          cm.replaceSelection(text$1, \"around\", \"paste\");\n          cm.display.input.focus();\n        }\n      }\n      catch(e$1){}\n    }\n  }\n\n  function onDragStart(cm, e) {\n    if (ie && (!cm.state.draggingText || +new Date - lastDrop < 100)) { e_stop(e); return }\n    if (signalDOMEvent(cm, e) || eventInWidget(cm.display, e)) { return }\n\n    e.dataTransfer.setData(\"Text\", cm.getSelection());\n    e.dataTransfer.effectAllowed = \"copyMove\";\n\n    // Use dummy image instead of default browsers image.\n    // Recent Safari (~6.0.2) have a tendency to segfault when this happens, so we don't do it there.\n    if (e.dataTransfer.setDragImage && !safari) {\n      var img = elt(\"img\", null, null, \"position: fixed; left: 0; top: 0;\");\n      img.src = \"data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\";\n      if (presto) {\n        img.width = img.height = 1;\n        cm.display.wrapper.appendChild(img);\n        // Force a relayout, or Opera won't use our image for some obscure reason\n        img._top = img.offsetTop;\n      }\n      e.dataTransfer.setDragImage(img, 0, 0);\n      if (presto) { img.parentNode.removeChild(img); }\n    }\n  }\n\n  function onDragOver(cm, e) {\n    var pos = posFromMouse(cm, e);\n    if (!pos) { return }\n    var frag = document.createDocumentFragment();\n    drawSelectionCursor(cm, pos, frag);\n    if (!cm.display.dragCursor) {\n      cm.display.dragCursor = elt(\"div\", null, \"CodeMirror-cursors CodeMirror-dragcursors\");\n      cm.display.lineSpace.insertBefore(cm.display.dragCursor, cm.display.cursorDiv);\n    }\n    removeChildrenAndAdd(cm.display.dragCursor, frag);\n  }\n\n  function clearDragCursor(cm) {\n    if (cm.display.dragCursor) {\n      cm.display.lineSpace.removeChild(cm.display.dragCursor);\n      cm.display.dragCursor = null;\n    }\n  }\n\n  // These must be handled carefully, because naively registering a\n  // handler for each editor will cause the editors to never be\n  // garbage collected.\n\n  function forEachCodeMirror(f) {\n    if (!document.getElementsByClassName) { return }\n    var byClass = document.getElementsByClassName(\"CodeMirror\"), editors = [];\n    for (var i = 0; i < byClass.length; i++) {\n      var cm = byClass[i].CodeMirror;\n      if (cm) { editors.push(cm); }\n    }\n    if (editors.length) { editors[0].operation(function () {\n      for (var i = 0; i < editors.length; i++) { f(editors[i]); }\n    }); }\n  }\n\n  var globalsRegistered = false;\n  function ensureGlobalHandlers() {\n    if (globalsRegistered) { return }\n    registerGlobalHandlers();\n    globalsRegistered = true;\n  }\n  function registerGlobalHandlers() {\n    // When the window resizes, we need to refresh active editors.\n    var resizeTimer;\n    on(window, \"resize\", function () {\n      if (resizeTimer == null) { resizeTimer = setTimeout(function () {\n        resizeTimer = null;\n        forEachCodeMirror(onResize);\n      }, 100); }\n    });\n    // When the window loses focus, we want to show the editor as blurred\n    on(window, \"blur\", function () { return forEachCodeMirror(onBlur); });\n  }\n  // Called when the window resizes\n  function onResize(cm) {\n    var d = cm.display;\n    // Might be a text scaling operation, clear size caches.\n    d.cachedCharWidth = d.cachedTextHeight = d.cachedPaddingH = null;\n    d.scrollbarsClipped = false;\n    cm.setSize();\n  }\n\n  var keyNames = {\n    3: \"Pause\", 8: \"Backspace\", 9: \"Tab\", 13: \"Enter\", 16: \"Shift\", 17: \"Ctrl\", 18: \"Alt\",\n    19: \"Pause\", 20: \"CapsLock\", 27: \"Esc\", 32: \"Space\", 33: \"PageUp\", 34: \"PageDown\", 35: \"End\",\n    36: \"Home\", 37: \"Left\", 38: \"Up\", 39: \"Right\", 40: \"Down\", 44: \"PrintScrn\", 45: \"Insert\",\n    46: \"Delete\", 59: \";\", 61: \"=\", 91: \"Mod\", 92: \"Mod\", 93: \"Mod\",\n    106: \"*\", 107: \"=\", 109: \"-\", 110: \".\", 111: \"/\", 145: \"ScrollLock\",\n    173: \"-\", 186: \";\", 187: \"=\", 188: \",\", 189: \"-\", 190: \".\", 191: \"/\", 192: \"`\", 219: \"[\", 220: \"\\\\\",\n    221: \"]\", 222: \"'\", 224: \"Mod\", 63232: \"Up\", 63233: \"Down\", 63234: \"Left\", 63235: \"Right\", 63272: \"Delete\",\n    63273: \"Home\", 63275: \"End\", 63276: \"PageUp\", 63277: \"PageDown\", 63302: \"Insert\"\n  };\n\n  // Number keys\n  for (var i = 0; i < 10; i++) { keyNames[i + 48] = keyNames[i + 96] = String(i); }\n  // Alphabetic keys\n  for (var i$1 = 65; i$1 <= 90; i$1++) { keyNames[i$1] = String.fromCharCode(i$1); }\n  // Function keys\n  for (var i$2 = 1; i$2 <= 12; i$2++) { keyNames[i$2 + 111] = keyNames[i$2 + 63235] = \"F\" + i$2; }\n\n  var keyMap = {};\n\n  keyMap.basic = {\n    \"Left\": \"goCharLeft\", \"Right\": \"goCharRight\", \"Up\": \"goLineUp\", \"Down\": \"goLineDown\",\n    \"End\": \"goLineEnd\", \"Home\": \"goLineStartSmart\", \"PageUp\": \"goPageUp\", \"PageDown\": \"goPageDown\",\n    \"Delete\": \"delCharAfter\", \"Backspace\": \"delCharBefore\", \"Shift-Backspace\": \"delCharBefore\",\n    \"Tab\": \"defaultTab\", \"Shift-Tab\": \"indentAuto\",\n    \"Enter\": \"newlineAndIndent\", \"Insert\": \"toggleOverwrite\",\n    \"Esc\": \"singleSelection\"\n  };\n  // Note that the save and find-related commands aren't defined by\n  // default. User code or addons can define them. Unknown commands\n  // are simply ignored.\n  keyMap.pcDefault = {\n    \"Ctrl-A\": \"selectAll\", \"Ctrl-D\": \"deleteLine\", \"Ctrl-Z\": \"undo\", \"Shift-Ctrl-Z\": \"redo\", \"Ctrl-Y\": \"redo\",\n    \"Ctrl-Home\": \"goDocStart\", \"Ctrl-End\": \"goDocEnd\", \"Ctrl-Up\": \"goLineUp\", \"Ctrl-Down\": \"goLineDown\",\n    \"Ctrl-Left\": \"goGroupLeft\", \"Ctrl-Right\": \"goGroupRight\", \"Alt-Left\": \"goLineStart\", \"Alt-Right\": \"goLineEnd\",\n    \"Ctrl-Backspace\": \"delGroupBefore\", \"Ctrl-Delete\": \"delGroupAfter\", \"Ctrl-S\": \"save\", \"Ctrl-F\": \"find\",\n    \"Ctrl-G\": \"findNext\", \"Shift-Ctrl-G\": \"findPrev\", \"Shift-Ctrl-F\": \"replace\", \"Shift-Ctrl-R\": \"replaceAll\",\n    \"Ctrl-[\": \"indentLess\", \"Ctrl-]\": \"indentMore\",\n    \"Ctrl-U\": \"undoSelection\", \"Shift-Ctrl-U\": \"redoSelection\", \"Alt-U\": \"redoSelection\",\n    \"fallthrough\": \"basic\"\n  };\n  // Very basic readline/emacs-style bindings, which are standard on Mac.\n  keyMap.emacsy = {\n    \"Ctrl-F\": \"goCharRight\", \"Ctrl-B\": \"goCharLeft\", \"Ctrl-P\": \"goLineUp\", \"Ctrl-N\": \"goLineDown\",\n    \"Ctrl-A\": \"goLineStart\", \"Ctrl-E\": \"goLineEnd\", \"Ctrl-V\": \"goPageDown\", \"Shift-Ctrl-V\": \"goPageUp\",\n    \"Ctrl-D\": \"delCharAfter\", \"Ctrl-H\": \"delCharBefore\", \"Alt-Backspace\": \"delWordBefore\", \"Ctrl-K\": \"killLine\",\n    \"Ctrl-T\": \"transposeChars\", \"Ctrl-O\": \"openLine\"\n  };\n  keyMap.macDefault = {\n    \"Cmd-A\": \"selectAll\", \"Cmd-D\": \"deleteLine\", \"Cmd-Z\": \"undo\", \"Shift-Cmd-Z\": \"redo\", \"Cmd-Y\": \"redo\",\n    \"Cmd-Home\": \"goDocStart\", \"Cmd-Up\": \"goDocStart\", \"Cmd-End\": \"goDocEnd\", \"Cmd-Down\": \"goDocEnd\", \"Alt-Left\": \"goGroupLeft\",\n    \"Alt-Right\": \"goGroupRight\", \"Cmd-Left\": \"goLineLeft\", \"Cmd-Right\": \"goLineRight\", \"Alt-Backspace\": \"delGroupBefore\",\n    \"Ctrl-Alt-Backspace\": \"delGroupAfter\", \"Alt-Delete\": \"delGroupAfter\", \"Cmd-S\": \"save\", \"Cmd-F\": \"find\",\n    \"Cmd-G\": \"findNext\", \"Shift-Cmd-G\": \"findPrev\", \"Cmd-Alt-F\": \"replace\", \"Shift-Cmd-Alt-F\": \"replaceAll\",\n    \"Cmd-[\": \"indentLess\", \"Cmd-]\": \"indentMore\", \"Cmd-Backspace\": \"delWrappedLineLeft\", \"Cmd-Delete\": \"delWrappedLineRight\",\n    \"Cmd-U\": \"undoSelection\", \"Shift-Cmd-U\": \"redoSelection\", \"Ctrl-Up\": \"goDocStart\", \"Ctrl-Down\": \"goDocEnd\",\n    \"fallthrough\": [\"basic\", \"emacsy\"]\n  };\n  keyMap[\"default\"] = mac ? keyMap.macDefault : keyMap.pcDefault;\n\n  // KEYMAP DISPATCH\n\n  function normalizeKeyName(name) {\n    var parts = name.split(/-(?!$)/);\n    name = parts[parts.length - 1];\n    var alt, ctrl, shift, cmd;\n    for (var i = 0; i < parts.length - 1; i++) {\n      var mod = parts[i];\n      if (/^(cmd|meta|m)$/i.test(mod)) { cmd = true; }\n      else if (/^a(lt)?$/i.test(mod)) { alt = true; }\n      else if (/^(c|ctrl|control)$/i.test(mod)) { ctrl = true; }\n      else if (/^s(hift)?$/i.test(mod)) { shift = true; }\n      else { throw new Error(\"Unrecognized modifier name: \" + mod) }\n    }\n    if (alt) { name = \"Alt-\" + name; }\n    if (ctrl) { name = \"Ctrl-\" + name; }\n    if (cmd) { name = \"Cmd-\" + name; }\n    if (shift) { name = \"Shift-\" + name; }\n    return name\n  }\n\n  // This is a kludge to keep keymaps mostly working as raw objects\n  // (backwards compatibility) while at the same time support features\n  // like normalization and multi-stroke key bindings. It compiles a\n  // new normalized keymap, and then updates the old object to reflect\n  // this.\n  function normalizeKeyMap(keymap) {\n    var copy = {};\n    for (var keyname in keymap) { if (keymap.hasOwnProperty(keyname)) {\n      var value = keymap[keyname];\n      if (/^(name|fallthrough|(de|at)tach)$/.test(keyname)) { continue }\n      if (value == \"...\") { delete keymap[keyname]; continue }\n\n      var keys = map(keyname.split(\" \"), normalizeKeyName);\n      for (var i = 0; i < keys.length; i++) {\n        var val = (void 0), name = (void 0);\n        if (i == keys.length - 1) {\n          name = keys.join(\" \");\n          val = value;\n        } else {\n          name = keys.slice(0, i + 1).join(\" \");\n          val = \"...\";\n        }\n        var prev = copy[name];\n        if (!prev) { copy[name] = val; }\n        else if (prev != val) { throw new Error(\"Inconsistent bindings for \" + name) }\n      }\n      delete keymap[keyname];\n    } }\n    for (var prop in copy) { keymap[prop] = copy[prop]; }\n    return keymap\n  }\n\n  function lookupKey(key, map, handle, context) {\n    map = getKeyMap(map);\n    var found = map.call ? map.call(key, context) : map[key];\n    if (found === false) { return \"nothing\" }\n    if (found === \"...\") { return \"multi\" }\n    if (found != null && handle(found)) { return \"handled\" }\n\n    if (map.fallthrough) {\n      if (Object.prototype.toString.call(map.fallthrough) != \"[object Array]\")\n        { return lookupKey(key, map.fallthrough, handle, context) }\n      for (var i = 0; i < map.fallthrough.length; i++) {\n        var result = lookupKey(key, map.fallthrough[i], handle, context);\n        if (result) { return result }\n      }\n    }\n  }\n\n  // Modifier key presses don't count as 'real' key presses for the\n  // purpose of keymap fallthrough.\n  function isModifierKey(value) {\n    var name = typeof value == \"string\" ? value : keyNames[value.keyCode];\n    return name == \"Ctrl\" || name == \"Alt\" || name == \"Shift\" || name == \"Mod\"\n  }\n\n  function addModifierNames(name, event, noShift) {\n    var base = name;\n    if (event.altKey && base != \"Alt\") { name = \"Alt-\" + name; }\n    if ((flipCtrlCmd ? event.metaKey : event.ctrlKey) && base != \"Ctrl\") { name = \"Ctrl-\" + name; }\n    if ((flipCtrlCmd ? event.ctrlKey : event.metaKey) && base != \"Mod\") { name = \"Cmd-\" + name; }\n    if (!noShift && event.shiftKey && base != \"Shift\") { name = \"Shift-\" + name; }\n    return name\n  }\n\n  // Look up the name of a key as indicated by an event object.\n  function keyName(event, noShift) {\n    if (presto && event.keyCode == 34 && event[\"char\"]) { return false }\n    var name = keyNames[event.keyCode];\n    if (name == null || event.altGraphKey) { return false }\n    // Ctrl-ScrollLock has keyCode 3, same as Ctrl-Pause,\n    // so we'll use event.code when available (Chrome 48+, FF 38+, Safari 10.1+)\n    if (event.keyCode == 3 && event.code) { name = event.code; }\n    return addModifierNames(name, event, noShift)\n  }\n\n  function getKeyMap(val) {\n    return typeof val == \"string\" ? keyMap[val] : val\n  }\n\n  // Helper for deleting text near the selection(s), used to implement\n  // backspace, delete, and similar functionality.\n  function deleteNearSelection(cm, compute) {\n    var ranges = cm.doc.sel.ranges, kill = [];\n    // Build up a set of ranges to kill first, merging overlapping\n    // ranges.\n    for (var i = 0; i < ranges.length; i++) {\n      var toKill = compute(ranges[i]);\n      while (kill.length && cmp(toKill.from, lst(kill).to) <= 0) {\n        var replaced = kill.pop();\n        if (cmp(replaced.from, toKill.from) < 0) {\n          toKill.from = replaced.from;\n          break\n        }\n      }\n      kill.push(toKill);\n    }\n    // Next, remove those actual ranges.\n    runInOp(cm, function () {\n      for (var i = kill.length - 1; i >= 0; i--)\n        { replaceRange(cm.doc, \"\", kill[i].from, kill[i].to, \"+delete\"); }\n      ensureCursorVisible(cm);\n    });\n  }\n\n  function moveCharLogically(line, ch, dir) {\n    var target = skipExtendingChars(line.text, ch + dir, dir);\n    return target < 0 || target > line.text.length ? null : target\n  }\n\n  function moveLogically(line, start, dir) {\n    var ch = moveCharLogically(line, start.ch, dir);\n    return ch == null ? null : new Pos(start.line, ch, dir < 0 ? \"after\" : \"before\")\n  }\n\n  function endOfLine(visually, cm, lineObj, lineNo, dir) {\n    if (visually) {\n      if (cm.doc.direction == \"rtl\") { dir = -dir; }\n      var order = getOrder(lineObj, cm.doc.direction);\n      if (order) {\n        var part = dir < 0 ? lst(order) : order[0];\n        var moveInStorageOrder = (dir < 0) == (part.level == 1);\n        var sticky = moveInStorageOrder ? \"after\" : \"before\";\n        var ch;\n        // With a wrapped rtl chunk (possibly spanning multiple bidi parts),\n        // it could be that the last bidi part is not on the last visual line,\n        // since visual lines contain content order-consecutive chunks.\n        // Thus, in rtl, we are looking for the first (content-order) character\n        // in the rtl chunk that is on the last line (that is, the same line\n        // as the last (content-order) character).\n        if (part.level > 0 || cm.doc.direction == \"rtl\") {\n          var prep = prepareMeasureForLine(cm, lineObj);\n          ch = dir < 0 ? lineObj.text.length - 1 : 0;\n          var targetTop = measureCharPrepared(cm, prep, ch).top;\n          ch = findFirst(function (ch) { return measureCharPrepared(cm, prep, ch).top == targetTop; }, (dir < 0) == (part.level == 1) ? part.from : part.to - 1, ch);\n          if (sticky == \"before\") { ch = moveCharLogically(lineObj, ch, 1); }\n        } else { ch = dir < 0 ? part.to : part.from; }\n        return new Pos(lineNo, ch, sticky)\n      }\n    }\n    return new Pos(lineNo, dir < 0 ? lineObj.text.length : 0, dir < 0 ? \"before\" : \"after\")\n  }\n\n  function moveVisually(cm, line, start, dir) {\n    var bidi = getOrder(line, cm.doc.direction);\n    if (!bidi) { return moveLogically(line, start, dir) }\n    if (start.ch >= line.text.length) {\n      start.ch = line.text.length;\n      start.sticky = \"before\";\n    } else if (start.ch <= 0) {\n      start.ch = 0;\n      start.sticky = \"after\";\n    }\n    var partPos = getBidiPartAt(bidi, start.ch, start.sticky), part = bidi[partPos];\n    if (cm.doc.direction == \"ltr\" && part.level % 2 == 0 && (dir > 0 ? part.to > start.ch : part.from < start.ch)) {\n      // Case 1: We move within an ltr part in an ltr editor. Even with wrapped lines,\n      // nothing interesting happens.\n      return moveLogically(line, start, dir)\n    }\n\n    var mv = function (pos, dir) { return moveCharLogically(line, pos instanceof Pos ? pos.ch : pos, dir); };\n    var prep;\n    var getWrappedLineExtent = function (ch) {\n      if (!cm.options.lineWrapping) { return {begin: 0, end: line.text.length} }\n      prep = prep || prepareMeasureForLine(cm, line);\n      return wrappedLineExtentChar(cm, line, prep, ch)\n    };\n    var wrappedLineExtent = getWrappedLineExtent(start.sticky == \"before\" ? mv(start, -1) : start.ch);\n\n    if (cm.doc.direction == \"rtl\" || part.level == 1) {\n      var moveInStorageOrder = (part.level == 1) == (dir < 0);\n      var ch = mv(start, moveInStorageOrder ? 1 : -1);\n      if (ch != null && (!moveInStorageOrder ? ch >= part.from && ch >= wrappedLineExtent.begin : ch <= part.to && ch <= wrappedLineExtent.end)) {\n        // Case 2: We move within an rtl part or in an rtl editor on the same visual line\n        var sticky = moveInStorageOrder ? \"before\" : \"after\";\n        return new Pos(start.line, ch, sticky)\n      }\n    }\n\n    // Case 3: Could not move within this bidi part in this visual line, so leave\n    // the current bidi part\n\n    var searchInVisualLine = function (partPos, dir, wrappedLineExtent) {\n      var getRes = function (ch, moveInStorageOrder) { return moveInStorageOrder\n        ? new Pos(start.line, mv(ch, 1), \"before\")\n        : new Pos(start.line, ch, \"after\"); };\n\n      for (; partPos >= 0 && partPos < bidi.length; partPos += dir) {\n        var part = bidi[partPos];\n        var moveInStorageOrder = (dir > 0) == (part.level != 1);\n        var ch = moveInStorageOrder ? wrappedLineExtent.begin : mv(wrappedLineExtent.end, -1);\n        if (part.from <= ch && ch < part.to) { return getRes(ch, moveInStorageOrder) }\n        ch = moveInStorageOrder ? part.from : mv(part.to, -1);\n        if (wrappedLineExtent.begin <= ch && ch < wrappedLineExtent.end) { return getRes(ch, moveInStorageOrder) }\n      }\n    };\n\n    // Case 3a: Look for other bidi parts on the same visual line\n    var res = searchInVisualLine(partPos + dir, dir, wrappedLineExtent);\n    if (res) { return res }\n\n    // Case 3b: Look for other bidi parts on the next visual line\n    var nextCh = dir > 0 ? wrappedLineExtent.end : mv(wrappedLineExtent.begin, -1);\n    if (nextCh != null && !(dir > 0 && nextCh == line.text.length)) {\n      res = searchInVisualLine(dir > 0 ? 0 : bidi.length - 1, dir, getWrappedLineExtent(nextCh));\n      if (res) { return res }\n    }\n\n    // Case 4: Nowhere to move\n    return null\n  }\n\n  // Commands are parameter-less actions that can be performed on an\n  // editor, mostly used for keybindings.\n  var commands = {\n    selectAll: selectAll,\n    singleSelection: function (cm) { return cm.setSelection(cm.getCursor(\"anchor\"), cm.getCursor(\"head\"), sel_dontScroll); },\n    killLine: function (cm) { return deleteNearSelection(cm, function (range) {\n      if (range.empty()) {\n        var len = getLine(cm.doc, range.head.line).text.length;\n        if (range.head.ch == len && range.head.line < cm.lastLine())\n          { return {from: range.head, to: Pos(range.head.line + 1, 0)} }\n        else\n          { return {from: range.head, to: Pos(range.head.line, len)} }\n      } else {\n        return {from: range.from(), to: range.to()}\n      }\n    }); },\n    deleteLine: function (cm) { return deleteNearSelection(cm, function (range) { return ({\n      from: Pos(range.from().line, 0),\n      to: clipPos(cm.doc, Pos(range.to().line + 1, 0))\n    }); }); },\n    delLineLeft: function (cm) { return deleteNearSelection(cm, function (range) { return ({\n      from: Pos(range.from().line, 0), to: range.from()\n    }); }); },\n    delWrappedLineLeft: function (cm) { return deleteNearSelection(cm, function (range) {\n      var top = cm.charCoords(range.head, \"div\").top + 5;\n      var leftPos = cm.coordsChar({left: 0, top: top}, \"div\");\n      return {from: leftPos, to: range.from()}\n    }); },\n    delWrappedLineRight: function (cm) { return deleteNearSelection(cm, function (range) {\n      var top = cm.charCoords(range.head, \"div\").top + 5;\n      var rightPos = cm.coordsChar({left: cm.display.lineDiv.offsetWidth + 100, top: top}, \"div\");\n      return {from: range.from(), to: rightPos }\n    }); },\n    undo: function (cm) { return cm.undo(); },\n    redo: function (cm) { return cm.redo(); },\n    undoSelection: function (cm) { return cm.undoSelection(); },\n    redoSelection: function (cm) { return cm.redoSelection(); },\n    goDocStart: function (cm) { return cm.extendSelection(Pos(cm.firstLine(), 0)); },\n    goDocEnd: function (cm) { return cm.extendSelection(Pos(cm.lastLine())); },\n    goLineStart: function (cm) { return cm.extendSelectionsBy(function (range) { return lineStart(cm, range.head.line); },\n      {origin: \"+move\", bias: 1}\n    ); },\n    goLineStartSmart: function (cm) { return cm.extendSelectionsBy(function (range) { return lineStartSmart(cm, range.head); },\n      {origin: \"+move\", bias: 1}\n    ); },\n    goLineEnd: function (cm) { return cm.extendSelectionsBy(function (range) { return lineEnd(cm, range.head.line); },\n      {origin: \"+move\", bias: -1}\n    ); },\n    goLineRight: function (cm) { return cm.extendSelectionsBy(function (range) {\n      var top = cm.cursorCoords(range.head, \"div\").top + 5;\n      return cm.coordsChar({left: cm.display.lineDiv.offsetWidth + 100, top: top}, \"div\")\n    }, sel_move); },\n    goLineLeft: function (cm) { return cm.extendSelectionsBy(function (range) {\n      var top = cm.cursorCoords(range.head, \"div\").top + 5;\n      return cm.coordsChar({left: 0, top: top}, \"div\")\n    }, sel_move); },\n    goLineLeftSmart: function (cm) { return cm.extendSelectionsBy(function (range) {\n      var top = cm.cursorCoords(range.head, \"div\").top + 5;\n      var pos = cm.coordsChar({left: 0, top: top}, \"div\");\n      if (pos.ch < cm.getLine(pos.line).search(/\\S/)) { return lineStartSmart(cm, range.head) }\n      return pos\n    }, sel_move); },\n    goLineUp: function (cm) { return cm.moveV(-1, \"line\"); },\n    goLineDown: function (cm) { return cm.moveV(1, \"line\"); },\n    goPageUp: function (cm) { return cm.moveV(-1, \"page\"); },\n    goPageDown: function (cm) { return cm.moveV(1, \"page\"); },\n    goCharLeft: function (cm) { return cm.moveH(-1, \"char\"); },\n    goCharRight: function (cm) { return cm.moveH(1, \"char\"); },\n    goColumnLeft: function (cm) { return cm.moveH(-1, \"column\"); },\n    goColumnRight: function (cm) { return cm.moveH(1, \"column\"); },\n    goWordLeft: function (cm) { return cm.moveH(-1, \"word\"); },\n    goGroupRight: function (cm) { return cm.moveH(1, \"group\"); },\n    goGroupLeft: function (cm) { return cm.moveH(-1, \"group\"); },\n    goWordRight: function (cm) { return cm.moveH(1, \"word\"); },\n    delCharBefore: function (cm) { return cm.deleteH(-1, \"codepoint\"); },\n    delCharAfter: function (cm) { return cm.deleteH(1, \"char\"); },\n    delWordBefore: function (cm) { return cm.deleteH(-1, \"word\"); },\n    delWordAfter: function (cm) { return cm.deleteH(1, \"word\"); },\n    delGroupBefore: function (cm) { return cm.deleteH(-1, \"group\"); },\n    delGroupAfter: function (cm) { return cm.deleteH(1, \"group\"); },\n    indentAuto: function (cm) { return cm.indentSelection(\"smart\"); },\n    indentMore: function (cm) { return cm.indentSelection(\"add\"); },\n    indentLess: function (cm) { return cm.indentSelection(\"subtract\"); },\n    insertTab: function (cm) { return cm.replaceSelection(\"\\t\"); },\n    insertSoftTab: function (cm) {\n      var spaces = [], ranges = cm.listSelections(), tabSize = cm.options.tabSize;\n      for (var i = 0; i < ranges.length; i++) {\n        var pos = ranges[i].from();\n        var col = countColumn(cm.getLine(pos.line), pos.ch, tabSize);\n        spaces.push(spaceStr(tabSize - col % tabSize));\n      }\n      cm.replaceSelections(spaces);\n    },\n    defaultTab: function (cm) {\n      if (cm.somethingSelected()) { cm.indentSelection(\"add\"); }\n      else { cm.execCommand(\"insertTab\"); }\n    },\n    // Swap the two chars left and right of each selection's head.\n    // Move cursor behind the two swapped characters afterwards.\n    //\n    // Doesn't consider line feeds a character.\n    // Doesn't scan more than one line above to find a character.\n    // Doesn't do anything on an empty line.\n    // Doesn't do anything with non-empty selections.\n    transposeChars: function (cm) { return runInOp(cm, function () {\n      var ranges = cm.listSelections(), newSel = [];\n      for (var i = 0; i < ranges.length; i++) {\n        if (!ranges[i].empty()) { continue }\n        var cur = ranges[i].head, line = getLine(cm.doc, cur.line).text;\n        if (line) {\n          if (cur.ch == line.length) { cur = new Pos(cur.line, cur.ch - 1); }\n          if (cur.ch > 0) {\n            cur = new Pos(cur.line, cur.ch + 1);\n            cm.replaceRange(line.charAt(cur.ch - 1) + line.charAt(cur.ch - 2),\n                            Pos(cur.line, cur.ch - 2), cur, \"+transpose\");\n          } else if (cur.line > cm.doc.first) {\n            var prev = getLine(cm.doc, cur.line - 1).text;\n            if (prev) {\n              cur = new Pos(cur.line, 1);\n              cm.replaceRange(line.charAt(0) + cm.doc.lineSeparator() +\n                              prev.charAt(prev.length - 1),\n                              Pos(cur.line - 1, prev.length - 1), cur, \"+transpose\");\n            }\n          }\n        }\n        newSel.push(new Range(cur, cur));\n      }\n      cm.setSelections(newSel);\n    }); },\n    newlineAndIndent: function (cm) { return runInOp(cm, function () {\n      var sels = cm.listSelections();\n      for (var i = sels.length - 1; i >= 0; i--)\n        { cm.replaceRange(cm.doc.lineSeparator(), sels[i].anchor, sels[i].head, \"+input\"); }\n      sels = cm.listSelections();\n      for (var i$1 = 0; i$1 < sels.length; i$1++)\n        { cm.indentLine(sels[i$1].from().line, null, true); }\n      ensureCursorVisible(cm);\n    }); },\n    openLine: function (cm) { return cm.replaceSelection(\"\\n\", \"start\"); },\n    toggleOverwrite: function (cm) { return cm.toggleOverwrite(); }\n  };\n\n\n  function lineStart(cm, lineN) {\n    var line = getLine(cm.doc, lineN);\n    var visual = visualLine(line);\n    if (visual != line) { lineN = lineNo(visual); }\n    return endOfLine(true, cm, visual, lineN, 1)\n  }\n  function lineEnd(cm, lineN) {\n    var line = getLine(cm.doc, lineN);\n    var visual = visualLineEnd(line);\n    if (visual != line) { lineN = lineNo(visual); }\n    return endOfLine(true, cm, line, lineN, -1)\n  }\n  function lineStartSmart(cm, pos) {\n    var start = lineStart(cm, pos.line);\n    var line = getLine(cm.doc, start.line);\n    var order = getOrder(line, cm.doc.direction);\n    if (!order || order[0].level == 0) {\n      var firstNonWS = Math.max(start.ch, line.text.search(/\\S/));\n      var inWS = pos.line == start.line && pos.ch <= firstNonWS && pos.ch;\n      return Pos(start.line, inWS ? 0 : firstNonWS, start.sticky)\n    }\n    return start\n  }\n\n  // Run a handler that was bound to a key.\n  function doHandleBinding(cm, bound, dropShift) {\n    if (typeof bound == \"string\") {\n      bound = commands[bound];\n      if (!bound) { return false }\n    }\n    // Ensure previous input has been read, so that the handler sees a\n    // consistent view of the document\n    cm.display.input.ensurePolled();\n    var prevShift = cm.display.shift, done = false;\n    try {\n      if (cm.isReadOnly()) { cm.state.suppressEdits = true; }\n      if (dropShift) { cm.display.shift = false; }\n      done = bound(cm) != Pass;\n    } finally {\n      cm.display.shift = prevShift;\n      cm.state.suppressEdits = false;\n    }\n    return done\n  }\n\n  function lookupKeyForEditor(cm, name, handle) {\n    for (var i = 0; i < cm.state.keyMaps.length; i++) {\n      var result = lookupKey(name, cm.state.keyMaps[i], handle, cm);\n      if (result) { return result }\n    }\n    return (cm.options.extraKeys && lookupKey(name, cm.options.extraKeys, handle, cm))\n      || lookupKey(name, cm.options.keyMap, handle, cm)\n  }\n\n  // Note that, despite the name, this function is also used to check\n  // for bound mouse clicks.\n\n  var stopSeq = new Delayed;\n\n  function dispatchKey(cm, name, e, handle) {\n    var seq = cm.state.keySeq;\n    if (seq) {\n      if (isModifierKey(name)) { return \"handled\" }\n      if (/\\'$/.test(name))\n        { cm.state.keySeq = null; }\n      else\n        { stopSeq.set(50, function () {\n          if (cm.state.keySeq == seq) {\n            cm.state.keySeq = null;\n            cm.display.input.reset();\n          }\n        }); }\n      if (dispatchKeyInner(cm, seq + \" \" + name, e, handle)) { return true }\n    }\n    return dispatchKeyInner(cm, name, e, handle)\n  }\n\n  function dispatchKeyInner(cm, name, e, handle) {\n    var result = lookupKeyForEditor(cm, name, handle);\n\n    if (result == \"multi\")\n      { cm.state.keySeq = name; }\n    if (result == \"handled\")\n      { signalLater(cm, \"keyHandled\", cm, name, e); }\n\n    if (result == \"handled\" || result == \"multi\") {\n      e_preventDefault(e);\n      restartBlink(cm);\n    }\n\n    return !!result\n  }\n\n  // Handle a key from the keydown event.\n  function handleKeyBinding(cm, e) {\n    var name = keyName(e, true);\n    if (!name) { return false }\n\n    if (e.shiftKey && !cm.state.keySeq) {\n      // First try to resolve full name (including 'Shift-'). Failing\n      // that, see if there is a cursor-motion command (starting with\n      // 'go') bound to the keyname without 'Shift-'.\n      return dispatchKey(cm, \"Shift-\" + name, e, function (b) { return doHandleBinding(cm, b, true); })\n          || dispatchKey(cm, name, e, function (b) {\n               if (typeof b == \"string\" ? /^go[A-Z]/.test(b) : b.motion)\n                 { return doHandleBinding(cm, b) }\n             })\n    } else {\n      return dispatchKey(cm, name, e, function (b) { return doHandleBinding(cm, b); })\n    }\n  }\n\n  // Handle a key from the keypress event\n  function handleCharBinding(cm, e, ch) {\n    return dispatchKey(cm, \"'\" + ch + \"'\", e, function (b) { return doHandleBinding(cm, b, true); })\n  }\n\n  var lastStoppedKey = null;\n  function onKeyDown(e) {\n    var cm = this;\n    if (e.target && e.target != cm.display.input.getField()) { return }\n    cm.curOp.focus = activeElt();\n    if (signalDOMEvent(cm, e)) { return }\n    // IE does strange things with escape.\n    if (ie && ie_version < 11 && e.keyCode == 27) { e.returnValue = false; }\n    var code = e.keyCode;\n    cm.display.shift = code == 16 || e.shiftKey;\n    var handled = handleKeyBinding(cm, e);\n    if (presto) {\n      lastStoppedKey = handled ? code : null;\n      // Opera has no cut event... we try to at least catch the key combo\n      if (!handled && code == 88 && !hasCopyEvent && (mac ? e.metaKey : e.ctrlKey))\n        { cm.replaceSelection(\"\", null, \"cut\"); }\n    }\n    if (gecko && !mac && !handled && code == 46 && e.shiftKey && !e.ctrlKey && document.execCommand)\n      { document.execCommand(\"cut\"); }\n\n    // Turn mouse into crosshair when Alt is held on Mac.\n    if (code == 18 && !/\\bCodeMirror-crosshair\\b/.test(cm.display.lineDiv.className))\n      { showCrossHair(cm); }\n  }\n\n  function showCrossHair(cm) {\n    var lineDiv = cm.display.lineDiv;\n    addClass(lineDiv, \"CodeMirror-crosshair\");\n\n    function up(e) {\n      if (e.keyCode == 18 || !e.altKey) {\n        rmClass(lineDiv, \"CodeMirror-crosshair\");\n        off(document, \"keyup\", up);\n        off(document, \"mouseover\", up);\n      }\n    }\n    on(document, \"keyup\", up);\n    on(document, \"mouseover\", up);\n  }\n\n  function onKeyUp(e) {\n    if (e.keyCode == 16) { this.doc.sel.shift = false; }\n    signalDOMEvent(this, e);\n  }\n\n  function onKeyPress(e) {\n    var cm = this;\n    if (e.target && e.target != cm.display.input.getField()) { return }\n    if (eventInWidget(cm.display, e) || signalDOMEvent(cm, e) || e.ctrlKey && !e.altKey || mac && e.metaKey) { return }\n    var keyCode = e.keyCode, charCode = e.charCode;\n    if (presto && keyCode == lastStoppedKey) {lastStoppedKey = null; e_preventDefault(e); return}\n    if ((presto && (!e.which || e.which < 10)) && handleKeyBinding(cm, e)) { return }\n    var ch = String.fromCharCode(charCode == null ? keyCode : charCode);\n    // Some browsers fire keypress events for backspace\n    if (ch == \"\\x08\") { return }\n    if (handleCharBinding(cm, e, ch)) { return }\n    cm.display.input.onKeyPress(e);\n  }\n\n  var DOUBLECLICK_DELAY = 400;\n\n  var PastClick = function(time, pos, button) {\n    this.time = time;\n    this.pos = pos;\n    this.button = button;\n  };\n\n  PastClick.prototype.compare = function (time, pos, button) {\n    return this.time + DOUBLECLICK_DELAY > time &&\n      cmp(pos, this.pos) == 0 && button == this.button\n  };\n\n  var lastClick, lastDoubleClick;\n  function clickRepeat(pos, button) {\n    var now = +new Date;\n    if (lastDoubleClick && lastDoubleClick.compare(now, pos, button)) {\n      lastClick = lastDoubleClick = null;\n      return \"triple\"\n    } else if (lastClick && lastClick.compare(now, pos, button)) {\n      lastDoubleClick = new PastClick(now, pos, button);\n      lastClick = null;\n      return \"double\"\n    } else {\n      lastClick = new PastClick(now, pos, button);\n      lastDoubleClick = null;\n      return \"single\"\n    }\n  }\n\n  // A mouse down can be a single click, double click, triple click,\n  // start of selection drag, start of text drag, new cursor\n  // (ctrl-click), rectangle drag (alt-drag), or xwin\n  // middle-click-paste. Or it might be a click on something we should\n  // not interfere with, such as a scrollbar or widget.\n  function onMouseDown(e) {\n    var cm = this, display = cm.display;\n    if (signalDOMEvent(cm, e) || display.activeTouch && display.input.supportsTouch()) { return }\n    display.input.ensurePolled();\n    display.shift = e.shiftKey;\n\n    if (eventInWidget(display, e)) {\n      if (!webkit) {\n        // Briefly turn off draggability, to allow widgets to do\n        // normal dragging things.\n        display.scroller.draggable = false;\n        setTimeout(function () { return display.scroller.draggable = true; }, 100);\n      }\n      return\n    }\n    if (clickInGutter(cm, e)) { return }\n    var pos = posFromMouse(cm, e), button = e_button(e), repeat = pos ? clickRepeat(pos, button) : \"single\";\n    window.focus();\n\n    // #3261: make sure, that we're not starting a second selection\n    if (button == 1 && cm.state.selectingText)\n      { cm.state.selectingText(e); }\n\n    if (pos && handleMappedButton(cm, button, pos, repeat, e)) { return }\n\n    if (button == 1) {\n      if (pos) { leftButtonDown(cm, pos, repeat, e); }\n      else if (e_target(e) == display.scroller) { e_preventDefault(e); }\n    } else if (button == 2) {\n      if (pos) { extendSelection(cm.doc, pos); }\n      setTimeout(function () { return display.input.focus(); }, 20);\n    } else if (button == 3) {\n      if (captureRightClick) { cm.display.input.onContextMenu(e); }\n      else { delayBlurEvent(cm); }\n    }\n  }\n\n  function handleMappedButton(cm, button, pos, repeat, event) {\n    var name = \"Click\";\n    if (repeat == \"double\") { name = \"Double\" + name; }\n    else if (repeat == \"triple\") { name = \"Triple\" + name; }\n    name = (button == 1 ? \"Left\" : button == 2 ? \"Middle\" : \"Right\") + name;\n\n    return dispatchKey(cm,  addModifierNames(name, event), event, function (bound) {\n      if (typeof bound == \"string\") { bound = commands[bound]; }\n      if (!bound) { return false }\n      var done = false;\n      try {\n        if (cm.isReadOnly()) { cm.state.suppressEdits = true; }\n        done = bound(cm, pos) != Pass;\n      } finally {\n        cm.state.suppressEdits = false;\n      }\n      return done\n    })\n  }\n\n  function configureMouse(cm, repeat, event) {\n    var option = cm.getOption(\"configureMouse\");\n    var value = option ? option(cm, repeat, event) : {};\n    if (value.unit == null) {\n      var rect = chromeOS ? event.shiftKey && event.metaKey : event.altKey;\n      value.unit = rect ? \"rectangle\" : repeat == \"single\" ? \"char\" : repeat == \"double\" ? \"word\" : \"line\";\n    }\n    if (value.extend == null || cm.doc.extend) { value.extend = cm.doc.extend || event.shiftKey; }\n    if (value.addNew == null) { value.addNew = mac ? event.metaKey : event.ctrlKey; }\n    if (value.moveOnDrag == null) { value.moveOnDrag = !(mac ? event.altKey : event.ctrlKey); }\n    return value\n  }\n\n  function leftButtonDown(cm, pos, repeat, event) {\n    if (ie) { setTimeout(bind(ensureFocus, cm), 0); }\n    else { cm.curOp.focus = activeElt(); }\n\n    var behavior = configureMouse(cm, repeat, event);\n\n    var sel = cm.doc.sel, contained;\n    if (cm.options.dragDrop && dragAndDrop && !cm.isReadOnly() &&\n        repeat == \"single\" && (contained = sel.contains(pos)) > -1 &&\n        (cmp((contained = sel.ranges[contained]).from(), pos) < 0 || pos.xRel > 0) &&\n        (cmp(contained.to(), pos) > 0 || pos.xRel < 0))\n      { leftButtonStartDrag(cm, event, pos, behavior); }\n    else\n      { leftButtonSelect(cm, event, pos, behavior); }\n  }\n\n  // Start a text drag. When it ends, see if any dragging actually\n  // happen, and treat as a click if it didn't.\n  function leftButtonStartDrag(cm, event, pos, behavior) {\n    var display = cm.display, moved = false;\n    var dragEnd = operation(cm, function (e) {\n      if (webkit) { display.scroller.draggable = false; }\n      cm.state.draggingText = false;\n      if (cm.state.delayingBlurEvent) {\n        if (cm.hasFocus()) { cm.state.delayingBlurEvent = false; }\n        else { delayBlurEvent(cm); }\n      }\n      off(display.wrapper.ownerDocument, \"mouseup\", dragEnd);\n      off(display.wrapper.ownerDocument, \"mousemove\", mouseMove);\n      off(display.scroller, \"dragstart\", dragStart);\n      off(display.scroller, \"drop\", dragEnd);\n      if (!moved) {\n        e_preventDefault(e);\n        if (!behavior.addNew)\n          { extendSelection(cm.doc, pos, null, null, behavior.extend); }\n        // Work around unexplainable focus problem in IE9 (#2127) and Chrome (#3081)\n        if ((webkit && !safari) || ie && ie_version == 9)\n          { setTimeout(function () {display.wrapper.ownerDocument.body.focus({preventScroll: true}); display.input.focus();}, 20); }\n        else\n          { display.input.focus(); }\n      }\n    });\n    var mouseMove = function(e2) {\n      moved = moved || Math.abs(event.clientX - e2.clientX) + Math.abs(event.clientY - e2.clientY) >= 10;\n    };\n    var dragStart = function () { return moved = true; };\n    // Let the drag handler handle this.\n    if (webkit) { display.scroller.draggable = true; }\n    cm.state.draggingText = dragEnd;\n    dragEnd.copy = !behavior.moveOnDrag;\n    on(display.wrapper.ownerDocument, \"mouseup\", dragEnd);\n    on(display.wrapper.ownerDocument, \"mousemove\", mouseMove);\n    on(display.scroller, \"dragstart\", dragStart);\n    on(display.scroller, \"drop\", dragEnd);\n\n    cm.state.delayingBlurEvent = true;\n    setTimeout(function () { return display.input.focus(); }, 20);\n    // IE's approach to draggable\n    if (display.scroller.dragDrop) { display.scroller.dragDrop(); }\n  }\n\n  function rangeForUnit(cm, pos, unit) {\n    if (unit == \"char\") { return new Range(pos, pos) }\n    if (unit == \"word\") { return cm.findWordAt(pos) }\n    if (unit == \"line\") { return new Range(Pos(pos.line, 0), clipPos(cm.doc, Pos(pos.line + 1, 0))) }\n    var result = unit(cm, pos);\n    return new Range(result.from, result.to)\n  }\n\n  // Normal selection, as opposed to text dragging.\n  function leftButtonSelect(cm, event, start, behavior) {\n    if (ie) { delayBlurEvent(cm); }\n    var display = cm.display, doc = cm.doc;\n    e_preventDefault(event);\n\n    var ourRange, ourIndex, startSel = doc.sel, ranges = startSel.ranges;\n    if (behavior.addNew && !behavior.extend) {\n      ourIndex = doc.sel.contains(start);\n      if (ourIndex > -1)\n        { ourRange = ranges[ourIndex]; }\n      else\n        { ourRange = new Range(start, start); }\n    } else {\n      ourRange = doc.sel.primary();\n      ourIndex = doc.sel.primIndex;\n    }\n\n    if (behavior.unit == \"rectangle\") {\n      if (!behavior.addNew) { ourRange = new Range(start, start); }\n      start = posFromMouse(cm, event, true, true);\n      ourIndex = -1;\n    } else {\n      var range = rangeForUnit(cm, start, behavior.unit);\n      if (behavior.extend)\n        { ourRange = extendRange(ourRange, range.anchor, range.head, behavior.extend); }\n      else\n        { ourRange = range; }\n    }\n\n    if (!behavior.addNew) {\n      ourIndex = 0;\n      setSelection(doc, new Selection([ourRange], 0), sel_mouse);\n      startSel = doc.sel;\n    } else if (ourIndex == -1) {\n      ourIndex = ranges.length;\n      setSelection(doc, normalizeSelection(cm, ranges.concat([ourRange]), ourIndex),\n                   {scroll: false, origin: \"*mouse\"});\n    } else if (ranges.length > 1 && ranges[ourIndex].empty() && behavior.unit == \"char\" && !behavior.extend) {\n      setSelection(doc, normalizeSelection(cm, ranges.slice(0, ourIndex).concat(ranges.slice(ourIndex + 1)), 0),\n                   {scroll: false, origin: \"*mouse\"});\n      startSel = doc.sel;\n    } else {\n      replaceOneSelection(doc, ourIndex, ourRange, sel_mouse);\n    }\n\n    var lastPos = start;\n    function extendTo(pos) {\n      if (cmp(lastPos, pos) == 0) { return }\n      lastPos = pos;\n\n      if (behavior.unit == \"rectangle\") {\n        var ranges = [], tabSize = cm.options.tabSize;\n        var startCol = countColumn(getLine(doc, start.line).text, start.ch, tabSize);\n        var posCol = countColumn(getLine(doc, pos.line).text, pos.ch, tabSize);\n        var left = Math.min(startCol, posCol), right = Math.max(startCol, posCol);\n        for (var line = Math.min(start.line, pos.line), end = Math.min(cm.lastLine(), Math.max(start.line, pos.line));\n             line <= end; line++) {\n          var text = getLine(doc, line).text, leftPos = findColumn(text, left, tabSize);\n          if (left == right)\n            { ranges.push(new Range(Pos(line, leftPos), Pos(line, leftPos))); }\n          else if (text.length > leftPos)\n            { ranges.push(new Range(Pos(line, leftPos), Pos(line, findColumn(text, right, tabSize)))); }\n        }\n        if (!ranges.length) { ranges.push(new Range(start, start)); }\n        setSelection(doc, normalizeSelection(cm, startSel.ranges.slice(0, ourIndex).concat(ranges), ourIndex),\n                     {origin: \"*mouse\", scroll: false});\n        cm.scrollIntoView(pos);\n      } else {\n        var oldRange = ourRange;\n        var range = rangeForUnit(cm, pos, behavior.unit);\n        var anchor = oldRange.anchor, head;\n        if (cmp(range.anchor, anchor) > 0) {\n          head = range.head;\n          anchor = minPos(oldRange.from(), range.anchor);\n        } else {\n          head = range.anchor;\n          anchor = maxPos(oldRange.to(), range.head);\n        }\n        var ranges$1 = startSel.ranges.slice(0);\n        ranges$1[ourIndex] = bidiSimplify(cm, new Range(clipPos(doc, anchor), head));\n        setSelection(doc, normalizeSelection(cm, ranges$1, ourIndex), sel_mouse);\n      }\n    }\n\n    var editorSize = display.wrapper.getBoundingClientRect();\n    // Used to ensure timeout re-tries don't fire when another extend\n    // happened in the meantime (clearTimeout isn't reliable -- at\n    // least on Chrome, the timeouts still happen even when cleared,\n    // if the clear happens after their scheduled firing time).\n    var counter = 0;\n\n    function extend(e) {\n      var curCount = ++counter;\n      var cur = posFromMouse(cm, e, true, behavior.unit == \"rectangle\");\n      if (!cur) { return }\n      if (cmp(cur, lastPos) != 0) {\n        cm.curOp.focus = activeElt();\n        extendTo(cur);\n        var visible = visibleLines(display, doc);\n        if (cur.line >= visible.to || cur.line < visible.from)\n          { setTimeout(operation(cm, function () {if (counter == curCount) { extend(e); }}), 150); }\n      } else {\n        var outside = e.clientY < editorSize.top ? -20 : e.clientY > editorSize.bottom ? 20 : 0;\n        if (outside) { setTimeout(operation(cm, function () {\n          if (counter != curCount) { return }\n          display.scroller.scrollTop += outside;\n          extend(e);\n        }), 50); }\n      }\n    }\n\n    function done(e) {\n      cm.state.selectingText = false;\n      counter = Infinity;\n      // If e is null or undefined we interpret this as someone trying\n      // to explicitly cancel the selection rather than the user\n      // letting go of the mouse button.\n      if (e) {\n        e_preventDefault(e);\n        display.input.focus();\n      }\n      off(display.wrapper.ownerDocument, \"mousemove\", move);\n      off(display.wrapper.ownerDocument, \"mouseup\", up);\n      doc.history.lastSelOrigin = null;\n    }\n\n    var move = operation(cm, function (e) {\n      if (e.buttons === 0 || !e_button(e)) { done(e); }\n      else { extend(e); }\n    });\n    var up = operation(cm, done);\n    cm.state.selectingText = up;\n    on(display.wrapper.ownerDocument, \"mousemove\", move);\n    on(display.wrapper.ownerDocument, \"mouseup\", up);\n  }\n\n  // Used when mouse-selecting to adjust the anchor to the proper side\n  // of a bidi jump depending on the visual position of the head.\n  function bidiSimplify(cm, range) {\n    var anchor = range.anchor;\n    var head = range.head;\n    var anchorLine = getLine(cm.doc, anchor.line);\n    if (cmp(anchor, head) == 0 && anchor.sticky == head.sticky) { return range }\n    var order = getOrder(anchorLine);\n    if (!order) { return range }\n    var index = getBidiPartAt(order, anchor.ch, anchor.sticky), part = order[index];\n    if (part.from != anchor.ch && part.to != anchor.ch) { return range }\n    var boundary = index + ((part.from == anchor.ch) == (part.level != 1) ? 0 : 1);\n    if (boundary == 0 || boundary == order.length) { return range }\n\n    // Compute the relative visual position of the head compared to the\n    // anchor (<0 is to the left, >0 to the right)\n    var leftSide;\n    if (head.line != anchor.line) {\n      leftSide = (head.line - anchor.line) * (cm.doc.direction == \"ltr\" ? 1 : -1) > 0;\n    } else {\n      var headIndex = getBidiPartAt(order, head.ch, head.sticky);\n      var dir = headIndex - index || (head.ch - anchor.ch) * (part.level == 1 ? -1 : 1);\n      if (headIndex == boundary - 1 || headIndex == boundary)\n        { leftSide = dir < 0; }\n      else\n        { leftSide = dir > 0; }\n    }\n\n    var usePart = order[boundary + (leftSide ? -1 : 0)];\n    var from = leftSide == (usePart.level == 1);\n    var ch = from ? usePart.from : usePart.to, sticky = from ? \"after\" : \"before\";\n    return anchor.ch == ch && anchor.sticky == sticky ? range : new Range(new Pos(anchor.line, ch, sticky), head)\n  }\n\n\n  // Determines whether an event happened in the gutter, and fires the\n  // handlers for the corresponding event.\n  function gutterEvent(cm, e, type, prevent) {\n    var mX, mY;\n    if (e.touches) {\n      mX = e.touches[0].clientX;\n      mY = e.touches[0].clientY;\n    } else {\n      try { mX = e.clientX; mY = e.clientY; }\n      catch(e$1) { return false }\n    }\n    if (mX >= Math.floor(cm.display.gutters.getBoundingClientRect().right)) { return false }\n    if (prevent) { e_preventDefault(e); }\n\n    var display = cm.display;\n    var lineBox = display.lineDiv.getBoundingClientRect();\n\n    if (mY > lineBox.bottom || !hasHandler(cm, type)) { return e_defaultPrevented(e) }\n    mY -= lineBox.top - display.viewOffset;\n\n    for (var i = 0; i < cm.display.gutterSpecs.length; ++i) {\n      var g = display.gutters.childNodes[i];\n      if (g && g.getBoundingClientRect().right >= mX) {\n        var line = lineAtHeight(cm.doc, mY);\n        var gutter = cm.display.gutterSpecs[i];\n        signal(cm, type, cm, line, gutter.className, e);\n        return e_defaultPrevented(e)\n      }\n    }\n  }\n\n  function clickInGutter(cm, e) {\n    return gutterEvent(cm, e, \"gutterClick\", true)\n  }\n\n  // CONTEXT MENU HANDLING\n\n  // To make the context menu work, we need to briefly unhide the\n  // textarea (making it as unobtrusive as possible) to let the\n  // right-click take effect on it.\n  function onContextMenu(cm, e) {\n    if (eventInWidget(cm.display, e) || contextMenuInGutter(cm, e)) { return }\n    if (signalDOMEvent(cm, e, \"contextmenu\")) { return }\n    if (!captureRightClick) { cm.display.input.onContextMenu(e); }\n  }\n\n  function contextMenuInGutter(cm, e) {\n    if (!hasHandler(cm, \"gutterContextMenu\")) { return false }\n    return gutterEvent(cm, e, \"gutterContextMenu\", false)\n  }\n\n  function themeChanged(cm) {\n    cm.display.wrapper.className = cm.display.wrapper.className.replace(/\\s*cm-s-\\S+/g, \"\") +\n      cm.options.theme.replace(/(^|\\s)\\s*/g, \" cm-s-\");\n    clearCaches(cm);\n  }\n\n  var Init = {toString: function(){return \"CodeMirror.Init\"}};\n\n  var defaults = {};\n  var optionHandlers = {};\n\n  function defineOptions(CodeMirror) {\n    var optionHandlers = CodeMirror.optionHandlers;\n\n    function option(name, deflt, handle, notOnInit) {\n      CodeMirror.defaults[name] = deflt;\n      if (handle) { optionHandlers[name] =\n        notOnInit ? function (cm, val, old) {if (old != Init) { handle(cm, val, old); }} : handle; }\n    }\n\n    CodeMirror.defineOption = option;\n\n    // Passed to option handlers when there is no old value.\n    CodeMirror.Init = Init;\n\n    // These two are, on init, called from the constructor because they\n    // have to be initialized before the editor can start at all.\n    option(\"value\", \"\", function (cm, val) { return cm.setValue(val); }, true);\n    option(\"mode\", null, function (cm, val) {\n      cm.doc.modeOption = val;\n      loadMode(cm);\n    }, true);\n\n    option(\"indentUnit\", 2, loadMode, true);\n    option(\"indentWithTabs\", false);\n    option(\"smartIndent\", true);\n    option(\"tabSize\", 4, function (cm) {\n      resetModeState(cm);\n      clearCaches(cm);\n      regChange(cm);\n    }, true);\n\n    option(\"lineSeparator\", null, function (cm, val) {\n      cm.doc.lineSep = val;\n      if (!val) { return }\n      var newBreaks = [], lineNo = cm.doc.first;\n      cm.doc.iter(function (line) {\n        for (var pos = 0;;) {\n          var found = line.text.indexOf(val, pos);\n          if (found == -1) { break }\n          pos = found + val.length;\n          newBreaks.push(Pos(lineNo, found));\n        }\n        lineNo++;\n      });\n      for (var i = newBreaks.length - 1; i >= 0; i--)\n        { replaceRange(cm.doc, val, newBreaks[i], Pos(newBreaks[i].line, newBreaks[i].ch + val.length)); }\n    });\n    option(\"specialChars\", /[\\u0000-\\u001f\\u007f-\\u009f\\u00ad\\u061c\\u200b\\u200e\\u200f\\u2028\\u2029\\ufeff\\ufff9-\\ufffc]/g, function (cm, val, old) {\n      cm.state.specialChars = new RegExp(val.source + (val.test(\"\\t\") ? \"\" : \"|\\t\"), \"g\");\n      if (old != Init) { cm.refresh(); }\n    });\n    option(\"specialCharPlaceholder\", defaultSpecialCharPlaceholder, function (cm) { return cm.refresh(); }, true);\n    option(\"electricChars\", true);\n    option(\"inputStyle\", mobile ? \"contenteditable\" : \"textarea\", function () {\n      throw new Error(\"inputStyle can not (yet) be changed in a running editor\") // FIXME\n    }, true);\n    option(\"spellcheck\", false, function (cm, val) { return cm.getInputField().spellcheck = val; }, true);\n    option(\"autocorrect\", false, function (cm, val) { return cm.getInputField().autocorrect = val; }, true);\n    option(\"autocapitalize\", false, function (cm, val) { return cm.getInputField().autocapitalize = val; }, true);\n    option(\"rtlMoveVisually\", !windows);\n    option(\"wholeLineUpdateBefore\", true);\n\n    option(\"theme\", \"default\", function (cm) {\n      themeChanged(cm);\n      updateGutters(cm);\n    }, true);\n    option(\"keyMap\", \"default\", function (cm, val, old) {\n      var next = getKeyMap(val);\n      var prev = old != Init && getKeyMap(old);\n      if (prev && prev.detach) { prev.detach(cm, next); }\n      if (next.attach) { next.attach(cm, prev || null); }\n    });\n    option(\"extraKeys\", null);\n    option(\"configureMouse\", null);\n\n    option(\"lineWrapping\", false, wrappingChanged, true);\n    option(\"gutters\", [], function (cm, val) {\n      cm.display.gutterSpecs = getGutters(val, cm.options.lineNumbers);\n      updateGutters(cm);\n    }, true);\n    option(\"fixedGutter\", true, function (cm, val) {\n      cm.display.gutters.style.left = val ? compensateForHScroll(cm.display) + \"px\" : \"0\";\n      cm.refresh();\n    }, true);\n    option(\"coverGutterNextToScrollbar\", false, function (cm) { return updateScrollbars(cm); }, true);\n    option(\"scrollbarStyle\", \"native\", function (cm) {\n      initScrollbars(cm);\n      updateScrollbars(cm);\n      cm.display.scrollbars.setScrollTop(cm.doc.scrollTop);\n      cm.display.scrollbars.setScrollLeft(cm.doc.scrollLeft);\n    }, true);\n    option(\"lineNumbers\", false, function (cm, val) {\n      cm.display.gutterSpecs = getGutters(cm.options.gutters, val);\n      updateGutters(cm);\n    }, true);\n    option(\"firstLineNumber\", 1, updateGutters, true);\n    option(\"lineNumberFormatter\", function (integer) { return integer; }, updateGutters, true);\n    option(\"showCursorWhenSelecting\", false, updateSelection, true);\n\n    option(\"resetSelectionOnContextMenu\", true);\n    option(\"lineWiseCopyCut\", true);\n    option(\"pasteLinesPerSelection\", true);\n    option(\"selectionsMayTouch\", false);\n\n    option(\"readOnly\", false, function (cm, val) {\n      if (val == \"nocursor\") {\n        onBlur(cm);\n        cm.display.input.blur();\n      }\n      cm.display.input.readOnlyChanged(val);\n    });\n\n    option(\"screenReaderLabel\", null, function (cm, val) {\n      val = (val === '') ? null : val;\n      cm.display.input.screenReaderLabelChanged(val);\n    });\n\n    option(\"disableInput\", false, function (cm, val) {if (!val) { cm.display.input.reset(); }}, true);\n    option(\"dragDrop\", true, dragDropChanged);\n    option(\"allowDropFileTypes\", null);\n\n    option(\"cursorBlinkRate\", 530);\n    option(\"cursorScrollMargin\", 0);\n    option(\"cursorHeight\", 1, updateSelection, true);\n    option(\"singleCursorHeightPerLine\", true, updateSelection, true);\n    option(\"workTime\", 100);\n    option(\"workDelay\", 100);\n    option(\"flattenSpans\", true, resetModeState, true);\n    option(\"addModeClass\", false, resetModeState, true);\n    option(\"pollInterval\", 100);\n    option(\"undoDepth\", 200, function (cm, val) { return cm.doc.history.undoDepth = val; });\n    option(\"historyEventDelay\", 1250);\n    option(\"viewportMargin\", 10, function (cm) { return cm.refresh(); }, true);\n    option(\"maxHighlightLength\", 10000, resetModeState, true);\n    option(\"moveInputWithCursor\", true, function (cm, val) {\n      if (!val) { cm.display.input.resetPosition(); }\n    });\n\n    option(\"tabindex\", null, function (cm, val) { return cm.display.input.getField().tabIndex = val || \"\"; });\n    option(\"autofocus\", null);\n    option(\"direction\", \"ltr\", function (cm, val) { return cm.doc.setDirection(val); }, true);\n    option(\"phrases\", null);\n  }\n\n  function dragDropChanged(cm, value, old) {\n    var wasOn = old && old != Init;\n    if (!value != !wasOn) {\n      var funcs = cm.display.dragFunctions;\n      var toggle = value ? on : off;\n      toggle(cm.display.scroller, \"dragstart\", funcs.start);\n      toggle(cm.display.scroller, \"dragenter\", funcs.enter);\n      toggle(cm.display.scroller, \"dragover\", funcs.over);\n      toggle(cm.display.scroller, \"dragleave\", funcs.leave);\n      toggle(cm.display.scroller, \"drop\", funcs.drop);\n    }\n  }\n\n  function wrappingChanged(cm) {\n    if (cm.options.lineWrapping) {\n      addClass(cm.display.wrapper, \"CodeMirror-wrap\");\n      cm.display.sizer.style.minWidth = \"\";\n      cm.display.sizerWidth = null;\n    } else {\n      rmClass(cm.display.wrapper, \"CodeMirror-wrap\");\n      findMaxLine(cm);\n    }\n    estimateLineHeights(cm);\n    regChange(cm);\n    clearCaches(cm);\n    setTimeout(function () { return updateScrollbars(cm); }, 100);\n  }\n\n  // A CodeMirror instance represents an editor. This is the object\n  // that user code is usually dealing with.\n\n  function CodeMirror(place, options) {\n    var this$1 = this;\n\n    if (!(this instanceof CodeMirror)) { return new CodeMirror(place, options) }\n\n    this.options = options = options ? copyObj(options) : {};\n    // Determine effective options based on given values and defaults.\n    copyObj(defaults, options, false);\n\n    var doc = options.value;\n    if (typeof doc == \"string\") { doc = new Doc(doc, options.mode, null, options.lineSeparator, options.direction); }\n    else if (options.mode) { doc.modeOption = options.mode; }\n    this.doc = doc;\n\n    var input = new CodeMirror.inputStyles[options.inputStyle](this);\n    var display = this.display = new Display(place, doc, input, options);\n    display.wrapper.CodeMirror = this;\n    themeChanged(this);\n    if (options.lineWrapping)\n      { this.display.wrapper.className += \" CodeMirror-wrap\"; }\n    initScrollbars(this);\n\n    this.state = {\n      keyMaps: [],  // stores maps added by addKeyMap\n      overlays: [], // highlighting overlays, as added by addOverlay\n      modeGen: 0,   // bumped when mode/overlay changes, used to invalidate highlighting info\n      overwrite: false,\n      delayingBlurEvent: false,\n      focused: false,\n      suppressEdits: false, // used to disable editing during key handlers when in readOnly mode\n      pasteIncoming: -1, cutIncoming: -1, // help recognize paste/cut edits in input.poll\n      selectingText: false,\n      draggingText: false,\n      highlight: new Delayed(), // stores highlight worker timeout\n      keySeq: null,  // Unfinished key sequence\n      specialChars: null\n    };\n\n    if (options.autofocus && !mobile) { display.input.focus(); }\n\n    // Override magic textarea content restore that IE sometimes does\n    // on our hidden textarea on reload\n    if (ie && ie_version < 11) { setTimeout(function () { return this$1.display.input.reset(true); }, 20); }\n\n    registerEventHandlers(this);\n    ensureGlobalHandlers();\n\n    startOperation(this);\n    this.curOp.forceUpdate = true;\n    attachDoc(this, doc);\n\n    if ((options.autofocus && !mobile) || this.hasFocus())\n      { setTimeout(function () {\n        if (this$1.hasFocus() && !this$1.state.focused) { onFocus(this$1); }\n      }, 20); }\n    else\n      { onBlur(this); }\n\n    for (var opt in optionHandlers) { if (optionHandlers.hasOwnProperty(opt))\n      { optionHandlers[opt](this, options[opt], Init); } }\n    maybeUpdateLineNumberWidth(this);\n    if (options.finishInit) { options.finishInit(this); }\n    for (var i = 0; i < initHooks.length; ++i) { initHooks[i](this); }\n    endOperation(this);\n    // Suppress optimizelegibility in Webkit, since it breaks text\n    // measuring on line wrapping boundaries.\n    if (webkit && options.lineWrapping &&\n        getComputedStyle(display.lineDiv).textRendering == \"optimizelegibility\")\n      { display.lineDiv.style.textRendering = \"auto\"; }\n  }\n\n  // The default configuration options.\n  CodeMirror.defaults = defaults;\n  // Functions to run when options are changed.\n  CodeMirror.optionHandlers = optionHandlers;\n\n  // Attach the necessary event handlers when initializing the editor\n  function registerEventHandlers(cm) {\n    var d = cm.display;\n    on(d.scroller, \"mousedown\", operation(cm, onMouseDown));\n    // Older IE's will not fire a second mousedown for a double click\n    if (ie && ie_version < 11)\n      { on(d.scroller, \"dblclick\", operation(cm, function (e) {\n        if (signalDOMEvent(cm, e)) { return }\n        var pos = posFromMouse(cm, e);\n        if (!pos || clickInGutter(cm, e) || eventInWidget(cm.display, e)) { return }\n        e_preventDefault(e);\n        var word = cm.findWordAt(pos);\n        extendSelection(cm.doc, word.anchor, word.head);\n      })); }\n    else\n      { on(d.scroller, \"dblclick\", function (e) { return signalDOMEvent(cm, e) || e_preventDefault(e); }); }\n    // Some browsers fire contextmenu *after* opening the menu, at\n    // which point we can't mess with it anymore. Context menu is\n    // handled in onMouseDown for these browsers.\n    on(d.scroller, \"contextmenu\", function (e) { return onContextMenu(cm, e); });\n    on(d.input.getField(), \"contextmenu\", function (e) {\n      if (!d.scroller.contains(e.target)) { onContextMenu(cm, e); }\n    });\n\n    // Used to suppress mouse event handling when a touch happens\n    var touchFinished, prevTouch = {end: 0};\n    function finishTouch() {\n      if (d.activeTouch) {\n        touchFinished = setTimeout(function () { return d.activeTouch = null; }, 1000);\n        prevTouch = d.activeTouch;\n        prevTouch.end = +new Date;\n      }\n    }\n    function isMouseLikeTouchEvent(e) {\n      if (e.touches.length != 1) { return false }\n      var touch = e.touches[0];\n      return touch.radiusX <= 1 && touch.radiusY <= 1\n    }\n    function farAway(touch, other) {\n      if (other.left == null) { return true }\n      var dx = other.left - touch.left, dy = other.top - touch.top;\n      return dx * dx + dy * dy > 20 * 20\n    }\n    on(d.scroller, \"touchstart\", function (e) {\n      if (!signalDOMEvent(cm, e) && !isMouseLikeTouchEvent(e) && !clickInGutter(cm, e)) {\n        d.input.ensurePolled();\n        clearTimeout(touchFinished);\n        var now = +new Date;\n        d.activeTouch = {start: now, moved: false,\n                         prev: now - prevTouch.end <= 300 ? prevTouch : null};\n        if (e.touches.length == 1) {\n          d.activeTouch.left = e.touches[0].pageX;\n          d.activeTouch.top = e.touches[0].pageY;\n        }\n      }\n    });\n    on(d.scroller, \"touchmove\", function () {\n      if (d.activeTouch) { d.activeTouch.moved = true; }\n    });\n    on(d.scroller, \"touchend\", function (e) {\n      var touch = d.activeTouch;\n      if (touch && !eventInWidget(d, e) && touch.left != null &&\n          !touch.moved && new Date - touch.start < 300) {\n        var pos = cm.coordsChar(d.activeTouch, \"page\"), range;\n        if (!touch.prev || farAway(touch, touch.prev)) // Single tap\n          { range = new Range(pos, pos); }\n        else if (!touch.prev.prev || farAway(touch, touch.prev.prev)) // Double tap\n          { range = cm.findWordAt(pos); }\n        else // Triple tap\n          { range = new Range(Pos(pos.line, 0), clipPos(cm.doc, Pos(pos.line + 1, 0))); }\n        cm.setSelection(range.anchor, range.head);\n        cm.focus();\n        e_preventDefault(e);\n      }\n      finishTouch();\n    });\n    on(d.scroller, \"touchcancel\", finishTouch);\n\n    // Sync scrolling between fake scrollbars and real scrollable\n    // area, ensure viewport is updated when scrolling.\n    on(d.scroller, \"scroll\", function () {\n      if (d.scroller.clientHeight) {\n        updateScrollTop(cm, d.scroller.scrollTop);\n        setScrollLeft(cm, d.scroller.scrollLeft, true);\n        signal(cm, \"scroll\", cm);\n      }\n    });\n\n    // Listen to wheel events in order to try and update the viewport on time.\n    on(d.scroller, \"mousewheel\", function (e) { return onScrollWheel(cm, e); });\n    on(d.scroller, \"DOMMouseScroll\", function (e) { return onScrollWheel(cm, e); });\n\n    // Prevent wrapper from ever scrolling\n    on(d.wrapper, \"scroll\", function () { return d.wrapper.scrollTop = d.wrapper.scrollLeft = 0; });\n\n    d.dragFunctions = {\n      enter: function (e) {if (!signalDOMEvent(cm, e)) { e_stop(e); }},\n      over: function (e) {if (!signalDOMEvent(cm, e)) { onDragOver(cm, e); e_stop(e); }},\n      start: function (e) { return onDragStart(cm, e); },\n      drop: operation(cm, onDrop),\n      leave: function (e) {if (!signalDOMEvent(cm, e)) { clearDragCursor(cm); }}\n    };\n\n    var inp = d.input.getField();\n    on(inp, \"keyup\", function (e) { return onKeyUp.call(cm, e); });\n    on(inp, \"keydown\", operation(cm, onKeyDown));\n    on(inp, \"keypress\", operation(cm, onKeyPress));\n    on(inp, \"focus\", function (e) { return onFocus(cm, e); });\n    on(inp, \"blur\", function (e) { return onBlur(cm, e); });\n  }\n\n  var initHooks = [];\n  CodeMirror.defineInitHook = function (f) { return initHooks.push(f); };\n\n  // Indent the given line. The how parameter can be \"smart\",\n  // \"add\"/null, \"subtract\", or \"prev\". When aggressive is false\n  // (typically set to true for forced single-line indents), empty\n  // lines are not indented, and places where the mode returns Pass\n  // are left alone.\n  function indentLine(cm, n, how, aggressive) {\n    var doc = cm.doc, state;\n    if (how == null) { how = \"add\"; }\n    if (how == \"smart\") {\n      // Fall back to \"prev\" when the mode doesn't have an indentation\n      // method.\n      if (!doc.mode.indent) { how = \"prev\"; }\n      else { state = getContextBefore(cm, n).state; }\n    }\n\n    var tabSize = cm.options.tabSize;\n    var line = getLine(doc, n), curSpace = countColumn(line.text, null, tabSize);\n    if (line.stateAfter) { line.stateAfter = null; }\n    var curSpaceString = line.text.match(/^\\s*/)[0], indentation;\n    if (!aggressive && !/\\S/.test(line.text)) {\n      indentation = 0;\n      how = \"not\";\n    } else if (how == \"smart\") {\n      indentation = doc.mode.indent(state, line.text.slice(curSpaceString.length), line.text);\n      if (indentation == Pass || indentation > 150) {\n        if (!aggressive) { return }\n        how = \"prev\";\n      }\n    }\n    if (how == \"prev\") {\n      if (n > doc.first) { indentation = countColumn(getLine(doc, n-1).text, null, tabSize); }\n      else { indentation = 0; }\n    } else if (how == \"add\") {\n      indentation = curSpace + cm.options.indentUnit;\n    } else if (how == \"subtract\") {\n      indentation = curSpace - cm.options.indentUnit;\n    } else if (typeof how == \"number\") {\n      indentation = curSpace + how;\n    }\n    indentation = Math.max(0, indentation);\n\n    var indentString = \"\", pos = 0;\n    if (cm.options.indentWithTabs)\n      { for (var i = Math.floor(indentation / tabSize); i; --i) {pos += tabSize; indentString += \"\\t\";} }\n    if (pos < indentation) { indentString += spaceStr(indentation - pos); }\n\n    if (indentString != curSpaceString) {\n      replaceRange(doc, indentString, Pos(n, 0), Pos(n, curSpaceString.length), \"+input\");\n      line.stateAfter = null;\n      return true\n    } else {\n      // Ensure that, if the cursor was in the whitespace at the start\n      // of the line, it is moved to the end of that space.\n      for (var i$1 = 0; i$1 < doc.sel.ranges.length; i$1++) {\n        var range = doc.sel.ranges[i$1];\n        if (range.head.line == n && range.head.ch < curSpaceString.length) {\n          var pos$1 = Pos(n, curSpaceString.length);\n          replaceOneSelection(doc, i$1, new Range(pos$1, pos$1));\n          break\n        }\n      }\n    }\n  }\n\n  // This will be set to a {lineWise: bool, text: [string]} object, so\n  // that, when pasting, we know what kind of selections the copied\n  // text was made out of.\n  var lastCopied = null;\n\n  function setLastCopied(newLastCopied) {\n    lastCopied = newLastCopied;\n  }\n\n  function applyTextInput(cm, inserted, deleted, sel, origin) {\n    var doc = cm.doc;\n    cm.display.shift = false;\n    if (!sel) { sel = doc.sel; }\n\n    var recent = +new Date - 200;\n    var paste = origin == \"paste\" || cm.state.pasteIncoming > recent;\n    var textLines = splitLinesAuto(inserted), multiPaste = null;\n    // When pasting N lines into N selections, insert one line per selection\n    if (paste && sel.ranges.length > 1) {\n      if (lastCopied && lastCopied.text.join(\"\\n\") == inserted) {\n        if (sel.ranges.length % lastCopied.text.length == 0) {\n          multiPaste = [];\n          for (var i = 0; i < lastCopied.text.length; i++)\n            { multiPaste.push(doc.splitLines(lastCopied.text[i])); }\n        }\n      } else if (textLines.length == sel.ranges.length && cm.options.pasteLinesPerSelection) {\n        multiPaste = map(textLines, function (l) { return [l]; });\n      }\n    }\n\n    var updateInput = cm.curOp.updateInput;\n    // Normal behavior is to insert the new text into every selection\n    for (var i$1 = sel.ranges.length - 1; i$1 >= 0; i$1--) {\n      var range = sel.ranges[i$1];\n      var from = range.from(), to = range.to();\n      if (range.empty()) {\n        if (deleted && deleted > 0) // Handle deletion\n          { from = Pos(from.line, from.ch - deleted); }\n        else if (cm.state.overwrite && !paste) // Handle overwrite\n          { to = Pos(to.line, Math.min(getLine(doc, to.line).text.length, to.ch + lst(textLines).length)); }\n        else if (paste && lastCopied && lastCopied.lineWise && lastCopied.text.join(\"\\n\") == textLines.join(\"\\n\"))\n          { from = to = Pos(from.line, 0); }\n      }\n      var changeEvent = {from: from, to: to, text: multiPaste ? multiPaste[i$1 % multiPaste.length] : textLines,\n                         origin: origin || (paste ? \"paste\" : cm.state.cutIncoming > recent ? \"cut\" : \"+input\")};\n      makeChange(cm.doc, changeEvent);\n      signalLater(cm, \"inputRead\", cm, changeEvent);\n    }\n    if (inserted && !paste)\n      { triggerElectric(cm, inserted); }\n\n    ensureCursorVisible(cm);\n    if (cm.curOp.updateInput < 2) { cm.curOp.updateInput = updateInput; }\n    cm.curOp.typing = true;\n    cm.state.pasteIncoming = cm.state.cutIncoming = -1;\n  }\n\n  function handlePaste(e, cm) {\n    var pasted = e.clipboardData && e.clipboardData.getData(\"Text\");\n    if (pasted) {\n      e.preventDefault();\n      if (!cm.isReadOnly() && !cm.options.disableInput)\n        { runInOp(cm, function () { return applyTextInput(cm, pasted, 0, null, \"paste\"); }); }\n      return true\n    }\n  }\n\n  function triggerElectric(cm, inserted) {\n    // When an 'electric' character is inserted, immediately trigger a reindent\n    if (!cm.options.electricChars || !cm.options.smartIndent) { return }\n    var sel = cm.doc.sel;\n\n    for (var i = sel.ranges.length - 1; i >= 0; i--) {\n      var range = sel.ranges[i];\n      if (range.head.ch > 100 || (i && sel.ranges[i - 1].head.line == range.head.line)) { continue }\n      var mode = cm.getModeAt(range.head);\n      var indented = false;\n      if (mode.electricChars) {\n        for (var j = 0; j < mode.electricChars.length; j++)\n          { if (inserted.indexOf(mode.electricChars.charAt(j)) > -1) {\n            indented = indentLine(cm, range.head.line, \"smart\");\n            break\n          } }\n      } else if (mode.electricInput) {\n        if (mode.electricInput.test(getLine(cm.doc, range.head.line).text.slice(0, range.head.ch)))\n          { indented = indentLine(cm, range.head.line, \"smart\"); }\n      }\n      if (indented) { signalLater(cm, \"electricInput\", cm, range.head.line); }\n    }\n  }\n\n  function copyableRanges(cm) {\n    var text = [], ranges = [];\n    for (var i = 0; i < cm.doc.sel.ranges.length; i++) {\n      var line = cm.doc.sel.ranges[i].head.line;\n      var lineRange = {anchor: Pos(line, 0), head: Pos(line + 1, 0)};\n      ranges.push(lineRange);\n      text.push(cm.getRange(lineRange.anchor, lineRange.head));\n    }\n    return {text: text, ranges: ranges}\n  }\n\n  function disableBrowserMagic(field, spellcheck, autocorrect, autocapitalize) {\n    field.setAttribute(\"autocorrect\", autocorrect ? \"\" : \"off\");\n    field.setAttribute(\"autocapitalize\", autocapitalize ? \"\" : \"off\");\n    field.setAttribute(\"spellcheck\", !!spellcheck);\n  }\n\n  function hiddenTextarea() {\n    var te = elt(\"textarea\", null, null, \"position: absolute; bottom: -1em; padding: 0; width: 1px; height: 1em; outline: none\");\n    var div = elt(\"div\", [te], null, \"overflow: hidden; position: relative; width: 3px; height: 0px;\");\n    // The textarea is kept positioned near the cursor to prevent the\n    // fact that it'll be scrolled into view on input from scrolling\n    // our fake cursor out of view. On webkit, when wrap=off, paste is\n    // very slow. So make the area wide instead.\n    if (webkit) { te.style.width = \"1000px\"; }\n    else { te.setAttribute(\"wrap\", \"off\"); }\n    // If border: 0; -- iOS fails to open keyboard (issue #1287)\n    if (ios) { te.style.border = \"1px solid black\"; }\n    disableBrowserMagic(te);\n    return div\n  }\n\n  // The publicly visible API. Note that methodOp(f) means\n  // 'wrap f in an operation, performed on its `this` parameter'.\n\n  // This is not the complete set of editor methods. Most of the\n  // methods defined on the Doc type are also injected into\n  // CodeMirror.prototype, for backwards compatibility and\n  // convenience.\n\n  function addEditorMethods(CodeMirror) {\n    var optionHandlers = CodeMirror.optionHandlers;\n\n    var helpers = CodeMirror.helpers = {};\n\n    CodeMirror.prototype = {\n      constructor: CodeMirror,\n      focus: function(){window.focus(); this.display.input.focus();},\n\n      setOption: function(option, value) {\n        var options = this.options, old = options[option];\n        if (options[option] == value && option != \"mode\") { return }\n        options[option] = value;\n        if (optionHandlers.hasOwnProperty(option))\n          { operation(this, optionHandlers[option])(this, value, old); }\n        signal(this, \"optionChange\", this, option);\n      },\n\n      getOption: function(option) {return this.options[option]},\n      getDoc: function() {return this.doc},\n\n      addKeyMap: function(map, bottom) {\n        this.state.keyMaps[bottom ? \"push\" : \"unshift\"](getKeyMap(map));\n      },\n      removeKeyMap: function(map) {\n        var maps = this.state.keyMaps;\n        for (var i = 0; i < maps.length; ++i)\n          { if (maps[i] == map || maps[i].name == map) {\n            maps.splice(i, 1);\n            return true\n          } }\n      },\n\n      addOverlay: methodOp(function(spec, options) {\n        var mode = spec.token ? spec : CodeMirror.getMode(this.options, spec);\n        if (mode.startState) { throw new Error(\"Overlays may not be stateful.\") }\n        insertSorted(this.state.overlays,\n                     {mode: mode, modeSpec: spec, opaque: options && options.opaque,\n                      priority: (options && options.priority) || 0},\n                     function (overlay) { return overlay.priority; });\n        this.state.modeGen++;\n        regChange(this);\n      }),\n      removeOverlay: methodOp(function(spec) {\n        var overlays = this.state.overlays;\n        for (var i = 0; i < overlays.length; ++i) {\n          var cur = overlays[i].modeSpec;\n          if (cur == spec || typeof spec == \"string\" && cur.name == spec) {\n            overlays.splice(i, 1);\n            this.state.modeGen++;\n            regChange(this);\n            return\n          }\n        }\n      }),\n\n      indentLine: methodOp(function(n, dir, aggressive) {\n        if (typeof dir != \"string\" && typeof dir != \"number\") {\n          if (dir == null) { dir = this.options.smartIndent ? \"smart\" : \"prev\"; }\n          else { dir = dir ? \"add\" : \"subtract\"; }\n        }\n        if (isLine(this.doc, n)) { indentLine(this, n, dir, aggressive); }\n      }),\n      indentSelection: methodOp(function(how) {\n        var ranges = this.doc.sel.ranges, end = -1;\n        for (var i = 0; i < ranges.length; i++) {\n          var range = ranges[i];\n          if (!range.empty()) {\n            var from = range.from(), to = range.to();\n            var start = Math.max(end, from.line);\n            end = Math.min(this.lastLine(), to.line - (to.ch ? 0 : 1)) + 1;\n            for (var j = start; j < end; ++j)\n              { indentLine(this, j, how); }\n            var newRanges = this.doc.sel.ranges;\n            if (from.ch == 0 && ranges.length == newRanges.length && newRanges[i].from().ch > 0)\n              { replaceOneSelection(this.doc, i, new Range(from, newRanges[i].to()), sel_dontScroll); }\n          } else if (range.head.line > end) {\n            indentLine(this, range.head.line, how, true);\n            end = range.head.line;\n            if (i == this.doc.sel.primIndex) { ensureCursorVisible(this); }\n          }\n        }\n      }),\n\n      // Fetch the parser token for a given character. Useful for hacks\n      // that want to inspect the mode state (say, for completion).\n      getTokenAt: function(pos, precise) {\n        return takeToken(this, pos, precise)\n      },\n\n      getLineTokens: function(line, precise) {\n        return takeToken(this, Pos(line), precise, true)\n      },\n\n      getTokenTypeAt: function(pos) {\n        pos = clipPos(this.doc, pos);\n        var styles = getLineStyles(this, getLine(this.doc, pos.line));\n        var before = 0, after = (styles.length - 1) / 2, ch = pos.ch;\n        var type;\n        if (ch == 0) { type = styles[2]; }\n        else { for (;;) {\n          var mid = (before + after) >> 1;\n          if ((mid ? styles[mid * 2 - 1] : 0) >= ch) { after = mid; }\n          else if (styles[mid * 2 + 1] < ch) { before = mid + 1; }\n          else { type = styles[mid * 2 + 2]; break }\n        } }\n        var cut = type ? type.indexOf(\"overlay \") : -1;\n        return cut < 0 ? type : cut == 0 ? null : type.slice(0, cut - 1)\n      },\n\n      getModeAt: function(pos) {\n        var mode = this.doc.mode;\n        if (!mode.innerMode) { return mode }\n        return CodeMirror.innerMode(mode, this.getTokenAt(pos).state).mode\n      },\n\n      getHelper: function(pos, type) {\n        return this.getHelpers(pos, type)[0]\n      },\n\n      getHelpers: function(pos, type) {\n        var found = [];\n        if (!helpers.hasOwnProperty(type)) { return found }\n        var help = helpers[type], mode = this.getModeAt(pos);\n        if (typeof mode[type] == \"string\") {\n          if (help[mode[type]]) { found.push(help[mode[type]]); }\n        } else if (mode[type]) {\n          for (var i = 0; i < mode[type].length; i++) {\n            var val = help[mode[type][i]];\n            if (val) { found.push(val); }\n          }\n        } else if (mode.helperType && help[mode.helperType]) {\n          found.push(help[mode.helperType]);\n        } else if (help[mode.name]) {\n          found.push(help[mode.name]);\n        }\n        for (var i$1 = 0; i$1 < help._global.length; i$1++) {\n          var cur = help._global[i$1];\n          if (cur.pred(mode, this) && indexOf(found, cur.val) == -1)\n            { found.push(cur.val); }\n        }\n        return found\n      },\n\n      getStateAfter: function(line, precise) {\n        var doc = this.doc;\n        line = clipLine(doc, line == null ? doc.first + doc.size - 1: line);\n        return getContextBefore(this, line + 1, precise).state\n      },\n\n      cursorCoords: function(start, mode) {\n        var pos, range = this.doc.sel.primary();\n        if (start == null) { pos = range.head; }\n        else if (typeof start == \"object\") { pos = clipPos(this.doc, start); }\n        else { pos = start ? range.from() : range.to(); }\n        return cursorCoords(this, pos, mode || \"page\")\n      },\n\n      charCoords: function(pos, mode) {\n        return charCoords(this, clipPos(this.doc, pos), mode || \"page\")\n      },\n\n      coordsChar: function(coords, mode) {\n        coords = fromCoordSystem(this, coords, mode || \"page\");\n        return coordsChar(this, coords.left, coords.top)\n      },\n\n      lineAtHeight: function(height, mode) {\n        height = fromCoordSystem(this, {top: height, left: 0}, mode || \"page\").top;\n        return lineAtHeight(this.doc, height + this.display.viewOffset)\n      },\n      heightAtLine: function(line, mode, includeWidgets) {\n        var end = false, lineObj;\n        if (typeof line == \"number\") {\n          var last = this.doc.first + this.doc.size - 1;\n          if (line < this.doc.first) { line = this.doc.first; }\n          else if (line > last) { line = last; end = true; }\n          lineObj = getLine(this.doc, line);\n        } else {\n          lineObj = line;\n        }\n        return intoCoordSystem(this, lineObj, {top: 0, left: 0}, mode || \"page\", includeWidgets || end).top +\n          (end ? this.doc.height - heightAtLine(lineObj) : 0)\n      },\n\n      defaultTextHeight: function() { return textHeight(this.display) },\n      defaultCharWidth: function() { return charWidth(this.display) },\n\n      getViewport: function() { return {from: this.display.viewFrom, to: this.display.viewTo}},\n\n      addWidget: function(pos, node, scroll, vert, horiz) {\n        var display = this.display;\n        pos = cursorCoords(this, clipPos(this.doc, pos));\n        var top = pos.bottom, left = pos.left;\n        node.style.position = \"absolute\";\n        node.setAttribute(\"cm-ignore-events\", \"true\");\n        this.display.input.setUneditable(node);\n        display.sizer.appendChild(node);\n        if (vert == \"over\") {\n          top = pos.top;\n        } else if (vert == \"above\" || vert == \"near\") {\n          var vspace = Math.max(display.wrapper.clientHeight, this.doc.height),\n          hspace = Math.max(display.sizer.clientWidth, display.lineSpace.clientWidth);\n          // Default to positioning above (if specified and possible); otherwise default to positioning below\n          if ((vert == 'above' || pos.bottom + node.offsetHeight > vspace) && pos.top > node.offsetHeight)\n            { top = pos.top - node.offsetHeight; }\n          else if (pos.bottom + node.offsetHeight <= vspace)\n            { top = pos.bottom; }\n          if (left + node.offsetWidth > hspace)\n            { left = hspace - node.offsetWidth; }\n        }\n        node.style.top = top + \"px\";\n        node.style.left = node.style.right = \"\";\n        if (horiz == \"right\") {\n          left = display.sizer.clientWidth - node.offsetWidth;\n          node.style.right = \"0px\";\n        } else {\n          if (horiz == \"left\") { left = 0; }\n          else if (horiz == \"middle\") { left = (display.sizer.clientWidth - node.offsetWidth) / 2; }\n          node.style.left = left + \"px\";\n        }\n        if (scroll)\n          { scrollIntoView(this, {left: left, top: top, right: left + node.offsetWidth, bottom: top + node.offsetHeight}); }\n      },\n\n      triggerOnKeyDown: methodOp(onKeyDown),\n      triggerOnKeyPress: methodOp(onKeyPress),\n      triggerOnKeyUp: onKeyUp,\n      triggerOnMouseDown: methodOp(onMouseDown),\n\n      execCommand: function(cmd) {\n        if (commands.hasOwnProperty(cmd))\n          { return commands[cmd].call(null, this) }\n      },\n\n      triggerElectric: methodOp(function(text) { triggerElectric(this, text); }),\n\n      findPosH: function(from, amount, unit, visually) {\n        var dir = 1;\n        if (amount < 0) { dir = -1; amount = -amount; }\n        var cur = clipPos(this.doc, from);\n        for (var i = 0; i < amount; ++i) {\n          cur = findPosH(this.doc, cur, dir, unit, visually);\n          if (cur.hitSide) { break }\n        }\n        return cur\n      },\n\n      moveH: methodOp(function(dir, unit) {\n        var this$1 = this;\n\n        this.extendSelectionsBy(function (range) {\n          if (this$1.display.shift || this$1.doc.extend || range.empty())\n            { return findPosH(this$1.doc, range.head, dir, unit, this$1.options.rtlMoveVisually) }\n          else\n            { return dir < 0 ? range.from() : range.to() }\n        }, sel_move);\n      }),\n\n      deleteH: methodOp(function(dir, unit) {\n        var sel = this.doc.sel, doc = this.doc;\n        if (sel.somethingSelected())\n          { doc.replaceSelection(\"\", null, \"+delete\"); }\n        else\n          { deleteNearSelection(this, function (range) {\n            var other = findPosH(doc, range.head, dir, unit, false);\n            return dir < 0 ? {from: other, to: range.head} : {from: range.head, to: other}\n          }); }\n      }),\n\n      findPosV: function(from, amount, unit, goalColumn) {\n        var dir = 1, x = goalColumn;\n        if (amount < 0) { dir = -1; amount = -amount; }\n        var cur = clipPos(this.doc, from);\n        for (var i = 0; i < amount; ++i) {\n          var coords = cursorCoords(this, cur, \"div\");\n          if (x == null) { x = coords.left; }\n          else { coords.left = x; }\n          cur = findPosV(this, coords, dir, unit);\n          if (cur.hitSide) { break }\n        }\n        return cur\n      },\n\n      moveV: methodOp(function(dir, unit) {\n        var this$1 = this;\n\n        var doc = this.doc, goals = [];\n        var collapse = !this.display.shift && !doc.extend && doc.sel.somethingSelected();\n        doc.extendSelectionsBy(function (range) {\n          if (collapse)\n            { return dir < 0 ? range.from() : range.to() }\n          var headPos = cursorCoords(this$1, range.head, \"div\");\n          if (range.goalColumn != null) { headPos.left = range.goalColumn; }\n          goals.push(headPos.left);\n          var pos = findPosV(this$1, headPos, dir, unit);\n          if (unit == \"page\" && range == doc.sel.primary())\n            { addToScrollTop(this$1, charCoords(this$1, pos, \"div\").top - headPos.top); }\n          return pos\n        }, sel_move);\n        if (goals.length) { for (var i = 0; i < doc.sel.ranges.length; i++)\n          { doc.sel.ranges[i].goalColumn = goals[i]; } }\n      }),\n\n      // Find the word at the given position (as returned by coordsChar).\n      findWordAt: function(pos) {\n        var doc = this.doc, line = getLine(doc, pos.line).text;\n        var start = pos.ch, end = pos.ch;\n        if (line) {\n          var helper = this.getHelper(pos, \"wordChars\");\n          if ((pos.sticky == \"before\" || end == line.length) && start) { --start; } else { ++end; }\n          var startChar = line.charAt(start);\n          var check = isWordChar(startChar, helper)\n            ? function (ch) { return isWordChar(ch, helper); }\n            : /\\s/.test(startChar) ? function (ch) { return /\\s/.test(ch); }\n            : function (ch) { return (!/\\s/.test(ch) && !isWordChar(ch)); };\n          while (start > 0 && check(line.charAt(start - 1))) { --start; }\n          while (end < line.length && check(line.charAt(end))) { ++end; }\n        }\n        return new Range(Pos(pos.line, start), Pos(pos.line, end))\n      },\n\n      toggleOverwrite: function(value) {\n        if (value != null && value == this.state.overwrite) { return }\n        if (this.state.overwrite = !this.state.overwrite)\n          { addClass(this.display.cursorDiv, \"CodeMirror-overwrite\"); }\n        else\n          { rmClass(this.display.cursorDiv, \"CodeMirror-overwrite\"); }\n\n        signal(this, \"overwriteToggle\", this, this.state.overwrite);\n      },\n      hasFocus: function() { return this.display.input.getField() == activeElt() },\n      isReadOnly: function() { return !!(this.options.readOnly || this.doc.cantEdit) },\n\n      scrollTo: methodOp(function (x, y) { scrollToCoords(this, x, y); }),\n      getScrollInfo: function() {\n        var scroller = this.display.scroller;\n        return {left: scroller.scrollLeft, top: scroller.scrollTop,\n                height: scroller.scrollHeight - scrollGap(this) - this.display.barHeight,\n                width: scroller.scrollWidth - scrollGap(this) - this.display.barWidth,\n                clientHeight: displayHeight(this), clientWidth: displayWidth(this)}\n      },\n\n      scrollIntoView: methodOp(function(range, margin) {\n        if (range == null) {\n          range = {from: this.doc.sel.primary().head, to: null};\n          if (margin == null) { margin = this.options.cursorScrollMargin; }\n        } else if (typeof range == \"number\") {\n          range = {from: Pos(range, 0), to: null};\n        } else if (range.from == null) {\n          range = {from: range, to: null};\n        }\n        if (!range.to) { range.to = range.from; }\n        range.margin = margin || 0;\n\n        if (range.from.line != null) {\n          scrollToRange(this, range);\n        } else {\n          scrollToCoordsRange(this, range.from, range.to, range.margin);\n        }\n      }),\n\n      setSize: methodOp(function(width, height) {\n        var this$1 = this;\n\n        var interpret = function (val) { return typeof val == \"number\" || /^\\d+$/.test(String(val)) ? val + \"px\" : val; };\n        if (width != null) { this.display.wrapper.style.width = interpret(width); }\n        if (height != null) { this.display.wrapper.style.height = interpret(height); }\n        if (this.options.lineWrapping) { clearLineMeasurementCache(this); }\n        var lineNo = this.display.viewFrom;\n        this.doc.iter(lineNo, this.display.viewTo, function (line) {\n          if (line.widgets) { for (var i = 0; i < line.widgets.length; i++)\n            { if (line.widgets[i].noHScroll) { regLineChange(this$1, lineNo, \"widget\"); break } } }\n          ++lineNo;\n        });\n        this.curOp.forceUpdate = true;\n        signal(this, \"refresh\", this);\n      }),\n\n      operation: function(f){return runInOp(this, f)},\n      startOperation: function(){return startOperation(this)},\n      endOperation: function(){return endOperation(this)},\n\n      refresh: methodOp(function() {\n        var oldHeight = this.display.cachedTextHeight;\n        regChange(this);\n        this.curOp.forceUpdate = true;\n        clearCaches(this);\n        scrollToCoords(this, this.doc.scrollLeft, this.doc.scrollTop);\n        updateGutterSpace(this.display);\n        if (oldHeight == null || Math.abs(oldHeight - textHeight(this.display)) > .5 || this.options.lineWrapping)\n          { estimateLineHeights(this); }\n        signal(this, \"refresh\", this);\n      }),\n\n      swapDoc: methodOp(function(doc) {\n        var old = this.doc;\n        old.cm = null;\n        // Cancel the current text selection if any (#5821)\n        if (this.state.selectingText) { this.state.selectingText(); }\n        attachDoc(this, doc);\n        clearCaches(this);\n        this.display.input.reset();\n        scrollToCoords(this, doc.scrollLeft, doc.scrollTop);\n        this.curOp.forceScroll = true;\n        signalLater(this, \"swapDoc\", this, old);\n        return old\n      }),\n\n      phrase: function(phraseText) {\n        var phrases = this.options.phrases;\n        return phrases && Object.prototype.hasOwnProperty.call(phrases, phraseText) ? phrases[phraseText] : phraseText\n      },\n\n      getInputField: function(){return this.display.input.getField()},\n      getWrapperElement: function(){return this.display.wrapper},\n      getScrollerElement: function(){return this.display.scroller},\n      getGutterElement: function(){return this.display.gutters}\n    };\n    eventMixin(CodeMirror);\n\n    CodeMirror.registerHelper = function(type, name, value) {\n      if (!helpers.hasOwnProperty(type)) { helpers[type] = CodeMirror[type] = {_global: []}; }\n      helpers[type][name] = value;\n    };\n    CodeMirror.registerGlobalHelper = function(type, name, predicate, value) {\n      CodeMirror.registerHelper(type, name, value);\n      helpers[type]._global.push({pred: predicate, val: value});\n    };\n  }\n\n  // Used for horizontal relative motion. Dir is -1 or 1 (left or\n  // right), unit can be \"codepoint\", \"char\", \"column\" (like char, but\n  // doesn't cross line boundaries), \"word\" (across next word), or\n  // \"group\" (to the start of next group of word or\n  // non-word-non-whitespace chars). The visually param controls\n  // whether, in right-to-left text, direction 1 means to move towards\n  // the next index in the string, or towards the character to the right\n  // of the current position. The resulting position will have a\n  // hitSide=true property if it reached the end of the document.\n  function findPosH(doc, pos, dir, unit, visually) {\n    var oldPos = pos;\n    var origDir = dir;\n    var lineObj = getLine(doc, pos.line);\n    var lineDir = visually && doc.direction == \"rtl\" ? -dir : dir;\n    function findNextLine() {\n      var l = pos.line + lineDir;\n      if (l < doc.first || l >= doc.first + doc.size) { return false }\n      pos = new Pos(l, pos.ch, pos.sticky);\n      return lineObj = getLine(doc, l)\n    }\n    function moveOnce(boundToLine) {\n      var next;\n      if (unit == \"codepoint\") {\n        var ch = lineObj.text.charCodeAt(pos.ch + (dir > 0 ? 0 : -1));\n        if (isNaN(ch)) {\n          next = null;\n        } else {\n          var astral = dir > 0 ? ch >= 0xD800 && ch < 0xDC00 : ch >= 0xDC00 && ch < 0xDFFF;\n          next = new Pos(pos.line, Math.max(0, Math.min(lineObj.text.length, pos.ch + dir * (astral ? 2 : 1))), -dir);\n        }\n      } else if (visually) {\n        next = moveVisually(doc.cm, lineObj, pos, dir);\n      } else {\n        next = moveLogically(lineObj, pos, dir);\n      }\n      if (next == null) {\n        if (!boundToLine && findNextLine())\n          { pos = endOfLine(visually, doc.cm, lineObj, pos.line, lineDir); }\n        else\n          { return false }\n      } else {\n        pos = next;\n      }\n      return true\n    }\n\n    if (unit == \"char\" || unit == \"codepoint\") {\n      moveOnce();\n    } else if (unit == \"column\") {\n      moveOnce(true);\n    } else if (unit == \"word\" || unit == \"group\") {\n      var sawType = null, group = unit == \"group\";\n      var helper = doc.cm && doc.cm.getHelper(pos, \"wordChars\");\n      for (var first = true;; first = false) {\n        if (dir < 0 && !moveOnce(!first)) { break }\n        var cur = lineObj.text.charAt(pos.ch) || \"\\n\";\n        var type = isWordChar(cur, helper) ? \"w\"\n          : group && cur == \"\\n\" ? \"n\"\n          : !group || /\\s/.test(cur) ? null\n          : \"p\";\n        if (group && !first && !type) { type = \"s\"; }\n        if (sawType && sawType != type) {\n          if (dir < 0) {dir = 1; moveOnce(); pos.sticky = \"after\";}\n          break\n        }\n\n        if (type) { sawType = type; }\n        if (dir > 0 && !moveOnce(!first)) { break }\n      }\n    }\n    var result = skipAtomic(doc, pos, oldPos, origDir, true);\n    if (equalCursorPos(oldPos, result)) { result.hitSide = true; }\n    return result\n  }\n\n  // For relative vertical movement. Dir may be -1 or 1. Unit can be\n  // \"page\" or \"line\". The resulting position will have a hitSide=true\n  // property if it reached the end of the document.\n  function findPosV(cm, pos, dir, unit) {\n    var doc = cm.doc, x = pos.left, y;\n    if (unit == \"page\") {\n      var pageSize = Math.min(cm.display.wrapper.clientHeight, window.innerHeight || document.documentElement.clientHeight);\n      var moveAmount = Math.max(pageSize - .5 * textHeight(cm.display), 3);\n      y = (dir > 0 ? pos.bottom : pos.top) + dir * moveAmount;\n\n    } else if (unit == \"line\") {\n      y = dir > 0 ? pos.bottom + 3 : pos.top - 3;\n    }\n    var target;\n    for (;;) {\n      target = coordsChar(cm, x, y);\n      if (!target.outside) { break }\n      if (dir < 0 ? y <= 0 : y >= doc.height) { target.hitSide = true; break }\n      y += dir * 5;\n    }\n    return target\n  }\n\n  // CONTENTEDITABLE INPUT STYLE\n\n  var ContentEditableInput = function(cm) {\n    this.cm = cm;\n    this.lastAnchorNode = this.lastAnchorOffset = this.lastFocusNode = this.lastFocusOffset = null;\n    this.polling = new Delayed();\n    this.composing = null;\n    this.gracePeriod = false;\n    this.readDOMTimeout = null;\n  };\n\n  ContentEditableInput.prototype.init = function (display) {\n      var this$1 = this;\n\n    var input = this, cm = input.cm;\n    var div = input.div = display.lineDiv;\n    div.contentEditable = true;\n    disableBrowserMagic(div, cm.options.spellcheck, cm.options.autocorrect, cm.options.autocapitalize);\n\n    function belongsToInput(e) {\n      for (var t = e.target; t; t = t.parentNode) {\n        if (t == div) { return true }\n        if (/\\bCodeMirror-(?:line)?widget\\b/.test(t.className)) { break }\n      }\n      return false\n    }\n\n    on(div, \"paste\", function (e) {\n      if (!belongsToInput(e) || signalDOMEvent(cm, e) || handlePaste(e, cm)) { return }\n      // IE doesn't fire input events, so we schedule a read for the pasted content in this way\n      if (ie_version <= 11) { setTimeout(operation(cm, function () { return this$1.updateFromDOM(); }), 20); }\n    });\n\n    on(div, \"compositionstart\", function (e) {\n      this$1.composing = {data: e.data, done: false};\n    });\n    on(div, \"compositionupdate\", function (e) {\n      if (!this$1.composing) { this$1.composing = {data: e.data, done: false}; }\n    });\n    on(div, \"compositionend\", function (e) {\n      if (this$1.composing) {\n        if (e.data != this$1.composing.data) { this$1.readFromDOMSoon(); }\n        this$1.composing.done = true;\n      }\n    });\n\n    on(div, \"touchstart\", function () { return input.forceCompositionEnd(); });\n\n    on(div, \"input\", function () {\n      if (!this$1.composing) { this$1.readFromDOMSoon(); }\n    });\n\n    function onCopyCut(e) {\n      if (!belongsToInput(e) || signalDOMEvent(cm, e)) { return }\n      if (cm.somethingSelected()) {\n        setLastCopied({lineWise: false, text: cm.getSelections()});\n        if (e.type == \"cut\") { cm.replaceSelection(\"\", null, \"cut\"); }\n      } else if (!cm.options.lineWiseCopyCut) {\n        return\n      } else {\n        var ranges = copyableRanges(cm);\n        setLastCopied({lineWise: true, text: ranges.text});\n        if (e.type == \"cut\") {\n          cm.operation(function () {\n            cm.setSelections(ranges.ranges, 0, sel_dontScroll);\n            cm.replaceSelection(\"\", null, \"cut\");\n          });\n        }\n      }\n      if (e.clipboardData) {\n        e.clipboardData.clearData();\n        var content = lastCopied.text.join(\"\\n\");\n        // iOS exposes the clipboard API, but seems to discard content inserted into it\n        e.clipboardData.setData(\"Text\", content);\n        if (e.clipboardData.getData(\"Text\") == content) {\n          e.preventDefault();\n          return\n        }\n      }\n      // Old-fashioned briefly-focus-a-textarea hack\n      var kludge = hiddenTextarea(), te = kludge.firstChild;\n      cm.display.lineSpace.insertBefore(kludge, cm.display.lineSpace.firstChild);\n      te.value = lastCopied.text.join(\"\\n\");\n      var hadFocus = activeElt();\n      selectInput(te);\n      setTimeout(function () {\n        cm.display.lineSpace.removeChild(kludge);\n        hadFocus.focus();\n        if (hadFocus == div) { input.showPrimarySelection(); }\n      }, 50);\n    }\n    on(div, \"copy\", onCopyCut);\n    on(div, \"cut\", onCopyCut);\n  };\n\n  ContentEditableInput.prototype.screenReaderLabelChanged = function (label) {\n    // Label for screenreaders, accessibility\n    if(label) {\n      this.div.setAttribute('aria-label', label);\n    } else {\n      this.div.removeAttribute('aria-label');\n    }\n  };\n\n  ContentEditableInput.prototype.prepareSelection = function () {\n    var result = prepareSelection(this.cm, false);\n    result.focus = activeElt() == this.div;\n    return result\n  };\n\n  ContentEditableInput.prototype.showSelection = function (info, takeFocus) {\n    if (!info || !this.cm.display.view.length) { return }\n    if (info.focus || takeFocus) { this.showPrimarySelection(); }\n    this.showMultipleSelections(info);\n  };\n\n  ContentEditableInput.prototype.getSelection = function () {\n    return this.cm.display.wrapper.ownerDocument.getSelection()\n  };\n\n  ContentEditableInput.prototype.showPrimarySelection = function () {\n    var sel = this.getSelection(), cm = this.cm, prim = cm.doc.sel.primary();\n    var from = prim.from(), to = prim.to();\n\n    if (cm.display.viewTo == cm.display.viewFrom || from.line >= cm.display.viewTo || to.line < cm.display.viewFrom) {\n      sel.removeAllRanges();\n      return\n    }\n\n    var curAnchor = domToPos(cm, sel.anchorNode, sel.anchorOffset);\n    var curFocus = domToPos(cm, sel.focusNode, sel.focusOffset);\n    if (curAnchor && !curAnchor.bad && curFocus && !curFocus.bad &&\n        cmp(minPos(curAnchor, curFocus), from) == 0 &&\n        cmp(maxPos(curAnchor, curFocus), to) == 0)\n      { return }\n\n    var view = cm.display.view;\n    var start = (from.line >= cm.display.viewFrom && posToDOM(cm, from)) ||\n        {node: view[0].measure.map[2], offset: 0};\n    var end = to.line < cm.display.viewTo && posToDOM(cm, to);\n    if (!end) {\n      var measure = view[view.length - 1].measure;\n      var map = measure.maps ? measure.maps[measure.maps.length - 1] : measure.map;\n      end = {node: map[map.length - 1], offset: map[map.length - 2] - map[map.length - 3]};\n    }\n\n    if (!start || !end) {\n      sel.removeAllRanges();\n      return\n    }\n\n    var old = sel.rangeCount && sel.getRangeAt(0), rng;\n    try { rng = range(start.node, start.offset, end.offset, end.node); }\n    catch(e) {} // Our model of the DOM might be outdated, in which case the range we try to set can be impossible\n    if (rng) {\n      if (!gecko && cm.state.focused) {\n        sel.collapse(start.node, start.offset);\n        if (!rng.collapsed) {\n          sel.removeAllRanges();\n          sel.addRange(rng);\n        }\n      } else {\n        sel.removeAllRanges();\n        sel.addRange(rng);\n      }\n      if (old && sel.anchorNode == null) { sel.addRange(old); }\n      else if (gecko) { this.startGracePeriod(); }\n    }\n    this.rememberSelection();\n  };\n\n  ContentEditableInput.prototype.startGracePeriod = function () {\n      var this$1 = this;\n\n    clearTimeout(this.gracePeriod);\n    this.gracePeriod = setTimeout(function () {\n      this$1.gracePeriod = false;\n      if (this$1.selectionChanged())\n        { this$1.cm.operation(function () { return this$1.cm.curOp.selectionChanged = true; }); }\n    }, 20);\n  };\n\n  ContentEditableInput.prototype.showMultipleSelections = function (info) {\n    removeChildrenAndAdd(this.cm.display.cursorDiv, info.cursors);\n    removeChildrenAndAdd(this.cm.display.selectionDiv, info.selection);\n  };\n\n  ContentEditableInput.prototype.rememberSelection = function () {\n    var sel = this.getSelection();\n    this.lastAnchorNode = sel.anchorNode; this.lastAnchorOffset = sel.anchorOffset;\n    this.lastFocusNode = sel.focusNode; this.lastFocusOffset = sel.focusOffset;\n  };\n\n  ContentEditableInput.prototype.selectionInEditor = function () {\n    var sel = this.getSelection();\n    if (!sel.rangeCount) { return false }\n    var node = sel.getRangeAt(0).commonAncestorContainer;\n    return contains(this.div, node)\n  };\n\n  ContentEditableInput.prototype.focus = function () {\n    if (this.cm.options.readOnly != \"nocursor\") {\n      if (!this.selectionInEditor() || activeElt() != this.div)\n        { this.showSelection(this.prepareSelection(), true); }\n      this.div.focus();\n    }\n  };\n  ContentEditableInput.prototype.blur = function () { this.div.blur(); };\n  ContentEditableInput.prototype.getField = function () { return this.div };\n\n  ContentEditableInput.prototype.supportsTouch = function () { return true };\n\n  ContentEditableInput.prototype.receivedFocus = function () {\n    var input = this;\n    if (this.selectionInEditor())\n      { this.pollSelection(); }\n    else\n      { runInOp(this.cm, function () { return input.cm.curOp.selectionChanged = true; }); }\n\n    function poll() {\n      if (input.cm.state.focused) {\n        input.pollSelection();\n        input.polling.set(input.cm.options.pollInterval, poll);\n      }\n    }\n    this.polling.set(this.cm.options.pollInterval, poll);\n  };\n\n  ContentEditableInput.prototype.selectionChanged = function () {\n    var sel = this.getSelection();\n    return sel.anchorNode != this.lastAnchorNode || sel.anchorOffset != this.lastAnchorOffset ||\n      sel.focusNode != this.lastFocusNode || sel.focusOffset != this.lastFocusOffset\n  };\n\n  ContentEditableInput.prototype.pollSelection = function () {\n    if (this.readDOMTimeout != null || this.gracePeriod || !this.selectionChanged()) { return }\n    var sel = this.getSelection(), cm = this.cm;\n    // On Android Chrome (version 56, at least), backspacing into an\n    // uneditable block element will put the cursor in that element,\n    // and then, because it's not editable, hide the virtual keyboard.\n    // Because Android doesn't allow us to actually detect backspace\n    // presses in a sane way, this code checks for when that happens\n    // and simulates a backspace press in this case.\n    if (android && chrome && this.cm.display.gutterSpecs.length && isInGutter(sel.anchorNode)) {\n      this.cm.triggerOnKeyDown({type: \"keydown\", keyCode: 8, preventDefault: Math.abs});\n      this.blur();\n      this.focus();\n      return\n    }\n    if (this.composing) { return }\n    this.rememberSelection();\n    var anchor = domToPos(cm, sel.anchorNode, sel.anchorOffset);\n    var head = domToPos(cm, sel.focusNode, sel.focusOffset);\n    if (anchor && head) { runInOp(cm, function () {\n      setSelection(cm.doc, simpleSelection(anchor, head), sel_dontScroll);\n      if (anchor.bad || head.bad) { cm.curOp.selectionChanged = true; }\n    }); }\n  };\n\n  ContentEditableInput.prototype.pollContent = function () {\n    if (this.readDOMTimeout != null) {\n      clearTimeout(this.readDOMTimeout);\n      this.readDOMTimeout = null;\n    }\n\n    var cm = this.cm, display = cm.display, sel = cm.doc.sel.primary();\n    var from = sel.from(), to = sel.to();\n    if (from.ch == 0 && from.line > cm.firstLine())\n      { from = Pos(from.line - 1, getLine(cm.doc, from.line - 1).length); }\n    if (to.ch == getLine(cm.doc, to.line).text.length && to.line < cm.lastLine())\n      { to = Pos(to.line + 1, 0); }\n    if (from.line < display.viewFrom || to.line > display.viewTo - 1) { return false }\n\n    var fromIndex, fromLine, fromNode;\n    if (from.line == display.viewFrom || (fromIndex = findViewIndex(cm, from.line)) == 0) {\n      fromLine = lineNo(display.view[0].line);\n      fromNode = display.view[0].node;\n    } else {\n      fromLine = lineNo(display.view[fromIndex].line);\n      fromNode = display.view[fromIndex - 1].node.nextSibling;\n    }\n    var toIndex = findViewIndex(cm, to.line);\n    var toLine, toNode;\n    if (toIndex == display.view.length - 1) {\n      toLine = display.viewTo - 1;\n      toNode = display.lineDiv.lastChild;\n    } else {\n      toLine = lineNo(display.view[toIndex + 1].line) - 1;\n      toNode = display.view[toIndex + 1].node.previousSibling;\n    }\n\n    if (!fromNode) { return false }\n    var newText = cm.doc.splitLines(domTextBetween(cm, fromNode, toNode, fromLine, toLine));\n    var oldText = getBetween(cm.doc, Pos(fromLine, 0), Pos(toLine, getLine(cm.doc, toLine).text.length));\n    while (newText.length > 1 && oldText.length > 1) {\n      if (lst(newText) == lst(oldText)) { newText.pop(); oldText.pop(); toLine--; }\n      else if (newText[0] == oldText[0]) { newText.shift(); oldText.shift(); fromLine++; }\n      else { break }\n    }\n\n    var cutFront = 0, cutEnd = 0;\n    var newTop = newText[0], oldTop = oldText[0], maxCutFront = Math.min(newTop.length, oldTop.length);\n    while (cutFront < maxCutFront && newTop.charCodeAt(cutFront) == oldTop.charCodeAt(cutFront))\n      { ++cutFront; }\n    var newBot = lst(newText), oldBot = lst(oldText);\n    var maxCutEnd = Math.min(newBot.length - (newText.length == 1 ? cutFront : 0),\n                             oldBot.length - (oldText.length == 1 ? cutFront : 0));\n    while (cutEnd < maxCutEnd &&\n           newBot.charCodeAt(newBot.length - cutEnd - 1) == oldBot.charCodeAt(oldBot.length - cutEnd - 1))\n      { ++cutEnd; }\n    // Try to move start of change to start of selection if ambiguous\n    if (newText.length == 1 && oldText.length == 1 && fromLine == from.line) {\n      while (cutFront && cutFront > from.ch &&\n             newBot.charCodeAt(newBot.length - cutEnd - 1) == oldBot.charCodeAt(oldBot.length - cutEnd - 1)) {\n        cutFront--;\n        cutEnd++;\n      }\n    }\n\n    newText[newText.length - 1] = newBot.slice(0, newBot.length - cutEnd).replace(/^\\u200b+/, \"\");\n    newText[0] = newText[0].slice(cutFront).replace(/\\u200b+$/, \"\");\n\n    var chFrom = Pos(fromLine, cutFront);\n    var chTo = Pos(toLine, oldText.length ? lst(oldText).length - cutEnd : 0);\n    if (newText.length > 1 || newText[0] || cmp(chFrom, chTo)) {\n      replaceRange(cm.doc, newText, chFrom, chTo, \"+input\");\n      return true\n    }\n  };\n\n  ContentEditableInput.prototype.ensurePolled = function () {\n    this.forceCompositionEnd();\n  };\n  ContentEditableInput.prototype.reset = function () {\n    this.forceCompositionEnd();\n  };\n  ContentEditableInput.prototype.forceCompositionEnd = function () {\n    if (!this.composing) { return }\n    clearTimeout(this.readDOMTimeout);\n    this.composing = null;\n    this.updateFromDOM();\n    this.div.blur();\n    this.div.focus();\n  };\n  ContentEditableInput.prototype.readFromDOMSoon = function () {\n      var this$1 = this;\n\n    if (this.readDOMTimeout != null) { return }\n    this.readDOMTimeout = setTimeout(function () {\n      this$1.readDOMTimeout = null;\n      if (this$1.composing) {\n        if (this$1.composing.done) { this$1.composing = null; }\n        else { return }\n      }\n      this$1.updateFromDOM();\n    }, 80);\n  };\n\n  ContentEditableInput.prototype.updateFromDOM = function () {\n      var this$1 = this;\n\n    if (this.cm.isReadOnly() || !this.pollContent())\n      { runInOp(this.cm, function () { return regChange(this$1.cm); }); }\n  };\n\n  ContentEditableInput.prototype.setUneditable = function (node) {\n    node.contentEditable = \"false\";\n  };\n\n  ContentEditableInput.prototype.onKeyPress = function (e) {\n    if (e.charCode == 0 || this.composing) { return }\n    e.preventDefault();\n    if (!this.cm.isReadOnly())\n      { operation(this.cm, applyTextInput)(this.cm, String.fromCharCode(e.charCode == null ? e.keyCode : e.charCode), 0); }\n  };\n\n  ContentEditableInput.prototype.readOnlyChanged = function (val) {\n    this.div.contentEditable = String(val != \"nocursor\");\n  };\n\n  ContentEditableInput.prototype.onContextMenu = function () {};\n  ContentEditableInput.prototype.resetPosition = function () {};\n\n  ContentEditableInput.prototype.needsContentAttribute = true;\n\n  function posToDOM(cm, pos) {\n    var view = findViewForLine(cm, pos.line);\n    if (!view || view.hidden) { return null }\n    var line = getLine(cm.doc, pos.line);\n    var info = mapFromLineView(view, line, pos.line);\n\n    var order = getOrder(line, cm.doc.direction), side = \"left\";\n    if (order) {\n      var partPos = getBidiPartAt(order, pos.ch);\n      side = partPos % 2 ? \"right\" : \"left\";\n    }\n    var result = nodeAndOffsetInLineMap(info.map, pos.ch, side);\n    result.offset = result.collapse == \"right\" ? result.end : result.start;\n    return result\n  }\n\n  function isInGutter(node) {\n    for (var scan = node; scan; scan = scan.parentNode)\n      { if (/CodeMirror-gutter-wrapper/.test(scan.className)) { return true } }\n    return false\n  }\n\n  function badPos(pos, bad) { if (bad) { pos.bad = true; } return pos }\n\n  function domTextBetween(cm, from, to, fromLine, toLine) {\n    var text = \"\", closing = false, lineSep = cm.doc.lineSeparator(), extraLinebreak = false;\n    function recognizeMarker(id) { return function (marker) { return marker.id == id; } }\n    function close() {\n      if (closing) {\n        text += lineSep;\n        if (extraLinebreak) { text += lineSep; }\n        closing = extraLinebreak = false;\n      }\n    }\n    function addText(str) {\n      if (str) {\n        close();\n        text += str;\n      }\n    }\n    function walk(node) {\n      if (node.nodeType == 1) {\n        var cmText = node.getAttribute(\"cm-text\");\n        if (cmText) {\n          addText(cmText);\n          return\n        }\n        var markerID = node.getAttribute(\"cm-marker\"), range;\n        if (markerID) {\n          var found = cm.findMarks(Pos(fromLine, 0), Pos(toLine + 1, 0), recognizeMarker(+markerID));\n          if (found.length && (range = found[0].find(0)))\n            { addText(getBetween(cm.doc, range.from, range.to).join(lineSep)); }\n          return\n        }\n        if (node.getAttribute(\"contenteditable\") == \"false\") { return }\n        var isBlock = /^(pre|div|p|li|table|br)$/i.test(node.nodeName);\n        if (!/^br$/i.test(node.nodeName) && node.textContent.length == 0) { return }\n\n        if (isBlock) { close(); }\n        for (var i = 0; i < node.childNodes.length; i++)\n          { walk(node.childNodes[i]); }\n\n        if (/^(pre|p)$/i.test(node.nodeName)) { extraLinebreak = true; }\n        if (isBlock) { closing = true; }\n      } else if (node.nodeType == 3) {\n        addText(node.nodeValue.replace(/\\u200b/g, \"\").replace(/\\u00a0/g, \" \"));\n      }\n    }\n    for (;;) {\n      walk(from);\n      if (from == to) { break }\n      from = from.nextSibling;\n      extraLinebreak = false;\n    }\n    return text\n  }\n\n  function domToPos(cm, node, offset) {\n    var lineNode;\n    if (node == cm.display.lineDiv) {\n      lineNode = cm.display.lineDiv.childNodes[offset];\n      if (!lineNode) { return badPos(cm.clipPos(Pos(cm.display.viewTo - 1)), true) }\n      node = null; offset = 0;\n    } else {\n      for (lineNode = node;; lineNode = lineNode.parentNode) {\n        if (!lineNode || lineNode == cm.display.lineDiv) { return null }\n        if (lineNode.parentNode && lineNode.parentNode == cm.display.lineDiv) { break }\n      }\n    }\n    for (var i = 0; i < cm.display.view.length; i++) {\n      var lineView = cm.display.view[i];\n      if (lineView.node == lineNode)\n        { return locateNodeInLineView(lineView, node, offset) }\n    }\n  }\n\n  function locateNodeInLineView(lineView, node, offset) {\n    var wrapper = lineView.text.firstChild, bad = false;\n    if (!node || !contains(wrapper, node)) { return badPos(Pos(lineNo(lineView.line), 0), true) }\n    if (node == wrapper) {\n      bad = true;\n      node = wrapper.childNodes[offset];\n      offset = 0;\n      if (!node) {\n        var line = lineView.rest ? lst(lineView.rest) : lineView.line;\n        return badPos(Pos(lineNo(line), line.text.length), bad)\n      }\n    }\n\n    var textNode = node.nodeType == 3 ? node : null, topNode = node;\n    if (!textNode && node.childNodes.length == 1 && node.firstChild.nodeType == 3) {\n      textNode = node.firstChild;\n      if (offset) { offset = textNode.nodeValue.length; }\n    }\n    while (topNode.parentNode != wrapper) { topNode = topNode.parentNode; }\n    var measure = lineView.measure, maps = measure.maps;\n\n    function find(textNode, topNode, offset) {\n      for (var i = -1; i < (maps ? maps.length : 0); i++) {\n        var map = i < 0 ? measure.map : maps[i];\n        for (var j = 0; j < map.length; j += 3) {\n          var curNode = map[j + 2];\n          if (curNode == textNode || curNode == topNode) {\n            var line = lineNo(i < 0 ? lineView.line : lineView.rest[i]);\n            var ch = map[j] + offset;\n            if (offset < 0 || curNode != textNode) { ch = map[j + (offset ? 1 : 0)]; }\n            return Pos(line, ch)\n          }\n        }\n      }\n    }\n    var found = find(textNode, topNode, offset);\n    if (found) { return badPos(found, bad) }\n\n    // FIXME this is all really shaky. might handle the few cases it needs to handle, but likely to cause problems\n    for (var after = topNode.nextSibling, dist = textNode ? textNode.nodeValue.length - offset : 0; after; after = after.nextSibling) {\n      found = find(after, after.firstChild, 0);\n      if (found)\n        { return badPos(Pos(found.line, found.ch - dist), bad) }\n      else\n        { dist += after.textContent.length; }\n    }\n    for (var before = topNode.previousSibling, dist$1 = offset; before; before = before.previousSibling) {\n      found = find(before, before.firstChild, -1);\n      if (found)\n        { return badPos(Pos(found.line, found.ch + dist$1), bad) }\n      else\n        { dist$1 += before.textContent.length; }\n    }\n  }\n\n  // TEXTAREA INPUT STYLE\n\n  var TextareaInput = function(cm) {\n    this.cm = cm;\n    // See input.poll and input.reset\n    this.prevInput = \"\";\n\n    // Flag that indicates whether we expect input to appear real soon\n    // now (after some event like 'keypress' or 'input') and are\n    // polling intensively.\n    this.pollingFast = false;\n    // Self-resetting timeout for the poller\n    this.polling = new Delayed();\n    // Used to work around IE issue with selection being forgotten when focus moves away from textarea\n    this.hasSelection = false;\n    this.composing = null;\n  };\n\n  TextareaInput.prototype.init = function (display) {\n      var this$1 = this;\n\n    var input = this, cm = this.cm;\n    this.createField(display);\n    var te = this.textarea;\n\n    display.wrapper.insertBefore(this.wrapper, display.wrapper.firstChild);\n\n    // Needed to hide big blue blinking cursor on Mobile Safari (doesn't seem to work in iOS 8 anymore)\n    if (ios) { te.style.width = \"0px\"; }\n\n    on(te, \"input\", function () {\n      if (ie && ie_version >= 9 && this$1.hasSelection) { this$1.hasSelection = null; }\n      input.poll();\n    });\n\n    on(te, \"paste\", function (e) {\n      if (signalDOMEvent(cm, e) || handlePaste(e, cm)) { return }\n\n      cm.state.pasteIncoming = +new Date;\n      input.fastPoll();\n    });\n\n    function prepareCopyCut(e) {\n      if (signalDOMEvent(cm, e)) { return }\n      if (cm.somethingSelected()) {\n        setLastCopied({lineWise: false, text: cm.getSelections()});\n      } else if (!cm.options.lineWiseCopyCut) {\n        return\n      } else {\n        var ranges = copyableRanges(cm);\n        setLastCopied({lineWise: true, text: ranges.text});\n        if (e.type == \"cut\") {\n          cm.setSelections(ranges.ranges, null, sel_dontScroll);\n        } else {\n          input.prevInput = \"\";\n          te.value = ranges.text.join(\"\\n\");\n          selectInput(te);\n        }\n      }\n      if (e.type == \"cut\") { cm.state.cutIncoming = +new Date; }\n    }\n    on(te, \"cut\", prepareCopyCut);\n    on(te, \"copy\", prepareCopyCut);\n\n    on(display.scroller, \"paste\", function (e) {\n      if (eventInWidget(display, e) || signalDOMEvent(cm, e)) { return }\n      if (!te.dispatchEvent) {\n        cm.state.pasteIncoming = +new Date;\n        input.focus();\n        return\n      }\n\n      // Pass the `paste` event to the textarea so it's handled by its event listener.\n      var event = new Event(\"paste\");\n      event.clipboardData = e.clipboardData;\n      te.dispatchEvent(event);\n    });\n\n    // Prevent normal selection in the editor (we handle our own)\n    on(display.lineSpace, \"selectstart\", function (e) {\n      if (!eventInWidget(display, e)) { e_preventDefault(e); }\n    });\n\n    on(te, \"compositionstart\", function () {\n      var start = cm.getCursor(\"from\");\n      if (input.composing) { input.composing.range.clear(); }\n      input.composing = {\n        start: start,\n        range: cm.markText(start, cm.getCursor(\"to\"), {className: \"CodeMirror-composing\"})\n      };\n    });\n    on(te, \"compositionend\", function () {\n      if (input.composing) {\n        input.poll();\n        input.composing.range.clear();\n        input.composing = null;\n      }\n    });\n  };\n\n  TextareaInput.prototype.createField = function (_display) {\n    // Wraps and hides input textarea\n    this.wrapper = hiddenTextarea();\n    // The semihidden textarea that is focused when the editor is\n    // focused, and receives input.\n    this.textarea = this.wrapper.firstChild;\n  };\n\n  TextareaInput.prototype.screenReaderLabelChanged = function (label) {\n    // Label for screenreaders, accessibility\n    if(label) {\n      this.textarea.setAttribute('aria-label', label);\n    } else {\n      this.textarea.removeAttribute('aria-label');\n    }\n  };\n\n  TextareaInput.prototype.prepareSelection = function () {\n    // Redraw the selection and/or cursor\n    var cm = this.cm, display = cm.display, doc = cm.doc;\n    var result = prepareSelection(cm);\n\n    // Move the hidden textarea near the cursor to prevent scrolling artifacts\n    if (cm.options.moveInputWithCursor) {\n      var headPos = cursorCoords(cm, doc.sel.primary().head, \"div\");\n      var wrapOff = display.wrapper.getBoundingClientRect(), lineOff = display.lineDiv.getBoundingClientRect();\n      result.teTop = Math.max(0, Math.min(display.wrapper.clientHeight - 10,\n                                          headPos.top + lineOff.top - wrapOff.top));\n      result.teLeft = Math.max(0, Math.min(display.wrapper.clientWidth - 10,\n                                           headPos.left + lineOff.left - wrapOff.left));\n    }\n\n    return result\n  };\n\n  TextareaInput.prototype.showSelection = function (drawn) {\n    var cm = this.cm, display = cm.display;\n    removeChildrenAndAdd(display.cursorDiv, drawn.cursors);\n    removeChildrenAndAdd(display.selectionDiv, drawn.selection);\n    if (drawn.teTop != null) {\n      this.wrapper.style.top = drawn.teTop + \"px\";\n      this.wrapper.style.left = drawn.teLeft + \"px\";\n    }\n  };\n\n  // Reset the input to correspond to the selection (or to be empty,\n  // when not typing and nothing is selected)\n  TextareaInput.prototype.reset = function (typing) {\n    if (this.contextMenuPending || this.composing) { return }\n    var cm = this.cm;\n    if (cm.somethingSelected()) {\n      this.prevInput = \"\";\n      var content = cm.getSelection();\n      this.textarea.value = content;\n      if (cm.state.focused) { selectInput(this.textarea); }\n      if (ie && ie_version >= 9) { this.hasSelection = content; }\n    } else if (!typing) {\n      this.prevInput = this.textarea.value = \"\";\n      if (ie && ie_version >= 9) { this.hasSelection = null; }\n    }\n  };\n\n  TextareaInput.prototype.getField = function () { return this.textarea };\n\n  TextareaInput.prototype.supportsTouch = function () { return false };\n\n  TextareaInput.prototype.focus = function () {\n    if (this.cm.options.readOnly != \"nocursor\" && (!mobile || activeElt() != this.textarea)) {\n      try { this.textarea.focus(); }\n      catch (e) {} // IE8 will throw if the textarea is display: none or not in DOM\n    }\n  };\n\n  TextareaInput.prototype.blur = function () { this.textarea.blur(); };\n\n  TextareaInput.prototype.resetPosition = function () {\n    this.wrapper.style.top = this.wrapper.style.left = 0;\n  };\n\n  TextareaInput.prototype.receivedFocus = function () { this.slowPoll(); };\n\n  // Poll for input changes, using the normal rate of polling. This\n  // runs as long as the editor is focused.\n  TextareaInput.prototype.slowPoll = function () {\n      var this$1 = this;\n\n    if (this.pollingFast) { return }\n    this.polling.set(this.cm.options.pollInterval, function () {\n      this$1.poll();\n      if (this$1.cm.state.focused) { this$1.slowPoll(); }\n    });\n  };\n\n  // When an event has just come in that is likely to add or change\n  // something in the input textarea, we poll faster, to ensure that\n  // the change appears on the screen quickly.\n  TextareaInput.prototype.fastPoll = function () {\n    var missed = false, input = this;\n    input.pollingFast = true;\n    function p() {\n      var changed = input.poll();\n      if (!changed && !missed) {missed = true; input.polling.set(60, p);}\n      else {input.pollingFast = false; input.slowPoll();}\n    }\n    input.polling.set(20, p);\n  };\n\n  // Read input from the textarea, and update the document to match.\n  // When something is selected, it is present in the textarea, and\n  // selected (unless it is huge, in which case a placeholder is\n  // used). When nothing is selected, the cursor sits after previously\n  // seen text (can be empty), which is stored in prevInput (we must\n  // not reset the textarea when typing, because that breaks IME).\n  TextareaInput.prototype.poll = function () {\n      var this$1 = this;\n\n    var cm = this.cm, input = this.textarea, prevInput = this.prevInput;\n    // Since this is called a *lot*, try to bail out as cheaply as\n    // possible when it is clear that nothing happened. hasSelection\n    // will be the case when there is a lot of text in the textarea,\n    // in which case reading its value would be expensive.\n    if (this.contextMenuPending || !cm.state.focused ||\n        (hasSelection(input) && !prevInput && !this.composing) ||\n        cm.isReadOnly() || cm.options.disableInput || cm.state.keySeq)\n      { return false }\n\n    var text = input.value;\n    // If nothing changed, bail.\n    if (text == prevInput && !cm.somethingSelected()) { return false }\n    // Work around nonsensical selection resetting in IE9/10, and\n    // inexplicable appearance of private area unicode characters on\n    // some key combos in Mac (#2689).\n    if (ie && ie_version >= 9 && this.hasSelection === text ||\n        mac && /[\\uf700-\\uf7ff]/.test(text)) {\n      cm.display.input.reset();\n      return false\n    }\n\n    if (cm.doc.sel == cm.display.selForContextMenu) {\n      var first = text.charCodeAt(0);\n      if (first == 0x200b && !prevInput) { prevInput = \"\\u200b\"; }\n      if (first == 0x21da) { this.reset(); return this.cm.execCommand(\"undo\") }\n    }\n    // Find the part of the input that is actually new\n    var same = 0, l = Math.min(prevInput.length, text.length);\n    while (same < l && prevInput.charCodeAt(same) == text.charCodeAt(same)) { ++same; }\n\n    runInOp(cm, function () {\n      applyTextInput(cm, text.slice(same), prevInput.length - same,\n                     null, this$1.composing ? \"*compose\" : null);\n\n      // Don't leave long text in the textarea, since it makes further polling slow\n      if (text.length > 1000 || text.indexOf(\"\\n\") > -1) { input.value = this$1.prevInput = \"\"; }\n      else { this$1.prevInput = text; }\n\n      if (this$1.composing) {\n        this$1.composing.range.clear();\n        this$1.composing.range = cm.markText(this$1.composing.start, cm.getCursor(\"to\"),\n                                           {className: \"CodeMirror-composing\"});\n      }\n    });\n    return true\n  };\n\n  TextareaInput.prototype.ensurePolled = function () {\n    if (this.pollingFast && this.poll()) { this.pollingFast = false; }\n  };\n\n  TextareaInput.prototype.onKeyPress = function () {\n    if (ie && ie_version >= 9) { this.hasSelection = null; }\n    this.fastPoll();\n  };\n\n  TextareaInput.prototype.onContextMenu = function (e) {\n    var input = this, cm = input.cm, display = cm.display, te = input.textarea;\n    if (input.contextMenuPending) { input.contextMenuPending(); }\n    var pos = posFromMouse(cm, e), scrollPos = display.scroller.scrollTop;\n    if (!pos || presto) { return } // Opera is difficult.\n\n    // Reset the current text selection only if the click is done outside of the selection\n    // and 'resetSelectionOnContextMenu' option is true.\n    var reset = cm.options.resetSelectionOnContextMenu;\n    if (reset && cm.doc.sel.contains(pos) == -1)\n      { operation(cm, setSelection)(cm.doc, simpleSelection(pos), sel_dontScroll); }\n\n    var oldCSS = te.style.cssText, oldWrapperCSS = input.wrapper.style.cssText;\n    var wrapperBox = input.wrapper.offsetParent.getBoundingClientRect();\n    input.wrapper.style.cssText = \"position: static\";\n    te.style.cssText = \"position: absolute; width: 30px; height: 30px;\\n      top: \" + (e.clientY - wrapperBox.top - 5) + \"px; left: \" + (e.clientX - wrapperBox.left - 5) + \"px;\\n      z-index: 1000; background: \" + (ie ? \"rgba(255, 255, 255, .05)\" : \"transparent\") + \";\\n      outline: none; border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);\";\n    var oldScrollY;\n    if (webkit) { oldScrollY = window.scrollY; } // Work around Chrome issue (#2712)\n    display.input.focus();\n    if (webkit) { window.scrollTo(null, oldScrollY); }\n    display.input.reset();\n    // Adds \"Select all\" to context menu in FF\n    if (!cm.somethingSelected()) { te.value = input.prevInput = \" \"; }\n    input.contextMenuPending = rehide;\n    display.selForContextMenu = cm.doc.sel;\n    clearTimeout(display.detectingSelectAll);\n\n    // Select-all will be greyed out if there's nothing to select, so\n    // this adds a zero-width space so that we can later check whether\n    // it got selected.\n    function prepareSelectAllHack() {\n      if (te.selectionStart != null) {\n        var selected = cm.somethingSelected();\n        var extval = \"\\u200b\" + (selected ? te.value : \"\");\n        te.value = \"\\u21da\"; // Used to catch context-menu undo\n        te.value = extval;\n        input.prevInput = selected ? \"\" : \"\\u200b\";\n        te.selectionStart = 1; te.selectionEnd = extval.length;\n        // Re-set this, in case some other handler touched the\n        // selection in the meantime.\n        display.selForContextMenu = cm.doc.sel;\n      }\n    }\n    function rehide() {\n      if (input.contextMenuPending != rehide) { return }\n      input.contextMenuPending = false;\n      input.wrapper.style.cssText = oldWrapperCSS;\n      te.style.cssText = oldCSS;\n      if (ie && ie_version < 9) { display.scrollbars.setScrollTop(display.scroller.scrollTop = scrollPos); }\n\n      // Try to detect the user choosing select-all\n      if (te.selectionStart != null) {\n        if (!ie || (ie && ie_version < 9)) { prepareSelectAllHack(); }\n        var i = 0, poll = function () {\n          if (display.selForContextMenu == cm.doc.sel && te.selectionStart == 0 &&\n              te.selectionEnd > 0 && input.prevInput == \"\\u200b\") {\n            operation(cm, selectAll)(cm);\n          } else if (i++ < 10) {\n            display.detectingSelectAll = setTimeout(poll, 500);\n          } else {\n            display.selForContextMenu = null;\n            display.input.reset();\n          }\n        };\n        display.detectingSelectAll = setTimeout(poll, 200);\n      }\n    }\n\n    if (ie && ie_version >= 9) { prepareSelectAllHack(); }\n    if (captureRightClick) {\n      e_stop(e);\n      var mouseup = function () {\n        off(window, \"mouseup\", mouseup);\n        setTimeout(rehide, 20);\n      };\n      on(window, \"mouseup\", mouseup);\n    } else {\n      setTimeout(rehide, 50);\n    }\n  };\n\n  TextareaInput.prototype.readOnlyChanged = function (val) {\n    if (!val) { this.reset(); }\n    this.textarea.disabled = val == \"nocursor\";\n    this.textarea.readOnly = !!val;\n  };\n\n  TextareaInput.prototype.setUneditable = function () {};\n\n  TextareaInput.prototype.needsContentAttribute = false;\n\n  function fromTextArea(textarea, options) {\n    options = options ? copyObj(options) : {};\n    options.value = textarea.value;\n    if (!options.tabindex && textarea.tabIndex)\n      { options.tabindex = textarea.tabIndex; }\n    if (!options.placeholder && textarea.placeholder)\n      { options.placeholder = textarea.placeholder; }\n    // Set autofocus to true if this textarea is focused, or if it has\n    // autofocus and no other element is focused.\n    if (options.autofocus == null) {\n      var hasFocus = activeElt();\n      options.autofocus = hasFocus == textarea ||\n        textarea.getAttribute(\"autofocus\") != null && hasFocus == document.body;\n    }\n\n    function save() {textarea.value = cm.getValue();}\n\n    var realSubmit;\n    if (textarea.form) {\n      on(textarea.form, \"submit\", save);\n      // Deplorable hack to make the submit method do the right thing.\n      if (!options.leaveSubmitMethodAlone) {\n        var form = textarea.form;\n        realSubmit = form.submit;\n        try {\n          var wrappedSubmit = form.submit = function () {\n            save();\n            form.submit = realSubmit;\n            form.submit();\n            form.submit = wrappedSubmit;\n          };\n        } catch(e) {}\n      }\n    }\n\n    options.finishInit = function (cm) {\n      cm.save = save;\n      cm.getTextArea = function () { return textarea; };\n      cm.toTextArea = function () {\n        cm.toTextArea = isNaN; // Prevent this from being ran twice\n        save();\n        textarea.parentNode.removeChild(cm.getWrapperElement());\n        textarea.style.display = \"\";\n        if (textarea.form) {\n          off(textarea.form, \"submit\", save);\n          if (!options.leaveSubmitMethodAlone && typeof textarea.form.submit == \"function\")\n            { textarea.form.submit = realSubmit; }\n        }\n      };\n    };\n\n    textarea.style.display = \"none\";\n    var cm = CodeMirror(function (node) { return textarea.parentNode.insertBefore(node, textarea.nextSibling); },\n      options);\n    return cm\n  }\n\n  function addLegacyProps(CodeMirror) {\n    CodeMirror.off = off;\n    CodeMirror.on = on;\n    CodeMirror.wheelEventPixels = wheelEventPixels;\n    CodeMirror.Doc = Doc;\n    CodeMirror.splitLines = splitLinesAuto;\n    CodeMirror.countColumn = countColumn;\n    CodeMirror.findColumn = findColumn;\n    CodeMirror.isWordChar = isWordCharBasic;\n    CodeMirror.Pass = Pass;\n    CodeMirror.signal = signal;\n    CodeMirror.Line = Line;\n    CodeMirror.changeEnd = changeEnd;\n    CodeMirror.scrollbarModel = scrollbarModel;\n    CodeMirror.Pos = Pos;\n    CodeMirror.cmpPos = cmp;\n    CodeMirror.modes = modes;\n    CodeMirror.mimeModes = mimeModes;\n    CodeMirror.resolveMode = resolveMode;\n    CodeMirror.getMode = getMode;\n    CodeMirror.modeExtensions = modeExtensions;\n    CodeMirror.extendMode = extendMode;\n    CodeMirror.copyState = copyState;\n    CodeMirror.startState = startState;\n    CodeMirror.innerMode = innerMode;\n    CodeMirror.commands = commands;\n    CodeMirror.keyMap = keyMap;\n    CodeMirror.keyName = keyName;\n    CodeMirror.isModifierKey = isModifierKey;\n    CodeMirror.lookupKey = lookupKey;\n    CodeMirror.normalizeKeyMap = normalizeKeyMap;\n    CodeMirror.StringStream = StringStream;\n    CodeMirror.SharedTextMarker = SharedTextMarker;\n    CodeMirror.TextMarker = TextMarker;\n    CodeMirror.LineWidget = LineWidget;\n    CodeMirror.e_preventDefault = e_preventDefault;\n    CodeMirror.e_stopPropagation = e_stopPropagation;\n    CodeMirror.e_stop = e_stop;\n    CodeMirror.addClass = addClass;\n    CodeMirror.contains = contains;\n    CodeMirror.rmClass = rmClass;\n    CodeMirror.keyNames = keyNames;\n  }\n\n  // EDITOR CONSTRUCTOR\n\n  defineOptions(CodeMirror);\n\n  addEditorMethods(CodeMirror);\n\n  // Set up methods on CodeMirror's prototype to redirect to the editor's document.\n  var dontDelegate = \"iter insert remove copy getEditor constructor\".split(\" \");\n  for (var prop in Doc.prototype) { if (Doc.prototype.hasOwnProperty(prop) && indexOf(dontDelegate, prop) < 0)\n    { CodeMirror.prototype[prop] = (function(method) {\n      return function() {return method.apply(this.doc, arguments)}\n    })(Doc.prototype[prop]); } }\n\n  eventMixin(Doc);\n  CodeMirror.inputStyles = {\"textarea\": TextareaInput, \"contenteditable\": ContentEditableInput};\n\n  // Extra arguments are stored as the mode's dependencies, which is\n  // used by (legacy) mechanisms like loadmode.js to automatically\n  // load a mode. (Preferred mechanism is the require/define calls.)\n  CodeMirror.defineMode = function(name/*, mode, */) {\n    if (!CodeMirror.defaults.mode && name != \"null\") { CodeMirror.defaults.mode = name; }\n    defineMode.apply(this, arguments);\n  };\n\n  CodeMirror.defineMIME = defineMIME;\n\n  // Minimal default mode.\n  CodeMirror.defineMode(\"null\", function () { return ({token: function (stream) { return stream.skipToEnd(); }}); });\n  CodeMirror.defineMIME(\"text/plain\", \"null\");\n\n  // EXTENSIONS\n\n  CodeMirror.defineExtension = function (name, func) {\n    CodeMirror.prototype[name] = func;\n  };\n  CodeMirror.defineDocExtension = function (name, func) {\n    Doc.prototype[name] = func;\n  };\n\n  CodeMirror.fromTextArea = fromTextArea;\n\n  addLegacyProps(CodeMirror);\n\n  CodeMirror.version = \"5.61.0\";\n\n  return CodeMirror;\n\n})));\n","// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: https://codemirror.net/LICENSE\n\n// Open simple dialogs on top of an editor. Relies on dialog.css.\n\n(function(mod) {\n  if (typeof exports == \"object\" && typeof module == \"object\") // CommonJS\n    mod(require(\"../../lib/codemirror\"));\n  else if (typeof define == \"function\" && define.amd) // AMD\n    define([\"../../lib/codemirror\"], mod);\n  else // Plain browser env\n    mod(CodeMirror);\n})(function(CodeMirror) {\n  function dialogDiv(cm, template, bottom) {\n    var wrap = cm.getWrapperElement();\n    var dialog;\n    dialog = wrap.appendChild(document.createElement(\"div\"));\n    if (bottom)\n      dialog.className = \"CodeMirror-dialog CodeMirror-dialog-bottom\";\n    else\n      dialog.className = \"CodeMirror-dialog CodeMirror-dialog-top\";\n\n    if (typeof template == \"string\") {\n      dialog.innerHTML = template;\n    } else { // Assuming it's a detached DOM element.\n      dialog.appendChild(template);\n    }\n    CodeMirror.addClass(wrap, 'dialog-opened');\n    return dialog;\n  }\n\n  function closeNotification(cm, newVal) {\n    if (cm.state.currentNotificationClose)\n      cm.state.currentNotificationClose();\n    cm.state.currentNotificationClose = newVal;\n  }\n\n  CodeMirror.defineExtension(\"openDialog\", function(template, callback, options) {\n    if (!options) options = {};\n\n    closeNotification(this, null);\n\n    var dialog = dialogDiv(this, template, options.bottom);\n    var closed = false, me = this;\n    function close(newVal) {\n      if (typeof newVal == 'string') {\n        inp.value = newVal;\n      } else {\n        if (closed) return;\n        closed = true;\n        CodeMirror.rmClass(dialog.parentNode, 'dialog-opened');\n        dialog.parentNode.removeChild(dialog);\n        me.focus();\n\n        if (options.onClose) options.onClose(dialog);\n      }\n    }\n\n    var inp = dialog.getElementsByTagName(\"input\")[0], button;\n    if (inp) {\n      inp.focus();\n\n      if (options.value) {\n        inp.value = options.value;\n        if (options.selectValueOnOpen !== false) {\n          inp.select();\n        }\n      }\n\n      if (options.onInput)\n        CodeMirror.on(inp, \"input\", function(e) { options.onInput(e, inp.value, close);});\n      if (options.onKeyUp)\n        CodeMirror.on(inp, \"keyup\", function(e) {options.onKeyUp(e, inp.value, close);});\n\n      CodeMirror.on(inp, \"keydown\", function(e) {\n        if (options && options.onKeyDown && options.onKeyDown(e, inp.value, close)) { return; }\n        if (e.keyCode == 27 || (options.closeOnEnter !== false && e.keyCode == 13)) {\n          inp.blur();\n          CodeMirror.e_stop(e);\n          close();\n        }\n        if (e.keyCode == 13) callback(inp.value, e);\n      });\n\n      if (options.closeOnBlur !== false) CodeMirror.on(dialog, \"focusout\", function (evt) {\n        if (evt.relatedTarget !== null) close();\n      });\n    } else if (button = dialog.getElementsByTagName(\"button\")[0]) {\n      CodeMirror.on(button, \"click\", function() {\n        close();\n        me.focus();\n      });\n\n      if (options.closeOnBlur !== false) CodeMirror.on(button, \"blur\", close);\n\n      button.focus();\n    }\n    return close;\n  });\n\n  CodeMirror.defineExtension(\"openConfirm\", function(template, callbacks, options) {\n    closeNotification(this, null);\n    var dialog = dialogDiv(this, template, options && options.bottom);\n    var buttons = dialog.getElementsByTagName(\"button\");\n    var closed = false, me = this, blurring = 1;\n    function close() {\n      if (closed) return;\n      closed = true;\n      CodeMirror.rmClass(dialog.parentNode, 'dialog-opened');\n      dialog.parentNode.removeChild(dialog);\n      me.focus();\n    }\n    buttons[0].focus();\n    for (var i = 0; i < buttons.length; ++i) {\n      var b = buttons[i];\n      (function(callback) {\n        CodeMirror.on(b, \"click\", function(e) {\n          CodeMirror.e_preventDefault(e);\n          close();\n          if (callback) callback(me);\n        });\n      })(callbacks[i]);\n      CodeMirror.on(b, \"blur\", function() {\n        --blurring;\n        setTimeout(function() { if (blurring <= 0) close(); }, 200);\n      });\n      CodeMirror.on(b, \"focus\", function() { ++blurring; });\n    }\n  });\n\n  /*\n   * openNotification\n   * Opens a notification, that can be closed with an optional timer\n   * (default 5000ms timer) and always closes on click.\n   *\n   * If a notification is opened while another is opened, it will close the\n   * currently opened one and open the new one immediately.\n   */\n  CodeMirror.defineExtension(\"openNotification\", function(template, options) {\n    closeNotification(this, close);\n    var dialog = dialogDiv(this, template, options && options.bottom);\n    var closed = false, doneTimer;\n    var duration = options && typeof options.duration !== \"undefined\" ? options.duration : 5000;\n\n    function close() {\n      if (closed) return;\n      closed = true;\n      clearTimeout(doneTimer);\n      CodeMirror.rmClass(dialog.parentNode, 'dialog-opened');\n      dialog.parentNode.removeChild(dialog);\n    }\n\n    CodeMirror.on(dialog, 'click', function(e) {\n      CodeMirror.e_preventDefault(e);\n      close();\n    });\n\n    if (duration)\n      doneTimer = setTimeout(close, duration);\n\n    return close;\n  });\n});\n","// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: https://codemirror.net/LICENSE\n\n(function(mod) {\n  if (typeof exports == \"object\" && typeof module == \"object\") // CommonJS\n    mod(require(\"../../lib/codemirror\"))\n  else if (typeof define == \"function\" && define.amd) // AMD\n    define([\"../../lib/codemirror\"], mod)\n  else // Plain browser env\n    mod(CodeMirror)\n})(function(CodeMirror) {\n  \"use strict\"\n  var Pos = CodeMirror.Pos\n\n  function regexpFlags(regexp) {\n    var flags = regexp.flags\n    return flags != null ? flags : (regexp.ignoreCase ? \"i\" : \"\")\n      + (regexp.global ? \"g\" : \"\")\n      + (regexp.multiline ? \"m\" : \"\")\n  }\n\n  function ensureFlags(regexp, flags) {\n    var current = regexpFlags(regexp), target = current\n    for (var i = 0; i < flags.length; i++) if (target.indexOf(flags.charAt(i)) == -1)\n      target += flags.charAt(i)\n    return current == target ? regexp : new RegExp(regexp.source, target)\n  }\n\n  function maybeMultiline(regexp) {\n    return /\\\\s|\\\\n|\\n|\\\\W|\\\\D|\\[\\^/.test(regexp.source)\n  }\n\n  function searchRegexpForward(doc, regexp, start) {\n    regexp = ensureFlags(regexp, \"g\")\n    for (var line = start.line, ch = start.ch, last = doc.lastLine(); line <= last; line++, ch = 0) {\n      regexp.lastIndex = ch\n      var string = doc.getLine(line), match = regexp.exec(string)\n      if (match)\n        return {from: Pos(line, match.index),\n                to: Pos(line, match.index + match[0].length),\n                match: match}\n    }\n  }\n\n  function searchRegexpForwardMultiline(doc, regexp, start) {\n    if (!maybeMultiline(regexp)) return searchRegexpForward(doc, regexp, start)\n\n    regexp = ensureFlags(regexp, \"gm\")\n    var string, chunk = 1\n    for (var line = start.line, last = doc.lastLine(); line <= last;) {\n      // This grows the search buffer in exponentially-sized chunks\n      // between matches, so that nearby matches are fast and don't\n      // require concatenating the whole document (in case we're\n      // searching for something that has tons of matches), but at the\n      // same time, the amount of retries is limited.\n      for (var i = 0; i < chunk; i++) {\n        if (line > last) break\n        var curLine = doc.getLine(line++)\n        string = string == null ? curLine : string + \"\\n\" + curLine\n      }\n      chunk = chunk * 2\n      regexp.lastIndex = start.ch\n      var match = regexp.exec(string)\n      if (match) {\n        var before = string.slice(0, match.index).split(\"\\n\"), inside = match[0].split(\"\\n\")\n        var startLine = start.line + before.length - 1, startCh = before[before.length - 1].length\n        return {from: Pos(startLine, startCh),\n                to: Pos(startLine + inside.length - 1,\n                        inside.length == 1 ? startCh + inside[0].length : inside[inside.length - 1].length),\n                match: match}\n      }\n    }\n  }\n\n  function lastMatchIn(string, regexp, endMargin) {\n    var match, from = 0\n    while (from <= string.length) {\n      regexp.lastIndex = from\n      var newMatch = regexp.exec(string)\n      if (!newMatch) break\n      var end = newMatch.index + newMatch[0].length\n      if (end > string.length - endMargin) break\n      if (!match || end > match.index + match[0].length)\n        match = newMatch\n      from = newMatch.index + 1\n    }\n    return match\n  }\n\n  function searchRegexpBackward(doc, regexp, start) {\n    regexp = ensureFlags(regexp, \"g\")\n    for (var line = start.line, ch = start.ch, first = doc.firstLine(); line >= first; line--, ch = -1) {\n      var string = doc.getLine(line)\n      var match = lastMatchIn(string, regexp, ch < 0 ? 0 : string.length - ch)\n      if (match)\n        return {from: Pos(line, match.index),\n                to: Pos(line, match.index + match[0].length),\n                match: match}\n    }\n  }\n\n  function searchRegexpBackwardMultiline(doc, regexp, start) {\n    if (!maybeMultiline(regexp)) return searchRegexpBackward(doc, regexp, start)\n    regexp = ensureFlags(regexp, \"gm\")\n    var string, chunkSize = 1, endMargin = doc.getLine(start.line).length - start.ch\n    for (var line = start.line, first = doc.firstLine(); line >= first;) {\n      for (var i = 0; i < chunkSize && line >= first; i++) {\n        var curLine = doc.getLine(line--)\n        string = string == null ? curLine : curLine + \"\\n\" + string\n      }\n      chunkSize *= 2\n\n      var match = lastMatchIn(string, regexp, endMargin)\n      if (match) {\n        var before = string.slice(0, match.index).split(\"\\n\"), inside = match[0].split(\"\\n\")\n        var startLine = line + before.length, startCh = before[before.length - 1].length\n        return {from: Pos(startLine, startCh),\n                to: Pos(startLine + inside.length - 1,\n                        inside.length == 1 ? startCh + inside[0].length : inside[inside.length - 1].length),\n                match: match}\n      }\n    }\n  }\n\n  var doFold, noFold\n  if (String.prototype.normalize) {\n    doFold = function(str) { return str.normalize(\"NFD\").toLowerCase() }\n    noFold = function(str) { return str.normalize(\"NFD\") }\n  } else {\n    doFold = function(str) { return str.toLowerCase() }\n    noFold = function(str) { return str }\n  }\n\n  // Maps a position in a case-folded line back to a position in the original line\n  // (compensating for codepoints increasing in number during folding)\n  function adjustPos(orig, folded, pos, foldFunc) {\n    if (orig.length == folded.length) return pos\n    for (var min = 0, max = pos + Math.max(0, orig.length - folded.length);;) {\n      if (min == max) return min\n      var mid = (min + max) >> 1\n      var len = foldFunc(orig.slice(0, mid)).length\n      if (len == pos) return mid\n      else if (len > pos) max = mid\n      else min = mid + 1\n    }\n  }\n\n  function searchStringForward(doc, query, start, caseFold) {\n    // Empty string would match anything and never progress, so we\n    // define it to match nothing instead.\n    if (!query.length) return null\n    var fold = caseFold ? doFold : noFold\n    var lines = fold(query).split(/\\r|\\n\\r?/)\n\n    search: for (var line = start.line, ch = start.ch, last = doc.lastLine() + 1 - lines.length; line <= last; line++, ch = 0) {\n      var orig = doc.getLine(line).slice(ch), string = fold(orig)\n      if (lines.length == 1) {\n        var found = string.indexOf(lines[0])\n        if (found == -1) continue search\n        var start = adjustPos(orig, string, found, fold) + ch\n        return {from: Pos(line, adjustPos(orig, string, found, fold) + ch),\n                to: Pos(line, adjustPos(orig, string, found + lines[0].length, fold) + ch)}\n      } else {\n        var cutFrom = string.length - lines[0].length\n        if (string.slice(cutFrom) != lines[0]) continue search\n        for (var i = 1; i < lines.length - 1; i++)\n          if (fold(doc.getLine(line + i)) != lines[i]) continue search\n        var end = doc.getLine(line + lines.length - 1), endString = fold(end), lastLine = lines[lines.length - 1]\n        if (endString.slice(0, lastLine.length) != lastLine) continue search\n        return {from: Pos(line, adjustPos(orig, string, cutFrom, fold) + ch),\n                to: Pos(line + lines.length - 1, adjustPos(end, endString, lastLine.length, fold))}\n      }\n    }\n  }\n\n  function searchStringBackward(doc, query, start, caseFold) {\n    if (!query.length) return null\n    var fold = caseFold ? doFold : noFold\n    var lines = fold(query).split(/\\r|\\n\\r?/)\n\n    search: for (var line = start.line, ch = start.ch, first = doc.firstLine() - 1 + lines.length; line >= first; line--, ch = -1) {\n      var orig = doc.getLine(line)\n      if (ch > -1) orig = orig.slice(0, ch)\n      var string = fold(orig)\n      if (lines.length == 1) {\n        var found = string.lastIndexOf(lines[0])\n        if (found == -1) continue search\n        return {from: Pos(line, adjustPos(orig, string, found, fold)),\n                to: Pos(line, adjustPos(orig, string, found + lines[0].length, fold))}\n      } else {\n        var lastLine = lines[lines.length - 1]\n        if (string.slice(0, lastLine.length) != lastLine) continue search\n        for (var i = 1, start = line - lines.length + 1; i < lines.length - 1; i++)\n          if (fold(doc.getLine(start + i)) != lines[i]) continue search\n        var top = doc.getLine(line + 1 - lines.length), topString = fold(top)\n        if (topString.slice(topString.length - lines[0].length) != lines[0]) continue search\n        return {from: Pos(line + 1 - lines.length, adjustPos(top, topString, top.length - lines[0].length, fold)),\n                to: Pos(line, adjustPos(orig, string, lastLine.length, fold))}\n      }\n    }\n  }\n\n  function SearchCursor(doc, query, pos, options) {\n    this.atOccurrence = false\n    this.doc = doc\n    pos = pos ? doc.clipPos(pos) : Pos(0, 0)\n    this.pos = {from: pos, to: pos}\n\n    var caseFold\n    if (typeof options == \"object\") {\n      caseFold = options.caseFold\n    } else { // Backwards compat for when caseFold was the 4th argument\n      caseFold = options\n      options = null\n    }\n\n    if (typeof query == \"string\") {\n      if (caseFold == null) caseFold = false\n      this.matches = function(reverse, pos) {\n        return (reverse ? searchStringBackward : searchStringForward)(doc, query, pos, caseFold)\n      }\n    } else {\n      query = ensureFlags(query, \"gm\")\n      if (!options || options.multiline !== false)\n        this.matches = function(reverse, pos) {\n          return (reverse ? searchRegexpBackwardMultiline : searchRegexpForwardMultiline)(doc, query, pos)\n        }\n      else\n        this.matches = function(reverse, pos) {\n          return (reverse ? searchRegexpBackward : searchRegexpForward)(doc, query, pos)\n        }\n    }\n  }\n\n  SearchCursor.prototype = {\n    findNext: function() {return this.find(false)},\n    findPrevious: function() {return this.find(true)},\n\n    find: function(reverse) {\n      var result = this.matches(reverse, this.doc.clipPos(reverse ? this.pos.from : this.pos.to))\n\n      // Implements weird auto-growing behavior on null-matches for\n      // backwards-compatibility with the vim code (unfortunately)\n      while (result && CodeMirror.cmpPos(result.from, result.to) == 0) {\n        if (reverse) {\n          if (result.from.ch) result.from = Pos(result.from.line, result.from.ch - 1)\n          else if (result.from.line == this.doc.firstLine()) result = null\n          else result = this.matches(reverse, this.doc.clipPos(Pos(result.from.line - 1)))\n        } else {\n          if (result.to.ch < this.doc.getLine(result.to.line).length) result.to = Pos(result.to.line, result.to.ch + 1)\n          else if (result.to.line == this.doc.lastLine()) result = null\n          else result = this.matches(reverse, Pos(result.to.line + 1, 0))\n        }\n      }\n\n      if (result) {\n        this.pos = result\n        this.atOccurrence = true\n        return this.pos.match || true\n      } else {\n        var end = Pos(reverse ? this.doc.firstLine() : this.doc.lastLine() + 1, 0)\n        this.pos = {from: end, to: end}\n        return this.atOccurrence = false\n      }\n    },\n\n    from: function() {if (this.atOccurrence) return this.pos.from},\n    to: function() {if (this.atOccurrence) return this.pos.to},\n\n    replace: function(newText, origin) {\n      if (!this.atOccurrence) return\n      var lines = CodeMirror.splitLines(newText)\n      this.doc.replaceRange(lines, this.pos.from, this.pos.to, origin)\n      this.pos.to = Pos(this.pos.from.line + lines.length - 1,\n                        lines[lines.length - 1].length + (lines.length == 1 ? this.pos.from.ch : 0))\n    }\n  }\n\n  CodeMirror.defineExtension(\"getSearchCursor\", function(query, pos, caseFold) {\n    return new SearchCursor(this.doc, query, pos, caseFold)\n  })\n  CodeMirror.defineDocExtension(\"getSearchCursor\", function(query, pos, caseFold) {\n    return new SearchCursor(this, query, pos, caseFold)\n  })\n\n  CodeMirror.defineExtension(\"selectMatches\", function(query, caseFold) {\n    var ranges = []\n    var cur = this.getSearchCursor(query, this.getCursor(\"from\"), caseFold)\n    while (cur.findNext()) {\n      if (CodeMirror.cmpPos(cur.to(), this.getCursor(\"to\")) > 0) break\n      ranges.push({anchor: cur.from(), head: cur.to()})\n    }\n    if (ranges.length)\n      this.setSelections(ranges, 0)\n  })\n});\n","// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: https://codemirror.net/LICENSE\n\n// declare global: DOMRect\n\n(function(mod) {\n  if (typeof exports == \"object\" && typeof module == \"object\") // CommonJS\n    mod(require(\"../../lib/codemirror\"));\n  else if (typeof define == \"function\" && define.amd) // AMD\n    define([\"../../lib/codemirror\"], mod);\n  else // Plain browser env\n    mod(CodeMirror);\n})(function(CodeMirror) {\n  \"use strict\";\n\n  var HINT_ELEMENT_CLASS        = \"CodeMirror-hint\";\n  var ACTIVE_HINT_ELEMENT_CLASS = \"CodeMirror-hint-active\";\n\n  // This is the old interface, kept around for now to stay\n  // backwards-compatible.\n  CodeMirror.showHint = function(cm, getHints, options) {\n    if (!getHints) return cm.showHint(options);\n    if (options && options.async) getHints.async = true;\n    var newOpts = {hint: getHints};\n    if (options) for (var prop in options) newOpts[prop] = options[prop];\n    return cm.showHint(newOpts);\n  };\n\n  CodeMirror.defineExtension(\"showHint\", function(options) {\n    options = parseOptions(this, this.getCursor(\"start\"), options);\n    var selections = this.listSelections()\n    if (selections.length > 1) return;\n    // By default, don't allow completion when something is selected.\n    // A hint function can have a `supportsSelection` property to\n    // indicate that it can handle selections.\n    if (this.somethingSelected()) {\n      if (!options.hint.supportsSelection) return;\n      // Don't try with cross-line selections\n      for (var i = 0; i < selections.length; i++)\n        if (selections[i].head.line != selections[i].anchor.line) return;\n    }\n\n    if (this.state.completionActive) this.state.completionActive.close();\n    var completion = this.state.completionActive = new Completion(this, options);\n    if (!completion.options.hint) return;\n\n    CodeMirror.signal(this, \"startCompletion\", this);\n    completion.update(true);\n  });\n\n  CodeMirror.defineExtension(\"closeHint\", function() {\n    if (this.state.completionActive) this.state.completionActive.close()\n  })\n\n  function Completion(cm, options) {\n    this.cm = cm;\n    this.options = options;\n    this.widget = null;\n    this.debounce = 0;\n    this.tick = 0;\n    this.startPos = this.cm.getCursor(\"start\");\n    this.startLen = this.cm.getLine(this.startPos.line).length - this.cm.getSelection().length;\n\n    if (this.options.updateOnCursorActivity) {\n      var self = this;\n      cm.on(\"cursorActivity\", this.activityFunc = function() { self.cursorActivity(); });\n    }\n  }\n\n  var requestAnimationFrame = window.requestAnimationFrame || function(fn) {\n    return setTimeout(fn, 1000/60);\n  };\n  var cancelAnimationFrame = window.cancelAnimationFrame || clearTimeout;\n\n  Completion.prototype = {\n    close: function() {\n      if (!this.active()) return;\n      this.cm.state.completionActive = null;\n      this.tick = null;\n      if (this.options.updateOnCursorActivity) {\n        this.cm.off(\"cursorActivity\", this.activityFunc);\n      }\n\n      if (this.widget && this.data) CodeMirror.signal(this.data, \"close\");\n      if (this.widget) this.widget.close();\n      CodeMirror.signal(this.cm, \"endCompletion\", this.cm);\n    },\n\n    active: function() {\n      return this.cm.state.completionActive == this;\n    },\n\n    pick: function(data, i) {\n      var completion = data.list[i], self = this;\n      this.cm.operation(function() {\n        if (completion.hint)\n          completion.hint(self.cm, data, completion);\n        else\n          self.cm.replaceRange(getText(completion), completion.from || data.from,\n                               completion.to || data.to, \"complete\");\n        CodeMirror.signal(data, \"pick\", completion);\n        self.cm.scrollIntoView();\n      });\n      if (this.options.closeOnPick) {\n        this.close();\n      }\n    },\n\n    cursorActivity: function() {\n      if (this.debounce) {\n        cancelAnimationFrame(this.debounce);\n        this.debounce = 0;\n      }\n\n      var identStart = this.startPos;\n      if(this.data) {\n        identStart = this.data.from;\n      }\n\n      var pos = this.cm.getCursor(), line = this.cm.getLine(pos.line);\n      if (pos.line != this.startPos.line || line.length - pos.ch != this.startLen - this.startPos.ch ||\n          pos.ch < identStart.ch || this.cm.somethingSelected() ||\n          (!pos.ch || this.options.closeCharacters.test(line.charAt(pos.ch - 1)))) {\n        this.close();\n      } else {\n        var self = this;\n        this.debounce = requestAnimationFrame(function() {self.update();});\n        if (this.widget) this.widget.disable();\n      }\n    },\n\n    update: function(first) {\n      if (this.tick == null) return\n      var self = this, myTick = ++this.tick\n      fetchHints(this.options.hint, this.cm, this.options, function(data) {\n        if (self.tick == myTick) self.finishUpdate(data, first)\n      })\n    },\n\n    finishUpdate: function(data, first) {\n      if (this.data) CodeMirror.signal(this.data, \"update\");\n\n      var picked = (this.widget && this.widget.picked) || (first && this.options.completeSingle);\n      if (this.widget) this.widget.close();\n\n      this.data = data;\n\n      if (data && data.list.length) {\n        if (picked && data.list.length == 1) {\n          this.pick(data, 0);\n        } else {\n          this.widget = new Widget(this, data);\n          CodeMirror.signal(data, \"shown\");\n        }\n      }\n    }\n  };\n\n  function parseOptions(cm, pos, options) {\n    var editor = cm.options.hintOptions;\n    var out = {};\n    for (var prop in defaultOptions) out[prop] = defaultOptions[prop];\n    if (editor) for (var prop in editor)\n      if (editor[prop] !== undefined) out[prop] = editor[prop];\n    if (options) for (var prop in options)\n      if (options[prop] !== undefined) out[prop] = options[prop];\n    if (out.hint.resolve) out.hint = out.hint.resolve(cm, pos)\n    return out;\n  }\n\n  function getText(completion) {\n    if (typeof completion == \"string\") return completion;\n    else return completion.text;\n  }\n\n  function buildKeyMap(completion, handle) {\n    var baseMap = {\n      Up: function() {handle.moveFocus(-1);},\n      Down: function() {handle.moveFocus(1);},\n      PageUp: function() {handle.moveFocus(-handle.menuSize() + 1, true);},\n      PageDown: function() {handle.moveFocus(handle.menuSize() - 1, true);},\n      Home: function() {handle.setFocus(0);},\n      End: function() {handle.setFocus(handle.length - 1);},\n      Enter: handle.pick,\n      Tab: handle.pick,\n      Esc: handle.close\n    };\n\n    var mac = /Mac/.test(navigator.platform);\n\n    if (mac) {\n      baseMap[\"Ctrl-P\"] = function() {handle.moveFocus(-1);};\n      baseMap[\"Ctrl-N\"] = function() {handle.moveFocus(1);};\n    }\n\n    var custom = completion.options.customKeys;\n    var ourMap = custom ? {} : baseMap;\n    function addBinding(key, val) {\n      var bound;\n      if (typeof val != \"string\")\n        bound = function(cm) { return val(cm, handle); };\n      // This mechanism is deprecated\n      else if (baseMap.hasOwnProperty(val))\n        bound = baseMap[val];\n      else\n        bound = val;\n      ourMap[key] = bound;\n    }\n    if (custom)\n      for (var key in custom) if (custom.hasOwnProperty(key))\n        addBinding(key, custom[key]);\n    var extra = completion.options.extraKeys;\n    if (extra)\n      for (var key in extra) if (extra.hasOwnProperty(key))\n        addBinding(key, extra[key]);\n    return ourMap;\n  }\n\n  function getHintElement(hintsElement, el) {\n    while (el && el != hintsElement) {\n      if (el.nodeName.toUpperCase() === \"LI\" && el.parentNode == hintsElement) return el;\n      el = el.parentNode;\n    }\n  }\n\n  function Widget(completion, data) {\n    this.completion = completion;\n    this.data = data;\n    this.picked = false;\n    var widget = this, cm = completion.cm;\n    var ownerDocument = cm.getInputField().ownerDocument;\n    var parentWindow = ownerDocument.defaultView || ownerDocument.parentWindow;\n\n    var hints = this.hints = ownerDocument.createElement(\"ul\");\n    var theme = completion.cm.options.theme;\n    hints.className = \"CodeMirror-hints \" + theme;\n    this.selectedHint = data.selectedHint || 0;\n\n    var completions = data.list;\n    for (var i = 0; i < completions.length; ++i) {\n      var elt = hints.appendChild(ownerDocument.createElement(\"li\")), cur = completions[i];\n      var className = HINT_ELEMENT_CLASS + (i != this.selectedHint ? \"\" : \" \" + ACTIVE_HINT_ELEMENT_CLASS);\n      if (cur.className != null) className = cur.className + \" \" + className;\n      elt.className = className;\n      if (cur.render) cur.render(elt, data, cur);\n      else elt.appendChild(ownerDocument.createTextNode(cur.displayText || getText(cur)));\n      elt.hintId = i;\n    }\n\n    var container = completion.options.container || ownerDocument.body;\n    var pos = cm.cursorCoords(completion.options.alignWithWord ? data.from : null);\n    var left = pos.left, top = pos.bottom, below = true;\n    var offsetLeft = 0, offsetTop = 0;\n    if (container !== ownerDocument.body) {\n      // We offset the cursor position because left and top are relative to the offsetParent's top left corner.\n      var isContainerPositioned = ['absolute', 'relative', 'fixed'].indexOf(parentWindow.getComputedStyle(container).position) !== -1;\n      var offsetParent = isContainerPositioned ? container : container.offsetParent;\n      var offsetParentPosition = offsetParent.getBoundingClientRect();\n      var bodyPosition = ownerDocument.body.getBoundingClientRect();\n      offsetLeft = (offsetParentPosition.left - bodyPosition.left - offsetParent.scrollLeft);\n      offsetTop = (offsetParentPosition.top - bodyPosition.top - offsetParent.scrollTop);\n    }\n    hints.style.left = (left - offsetLeft) + \"px\";\n    hints.style.top = (top - offsetTop) + \"px\";\n\n    // If we're at the edge of the screen, then we want the menu to appear on the left of the cursor.\n    var winW = parentWindow.innerWidth || Math.max(ownerDocument.body.offsetWidth, ownerDocument.documentElement.offsetWidth);\n    var winH = parentWindow.innerHeight || Math.max(ownerDocument.body.offsetHeight, ownerDocument.documentElement.offsetHeight);\n    container.appendChild(hints);\n\n    var box = completion.options.moveOnOverlap ? hints.getBoundingClientRect() : new DOMRect();\n    var scrolls = completion.options.paddingForScrollbar ? hints.scrollHeight > hints.clientHeight + 1 : false;\n\n    // Compute in the timeout to avoid reflow on init\n    var startScroll;\n    setTimeout(function() { startScroll = cm.getScrollInfo(); });\n\n    var overlapY = box.bottom - winH;\n    if (overlapY > 0) {\n      var height = box.bottom - box.top, curTop = pos.top - (pos.bottom - box.top);\n      if (curTop - height > 0) { // Fits above cursor\n        hints.style.top = (top = pos.top - height - offsetTop) + \"px\";\n        below = false;\n      } else if (height > winH) {\n        hints.style.height = (winH - 5) + \"px\";\n        hints.style.top = (top = pos.bottom - box.top - offsetTop) + \"px\";\n        var cursor = cm.getCursor();\n        if (data.from.ch != cursor.ch) {\n          pos = cm.cursorCoords(cursor);\n          hints.style.left = (left = pos.left - offsetLeft) + \"px\";\n          box = hints.getBoundingClientRect();\n        }\n      }\n    }\n    var overlapX = box.right - winW;\n    if (scrolls) overlapX += cm.display.nativeBarWidth;\n    if (overlapX > 0) {\n      if (box.right - box.left > winW) {\n        hints.style.width = (winW - 5) + \"px\";\n        overlapX -= (box.right - box.left) - winW;\n      }\n      hints.style.left = (left = pos.left - overlapX - offsetLeft) + \"px\";\n    }\n    if (scrolls) for (var node = hints.firstChild; node; node = node.nextSibling)\n      node.style.paddingRight = cm.display.nativeBarWidth + \"px\"\n\n    cm.addKeyMap(this.keyMap = buildKeyMap(completion, {\n      moveFocus: function(n, avoidWrap) { widget.changeActive(widget.selectedHint + n, avoidWrap); },\n      setFocus: function(n) { widget.changeActive(n); },\n      menuSize: function() { return widget.screenAmount(); },\n      length: completions.length,\n      close: function() { completion.close(); },\n      pick: function() { widget.pick(); },\n      data: data\n    }));\n\n    if (completion.options.closeOnUnfocus) {\n      var closingOnBlur;\n      cm.on(\"blur\", this.onBlur = function() { closingOnBlur = setTimeout(function() { completion.close(); }, 100); });\n      cm.on(\"focus\", this.onFocus = function() { clearTimeout(closingOnBlur); });\n    }\n\n    cm.on(\"scroll\", this.onScroll = function() {\n      var curScroll = cm.getScrollInfo(), editor = cm.getWrapperElement().getBoundingClientRect();\n      if (!startScroll) startScroll = cm.getScrollInfo();\n      var newTop = top + startScroll.top - curScroll.top;\n      var point = newTop - (parentWindow.pageYOffset || (ownerDocument.documentElement || ownerDocument.body).scrollTop);\n      if (!below) point += hints.offsetHeight;\n      if (point <= editor.top || point >= editor.bottom) return completion.close();\n      hints.style.top = newTop + \"px\";\n      hints.style.left = (left + startScroll.left - curScroll.left) + \"px\";\n    });\n\n    CodeMirror.on(hints, \"dblclick\", function(e) {\n      var t = getHintElement(hints, e.target || e.srcElement);\n      if (t && t.hintId != null) {widget.changeActive(t.hintId); widget.pick();}\n    });\n\n    CodeMirror.on(hints, \"click\", function(e) {\n      var t = getHintElement(hints, e.target || e.srcElement);\n      if (t && t.hintId != null) {\n        widget.changeActive(t.hintId);\n        if (completion.options.completeOnSingleClick) widget.pick();\n      }\n    });\n\n    CodeMirror.on(hints, \"mousedown\", function() {\n      setTimeout(function(){cm.focus();}, 20);\n    });\n\n    // The first hint doesn't need to be scrolled to on init\n    var selectedHintRange = this.getSelectedHintRange();\n    if (selectedHintRange.from !== 0 || selectedHintRange.to !== 0) {\n      this.scrollToActive();\n    }\n\n    CodeMirror.signal(data, \"select\", completions[this.selectedHint], hints.childNodes[this.selectedHint]);\n    return true;\n  }\n\n  Widget.prototype = {\n    close: function() {\n      if (this.completion.widget != this) return;\n      this.completion.widget = null;\n      if (this.hints.parentNode) this.hints.parentNode.removeChild(this.hints);\n      this.completion.cm.removeKeyMap(this.keyMap);\n\n      var cm = this.completion.cm;\n      if (this.completion.options.closeOnUnfocus) {\n        cm.off(\"blur\", this.onBlur);\n        cm.off(\"focus\", this.onFocus);\n      }\n      cm.off(\"scroll\", this.onScroll);\n    },\n\n    disable: function() {\n      this.completion.cm.removeKeyMap(this.keyMap);\n      var widget = this;\n      this.keyMap = {Enter: function() { widget.picked = true; }};\n      this.completion.cm.addKeyMap(this.keyMap);\n    },\n\n    pick: function() {\n      this.completion.pick(this.data, this.selectedHint);\n    },\n\n    changeActive: function(i, avoidWrap) {\n      if (i >= this.data.list.length)\n        i = avoidWrap ? this.data.list.length - 1 : 0;\n      else if (i < 0)\n        i = avoidWrap ? 0  : this.data.list.length - 1;\n      if (this.selectedHint == i) return;\n      var node = this.hints.childNodes[this.selectedHint];\n      if (node) node.className = node.className.replace(\" \" + ACTIVE_HINT_ELEMENT_CLASS, \"\");\n      node = this.hints.childNodes[this.selectedHint = i];\n      node.className += \" \" + ACTIVE_HINT_ELEMENT_CLASS;\n      this.scrollToActive()\n      CodeMirror.signal(this.data, \"select\", this.data.list[this.selectedHint], node);\n    },\n\n    scrollToActive: function() {\n      var selectedHintRange = this.getSelectedHintRange();\n      var node1 = this.hints.childNodes[selectedHintRange.from];\n      var node2 = this.hints.childNodes[selectedHintRange.to];\n      var firstNode = this.hints.firstChild;\n      if (node1.offsetTop < this.hints.scrollTop)\n        this.hints.scrollTop = node1.offsetTop - firstNode.offsetTop;\n      else if (node2.offsetTop + node2.offsetHeight > this.hints.scrollTop + this.hints.clientHeight)\n        this.hints.scrollTop = node2.offsetTop + node2.offsetHeight - this.hints.clientHeight + firstNode.offsetTop;\n    },\n\n    screenAmount: function() {\n      return Math.floor(this.hints.clientHeight / this.hints.firstChild.offsetHeight) || 1;\n    },\n\n    getSelectedHintRange: function() {\n      var margin = this.completion.options.scrollMargin || 0;\n      return {\n        from: Math.max(0, this.selectedHint - margin),\n        to: Math.min(this.data.list.length - 1, this.selectedHint + margin),\n      };\n    }\n  };\n\n  function applicableHelpers(cm, helpers) {\n    if (!cm.somethingSelected()) return helpers\n    var result = []\n    for (var i = 0; i < helpers.length; i++)\n      if (helpers[i].supportsSelection) result.push(helpers[i])\n    return result\n  }\n\n  function fetchHints(hint, cm, options, callback) {\n    if (hint.async) {\n      hint(cm, callback, options)\n    } else {\n      var result = hint(cm, options)\n      if (result && result.then) result.then(callback)\n      else callback(result)\n    }\n  }\n\n  function resolveAutoHints(cm, pos) {\n    var helpers = cm.getHelpers(pos, \"hint\"), words\n    if (helpers.length) {\n      var resolved = function(cm, callback, options) {\n        var app = applicableHelpers(cm, helpers);\n        function run(i) {\n          if (i == app.length) return callback(null)\n          fetchHints(app[i], cm, options, function(result) {\n            if (result && result.list.length > 0) callback(result)\n            else run(i + 1)\n          })\n        }\n        run(0)\n      }\n      resolved.async = true\n      resolved.supportsSelection = true\n      return resolved\n    } else if (words = cm.getHelper(cm.getCursor(), \"hintWords\")) {\n      return function(cm) { return CodeMirror.hint.fromList(cm, {words: words}) }\n    } else if (CodeMirror.hint.anyword) {\n      return function(cm, options) { return CodeMirror.hint.anyword(cm, options) }\n    } else {\n      return function() {}\n    }\n  }\n\n  CodeMirror.registerHelper(\"hint\", \"auto\", {\n    resolve: resolveAutoHints\n  });\n\n  CodeMirror.registerHelper(\"hint\", \"fromList\", function(cm, options) {\n    var cur = cm.getCursor(), token = cm.getTokenAt(cur)\n    var term, from = CodeMirror.Pos(cur.line, token.start), to = cur\n    if (token.start < cur.ch && /\\w/.test(token.string.charAt(cur.ch - token.start - 1))) {\n      term = token.string.substr(0, cur.ch - token.start)\n    } else {\n      term = \"\"\n      from = cur\n    }\n    var found = [];\n    for (var i = 0; i < options.words.length; i++) {\n      var word = options.words[i];\n      if (word.slice(0, term.length) == term)\n        found.push(word);\n    }\n\n    if (found.length) return {list: found, from: from, to: to};\n  });\n\n  CodeMirror.commands.autocomplete = CodeMirror.showHint;\n\n  var defaultOptions = {\n    hint: CodeMirror.hint.auto,\n    completeSingle: true,\n    alignWithWord: true,\n    closeCharacters: /[\\s()\\[\\]{};:>,]/,\n    closeOnPick: true,\n    closeOnUnfocus: true,\n    updateOnCursorActivity: true,\n    completeOnSingleClick: true,\n    container: null,\n    customKeys: null,\n    extraKeys: null,\n    paddingForScrollbar: true,\n    moveOnOverlap: true,\n  };\n\n  CodeMirror.defineOption(\"hintOptions\", null);\n});\n","// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: https://codemirror.net/LICENSE\n\n// Define search commands. Depends on dialog.js or another\n// implementation of the openDialog method.\n\n// Replace works a little oddly -- it will do the replace on the next\n// Ctrl-G (or whatever is bound to findNext) press. You prevent a\n// replace by making sure the match is no longer selected when hitting\n// Ctrl-G.\n\n(function(mod) {\n  if (typeof exports == \"object\" && typeof module == \"object\") // CommonJS\n    mod(require(\"../../lib/codemirror\"), require(\"./searchcursor\"), require(\"../dialog/dialog\"));\n  else if (typeof define == \"function\" && define.amd) // AMD\n    define([\"../../lib/codemirror\", \"./searchcursor\", \"../dialog/dialog\"], mod);\n  else // Plain browser env\n    mod(CodeMirror);\n})(function(CodeMirror) {\n  \"use strict\";\n\n  // default search panel location\n  CodeMirror.defineOption(\"search\", {bottom: false});\n\n  function searchOverlay(query, caseInsensitive) {\n    if (typeof query == \"string\")\n      query = new RegExp(query.replace(/[\\-\\[\\]\\/\\{\\}\\(\\)\\*\\+\\?\\.\\\\\\^\\$\\|]/g, \"\\\\$&\"), caseInsensitive ? \"gi\" : \"g\");\n    else if (!query.global)\n      query = new RegExp(query.source, query.ignoreCase ? \"gi\" : \"g\");\n\n    return {token: function(stream) {\n      query.lastIndex = stream.pos;\n      var match = query.exec(stream.string);\n      if (match && match.index == stream.pos) {\n        stream.pos += match[0].length || 1;\n        return \"searching\";\n      } else if (match) {\n        stream.pos = match.index;\n      } else {\n        stream.skipToEnd();\n      }\n    }};\n  }\n\n  function SearchState() {\n    this.posFrom = this.posTo = this.lastQuery = this.query = null;\n    this.overlay = null;\n  }\n\n  function getSearchState(cm) {\n    return cm.state.search || (cm.state.search = new SearchState());\n  }\n\n  function queryCaseInsensitive(query) {\n    return typeof query == \"string\" && query == query.toLowerCase();\n  }\n\n  function getSearchCursor(cm, query, pos) {\n    // Heuristic: if the query string is all lowercase, do a case insensitive search.\n    return cm.getSearchCursor(query, pos, {caseFold: queryCaseInsensitive(query), multiline: true});\n  }\n\n  function persistentDialog(cm, text, deflt, onEnter, onKeyDown) {\n    cm.openDialog(text, onEnter, {\n      value: deflt,\n      selectValueOnOpen: true,\n      closeOnEnter: false,\n      onClose: function() { clearSearch(cm); },\n      onKeyDown: onKeyDown,\n      bottom: cm.options.search.bottom\n    });\n  }\n\n  function dialog(cm, text, shortText, deflt, f) {\n    if (cm.openDialog) cm.openDialog(text, f, {value: deflt, selectValueOnOpen: true, bottom: cm.options.search.bottom});\n    else f(prompt(shortText, deflt));\n  }\n\n  function confirmDialog(cm, text, shortText, fs) {\n    if (cm.openConfirm) cm.openConfirm(text, fs);\n    else if (confirm(shortText)) fs[0]();\n  }\n\n  function parseString(string) {\n    return string.replace(/\\\\([nrt\\\\])/g, function(match, ch) {\n      if (ch == \"n\") return \"\\n\"\n      if (ch == \"r\") return \"\\r\"\n      if (ch == \"t\") return \"\\t\"\n      if (ch == \"\\\\\") return \"\\\\\"\n      return match\n    })\n  }\n\n  function parseQuery(query) {\n    var isRE = query.match(/^\\/(.*)\\/([a-z]*)$/);\n    if (isRE) {\n      try { query = new RegExp(isRE[1], isRE[2].indexOf(\"i\") == -1 ? \"\" : \"i\"); }\n      catch(e) {} // Not a regular expression after all, do a string search\n    } else {\n      query = parseString(query)\n    }\n    if (typeof query == \"string\" ? query == \"\" : query.test(\"\"))\n      query = /x^/;\n    return query;\n  }\n\n  function startSearch(cm, state, query) {\n    state.queryText = query;\n    state.query = parseQuery(query);\n    cm.removeOverlay(state.overlay, queryCaseInsensitive(state.query));\n    state.overlay = searchOverlay(state.query, queryCaseInsensitive(state.query));\n    cm.addOverlay(state.overlay);\n    if (cm.showMatchesOnScrollbar) {\n      if (state.annotate) { state.annotate.clear(); state.annotate = null; }\n      state.annotate = cm.showMatchesOnScrollbar(state.query, queryCaseInsensitive(state.query));\n    }\n  }\n\n  function doSearch(cm, rev, persistent, immediate) {\n    var state = getSearchState(cm);\n    if (state.query) return findNext(cm, rev);\n    var q = cm.getSelection() || state.lastQuery;\n    if (q instanceof RegExp && q.source == \"x^\") q = null\n    if (persistent && cm.openDialog) {\n      var hiding = null\n      var searchNext = function(query, event) {\n        CodeMirror.e_stop(event);\n        if (!query) return;\n        if (query != state.queryText) {\n          startSearch(cm, state, query);\n          state.posFrom = state.posTo = cm.getCursor();\n        }\n        if (hiding) hiding.style.opacity = 1\n        findNext(cm, event.shiftKey, function(_, to) {\n          var dialog\n          if (to.line < 3 && document.querySelector &&\n              (dialog = cm.display.wrapper.querySelector(\".CodeMirror-dialog\")) &&\n              dialog.getBoundingClientRect().bottom - 4 > cm.cursorCoords(to, \"window\").top)\n            (hiding = dialog).style.opacity = .4\n        })\n      };\n      persistentDialog(cm, getQueryDialog(cm), q, searchNext, function(event, query) {\n        var keyName = CodeMirror.keyName(event)\n        var extra = cm.getOption('extraKeys'), cmd = (extra && extra[keyName]) || CodeMirror.keyMap[cm.getOption(\"keyMap\")][keyName]\n        if (cmd == \"findNext\" || cmd == \"findPrev\" ||\n          cmd == \"findPersistentNext\" || cmd == \"findPersistentPrev\") {\n          CodeMirror.e_stop(event);\n          startSearch(cm, getSearchState(cm), query);\n          cm.execCommand(cmd);\n        } else if (cmd == \"find\" || cmd == \"findPersistent\") {\n          CodeMirror.e_stop(event);\n          searchNext(query, event);\n        }\n      });\n      if (immediate && q) {\n        startSearch(cm, state, q);\n        findNext(cm, rev);\n      }\n    } else {\n      dialog(cm, getQueryDialog(cm), \"Search for:\", q, function(query) {\n        if (query && !state.query) cm.operation(function() {\n          startSearch(cm, state, query);\n          state.posFrom = state.posTo = cm.getCursor();\n          findNext(cm, rev);\n        });\n      });\n    }\n  }\n\n  function findNext(cm, rev, callback) {cm.operation(function() {\n    var state = getSearchState(cm);\n    var cursor = getSearchCursor(cm, state.query, rev ? state.posFrom : state.posTo);\n    if (!cursor.find(rev)) {\n      cursor = getSearchCursor(cm, state.query, rev ? CodeMirror.Pos(cm.lastLine()) : CodeMirror.Pos(cm.firstLine(), 0));\n      if (!cursor.find(rev)) return;\n    }\n    cm.setSelection(cursor.from(), cursor.to());\n    cm.scrollIntoView({from: cursor.from(), to: cursor.to()}, 20);\n    state.posFrom = cursor.from(); state.posTo = cursor.to();\n    if (callback) callback(cursor.from(), cursor.to())\n  });}\n\n  function clearSearch(cm) {cm.operation(function() {\n    var state = getSearchState(cm);\n    state.lastQuery = state.query;\n    if (!state.query) return;\n    state.query = state.queryText = null;\n    cm.removeOverlay(state.overlay);\n    if (state.annotate) { state.annotate.clear(); state.annotate = null; }\n  });}\n\n\n  function getQueryDialog(cm)  {\n    return '<span class=\"CodeMirror-search-label\">' + cm.phrase(\"Search:\") + '</span> <input type=\"text\" style=\"width: 10em\" class=\"CodeMirror-search-field\"/> <span style=\"color: #888\" class=\"CodeMirror-search-hint\">' + cm.phrase(\"(Use /re/ syntax for regexp search)\") + '</span>';\n  }\n  function getReplaceQueryDialog(cm) {\n    return ' <input type=\"text\" style=\"width: 10em\" class=\"CodeMirror-search-field\"/> <span style=\"color: #888\" class=\"CodeMirror-search-hint\">' + cm.phrase(\"(Use /re/ syntax for regexp search)\") + '</span>';\n  }\n  function getReplacementQueryDialog(cm) {\n    return '<span class=\"CodeMirror-search-label\">' + cm.phrase(\"With:\") + '</span> <input type=\"text\" style=\"width: 10em\" class=\"CodeMirror-search-field\"/>';\n  }\n  function getDoReplaceConfirm(cm) {\n    return '<span class=\"CodeMirror-search-label\">' + cm.phrase(\"Replace?\") + '</span> <button>' + cm.phrase(\"Yes\") + '</button> <button>' + cm.phrase(\"No\") + '</button> <button>' + cm.phrase(\"All\") + '</button> <button>' + cm.phrase(\"Stop\") + '</button> ';\n  }\n\n  function replaceAll(cm, query, text) {\n    cm.operation(function() {\n      for (var cursor = getSearchCursor(cm, query); cursor.findNext();) {\n        if (typeof query != \"string\") {\n          var match = cm.getRange(cursor.from(), cursor.to()).match(query);\n          cursor.replace(text.replace(/\\$(\\d)/g, function(_, i) {return match[i];}));\n        } else cursor.replace(text);\n      }\n    });\n  }\n\n  function replace(cm, all) {\n    if (cm.getOption(\"readOnly\")) return;\n    var query = cm.getSelection() || getSearchState(cm).lastQuery;\n    var dialogText = '<span class=\"CodeMirror-search-label\">' + (all ? cm.phrase(\"Replace all:\") : cm.phrase(\"Replace:\")) + '</span>';\n    dialog(cm, dialogText + getReplaceQueryDialog(cm), dialogText, query, function(query) {\n      if (!query) return;\n      query = parseQuery(query);\n      dialog(cm, getReplacementQueryDialog(cm), cm.phrase(\"Replace with:\"), \"\", function(text) {\n        text = parseString(text)\n        if (all) {\n          replaceAll(cm, query, text)\n        } else {\n          clearSearch(cm);\n          var cursor = getSearchCursor(cm, query, cm.getCursor(\"from\"));\n          var advance = function() {\n            var start = cursor.from(), match;\n            if (!(match = cursor.findNext())) {\n              cursor = getSearchCursor(cm, query);\n              if (!(match = cursor.findNext()) ||\n                  (start && cursor.from().line == start.line && cursor.from().ch == start.ch)) return;\n            }\n            cm.setSelection(cursor.from(), cursor.to());\n            cm.scrollIntoView({from: cursor.from(), to: cursor.to()});\n            confirmDialog(cm, getDoReplaceConfirm(cm), cm.phrase(\"Replace?\"),\n                          [function() {doReplace(match);}, advance,\n                           function() {replaceAll(cm, query, text)}]);\n          };\n          var doReplace = function(match) {\n            cursor.replace(typeof query == \"string\" ? text :\n                           text.replace(/\\$(\\d)/g, function(_, i) {return match[i];}));\n            advance();\n          };\n          advance();\n        }\n      });\n    });\n  }\n\n  CodeMirror.commands.find = function(cm) {clearSearch(cm); doSearch(cm);};\n  CodeMirror.commands.findPersistent = function(cm) {clearSearch(cm); doSearch(cm, false, true);};\n  CodeMirror.commands.findPersistentNext = function(cm) {doSearch(cm, false, true, true);};\n  CodeMirror.commands.findPersistentPrev = function(cm) {doSearch(cm, true, true, true);};\n  CodeMirror.commands.findNext = doSearch;\n  CodeMirror.commands.findPrev = function(cm) {doSearch(cm, true);};\n  CodeMirror.commands.clearSearch = clearSearch;\n  CodeMirror.commands.replace = replace;\n  CodeMirror.commands.replaceAll = function(cm) {replace(cm, true);};\n});\n"],"sourceRoot":""}