{"version":3,"sources":["../../core/src/configeditor/codemirror-yaml/lint.js","../../core/src/configeditor/codemirror-yaml/mode.tsx","../../core/src/configeditor/ConfigEditor.tsx","../../core/src/configeditor/ConfigEditorUtils.tsx","../../core/src/configeditor/isHelpContextEqual.ts","../../core/src/execute/ConfigEditorHelp.tsx","../../core/src/execute/ConfigEditorModePicker.tsx","../../core/src/execute/ExecutionTabs.tsx","../../core/src/execute/LaunchRootExecutionButton.tsx","../../core/src/execute/RunPreview.tsx","../../core/src/execute/SolidSelector.tsx","../../core/src/execute/scaffoldType.ts","../../core/src/execute/ExecutionSessionContainer.tsx"],"names":["GUTTER_ID","rm","elt","parentNode","removeChild","showTooltipFor","e","content","node","tooltip","tt","document","createElement","nodeRect","getBoundingClientRect","className","appendChild","cloneNode","body","top","clientHeight","style","left","right","opacity","showTooltip","hide","CodeMirror","off","setTimeout","poll","setInterval","n","nodeType","host","clearInterval","on","clearMarks","cm","state","lint","hasGutter","clearGutter","i","marked","length","clear","makeMarker","labels","severity","multiple","tooltips","marker","inner","annotationTooltip","ann","tip","messageHTML","innerHTML","createTextNode","message","updateLinting","annotationsNotSorted","a","b","options","annotations","lines","line","from","push","groupByLine","anns","maxSeverity","tipLabel","createDocumentFragment","formatAnnotation","to","markText","__annotation","setGutterMarker","onUpdateLinting","startLinting","passOptions","getAnnotations","getHelper","Pos","async","id","waitingFor","abort","getValue","arg2","operation","lintAsync","then","issues","onChange","clearTimeout","timeout","delay","onMouseOver","box","target","srcElement","x","y","bottom","pos","coordsChar","spans","findMarksAt","docs","getDocs","docsEl","textContent","paddingBottom","marginBottom","borderBottom","popupTooltip","LintState","this","defineOption","val","old","Init","lintOnChange","getWrapperElement","gutters","getOption","hasLintGutter","Function","defineExtension","ContainerType","parentsAddingChildKeyAtIndent","parents","key","indent","immediateParent","slice","childKeys","parentsAddingChildKeyToLast","parentsPoppingItemsDeeperThan","RegExps","KEYWORD","RegExp","join","DICT_COLON","DICT_KEY","QUOTED_STRING","BLOCKSTART_PIPE_OR_ARROW","NUMBER","VARIABLE","findAutocompletionContext","schema","currentIndent","filter","type","allConfigTypes","find","t","rootConfigType","__typename","available","fields","closestCompositeType","inArray","parent","parentTypeDef","name","parentConfigType","configTypeKey","childTypeKey","childEntriesUnique","typeParamKeys","nonScalarTypeKey","nonScalarType","item","indexOf","availableFields","expandAutocompletionContextAtCursor","editor","searchString","start","hintOptions","cursor","getCursor","token","getTokenAt","prevToken","ch","string","startsWith","end","context","validationErrorToCodemirrorError","error","yamlDoc","codeMirrorDoc","part","reason","range","findRangeInDocumentFromPath","path","posFromIndex","Number","MAX_SAFE_INTEGER","doc","pathPart","contents","value","index","parseInt","isNaN","items","nodeAtPath","lineComment","fold","startState","trailingSpace","escaped","inValue","inBlockLiteral","inBlockLiteralIndentation","inlineContainers","stream","peek","wasEscaped","wasTrailingSpace","eatSpace","next","sol","skipToEnd","indentation","match","Dict","List","eol","keyIndent","result","parentContainer","list","formatReplacement","field","inList","replacement","postReplacementIndentation","listMarkerPresent","nextLineIndent","repeat","isCompOrList","buildSuggestion","display","description","text","render","el","div","innerText","substr","overflow","maxHeight","maxWidth","whiteSpace","isScalarUnionNewLine","map","searchWithoutQuotes","values","givenName","scalarType","scalarTypeKey","scalarSuggestions","nonScalarSuggestions","f","checkConfig","getDoc","yaml","lints","lintingTruncated","errors","forEach","source","lastMarkLocation","nextLineLocation","json","toJSON","validationResult","isValid","AUTO_COMPLETE_AFTER_KEY","performLint","debounce","CodeMirrorShimStyle","createGlobalStyle","FontFamily","monospace","CodeMirrorWhitespaceStyle","ConfigEditor","_editor","moveCursor","setCursor","scroll","getScrollInfo","cursorCoords","scrollIntoView","focus","moveCursorToPath","props","configCode","prevProps","runConfigSchema","performInitialPass","readOnly","showWhitespace","onHelpContextChange","flex","position","mode","theme","lineNumbers","indentUnit","smartIndent","showCursorWhenSelecting","completeSingle","closeOnUnfocus","keyMap","extraKeys","showHint","execCommand","Tab","undo","redo","foldGutter","editorDidMount","onBeforeChange","data","onConfigChange","onCursorActivity","getSelection","onBlur","onKeyUp","event","test","React","CONFIG_EDITOR_RUN_CONFIG_SCHEMA_FRAGMENT","gql","CONFIG_EDITOR_VALIDATION_FRAGMENT","errorStackToYamlPath","entries","entry","fieldName","listIndex","responseToYamlValidationResult","configJSON","response","err","stack","topLevelKey","Object","keys","isHelpContextEqual","prev","ConfigEditorHelp","allInnerTypes","Container","ConfigScrollWrap","ConfigTypeSchema","typesInScope","maxDepth","AutocompletionsNote","styled","Colors","LIGHT_GRAY1","ModeSelect","Select","ofType","ConfigEditorModePicker","resolvedMode","modeName","modes","m","onModeChange","singleMode","valid","modeError","disabled","activeItem","filterable","itemPredicate","query","includes","itemRenderer","Item","active","modifiers","onClick","handleClick","onItemSelect","icon","undefined","IconNames","ERROR","intent","Intent","NONE","DANGER","title","rightIcon","data-test-id","ExecutionTab","canRemove","onRemove","input","editing","setEditing","setValue","onDoubleClick","onClickRemove","stopPropagation","handleBlur","handleChange","current","select","TabContainer","ref","onKeyDown","currentTarget","blur","RemoveButton","Icon","ExecutionTabs","onCreate","onSave","sessions","sessionKeys","sessionCount","confirm","useConfirmation","onApply","mutator","args","keyToRemove","applyRemoveSession","ExecutionTabsContainer","applySelectSession","applyChangesToSession","GRAY5","WHITE","LIGHT_GRAY3","BLACK","DARK_GRAY3","LIGHT_GRAY5","button","LaunchRootExecutionButton","canLaunchPipelineExecution","usePermissions","useMutation","LAUNCH_PIPELINE_EXECUTION_MUTATION","launchPipelineExecution","basePath","AppContext","onLaunch","variables","getVariables","handleLaunchResult","pipelineName","showLaunchError","marginRight","LaunchButton","runCount","config","DISABLED_MESSAGE","isValidationError","stateToHint","invalid","missing","present","SUCCESS","none","PRIMARY","RemoveExtraConfigButton","onRemoveExtraPaths","extraNodes","knownKeyExtraPaths","otherPaths","parts","split","marginTop","small","v","ScaffoldConfigButton","onScaffoldMissingConfig","missingNodes","confirmationMessage","RunPreview","validation","onHighlightPath","solidSelection","errorsOnly","setErrorsOnly","flagPipelineModeTuples","useFeatureFlags","rootCompositeChildren","children","root","allConfigVersion","errorsAndPaths","pathKey","fieldNames","info","PythonErrorInfo","ButtonLink","showCustomAlert","resources","solids","rest","itemsIn","boxes","pathErrors","isPresent","pathExistsInObject","containsMissing","some","missingNode","isInvalid","isMissing","_","idx","isRequired","Position","BOTTOM","first","Boolean","ItemsEmptyNotice","SplitPanelContainer","identifier","axis","ErrorListContainer","Section","SectionTitle","onHighlight","firstInitialPercent","firstMinSize","second","overflowY","width","height","RuntimeAndResourcesSection","ItemSet","padding","background","label","checked","RUN_PREVIEW_VALIDATION_FRAGMENT","PYTHON_ERROR_FRAGMENT","GRAY3","ItemBorder","LIGHT_GRAY2","ItemBackground","RED5","LIGHT_GRAY4","ItemBackgroundHover","ItemColor","ErrorRowContainer","hoverable","ErrorRow","displayed","truncateErrorMessage","paddingRight","color","ColorsWIP","Red500","object","SolidSelectorModal","graphRef","pipelineOrError","queryResultSolids","errorMessage","SolidSelectorModalContainer","ModalErrorOverlay","PipelineGraph","backgroundColor","layout","getDagrePipelineLayout","interactor","SVGViewport","Interactors","None","focusSolids","highlightedSolids","SOLID_SELECTOR_QUERY","PIPELINE_GRAPH_SOLID_FRAGMENT","SolidSelector","serverProvidedSubsetError","repoAddress","pending","setPending","focused","setFocused","selector","repoAddressToSelector","useQuery","fetchPolicy","loading","filterByQuery","all","pipelineErrorMessage","console","invalidResult","autoFocus","isOpen","minimal","arrow","enabled","offset","ShortcutHandler","shortcutLabel","shortcutFilter","keyCode","altKey","GraphQueryInput","placeholder","applied","s","onCommitPendingValue","onFocus","isDefaultPrevented","RED3","scaffoldType","typeLookup","isSelector","String","Int","Bool","Any","assertUnreachable","scaffoldPipelineConfig","configSchema","log","createTypeLookup","YAML_SYNTAX_INVALID","reducer","action","previewLoading","payload","preview","previewedDocument","tagEditorOpen","configLoading","editorHelpContext","initialState","PREVIEW_CONFIG_QUERY","ExecutionSessionContainer","partitionSets","pipeline","pipelineMode","client","useApolloClient","dispatch","mounted","editorSplitPanelContainer","previewCounter","presets","initialDataForMode","presetsForMode","preset","partitionSetsForMode","results","partitionSet","runConfigYaml","base","partitionsSetName","partitionName","useStorage","currentSession","pipelineSelector","configResult","PIPELINE_EXECUTION_CONFIG_SCHEMA_QUERY","partialRefetch","configSchemaOrError","runConfigSchemaOrError","onSaveSession","changes","currentPreviewCount","runConfigData","isLatestRequest","isPipelineConfigValid","onSelectPreset","tagsDict","tags","reduce","kv","presetName","solidSelectionQuery","needsRefresh","onSelectPartition","repositorySelector","partitionSetName","sessionSolidSelection","onConfigLoading","CONFIG_PARTITION_SELECTION_QUERY","partitionSetOrError","onConfigLoaded","partition","tagsOrError","runConfigOrError","assign","onRefreshConfig","matchingPreset","openTagEditor","tagsFromDefinition","tagsFromSession","allTags","fromDefinition","fromSession","refreshableSessionBase","applyCreateSession","LoadingOverlay","isLoading","SessionSettingsBar","ConfigEditorConfigPicker","SessionSettingsSpacer","Box","margin","onShortcut","link","hover","underline","TagEditor","tagDict","toSave","tag","open","onRequestClose","marginLeft","container","onRequestEdit","vertical","horizontal","border","side","Group","direction","spacing","alignItems","Yellow500","paths","deletePropertyPath","obj","lastKey","pop","updatedRunConfigData","merge","zIndex","executionParams","executionMetadata","DagsterTag","SolidSelection","PresetName","RUN_CONFIG_SCHEMA_OR_ERROR_FRAGMENT"],"mappings":"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","file":"static/js/11.1f72402e.chunk.js","sourcesContent":["// Patched lint mode that won't constantly lint\nimport CodeMirror from 'codemirror';\n\nconst GUTTER_ID = 'CodeMirror-lint-markers';\n\nfunction showTooltip(e, content, node) {\n  const tt = document.createElement('div');\n  const nodeRect = node.getBoundingClientRect();\n\n  tt.className = 'CodeMirror-lint-tooltip';\n  tt.appendChild(content.cloneNode(true));\n  document.body.appendChild(tt);\n  if (nodeRect.top > tt.clientHeight) {\n    // position on the top\n    tt.style.top = nodeRect.top - tt.clientHeight - 5 + 'px';\n    tt.style.left = nodeRect.left + 5 + 'px';\n  } else {\n    // positon on the right if top would be off-screen\n    tt.style.top = nodeRect.top + 5 + 'px';\n    tt.style.left = nodeRect.right + 10 + 'px';\n  }\n  if (tt.style.opacity != null) {\n    tt.style.opacity = 1;\n  }\n  return tt;\n}\nfunction rm(elt) {\n  if (elt.parentNode) {\n    elt.parentNode.removeChild(elt);\n  }\n}\nfunction hideTooltip(tt) {\n  if (!tt.parentNode) {\n    return;\n  }\n  if (tt.style.opacity == null) {\n    rm(tt);\n  }\n  tt.style.opacity = 0;\n  setTimeout(function () {\n    rm(tt);\n  }, 600);\n}\n\nfunction showTooltipFor(e, content, node) {\n  let tooltip = showTooltip(e, content, node);\n  function hide() {\n    CodeMirror.off(node, 'mouseout', hide);\n    if (tooltip) {\n      hideTooltip(tooltip);\n      tooltip = null;\n    }\n  }\n  const poll = setInterval(function () {\n    if (tooltip) {\n      for (let n = node; ; n = n.parentNode) {\n        if (n && n.nodeType === 11) {\n          n = n.host;\n        }\n        if (n === document.body) {\n          return;\n        }\n        if (!n) {\n          hide();\n          break;\n        }\n      }\n    }\n    if (!tooltip) {\n      return clearInterval(poll);\n    }\n  }, 400);\n  CodeMirror.on(node, 'mouseout', hide);\n}\n\nfunction parseOptions(_cm, options) {\n  if (options instanceof Function) {\n    return {getAnnotations: options};\n  }\n  if (!options || options === true) {\n    options = {};\n  }\n  return options;\n}\n\nfunction clearMarks(cm) {\n  const state = cm.state.lint;\n  if (state.hasGutter) {\n    cm.clearGutter(GUTTER_ID);\n  }\n  for (let i = 0; i < state.marked.length; ++i) {\n    state.marked[i].clear();\n  }\n  state.marked.length = 0;\n}\n\nfunction makeMarker(labels, severity, multiple, tooltips) {\n  const marker = document.createElement('div');\n  let inner = marker;\n  marker.className = 'CodeMirror-lint-marker CodeMirror-lint-marker-' + severity;\n  if (multiple) {\n    inner = marker.appendChild(document.createElement('div'));\n    inner.className = 'CodeMirror-lint-marker CodeMirror-lint-marker-multiple';\n  }\n\n  if (tooltips !== false) {\n    CodeMirror.on(inner, 'mouseover', function (e) {\n      showTooltipFor(e, labels, inner);\n    });\n  }\n  return marker;\n}\n\nfunction getMaxSeverity(a, b) {\n  if (a === 'error') {\n    return a;\n  } else {\n    return b;\n  }\n}\n\nfunction groupByLine(annotations) {\n  const lines = [];\n  for (let i = 0; i < annotations.length; ++i) {\n    const ann = annotations[i],\n      line = ann.from.line;\n    (lines[line] || (lines[line] = [])).push(ann);\n  }\n  return lines;\n}\n\nfunction annotationTooltip(ann) {\n  let severity = ann.severity;\n  if (!severity) {\n    severity = 'error';\n  }\n  const tip = document.createElement('div');\n  tip.className = 'CodeMirror-lint-message CodeMirror-lint-message-' + severity;\n  if (typeof ann.messageHTML !== 'undefined') {\n    tip.innerHTML = ann.messageHTML;\n  } else {\n    tip.appendChild(document.createTextNode(ann.message));\n  }\n  return tip;\n}\n\nfunction updateLinting(cm, annotationsNotSorted) {\n  clearMarks(cm);\n  const state = cm.state.lint,\n    options = state.options;\n\n  const annotations = groupByLine(annotationsNotSorted);\n\n  for (let line = 0; line < annotations.length; ++line) {\n    const anns = annotations[line];\n    if (!anns) {\n      continue;\n    }\n\n    let maxSeverity = null;\n    const tipLabel = state.hasGutter && document.createDocumentFragment();\n\n    for (let i = 0; i < anns.length; ++i) {\n      let ann = anns[i];\n      let severity = ann.severity;\n      if (!severity) {\n        severity = 'error';\n      }\n      maxSeverity = getMaxSeverity(maxSeverity, severity);\n\n      if (options.formatAnnotation) {\n        ann = options.formatAnnotation(ann);\n      }\n      if (state.hasGutter) {\n        tipLabel.appendChild(annotationTooltip(ann));\n      }\n\n      if (ann.to) {\n        state.marked.push(\n          cm.markText(ann.from, ann.to, {\n            className: 'CodeMirror-lint-mark CodeMirror-lint-mark-' + severity,\n            __annotation: ann,\n          }),\n        );\n      }\n    }\n\n    if (state.hasGutter) {\n      cm.setGutterMarker(\n        line,\n        GUTTER_ID,\n        makeMarker(tipLabel, maxSeverity, anns.length > 1, state.options.tooltips),\n      );\n    }\n  }\n  if (options.onUpdateLinting) {\n    options.onUpdateLinting(annotationsNotSorted, annotations, cm);\n  }\n}\n\nfunction lintAsync(cm, getAnnotations, passOptions) {\n  const state = cm.state.lint;\n  let id = ++state.waitingFor;\n  function abort() {\n    id = -1;\n    cm.off('change', abort);\n  }\n  cm.on('change', abort);\n  getAnnotations(\n    cm.getValue(),\n    function (annotations, arg2) {\n      cm.off('change', abort);\n      if (state.waitingFor !== id) {\n        return;\n      }\n      if (arg2 && annotations instanceof CodeMirror) {\n        annotations = arg2;\n      }\n      cm.operation(function () {\n        updateLinting(cm, annotations);\n      });\n    },\n    passOptions,\n    cm,\n  );\n}\n\nfunction startLinting(cm) {\n  const state = cm.state.lint,\n    options = state.options;\n  /*\n   * Passing rules in `options` property prevents JSHint (and other linters) from complaining\n   * about unrecognized rules like `onUpdateLinting`, `delay`, `lintOnChange`, etc.\n   */\n  const passOptions = options.options || options;\n  const getAnnotations = options.getAnnotations || cm.getHelper(CodeMirror.Pos(0, 0), 'lint');\n  if (!getAnnotations) {\n    return;\n  }\n  if (options.async || getAnnotations.async) {\n    lintAsync(cm, getAnnotations, passOptions);\n  } else {\n    const annotations = getAnnotations(cm.getValue(), passOptions, cm);\n    if (!annotations) {\n      return;\n    }\n    if (annotations.then) {\n      annotations.then(function (issues) {\n        cm.operation(function () {\n          updateLinting(cm, issues);\n        });\n      });\n    } else {\n      cm.operation(function () {\n        updateLinting(cm, annotations);\n      });\n    }\n  }\n}\n\nfunction onChange(cm) {\n  const state = cm.state.lint;\n  if (!state) {\n    return;\n  }\n  clearTimeout(state.timeout);\n  state.timeout = setTimeout(function () {\n    startLinting(cm);\n  }, state.options.delay || 500);\n}\n\nfunction popupTooltip(docs, annotations, e) {\n  const target = e.target || e.srcElement;\n\n  const tooltip = document.createDocumentFragment();\n\n  if (docs) {\n    const docsEl = document.createElement('div');\n    docsEl.textContent = docs;\n    tooltip.appendChild(docsEl);\n    if (annotations.length) {\n      docsEl.style.paddingBottom = '4px';\n      docsEl.style.marginBottom = '4px';\n      docsEl.style.borderBottom = '1px solid rgba(0,0,0,0.25)';\n    }\n  }\n\n  for (let i = 0; i < annotations.length; i++) {\n    const ann = annotations[i];\n    tooltip.appendChild(annotationTooltip(ann));\n  }\n  showTooltipFor(e, tooltip, target);\n}\n\nfunction onMouseOver(cm, e) {\n  const target = e.target || e.srcElement;\n  const box = target.getBoundingClientRect(),\n    x = (box.left + box.right) / 2,\n    y = (box.top + box.bottom) / 2;\n  const pos = cm.coordsChar({left: x, top: y}, 'client');\n  const spans = cm.findMarksAt(pos);\n\n  const getDocs = cm.getHelper(CodeMirror.Pos(0, 0), 'dagster-docs');\n  const docs = getDocs(cm, pos);\n\n  const annotations = [];\n  for (let i = 0; i < spans.length; ++i) {\n    const ann = spans[i].__annotation;\n    if (ann) {\n      annotations.push(ann);\n    }\n  }\n\n  if (docs || annotations.length) {\n    popupTooltip(docs, annotations, e);\n  }\n}\n\nfunction LintState(cm, options, hasGutter) {\n  this.marked = [];\n  this.options = options;\n  this.timeout = null;\n  this.hasGutter = hasGutter;\n  this.onMouseOver = function (e) {\n    onMouseOver(cm, e);\n  };\n  this.waitingFor = 0;\n}\n\nCodeMirror.defineOption('lint', false, function (cm, val, old) {\n  if (old && old !== CodeMirror.Init) {\n    clearMarks(cm);\n    if (cm.state.lint.options.lintOnChange !== false) {\n      cm.off('change', onChange);\n    }\n    CodeMirror.off(cm.getWrapperElement(), 'mouseover', cm.state.lint.onMouseOver);\n    clearTimeout(cm.state.lint.timeout);\n    delete cm.state.lint;\n  }\n\n  if (val) {\n    const gutters = cm.getOption('gutters');\n    let hasLintGutter = false;\n    for (let i = 0; i < gutters.length; ++i) {\n      if (gutters[i] === GUTTER_ID) {\n        hasLintGutter = true;\n      }\n    }\n    const state = (cm.state.lint = new LintState(cm, parseOptions(cm, val), hasLintGutter));\n    if (state.options.lintOnChange !== false) {\n      cm.on('change', onChange);\n    }\n    if (state.options.tooltips !== false && state.options.tooltips !== 'gutter') {\n      CodeMirror.on(cm.getWrapperElement(), 'mouseover', state.onMouseOver);\n    }\n  }\n});\n\nCodeMirror.defineExtension('performLint', function () {\n  if (this.state.lint) {\n    startLinting(this);\n  }\n});\n","import * as CodeMirror from 'codemirror';\nimport 'codemirror/addon/hint/show-hint';\nimport 'codemirror/addon/search/search';\nimport 'codemirror/addon/search/searchcursor';\nimport 'codemirror/addon/dialog/dialog';\nimport 'codemirror/addon/dialog/dialog.css';\nimport * as yaml from 'yaml';\n\nimport {ConfigEditorRunConfigSchemaFragment} from '../types/ConfigEditorRunConfigSchemaFragment';\n\n// Example YAML for testing this parser:\n// https://gist.github.com/bengotow/0b700e7d0367750cb31eaf697f865d70\n\ninterface IParseStateParent {\n  key: string;\n  indent: number;\n  childKeys: string[];\n}\n\nenum ContainerType {\n  Dict = 'dict',\n  List = 'list',\n}\n\ninterface IParseState {\n  trailingSpace: boolean;\n  inlineContainers: ContainerType[];\n  escaped: boolean;\n  inValue: boolean;\n  inBlockLiteral: boolean;\n  inBlockLiteralIndentation: number;\n  parents: IParseStateParent[];\n}\n\n// Helper methods that mutate parser state. These must return new JavaScript objects.\n//\nfunction parentsPoppingItemsDeeperThan(parents: IParseStateParent[], indent: number) {\n  while (parents.length > 0 && parents[parents.length - 1].indent >= indent) {\n    parents = parents.slice(0, parents.length - 1);\n  }\n  return parents;\n}\n\nfunction parentsAddingChildKeyToLast(parents: IParseStateParent[], key: string) {\n  if (parents.length === 0) {\n    return [];\n  }\n\n  const immediateParent = parents[parents.length - 1];\n  return [\n    ...parents.slice(0, parents.length - 1),\n    {\n      key: immediateParent.key,\n      indent: immediateParent.indent,\n      childKeys: [...immediateParent.childKeys, key],\n    },\n  ];\n}\n\nfunction parentsAddingChildKeyAtIndent(parents: IParseStateParent[], key: string, indent: number) {\n  parents = parentsPoppingItemsDeeperThan(parents, indent);\n  parents = parentsAddingChildKeyToLast(parents, key);\n  parents = [...parents, {key, indent: indent, childKeys: []}];\n  return parents;\n}\n\nconst Constants = ['true', 'false', 'on', 'off', 'yes', 'no'];\n\nexport const RegExps = {\n  KEYWORD: new RegExp('\\\\b((' + Constants.join(')|(') + '))$', 'i'),\n  DICT_COLON: /^:\\s*/,\n  // eslint-disable-next-line no-useless-escape\n  DICT_KEY: /^\\s*(?:[,\\[\\]{}&*!|>'\"%@`][^\\s'\":]|[^,\\[\\]{}#&*!|>'\"%@`])[^# ,]*?(?=\\s*:)/,\n  // eslint-disable-next-line no-useless-escape\n  QUOTED_STRING: /^('([^']|\\\\.)*'?|\"([^\"\\\\]|\\\\.)*\"?)/,\n  // eslint-disable-next-line no-useless-escape\n  BLOCKSTART_PIPE_OR_ARROW: /^\\s*(\\||\\>)\\s*/,\n  // eslint-disable-next-line no-useless-escape\n  NUMBER: /^\\s*-?[0-9\\.]+(?![0-9\\.]+)$/,\n  // eslint-disable-next-line no-useless-escape\n  VARIABLE: /^\\s*(\\&|\\*)[a-z0-9\\._-]+$/i,\n};\n\nCodeMirror.defineMode('yaml', () => {\n  return {\n    lineComment: '#',\n    fold: 'indent',\n    startState: (): IParseState => {\n      return {\n        trailingSpace: false,\n        escaped: false,\n        inValue: false,\n        inBlockLiteral: false,\n        inBlockLiteralIndentation: 0,\n        inlineContainers: [],\n        parents: [],\n      };\n    },\n    token: (stream, state: IParseState) => {\n      const ch = stream.peek();\n\n      // reset escape, indent and trailing\n      const wasEscaped = state.escaped;\n      const wasTrailingSpace = state.trailingSpace;\n      state.escaped = false;\n      state.trailingSpace = false;\n\n      // whitespace\n      const trailingSpace = stream.eatSpace();\n      if (trailingSpace) {\n        state.trailingSpace = true;\n        return 'whitespace';\n      }\n      // escape\n      if (ch === '\\\\') {\n        state.escaped = true;\n        stream.next();\n        return null;\n      }\n\n      // comments\n      // either beginning of the line or had whitespace before\n      if (ch === '#' && (stream.sol() || wasTrailingSpace)) {\n        stream.skipToEnd();\n        return 'comment';\n      }\n\n      if (state.inBlockLiteral) {\n        // continuation of a literal string that was started on a previous line\n        if (stream.indentation() > state.inBlockLiteralIndentation) {\n          stream.skipToEnd();\n          return 'string';\n        }\n        state.inBlockLiteralIndentation = 0;\n        state.inBlockLiteral = false;\n      }\n\n      // array list item, value to follow\n      if (stream.match(/-/)) {\n        state.inValue = true;\n        return 'meta';\n      }\n\n      // doc start / end\n      if (stream.sol()) {\n        state.inValue = false;\n        state.parents = [];\n\n        if (stream.match(/---/) || stream.match(/\\.\\.\\./)) {\n          return 'def';\n        }\n      }\n\n      // Handle inline objects and arrays. These can be nested arbitrarily but we\n      // don't currently support them spanning multiple lines.\n      if (stream.match(/^(\\{|\\}|\\[|\\])/)) {\n        if (ch === '{') {\n          state.inlineContainers = [...state.inlineContainers, ContainerType.Dict];\n          state.inValue = false;\n        } else if (ch === '}') {\n          state.inlineContainers = state.inlineContainers.slice(\n            0,\n            state.inlineContainers.length - 1,\n          );\n          state.parents = state.parents.slice(0, state.parents.length - 1);\n          state.inValue = state.inlineContainers.length > 0;\n        } else if (ch === '[') {\n          state.inlineContainers = [...state.inlineContainers, ContainerType.List];\n          state.inValue = true;\n        } else if (ch === ']') {\n          state.inlineContainers = state.inlineContainers.slice(\n            0,\n            state.inlineContainers.length - 1,\n          );\n          state.inValue = state.inlineContainers.length > 0;\n        }\n        state.trailingSpace = false;\n        return 'meta';\n      }\n\n      // Handle inline separators. For dictionaries, we pop from value parsing state back to\n      // key parsing state after a comma and unwind the parent stack.\n      if (state.inlineContainers && !wasEscaped && ch === ',') {\n        const current = state.inlineContainers[state.inlineContainers.length - 1];\n        if (current === ContainerType.Dict) {\n          state.parents = state.parents.slice(0, state.parents.length - 1);\n          state.inValue = false;\n        }\n        stream.next();\n        return 'meta';\n      }\n\n      // A `:` fragment starts value parsing mode if it is not the last character on the line\n      if (stream.match(RegExps.DICT_COLON)) {\n        state.inValue = !stream.eol();\n        return 'meta';\n      }\n\n      // Handle dict key fragments. May be the first element on a line or nested within an inline\n      // (eg: {a: 1, b: 2}). We add the new key to the current `parent` and push a new parent\n      // in case the dict key has subkeys.\n      if (!state.inValue) {\n        const match = stream.match(RegExps.DICT_KEY);\n        if (match) {\n          const key = match[0];\n          const keyIndent = stream.pos - key.length;\n          state.parents = parentsAddingChildKeyAtIndent(state.parents, key, keyIndent);\n          return 'atom';\n        }\n      }\n\n      if (state.inValue) {\n        let result = null;\n\n        // Child dicts can start within a value if the user is creating a list, but we don't want to\n        // clasifiy \"my\" as a sub-dict in \"- my:weird:key\". As a balance we require that the colon\n        // be followed by the end-of-line or whitespace.\n        const match = !stream.string.match(/[^\\s]:[^\\s]/) ? stream.match(RegExps.DICT_KEY) : false;\n        if (match) {\n          const key = match[0];\n          const keyIndent = stream.pos - key.length;\n          state.inValue = false;\n          state.parents = parentsAddingChildKeyAtIndent(state.parents, key, keyIndent);\n          result = 'atom';\n        }\n\n        if (stream.match(RegExps.BLOCKSTART_PIPE_OR_ARROW)) {\n          state.inBlockLiteralIndentation = stream.indentation();\n          state.inBlockLiteral = true;\n          result = 'meta';\n        }\n\n        if (!result) {\n          // First, read any value that is a quoted string until we reach the end quote.\n          let match = stream.match(RegExps.QUOTED_STRING);\n          if (!match) {\n            // If the value is not a string in quotes, read until a separator (,) or container closing character,\n            // then we'll decide what to do with it.\n            const parentContainer = state.inlineContainers[state.inlineContainers.length - 1];\n            match =\n              parentContainer === ContainerType.List\n                ? stream.match(/^[^,\\]]+/)\n                : parentContainer === ContainerType.Dict\n                ? stream.match(/^[^,\\}]+/)\n                : stream.match(/^.+$/);\n          }\n          const value = match ? match[0] : '';\n          if (value.match(RegExps.VARIABLE)) {\n            result = 'variable-2';\n          } else if (value.match(RegExps.NUMBER)) {\n            result = 'number';\n          } else if (value.match(RegExps.KEYWORD)) {\n            result = 'keyword';\n          } else {\n            // \"In YAML, you can write a string without quotes, if it doesn't have a special meaning.\",\n            // so if we can't match the content to any other type and we are inValue, we make it a string.\n            // http://blogs.perl.org/users/tinita/2018/03/strings-in-yaml---to-quote-or-not-to-quote.html\n            result = 'string';\n          }\n        }\n\n        // If after consuming the value and trailing spaces we're at the end of the\n        // line, terminate the value and look for another key on the following line.\n        if (stream.eol() && !state.inBlockLiteral) {\n          state.inValue = false;\n        }\n\n        return result;\n      }\n\n      stream.skipToEnd();\n\n      return null;\n    },\n  };\n});\n\n// TODO\n// Uniquity of keys\n// add colon\n// add colon and return for composites\n\ntype CodemirrorLocation = {\n  line: number;\n  ch: number;\n};\n\ntype CodemirrorHint = {\n  render: (el: Element, self: any, data: any) => void;\n  text: string;\n  from: CodemirrorLocation;\n  to: CodemirrorLocation;\n};\n\ntype CodemirrorToken = CodeMirror.Token & {\n  state: IParseState;\n};\n\nCodeMirror.registerHelper(\n  'hint',\n  'yaml',\n  (\n    editor: any,\n    options: {\n      schema?: ConfigEditorRunConfigSchemaFragment;\n    },\n  ): {list: Array<CodemirrorHint>} => {\n    if (!options.schema) {\n      return {list: []};\n    }\n\n    const {\n      cursor,\n      context,\n      token,\n      start,\n      searchString,\n      prevToken,\n    } = expandAutocompletionContextAtCursor(editor);\n    if (!context) {\n      return {list: []};\n    }\n\n    // Since writing meaningful tests for this functionality is difficult given a) no jsdom\n    // support for APIs that codemirror uses (and so no way to use snapshot tests) and b) no\n    // appetite (yet) for writing Selenium tests, we record here the manual tests used to verify\n    // this logic. In what follows, | represents the position of the cursor and -> the transition\n    // on accepting an autocomplete suggestion for `storage: filesystem:\n\n    // st|\n    // ->\n    // storage:\n    //   |\n\n    // storage:|\n    // ->\n    // storage:\n    //   filesystem:\n    //     |\n\n    // storage: |\n    // ->\n    // storage:\n    //   filesystem:\n    //     |\n\n    // storage:  |\n    // ->\n    // storage:\n    //   filesystem:\n    //     |\n\n    // storage:\n    //   |\n    // ->\n    // storage:\n    //   filesystem:\n    //     |\n\n    const isCompOrList = (key: string): boolean => {\n      if (!options.schema) {\n        return false;\n      }\n      // Using a lookup table here seems like a good idea\n      // https://github.com/dagster-io/dagster/issues/1966\n      const type = options.schema.allConfigTypes.find((t) => t.key === key);\n      if (!type) {\n        return false;\n      }\n      return type.__typename === 'ArrayConfigType' || type.__typename === 'CompositeConfigType';\n    };\n\n    const formatReplacement = (\n      field: any,\n      start: any,\n      token: CodemirrorToken,\n      prevToken: CodemirrorToken,\n      inList: boolean,\n    ) => {\n      let replacement = `${field.name}`;\n      let postReplacementIndentation = start;\n\n      const listMarkerPresent = prevToken.string === ' ' || prevToken.string === '-';\n      if (inList && !listMarkerPresent) {\n        replacement = `- ${replacement}`;\n        postReplacementIndentation += 2;\n      }\n\n      const cursorAtColon = token.string.startsWith(':');\n      if (cursorAtColon) {\n        const nextLineIndent = prevToken.start + 2;\n        replacement = `\\n${' '.repeat(nextLineIndent)}${replacement}`;\n        postReplacementIndentation = nextLineIndent;\n      }\n\n      const completionHasChildren = isCompOrList(field.configTypeKey);\n      if (completionHasChildren) {\n        replacement += `:\\n${' '.repeat(postReplacementIndentation + 2)}`;\n      } else {\n        replacement += ': ';\n      }\n\n      return replacement;\n    };\n\n    const buildSuggestion = (\n      display: string,\n      replacement: string,\n      description: string | null,\n    ): CodemirrorHint => ({\n      text: replacement,\n      render: (el) => {\n        const div = document.createElement('div');\n        div.textContent = display;\n        if (description) {\n          const docs = document.createElement('div');\n          docs.innerText =\n            description.length < 90 ? description : description.substr(0, 87) + '...';\n          docs.style.opacity = '0.5';\n          docs.style.overflow = 'hidden';\n          docs.style.maxHeight = '33px';\n          docs.style.maxWidth = '360px';\n          docs.style.whiteSpace = 'normal';\n          div.appendChild(docs);\n        }\n        el.appendChild(div);\n      },\n      from: {line: cursor.line, ch: start},\n      to: {line: cursor.line, ch: token.end},\n    });\n\n    // Calculate if this is on a new-line child of a scalar union type, as an indication that we\n    // should autocomplete the selector fields of the scalar union\n    const isScalarUnionNewLine =\n      context.type.__typename === 'ScalarUnionConfigType' && !prevToken.end;\n\n    // The context will have available fields if the type is a composite config type OR a scalar\n    // union type\n    if (\n      context.availableFields.length &&\n      (context.type.__typename === 'CompositeConfigType' || isScalarUnionNewLine)\n    ) {\n      return {\n        list: context.availableFields\n          .filter((field) => field.name.startsWith(searchString))\n          .map((field) =>\n            buildSuggestion(\n              field.name,\n              formatReplacement(field, start, token, prevToken, context.inArray),\n              field.description,\n            ),\n          ),\n      };\n    }\n\n    // Completion of enum field values\n    if (context.type.__typename === 'EnumConfigType') {\n      const searchWithoutQuotes = searchString.startsWith('\"')\n        ? searchString.substr(1)\n        : searchString;\n      return {\n        list: context.type.values\n          .filter((val) => val.value.startsWith(searchWithoutQuotes))\n          .map((val) => buildSuggestion(val.value, `\"${val.value}\"`, null)),\n      };\n    }\n\n    // Completion of boolean field values\n    if (context.type.__typename === 'RegularConfigType' && context.type.givenName === 'Bool') {\n      return {\n        list: ['True', 'False']\n          .filter((val) => val.startsWith(searchString))\n          .map((val) => buildSuggestion(val, val, null)),\n      };\n    }\n\n    // Completion of Scalar Union field values, the union of the scalar suggestions and the\n    // non-scalar suggestions\n    const type = context.type;\n    if (type.__typename === 'ScalarUnionConfigType') {\n      const scalarType = options.schema.allConfigTypes.find((x) => x.key === type.scalarTypeKey);\n      const nonScalarType = options.schema.allConfigTypes.find(\n        (x) => x.key === type.nonScalarTypeKey,\n      );\n      let scalarSuggestions: CodemirrorHint[] = [];\n      if (\n        scalarType &&\n        scalarType.__typename === 'RegularConfigType' &&\n        scalarType.givenName === 'Bool'\n      ) {\n        scalarSuggestions = ['True', 'False']\n          .filter((val) => val.startsWith(searchString))\n          .map((val) => buildSuggestion(val, val, null));\n      }\n      let nonScalarSuggestions: CodemirrorHint[] = [];\n      if (nonScalarType && nonScalarType.__typename === 'CompositeConfigType') {\n        nonScalarSuggestions = nonScalarType.fields\n          .filter((field) => field.name.startsWith(searchString))\n          .map((field) =>\n            buildSuggestion(\n              field.name,\n              formatReplacement(field, start, token, prevToken, false),\n              field.description,\n            ),\n          );\n      }\n\n      return {list: [...scalarSuggestions, ...nonScalarSuggestions]};\n    }\n\n    return {list: []};\n  },\n);\n\n/** Takes the pipeline schema and the YAML tokenizer state and returns the\n * type in scope and available (yet-to-be-used) fields\n * if it is a composite type.\n */\nfunction findAutocompletionContext(\n  schema: ConfigEditorRunConfigSchemaFragment | null,\n  parents: IParseStateParent[],\n  currentIndent: number,\n) {\n  parents = parents.filter(({indent}) => currentIndent > indent);\n  const immediateParent = parents[parents.length - 1];\n\n  if (!schema) {\n    // Schema may still be loading\n    return;\n  }\n\n  let type = schema.allConfigTypes.find((t) => t.key === schema.rootConfigType.key);\n  if (!type || type.__typename !== 'CompositeConfigType') {\n    return null;\n  }\n\n  let available = type.fields;\n  let closestCompositeType = type;\n  let inArray = false;\n\n  if (available && parents.length > 0) {\n    for (const parent of parents) {\n      const parentTypeDef = available.find(({name}) => parent.key === name);\n      if (!parentTypeDef) {\n        return null;\n      }\n\n      // The current composite type's available \"fields\" each only have a configType key.\n      // The rest of the configType's information is in the top level schema.allConfigTypes\n      // to avoid superlinear GraphQL response size.\n      const parentConfigType = schema.allConfigTypes.find(\n        (t) => t.key === parentTypeDef.configTypeKey,\n      )!;\n      let childTypeKey = parentConfigType.key;\n      let childEntriesUnique = true;\n\n      inArray = parentConfigType.__typename === 'ArrayConfigType';\n      if (inArray) {\n        childTypeKey = parentConfigType.typeParamKeys[0];\n        childEntriesUnique = false;\n      }\n\n      type = schema.allConfigTypes.find((t) => t.key === childTypeKey);\n      if (!type) {\n        return null;\n      }\n\n      if (type.__typename === 'ScalarUnionConfigType') {\n        available = [];\n        const nonScalarTypeKey = type.nonScalarTypeKey;\n        const nonScalarType = schema.allConfigTypes.find((x) => x.key === nonScalarTypeKey);\n        if (nonScalarType && nonScalarType.__typename === 'CompositeConfigType') {\n          available = nonScalarType.fields;\n        }\n      } else if (type.__typename === 'CompositeConfigType') {\n        closestCompositeType = type;\n        available = type.fields;\n\n        if (parent === immediateParent && childEntriesUnique) {\n          available = available.filter(\n            (item) => immediateParent.childKeys.indexOf(item.name) === -1,\n          );\n        }\n      } else {\n        available = [];\n      }\n    }\n  }\n\n  return {type, closestCompositeType, availableFields: available, inArray};\n}\n\n// Find context for a fully- or partially- typed key or value in the YAML document\nexport function expandAutocompletionContextAtCursor(editor: any) {\n  const schema: ConfigEditorRunConfigSchemaFragment = editor.options.hintOptions.schema;\n\n  const cursor = editor.getCursor();\n  const token: CodemirrorToken = editor.getTokenAt(cursor);\n  const prevToken: CodemirrorToken = editor.getTokenAt({\n    line: cursor.line,\n    ch: token.start,\n  });\n\n  let searchString: string;\n  let start: number;\n  if (token.type === 'whitespace' || token.string.startsWith(':')) {\n    searchString = '';\n    start = token.end;\n  } else {\n    searchString = token.string;\n    start = token.start;\n  }\n\n  // Takes the schema and the YAML tokenizer state and returns the\n  // type in scope and available (yet-to-be-used) fields\n  // if it is a composite type.\n  return {\n    start,\n    cursor,\n    searchString,\n    token,\n    prevToken,\n    context: findAutocompletionContext(schema, token.state.parents, start),\n  };\n}\n\ntype CodemirrorLintError = {\n  message: string;\n  severity: 'error' | 'warning' | 'information' | 'hint';\n  type: 'validation' | 'syntax' | 'deprecation';\n  from: CodemirrorLocation;\n  to: CodemirrorLocation;\n};\n\nexport type YamlModeValidationResult =\n  | {\n      isValid: true;\n    }\n  | {\n      isValid: false;\n      errors: YamlModeValidationError[];\n    };\n\nexport type YamlModeValidateFunction = (\n  configJSON: Record<string, unknown>,\n) => Promise<YamlModeValidationResult>;\n\nexport type YamlModeValidationError = {\n  message: string;\n  path: string[];\n  reason: string;\n};\n\nCodeMirror.registerHelper('dagster-docs', 'yaml', (editor: any, pos: CodeMirror.Position) => {\n  const token = editor.getTokenAt(pos);\n\n  const schema: ConfigEditorRunConfigSchemaFragment = editor.options.hintOptions.schema;\n\n  if (token.type !== 'atom') {\n    return null;\n  }\n\n  const context = findAutocompletionContext(schema, token.state.parents, token.start);\n  const match =\n    context &&\n    context.type.__typename === 'CompositeConfigType' &&\n    context.type.fields.find((f) => f.name === token.string);\n\n  if (match && match.description) {\n    return match.description;\n  }\n\n  return null;\n});\n\nCodeMirror.registerHelper(\n  'lint',\n  'yaml',\n  async (\n    text: string,\n    {checkConfig}: {checkConfig: YamlModeValidateFunction},\n    editor: any,\n  ): Promise<Array<CodemirrorLintError>> => {\n    const codeMirrorDoc = editor.getDoc();\n\n    // TODO: In some scenarios where every line yields an error `parseDocument` can take 1s+\n    // and returns 20,000+ errors. The library does not have a \"bail out\" option but we need one.\n    // However we can't switch libraries because we need the structured document model this returns.\n    // (It's not just text parsed to plain JS objects.)\n    const yamlDoc = yaml.parseDocument(text);\n    const lints: Array<CodemirrorLintError> = [];\n    const lintingTruncated = yamlDoc.errors.length > 10;\n    let lastMarkLocation: CodeMirror.Position | undefined;\n\n    yamlDoc.errors.slice(0, 10).forEach((error) => {\n      const from = codeMirrorDoc.posFromIndex(\n        error.source?.range ? error.source.range.start : 0,\n      ) as CodeMirror.Position;\n      const to = codeMirrorDoc.posFromIndex(\n        error.source?.range ? error.source.range.end : Number.MAX_SAFE_INTEGER,\n      ) as CodeMirror.Position;\n\n      if (!lastMarkLocation || lastMarkLocation.line < from.line) {\n        lastMarkLocation = from;\n      }\n\n      lints.push({\n        message: error.message,\n        severity: 'error',\n        type: 'syntax',\n        from,\n        to,\n      });\n    });\n\n    if (lintingTruncated && lastMarkLocation) {\n      const nextLineLocation: CodeMirror.Position = {\n        line: lastMarkLocation.line + 1,\n        ch: 0,\n      };\n      lints.push({\n        message: `${yamlDoc.errors.length - lints.length} more errors - bailed out.`,\n        severity: 'warning',\n        type: 'syntax',\n        from: nextLineLocation,\n        to: nextLineLocation,\n      });\n    }\n\n    if (yamlDoc.errors.length === 0) {\n      const json = yamlDoc.toJSON() || {};\n      const validationResult = await checkConfig(json);\n      if (!validationResult.isValid) {\n        validationResult.errors.forEach((error) => {\n          const lint = validationErrorToCodemirrorError(error, yamlDoc, codeMirrorDoc);\n          if (lint) {\n            lints.push(lint);\n          }\n        });\n      }\n    }\n\n    return lints;\n  },\n);\n\nexport function validationErrorToCodemirrorError(\n  error: YamlModeValidationError,\n  yamlDoc: yaml.Document,\n  codeMirrorDoc: any,\n): CodemirrorLintError | null {\n  const part = error.reason === 'RUNTIME_TYPE_MISMATCH' ? 'value' : 'key';\n  const range = findRangeInDocumentFromPath(yamlDoc, error.path, part);\n  if (range === null) {\n    return null;\n  }\n  return {\n    message: error.message,\n    severity: 'error',\n    type: 'syntax',\n    from: codeMirrorDoc.posFromIndex(range ? range.start : 0) as CodeMirror.Position,\n    to: codeMirrorDoc.posFromIndex(\n      range ? range.end : Number.MAX_SAFE_INTEGER,\n    ) as CodeMirror.Position,\n  };\n}\n\nexport function findRangeInDocumentFromPath(\n  doc: yaml.Document,\n  path: Array<string>,\n  pathPart: 'key' | 'value',\n): {start: number; end: number} | null {\n  let node = nodeAtPath(doc, path);\n  if (!node || !('type' in node)) {\n    return null;\n  }\n\n  if (node.type === 'PAIR') {\n    if (pathPart === 'value' && node.value) {\n      node = node.value;\n    } else {\n      node = node.key;\n    }\n  }\n\n  if (node && node.range) {\n    return {\n      start: node.range[0],\n      end: node.range[1],\n    };\n  } else {\n    return null;\n  }\n}\n\nfunction nodeAtPath(doc: yaml.Document, path: Array<string>) {\n  let node: any = doc.contents;\n  for (let i = 0; i < path.length; i++) {\n    const part = path[i];\n    if (node && node.type && node.type === 'PAIR') {\n      node = node.value;\n    }\n\n    if (node && node.type && (node.type === 'SEQ' || node.type === 'FLOW_SEQ')) {\n      const index = Number.parseInt(part);\n      if (!Number.isNaN(index)) {\n        node = node.items[index];\n      } else {\n        return null;\n      }\n    } else if (node && node.type && (node.type === 'FLOW_MAP' || node.type === 'MAP')) {\n      const item = node.items.find(({key}: {key: any}) => key.value === part);\n      if (item && item.type && item.type === 'PAIR') {\n        node = item;\n      } else {\n        return null;\n      }\n    } else {\n      return null;\n    }\n  }\n\n  return node;\n}\n","import 'codemirror/addon/comment/comment';\nimport 'codemirror/addon/dialog/dialog';\nimport 'codemirror/addon/fold/foldgutter';\nimport 'codemirror/addon/fold/foldgutter.css';\nimport 'codemirror/addon/fold/indent-fold';\nimport 'codemirror/addon/hint/show-hint';\nimport 'codemirror/addon/hint/show-hint.css';\nimport 'codemirror/addon/lint/lint.css';\nimport 'codemirror/addon/search/jump-to-line';\nimport 'codemirror/addon/search/search';\nimport 'codemirror/addon/search/searchcursor';\nimport 'codemirror/keymap/sublime';\nimport 'codemirror/lib/codemirror.css';\nimport './codemirror-yaml/lint'; // Patch lint\nimport './codemirror-yaml/mode'; // eslint-disable-line import/no-duplicates\n\nimport {Editor} from 'codemirror';\nimport debounce from 'lodash/debounce';\nimport * as React from 'react';\nimport {Controlled as CodeMirrorReact} from 'react-codemirror2';\nimport {createGlobalStyle} from 'styled-components/macro';\nimport * as yaml from 'yaml';\n\nimport {FontFamily} from '../ui/styles';\n\nimport {ConfigEditorHelpContext} from './ConfigEditorHelpContext';\nimport {\n  YamlModeValidateFunction,\n  expandAutocompletionContextAtCursor,\n  findRangeInDocumentFromPath,\n} from './codemirror-yaml/mode'; // eslint-disable-line import/no-duplicates\nimport {ConfigEditorRunConfigSchemaFragment} from './types/ConfigEditorRunConfigSchemaFragment';\n\ninterface ConfigEditorProps {\n  configCode: string;\n  readOnly: boolean;\n  showWhitespace: boolean;\n  runConfigSchema?: ConfigEditorRunConfigSchemaFragment;\n\n  checkConfig: YamlModeValidateFunction;\n  onConfigChange: (newValue: string) => void;\n  onHelpContextChange: (helpContext: ConfigEditorHelpContext | null) => void;\n}\n\nconst AUTO_COMPLETE_AFTER_KEY = /^[a-zA-Z0-9_@(]$/;\nconst performLint = debounce((editor: any) => {\n  editor.performLint();\n}, 1000);\n\nconst CodeMirrorShimStyle = createGlobalStyle`\n  .react-codemirror2 {\n    height: 100%;\n    flex: 1;\n    position: relative;\n  }\n  .react-codemirror2 .CodeMirror {\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    height: initial;\n    font-family: ${FontFamily.monospace};\n    font-size: 16px;\n\n    /* Note: Theme overrides */\n    &.cm-s-default .cm-comment {\n      color: #999;\n    }\n  }\n\n  .CodeMirror-hint,\n  .CodeMirror-lint-marker-error,\n  .CodeMirror-lint-marker-warning,\n  .CodeMirror-lint-message-error,\n  .CodeMirror-lint-message-warning {\n    font-family: ${FontFamily.monospace};\n    font-size: 16px;\n  }\n`;\nconst CodeMirrorWhitespaceStyle = createGlobalStyle`\n.cm-whitespace {\n  /*\n    Note: background is a 16x16px PNG containing a semi-transparent gray dot. 8.4px\n    is the exact width of a character in Codemirror's monospace font. It's consistent\n    in Firefox and Chrome and doesn't change on zoom in / out, but may need to be\n    modified if we change the Codemirror font.\n  */\n  background: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAEKADAAQAAAABAAAAEAAAAAA0VXHyAAAAm0lEQVQ4Ee2RMQ7DIAxFMVIvBEvm7FXXniIXak4RhnTujMSBkKDfCgPCzg2whAzf9hN8jJlBmgUxxgf0DWvFykR0Ouc+yGXsFwAeRuOv1rr0zdACIC/k2uu2P7T9Ng6zDu2ZUnqP/RqAr61GKUXUNEBWpy9R1AQAbzzvAFpNAJrbQYHs3nuhi1/gQRhGbFh7c7bWfgE+FOiU4MAfhpIwd0LjE+wAAAAASUVORK5CYII=') center left / 8.4px 8.4px repeat-x;\n}\n.cm-whitespace.CodeMirror-lint-mark-error {\n  background: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAEKADAAQAAAABAAAAEAAAAAA0VXHyAAAAm0lEQVQ4Ee2RMQ7DIAxFMVIvBEvm7FXXniIXak4RhnTujMSBkKDfCgPCzg2whAzf9hN8jJlBmgUxxgf0DWvFykR0Ouc+yGXsFwAeRuOv1rr0zdACIC/k2uu2P7T9Ng6zDu2ZUnqP/RqAr61GKUXUNEBWpy9R1AQAbzzvAFpNAJrbQYHs3nuhi1/gQRhGbFh7c7bWfgE+FOiU4MAfhpIwd0LjE+wAAAAASUVORK5CYII=') center left / 8.4px 8.4px repeat-x;\n}\n`;\n\nexport class ConfigEditor extends React.Component<ConfigEditorProps> {\n  _editor?: Editor;\n\n  componentDidUpdate(prevProps: ConfigEditorProps) {\n    if (!this._editor) {\n      return;\n    }\n    if (prevProps.runConfigSchema === this.props.runConfigSchema) {\n      return;\n    }\n    this.performInitialPass();\n  }\n\n  shouldComponentUpdate(prevProps: ConfigEditorProps) {\n    // Unfortunately, updates to the ConfigEditor clear the linter highlighting for\n    // unknown reasons and they're recalculated asynchronously. To prevent flickering,\n    // only update if our input has meaningfully changed.\n    return (\n      prevProps.configCode !== this.props.configCode ||\n      prevProps.readOnly !== this.props.readOnly ||\n      prevProps.runConfigSchema !== this.props.runConfigSchema ||\n      prevProps.showWhitespace !== this.props.showWhitespace\n    );\n  }\n\n  // Public API\n\n  moveCursor = (line: number, ch: number) => {\n    if (!this._editor) {\n      return;\n    }\n    this._editor.setCursor(line, ch, {scroll: false});\n    const {clientHeight} = this._editor.getScrollInfo();\n    const {left, top} = this._editor.cursorCoords(true, 'local');\n    const offsetFromTop = 20;\n\n    this._editor?.scrollIntoView({\n      left: left,\n      right: left,\n      top: top - offsetFromTop,\n      bottom: top + (clientHeight - offsetFromTop),\n    });\n    this._editor.focus();\n  };\n\n  moveCursorToPath = (path: string[]) => {\n    if (!this._editor) {\n      return;\n    }\n    const codeMirrorDoc = this._editor.getDoc();\n    const yamlDoc = yaml.parseDocument(this.props.configCode);\n    const range = findRangeInDocumentFromPath(yamlDoc, path, 'key');\n    if (!range) {\n      return;\n    }\n    const from = codeMirrorDoc.posFromIndex(range ? range.start : 0) as CodeMirror.Position;\n    this.moveCursor(from.line, from.ch);\n  };\n\n  // End Public API\n\n  performInitialPass() {\n    // update the gutter and redlining\n    performLint(this._editor);\n\n    // update the contextual help based on the runConfigSchema and content\n    const {context} = expandAutocompletionContextAtCursor(this._editor);\n    this.props.onHelpContextChange(context ? {type: context.closestCompositeType} : null);\n  }\n\n  render() {\n    // Unfortunately, CodeMirror is too intense to be simulated in the JSDOM \"virtual\" DOM.\n    // Until we run tests against something like selenium, trying to render the editor in\n    // tests have to stop here.\n    if (process.env.NODE_ENV === 'test') {\n      return <span />;\n    }\n\n    return (\n      <div style={{flex: 1, position: 'relative'}}>\n        <CodeMirrorShimStyle />\n        {this.props.showWhitespace ? <CodeMirrorWhitespaceStyle /> : null}\n        <CodeMirrorReact\n          value={this.props.configCode}\n          options={\n            {\n              mode: 'yaml',\n              theme: 'default',\n              lineNumbers: true,\n              readOnly: this.props.readOnly,\n              indentUnit: 2,\n              smartIndent: true,\n              showCursorWhenSelecting: true,\n              lintOnChange: false,\n              lint: {\n                checkConfig: this.props.checkConfig,\n                lintOnChange: false,\n                onUpdateLinting: false,\n              },\n              hintOptions: {\n                completeSingle: false,\n                closeOnUnfocus: false,\n                schema: this.props.runConfigSchema,\n              },\n              keyMap: 'sublime',\n              extraKeys: {\n                'Cmd-Space': (editor: any) => editor.showHint({completeSingle: true}),\n                'Ctrl-A': (editor: any) => {\n                  editor.execCommand('goLineStartSmart');\n                },\n                'Ctrl-E': (editor: any) => editor.execCommand('goLineEnd'),\n                'Ctrl-Space': (editor: any) => editor.showHint({completeSingle: true}),\n                'Alt-Space': (editor: any) => editor.showHint({completeSingle: true}),\n                'Shift-Tab': (editor: any) => editor.execCommand('indentLess'),\n                Tab: (editor: any) => editor.execCommand('indentMore'),\n                // Persistent search box in Query Editor\n                'Cmd-F': 'findPersistent',\n                'Ctrl-F': 'findPersistent',\n                'Cmd-Z': (editor: any) => editor.undo(),\n                'Cmd-Y': (editor: any) => editor.redo(),\n              },\n              gutters: [\n                'CodeMirror-foldgutter',\n                'CodeMirror-lint-markers',\n                'CodeMirror-linenumbers',\n              ],\n              foldGutter: true,\n            } as any\n          }\n          editorDidMount={(editor) => {\n            this._editor = editor;\n            this.performInitialPass();\n          }}\n          onBeforeChange={(editor, data, value) => {\n            this.props.onConfigChange(value);\n          }}\n          onCursorActivity={(editor: any) => {\n            if (editor.getSelection().length) {\n              this.props.onHelpContextChange(null);\n            } else {\n              const {context} = expandAutocompletionContextAtCursor(editor);\n              this.props.onHelpContextChange(context ? {type: context.closestCompositeType} : null);\n            }\n          }}\n          onChange={(editor: any) => {\n            performLint(editor);\n          }}\n          onBlur={(editor: any) => {\n            performLint(editor);\n          }}\n          onKeyUp={(editor, event: KeyboardEvent) => {\n            if (AUTO_COMPLETE_AFTER_KEY.test(event.key)) {\n              editor.execCommand('autocomplete');\n            }\n          }}\n        />\n      </div>\n    );\n  }\n}\n","import {gql} from '@apollo/client';\n\nimport {YamlModeValidationResult} from './codemirror-yaml/mode';\nimport {ConfigEditorValidationFragment} from './types/ConfigEditorValidationFragment';\n\nexport const CONFIG_EDITOR_RUN_CONFIG_SCHEMA_FRAGMENT = gql`\n  fragment ConfigEditorRunConfigSchemaFragment on RunConfigSchema {\n    rootConfigType {\n      key\n    }\n    allConfigTypes {\n      __typename\n      key\n      description\n      isSelector\n      typeParamKeys\n      ... on RegularConfigType {\n        givenName\n      }\n      ... on EnumConfigType {\n        givenName\n        values {\n          value\n          description\n        }\n      }\n      ... on CompositeConfigType {\n        fields {\n          name\n          description\n          isRequired\n          configTypeKey\n        }\n      }\n      ... on ScalarUnionConfigType {\n        key\n        scalarTypeKey\n        nonScalarTypeKey\n      }\n    }\n  }\n`;\n\nexport const CONFIG_EDITOR_VALIDATION_FRAGMENT = gql`\n  fragment ConfigEditorValidationFragment on PipelineConfigValidationResult {\n    __typename\n    ... on PipelineConfigValidationInvalid {\n      errors {\n        __typename\n        reason\n        message\n        stack {\n          entries {\n            __typename\n            ... on EvaluationStackPathEntry {\n              fieldName\n            }\n            ... on EvaluationStackListItemEntry {\n              listIndex\n            }\n          }\n        }\n      }\n    }\n  }\n`;\n\ntype StackEntry =\n  | {\n      __typename: 'EvaluationStackPathEntry';\n      fieldName: string;\n    }\n  | {\n      __typename: 'EvaluationStackListItemEntry';\n      listIndex: number;\n    };\n\nexport function errorStackToYamlPath(entries: StackEntry[]) {\n  return entries.map((entry) =>\n    entry.__typename === 'EvaluationStackPathEntry' ? entry.fieldName : `${entry.listIndex}`,\n  );\n}\n\nexport function responseToYamlValidationResult(\n  configJSON: Record<string, unknown>,\n  response: ConfigEditorValidationFragment,\n): YamlModeValidationResult {\n  if (response.__typename !== 'PipelineConfigValidationInvalid') {\n    return {isValid: true};\n  }\n\n  const errors = response.errors.map((err) => ({\n    message: err.message,\n    reason: err.reason,\n    path: errorStackToYamlPath(err.stack.entries),\n  }));\n\n  // Errors at the top level have no stack path because they are not within any\n  // dicts. To avoid highlighting the entire editor, associate them with the first\n  // element of the top dict.\n  const topLevelKey = Object.keys(configJSON);\n  errors.forEach((error) => {\n    if (error.path.length === 0 && topLevelKey.length) {\n      error.path = [topLevelKey[0]];\n    }\n  });\n\n  return {isValid: false, errors};\n}\n","import {ConfigEditorHelpContext} from './ConfigEditorHelpContext';\n\nexport const isHelpContextEqual = (\n  prev: ConfigEditorHelpContext | null,\n  next: ConfigEditorHelpContext | null,\n) => (prev && prev.type.key) === (next && next.type.key);\n","import {Colors} from '@blueprintjs/core';\nimport * as React from 'react';\nimport styled from 'styled-components/macro';\n\nimport {ConfigEditorHelpContext} from '../configeditor/ConfigEditorHelpContext';\nimport {isHelpContextEqual} from '../configeditor/isHelpContextEqual';\nimport {ConfigTypeSchema, TypeData} from '../typeexplorer/ConfigTypeSchema';\n\ninterface ConfigEditorHelpProps {\n  context: ConfigEditorHelpContext | null;\n  allInnerTypes: TypeData[];\n}\n\nexport const ConfigEditorHelp: React.FunctionComponent<ConfigEditorHelpProps> = React.memo(\n  ({context, allInnerTypes}) => {\n    if (!context) {\n      return <Container />;\n    }\n    return (\n      <Container>\n        <ConfigScrollWrap>\n          <ConfigTypeSchema type={context.type} typesInScope={allInnerTypes} maxDepth={2} />\n        </ConfigScrollWrap>\n        <AutocompletionsNote>Ctrl+Space to show auto-completions inline.</AutocompletionsNote>\n      </Container>\n    );\n  },\n  (prev, next) => isHelpContextEqual(prev.context, next.context),\n);\n\nconst AutocompletionsNote = styled.div`\n  font-size: 0.75rem;\n  text-align: center;\n  padding: 4px;\n  border-top: 1px solid ${Colors.LIGHT_GRAY1};\n  background: rgba(238, 238, 238, 0.9);\n  color: rgba(0, 0, 0, 0.7);\n`;\n\nconst ConfigScrollWrap = styled.div`\n  padding: 8px;\n  color: black;\n  flex: 1;\n  pointer-events: initial;\n  max-height: 100%;\n  overflow-y: auto;\n`;\n\nconst Container = styled.div`\n  position: relative;\n  display: flex;\n  flex-direction: column;\n  background-color: #e1e8edd1;\n  height: 100%;\n`;\n","import {Button, Intent, Menu} from '@blueprintjs/core';\nimport {IconNames} from '@blueprintjs/icons';\nimport {Select} from '@blueprintjs/select';\nimport * as React from 'react';\n\nimport {ModeNotFoundError} from './ModeNotFoundError';\n\ninterface Mode {\n  name: string;\n}\n\ninterface ConfigEditorModePickerProps {\n  modes: Mode[];\n  modeError?: ModeNotFoundError;\n  modeName: string | null;\n  onModeChange: (mode: string) => void;\n}\n\nconst MODE_PICKER_HINT_TEXT = `To add a mode, add a ModeDefinition to the pipeline.`;\n\nconst ModeSelect = Select.ofType<Mode>();\n\nexport const ConfigEditorModePicker: React.FunctionComponent<ConfigEditorModePickerProps> = (\n  props,\n) => {\n  const resolvedMode = props.modeName\n    ? props.modes.find((m) => m.name === props.modeName)\n    : props.modes[0];\n\n  React.useEffect(() => {\n    if (resolvedMode && resolvedMode.name !== props.modeName) {\n      props.onModeChange?.(resolvedMode.name);\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [resolvedMode, props.modeName]);\n\n  const singleMode = props.modes.length === 1;\n  const valid = !props.modeError;\n  const disabled = singleMode && valid;\n\n  const onItemSelect = (mode: Mode) => {\n    props.onModeChange?.(mode.name);\n  };\n\n  return (\n    <ModeSelect\n      activeItem={resolvedMode}\n      filterable={true}\n      disabled={singleMode && valid}\n      items={props.modes}\n      itemPredicate={(query, mode) => query.length === 0 || mode.name.includes(query)}\n      itemRenderer={(mode, props) => (\n        <Menu.Item\n          active={props.modifiers.active}\n          key={mode.name}\n          text={mode.name}\n          onClick={props.handleClick}\n        />\n      )}\n      onItemSelect={onItemSelect}\n    >\n      <Button\n        icon={valid ? undefined : IconNames.ERROR}\n        intent={valid ? Intent.NONE : Intent.DANGER}\n        title={disabled ? MODE_PICKER_HINT_TEXT : 'Current execution mode'}\n        text={\n          valid\n            ? resolvedMode\n              ? `Mode: ${resolvedMode.name}`\n              : 'Select Mode'\n            : 'Invalid Mode Selection'\n        }\n        disabled={disabled}\n        rightIcon=\"caret-down\"\n        data-test-id=\"mode-picker-button\"\n      />\n    </ModeSelect>\n  );\n};\n","import {Colors} from '@blueprintjs/core';\nimport * as React from 'react';\nimport styled from 'styled-components/macro';\n\nimport {useConfirmation} from '../app/CustomConfirmationProvider';\nimport {\n  IStorageData,\n  applyChangesToSession,\n  applyRemoveSession,\n  applySelectSession,\n} from '../app/LocalStorage';\nimport {IconWIP} from '../ui/Icon';\n\ninterface ExecutationTabProps {\n  canRemove?: boolean;\n  title: string;\n  active?: boolean;\n  onChange?: (title: string) => void;\n  onRemove?: () => void;\n  onClick: () => void;\n}\n\nconst ExecutionTab = (props: ExecutationTabProps) => {\n  const {canRemove, title, onChange, onClick, onRemove, active} = props;\n\n  const input = React.useRef<HTMLInputElement>(null);\n  const [editing, setEditing] = React.useState(false);\n  const [value, setValue] = React.useState(title);\n\n  const onDoubleClick = React.useCallback(() => {\n    if (onChange) {\n      setEditing(true);\n    }\n  }, [onChange]);\n\n  const onClickRemove = React.useCallback(\n    (e) => {\n      e.stopPropagation();\n      onRemove && onRemove();\n    },\n    [onRemove],\n  );\n\n  const handleBlur = React.useCallback(() => {\n    setEditing(false);\n    onChange && onChange(value);\n  }, [onChange, value]);\n\n  const handleChange = React.useCallback((e) => setValue(e.target.value), []);\n\n  React.useEffect(() => {\n    const el = input.current;\n    if (el && editing) {\n      el.focus();\n      el.select();\n    }\n  }, [editing]);\n\n  return (\n    <TabContainer active={active || false} onDoubleClick={onDoubleClick} onClick={onClick}>\n      {editing ? (\n        <input\n          ref={input}\n          type=\"text\"\n          onKeyDown={(e) => e.key === 'Enter' && e.currentTarget.blur()}\n          onChange={handleChange}\n          onBlur={handleBlur}\n          value={value}\n        />\n      ) : (\n        title\n      )}\n      {canRemove && !editing && onRemove ? (\n        <RemoveButton onClick={onClickRemove}>\n          <IconWIP name=\"close\" />\n        </RemoveButton>\n      ) : null}\n    </TabContainer>\n  );\n};\n\ninterface ExecutionTabsProps {\n  data: IStorageData;\n  onCreate: () => void;\n  onSave: (data: IStorageData) => void;\n}\n\nexport const ExecutionTabs = (props: ExecutionTabsProps) => {\n  const {data, onCreate, onSave} = props;\n  const {sessions} = data;\n  const sessionKeys = Object.keys(sessions);\n  const sessionCount = sessionKeys.length;\n\n  const confirm = useConfirmation();\n\n  const onApply = (mutator: any, ...args: any[]) => {\n    onSave(mutator(data, ...args));\n  };\n\n  const onRemove = async (keyToRemove: string) => {\n    if (sessionCount > 1) {\n      await confirm({\n        title: 'Discard tab?',\n        description: `The configuration for ${\n          keyToRemove ? `\"${sessions[keyToRemove].name}\"` : 'this tab'\n        } will be discarded.`,\n      });\n      onApply(applyRemoveSession, keyToRemove);\n    }\n  };\n\n  return (\n    <ExecutionTabsContainer>\n      {sessionKeys.map((key) => (\n        <ExecutionTab\n          canRemove={sessionCount > 1}\n          key={key}\n          active={key === data.current}\n          title={sessions[key].name}\n          onClick={() => onApply(applySelectSession, key)}\n          onChange={(name) => onApply(applyChangesToSession, key, {name})}\n          onRemove={() => onRemove(key)}\n        />\n      ))}\n      <ExecutionTab title=\"Add...\" onClick={onCreate} />\n    </ExecutionTabsContainer>\n  );\n};\n\nconst ExecutionTabsContainer = styled.div`\n  padding-left: 20px;\n  padding-top: 12px;\n  display; flex;\n  z-index: 1;\n  flex-direction: row;\n  border-bottom: 1px solid ${Colors.GRAY5};\n`;\n\nconst TabContainer = styled.div<{active: boolean}>`\n  position: relative;\n  padding: 6px 8px;\n  display: inline-flex;\n  flex-direction: row;\n  align-items: center;\n  background: ${({active}) => (active ? Colors.WHITE : Colors.LIGHT_GRAY3)};\n  color: ${({active}) => (active ? Colors.BLACK : Colors.DARK_GRAY3)};\n  user-select: none;\n  top: 1px;\n\n  border: 1px solid ${Colors.GRAY5};\n  border-bottom: 1px solid ${({active}) => (active ? 'transparent' : Colors.GRAY5)};\n  border-right: 0;\n  &:last-child {\n    border-right: 1px solid ${Colors.GRAY5};\n  }\n  &:hover {\n    background: ${({active}) => (active ? Colors.WHITE : Colors.LIGHT_GRAY5)};\n  }\n  input {\n    line-height: 1.28581;\n    font-size: 14px;\n    border: 0;\n    outline: none;\n  }\n  cursor: ${({active}) => (!active ? 'pointer' : 'inherit')};\n`;\n\nconst RemoveButton = styled.button`\n  border: 0;\n  cursor: pointer;\n  margin-left: 4px;\n  opacity: 0.2;\n  padding: 0;\n  &:hover {\n    opacity: 0.6;\n  }\n`;\n","import {useMutation} from '@apollo/client';\nimport * as React from 'react';\n\nimport {AppContext} from '../app/AppContext';\nimport {DISABLED_MESSAGE, usePermissions} from '../app/Permissions';\nimport {LAUNCH_PIPELINE_EXECUTION_MUTATION, handleLaunchResult} from '../runs/RunUtils';\nimport {\n  LaunchPipelineExecution,\n  LaunchPipelineExecutionVariables,\n} from '../runs/types/LaunchPipelineExecution';\n\nimport {LaunchButton} from './LaunchButton';\nimport {showLaunchError} from './showLaunchError';\n\ninterface LaunchRootExecutionButtonProps {\n  disabled: boolean;\n  getVariables: () => undefined | LaunchPipelineExecutionVariables;\n  pipelineName: string;\n}\n\nexport const LaunchRootExecutionButton: React.FunctionComponent<LaunchRootExecutionButtonProps> = (\n  props,\n) => {\n  const {canLaunchPipelineExecution} = usePermissions();\n  const [launchPipelineExecution] = useMutation<LaunchPipelineExecution>(\n    LAUNCH_PIPELINE_EXECUTION_MUTATION,\n  );\n  const {basePath} = React.useContext(AppContext);\n\n  const onLaunch = async () => {\n    const variables = props.getVariables();\n    if (variables == null) {\n      return;\n    }\n\n    try {\n      const result = await launchPipelineExecution({variables});\n      handleLaunchResult(basePath, props.pipelineName, result);\n    } catch (error) {\n      showLaunchError(error as Error);\n    }\n  };\n\n  return (\n    <div style={{marginRight: 20}}>\n      <LaunchButton\n        runCount={1}\n        config={{\n          icon: 'send-to',\n          onClick: onLaunch,\n          title: 'Launch Execution',\n          disabled: props.disabled || !canLaunchPipelineExecution,\n          tooltip: !canLaunchPipelineExecution ? DISABLED_MESSAGE : undefined,\n        }}\n      />\n    </div>\n  );\n};\n","import {gql} from '@apollo/client';\nimport {Button, Checkbox, Code, Colors, Intent, Position} from '@blueprintjs/core';\nimport {Tooltip2 as Tooltip} from '@blueprintjs/popover2';\nimport * as React from 'react';\nimport styled from 'styled-components/macro';\n\nimport {showCustomAlert} from '../app/CustomAlertProvider';\nimport {useConfirmation} from '../app/CustomConfirmationProvider';\nimport {useFeatureFlags} from '../app/Flags';\nimport {PythonErrorInfo, PYTHON_ERROR_FRAGMENT} from '../app/PythonErrorInfo';\nimport {errorStackToYamlPath} from '../configeditor/ConfigEditorUtils';\nimport {\n  ConfigEditorRunConfigSchemaFragment,\n  ConfigEditorRunConfigSchemaFragment_allConfigTypes_CompositeConfigType,\n} from '../configeditor/types/ConfigEditorRunConfigSchemaFragment';\nimport {ButtonLink} from '../ui/ButtonLink';\nimport {ColorsWIP} from '../ui/Colors';\nimport {IconWIP} from '../ui/Icon';\nimport {SplitPanelContainer} from '../ui/SplitPanelContainer';\n\nimport {\n  RunPreviewValidationFragment,\n  RunPreviewValidationFragment_PipelineConfigValidationInvalid_errors,\n} from './types/RunPreviewValidationFragment';\n\ntype ValidationError = RunPreviewValidationFragment_PipelineConfigValidationInvalid_errors;\ntype ValidationErrorOrNode = ValidationError | React.ReactNode;\n\nfunction isValidationError(e: ValidationErrorOrNode): e is ValidationError {\n  return e && typeof e === 'object' && '__typename' in e ? true : false;\n}\n\nconst stateToHint = {\n  invalid: {\n    title: `You need to fix this configuration section.`,\n    intent: Intent.DANGER,\n  },\n  missing: {\n    title: `You need to add this configuration section.`,\n    intent: Intent.DANGER,\n  },\n  present: {\n    title: `This section is present and valid.`,\n    intent: Intent.SUCCESS,\n  },\n  none: {title: `This section is empty and valid.`, intent: Intent.PRIMARY},\n};\n\nconst RemoveExtraConfigButton = ({\n  onRemoveExtraPaths,\n  extraNodes,\n}: {\n  extraNodes: string[];\n  onRemoveExtraPaths: (paths: string[]) => void;\n}) => {\n  const confirm = useConfirmation();\n\n  const knownKeyExtraPaths: {[key: string]: string[]} = {};\n  const otherPaths: string[] = [];\n\n  for (const path of extraNodes) {\n    const parts = path.split('.');\n\n    // If the length is 2, the first part of the path is a known key, such as \"solids\", \"resouces\",\n    // or \"loggers\", and the user has provided extra config for one of those. We will keep track of\n    // these in `knownKeyExtraPaths` just so we can display them with an extra description.\n    if (parts.length === 2) {\n      const [type, name] = parts;\n      if (!knownKeyExtraPaths[type]) {\n        knownKeyExtraPaths[type] = [];\n      }\n      knownKeyExtraPaths[type].push(name);\n    } else {\n      otherPaths.push(path);\n    }\n  }\n\n  return (\n    <div style={{marginTop: 5}}>\n      <Button\n        small={true}\n        onClick={async () => {\n          await confirm({\n            title: 'Remove extra config',\n            description: (\n              <div>\n                <p>\n                  You have provided extra configuration in your run config which does not conform to\n                  your pipeline{`'`}s config schema.\n                </p>\n                {Object.entries(knownKeyExtraPaths).length > 0 &&\n                  Object.entries(knownKeyExtraPaths).map(([key, value]) => (\n                    <>\n                      <p>Extra {key}:</p>\n                      <ul>\n                        {value.map((v) => (\n                          <li key={v}>\n                            <Code>{v}</Code>\n                          </li>\n                        ))}\n                      </ul>\n                    </>\n                  ))}\n                {otherPaths.length > 0 && (\n                  <>\n                    <p>Other extra paths:</p>\n                    <ul>\n                      {otherPaths.map((v) => (\n                        <li key={v}>\n                          <Code>{v}</Code>\n                        </li>\n                      ))}\n                    </ul>\n                  </>\n                )}\n                <p>\n                  Clicking confirm will automatically remove this extra configuration from your run\n                  config.\n                </p>{' '}\n              </div>\n            ),\n          });\n          onRemoveExtraPaths(extraNodes);\n        }}\n      >\n        Remove Extra Config\n      </Button>\n    </div>\n  );\n};\n\nconst ScaffoldConfigButton = ({\n  onScaffoldMissingConfig,\n  missingNodes,\n}: {\n  missingNodes: string[];\n  onScaffoldMissingConfig: () => void;\n}) => {\n  const confirm = useConfirmation();\n\n  const confirmationMessage = (\n    <div>\n      {missingNodes.length > 0 && (\n        <>\n          <p>Missing paths:</p>\n          <ul>\n            {missingNodes.map((v) => (\n              <li key={v}>\n                <Code>{v}</Code>\n              </li>\n            ))}\n          </ul>\n        </>\n      )}\n      <p>\n        Clicking confirm will automatically scaffold this missing configuration into your run config\n        with default values. You will need to change the values appropriately.\n      </p>\n    </div>\n  );\n\n  const onClick = async () => {\n    await confirm({\n      title: 'Scaffold extra config',\n      description: confirmationMessage,\n    });\n    onScaffoldMissingConfig();\n  };\n\n  return (\n    <div style={{marginTop: 5}}>\n      <Button small={true} onClick={onClick}>\n        Scaffold Missing Config\n      </Button>\n    </div>\n  );\n};\n\ninterface RunPreviewProps {\n  validation: RunPreviewValidationFragment | null;\n  document: any | null;\n\n  runConfigSchema?: ConfigEditorRunConfigSchemaFragment;\n  onHighlightPath: (path: string[]) => void;\n  onRemoveExtraPaths: (paths: string[]) => void;\n  onScaffoldMissingConfig: () => void;\n  solidSelection: string[] | null;\n}\n\nexport const RunPreview: React.FC<RunPreviewProps> = (props) => {\n  const {\n    document,\n    validation,\n    onHighlightPath,\n    onRemoveExtraPaths,\n    onScaffoldMissingConfig,\n    solidSelection,\n    runConfigSchema,\n  } = props;\n  const [errorsOnly, setErrorsOnly] = React.useState(false);\n  const {flagPipelineModeTuples} = useFeatureFlags();\n\n  const rootCompositeChildren = React.useMemo(() => {\n    if (!runConfigSchema) {\n      return {};\n    }\n\n    const {allConfigTypes, rootConfigType} = runConfigSchema;\n    const children: {\n      [fieldName: string]: ConfigEditorRunConfigSchemaFragment_allConfigTypes_CompositeConfigType;\n    } = {};\n\n    const root = allConfigTypes.find((t) => t.key === rootConfigType.key);\n    if (root?.__typename !== 'CompositeConfigType') {\n      return children;\n    }\n\n    root.fields.forEach((field) => {\n      const allConfigVersion = allConfigTypes.find((t) => t.key === field.configTypeKey);\n      if (allConfigVersion?.__typename !== 'CompositeConfigType') {\n        return;\n      }\n      children[field.name] = allConfigVersion;\n    });\n\n    return children;\n  }, [runConfigSchema]);\n\n  const extraNodes: string[] = [];\n  const missingNodes: string[] = [];\n  const errorsAndPaths: {\n    pathKey: string;\n    error: ValidationErrorOrNode;\n  }[] = [];\n\n  if (validation && validation.__typename === 'PipelineConfigValidationInvalid') {\n    validation.errors.forEach((e) => {\n      const path = errorStackToYamlPath(e.stack.entries);\n\n      errorsAndPaths.push({pathKey: path.join('.'), error: e});\n\n      if (e.__typename === 'MissingFieldConfigError') {\n        missingNodes.push([...path, e.field.name].join('.'));\n      } else if (e.__typename === 'MissingFieldsConfigError') {\n        for (const field of e.fields) {\n          missingNodes.push([...path, field.name].join('.'));\n        }\n      } else if (e.__typename === 'FieldNotDefinedConfigError') {\n        extraNodes.push([...path, e.fieldName].join('.'));\n      } else if (e.__typename === 'FieldsNotDefinedConfigError') {\n        for (const fieldName of e.fieldNames) {\n          extraNodes.push([...path, fieldName].join('.'));\n        }\n      } else if (e.__typename === 'RuntimeMismatchConfigError') {\n        // If an entry at a path is the wrong type,\n        // it is equivalent to it being missing\n        missingNodes.push(path.join('.'));\n      }\n    });\n  }\n\n  if (validation?.__typename === 'InvalidSubsetError') {\n    errorsAndPaths.push({pathKey: '', error: validation.message});\n  }\n\n  if (validation?.__typename === 'PythonError') {\n    const info = <PythonErrorInfo error={validation} />;\n    errorsAndPaths.push({\n      pathKey: '',\n      error: (\n        <span>\n          PythonError:{' '}\n          <ButtonLink onClick={() => showCustomAlert({body: info})}>Click for details</ButtonLink>\n        </span>\n      ),\n    });\n  }\n\n  const {resources, solids, ...rest} = rootCompositeChildren;\n\n  const itemsIn = (parents: string[], items: {name: string; isRequired: boolean}[]) => {\n    const boxes = items\n      .map((item) => {\n        // If a solid selection is in use, discard anything not in it.\n        if (solidSelection?.length && !solidSelection?.includes(item.name)) {\n          return null;\n        }\n\n        const path = [...parents, item.name];\n        const pathKey = path.join('.');\n        const pathErrors = errorsAndPaths\n          .filter((e) => e.pathKey === pathKey || e.pathKey.startsWith(`${pathKey}.`))\n          .map((e) => e.error);\n\n        const isPresent = pathExistsInObject(path, document);\n        const containsMissing = missingNodes.some((missingNode) =>\n          missingNode.includes(path.join('.')),\n        );\n        const isInvalid = pathErrors.length || containsMissing;\n        const isMissing = path.some((_, idx) =>\n          missingNodes.includes(path.slice(0, idx + 1).join('.')),\n        );\n        if (errorsOnly && !isInvalid) {\n          return false;\n        }\n        const state =\n          isMissing && item.isRequired\n            ? 'missing'\n            : isInvalid\n            ? 'invalid'\n            : isPresent\n            ? 'present'\n            : 'none';\n\n        return (\n          <Tooltip\n            position={Position.BOTTOM}\n            content={stateToHint[state].title}\n            intent={stateToHint[state].intent}\n            key={item.name}\n          >\n            <Item\n              key={item.name}\n              state={state}\n              onClick={() => {\n                const first = pathErrors.find(isValidationError);\n                onHighlightPath(first ? errorStackToYamlPath(first.stack.entries) : path);\n              }}\n            >\n              {item.name}\n            </Item>\n          </Tooltip>\n        );\n      })\n      .filter(Boolean);\n\n    if (!boxes.length) {\n      return <ItemsEmptyNotice>Nothing to display.</ItemsEmptyNotice>;\n    }\n    return boxes;\n  };\n\n  return (\n    <SplitPanelContainer\n      identifier=\"run-preview\"\n      axis=\"horizontal\"\n      first={\n        <ErrorListContainer>\n          <Section>\n            <SectionTitle>Errors</SectionTitle>\n            {errorsAndPaths.map((item, idx) => (\n              <ErrorRow key={idx} error={item.error} onHighlight={onHighlightPath} />\n            ))}\n          </Section>\n\n          {(extraNodes.length > 0 || missingNodes.length > 0) && (\n            <Section>\n              <SectionTitle>Bulk Actions:</SectionTitle>\n              {extraNodes.length ? (\n                <RemoveExtraConfigButton\n                  onRemoveExtraPaths={onRemoveExtraPaths}\n                  extraNodes={extraNodes}\n                />\n              ) : null}\n              {missingNodes.length ? (\n                <ScaffoldConfigButton\n                  onScaffoldMissingConfig={onScaffoldMissingConfig}\n                  missingNodes={missingNodes}\n                />\n              ) : null}\n            </Section>\n          )}\n        </ErrorListContainer>\n      }\n      firstInitialPercent={50}\n      firstMinSize={150}\n      second={\n        <>\n          <div style={{overflowY: 'scroll', width: '100%', height: '100%'}}>\n            <RuntimeAndResourcesSection>\n              <Section>\n                <SectionTitle>Runtime</SectionTitle>\n                <ItemSet>\n                  {itemsIn(\n                    [],\n                    Object.keys(rest).map((name) => ({name, isRequired: false})),\n                  )}\n                </ItemSet>\n              </Section>\n              {(resources?.fields.length || 0) > 0 && (\n                <Section>\n                  <SectionTitle>Resources</SectionTitle>\n                  <ItemSet>{itemsIn(['resources'], resources?.fields || [])}</ItemSet>\n                </Section>\n              )}\n            </RuntimeAndResourcesSection>\n            <Section>\n              <SectionTitle>{flagPipelineModeTuples ? 'Ops' : 'Solids'}</SectionTitle>\n              <ItemSet>{itemsIn(['solids'], solids?.fields || [])}</ItemSet>\n            </Section>\n            <div style={{height: 50}} />\n          </div>\n          <div\n            style={{\n              position: 'absolute',\n              top: 0,\n              right: 0,\n              padding: '12px 15px 0px 10px',\n              background: 'rgba(255,255,255,0.7)',\n            }}\n          >\n            <Checkbox\n              label=\"Errors Only\"\n              checked={errorsOnly}\n              onChange={() => setErrorsOnly(!errorsOnly)}\n            />\n          </div>\n        </>\n      }\n    />\n  );\n};\n\nexport const RUN_PREVIEW_VALIDATION_FRAGMENT = gql`\n  fragment RunPreviewValidationFragment on PipelineConfigValidationResult {\n    __typename\n    ... on PipelineConfigValidationInvalid {\n      errors {\n        __typename\n        reason\n        message\n        stack {\n          entries {\n            __typename\n            ... on EvaluationStackPathEntry {\n              fieldName\n            }\n            ... on EvaluationStackListItemEntry {\n              listIndex\n            }\n          }\n        }\n        ... on MissingFieldConfigError {\n          field {\n            name\n          }\n        }\n        ... on MissingFieldsConfigError {\n          fields {\n            name\n          }\n        }\n        ... on FieldNotDefinedConfigError {\n          fieldName\n        }\n        ... on FieldsNotDefinedConfigError {\n          fieldNames\n        }\n      }\n    }\n    ... on PipelineNotFoundError {\n      message\n    }\n    ... on InvalidSubsetError {\n      message\n    }\n    ...PythonErrorFragment\n  }\n\n  ${PYTHON_ERROR_FRAGMENT}\n`;\n\nconst SectionTitle = styled.div`\n  color: ${Colors.GRAY3};\n  text-transform: uppercase;\n  font-size: 12px;\n`;\n\nconst Section = styled.div`\n  margin-top: 14px;\n  margin-left: 10px;\n`;\n\nconst ItemSet = styled.div`\n  display: flex;\n  flex-direction: row;\n  flex-wrap: wrap;\n`;\n\nconst ItemsEmptyNotice = styled.div`\n  font-size: 13px;\n  padding-top: 7px;\n  padding-bottom: 7px;\n`;\n\nconst ItemBorder = {\n  invalid: `1px solid #CE1126`,\n  missing: `1px solid #CE1126`,\n  present: `1px solid #AFCCE1`,\n  none: `1px solid ${Colors.LIGHT_GRAY2}`,\n};\n\nconst ItemBackground = {\n  invalid: Colors.RED5,\n  missing: Colors.RED5,\n  present: '#C8E1F4',\n  none: Colors.LIGHT_GRAY4,\n};\n\nconst ItemBackgroundHover = {\n  invalid: '#E15858',\n  missing: '#E15858',\n  present: '#AFCCE1',\n  none: Colors.LIGHT_GRAY4,\n};\n\nconst ItemColor = {\n  invalid: Colors.WHITE,\n  missing: Colors.WHITE,\n  present: Colors.BLACK,\n  none: Colors.BLACK,\n};\n\nconst Item = styled.div<{\n  state: 'present' | 'missing' | 'invalid' | 'none';\n}>`\n  white-space: nowrap;\n  font-size: 13px;\n  color: ${({state}) => ItemColor[state]};\n  background: ${({state}) => ItemBackground[state]};\n  border-radius: 3px;\n  border: ${({state}) => ItemBorder[state]};\n  padding: 3px 5px;\n  margin: 3px;\n  transition: background 150ms linear, color 150ms linear;\n  cursor: ${({state}) => (state === 'present' ? 'default' : 'not-allowed')};\n  overflow: hidden;\n  text-overflow: ellipsis;\n\n  &:hover {\n    transition: none;\n    background: ${({state}) => ItemBackgroundHover[state]};\n  }\n`;\n\nconst ErrorListContainer = styled.div`\n  margin-left: 10px;\n  overflow-y: scroll;\n  height: 100%;\n`;\n\nconst ErrorRowContainer = styled.div<{hoverable: boolean}>`\n  text-align: left;\n  font-size: 13px;\n  white-space: pre-wrap;\n  word-break: break-word;\n  display: flex;\n  flex-direction: row;\n  align-items: flex-start;\n  border-bottom: 1px solid #ccc;\n  padding: 7px 0;\n  padding-right: 7px;\n  margin-bottom: 8px;\n  &:last-child {\n    border-bottom: 0;\n    margin-bottom: 15px;\n  }\n  ${({hoverable}) =>\n    hoverable &&\n    `&:hover {\n      background: ${Colors.LIGHT_GRAY5};\n    }\n  `}\n`;\n\nconst RuntimeAndResourcesSection = styled.div`\n  display: flex;\n  @media (max-width: 800px) {\n    flex-direction: column;\n  }\n`;\n\nconst ErrorRow: React.FunctionComponent<{\n  error: ValidationError | React.ReactNode;\n  onHighlight: (path: string[]) => void;\n}> = ({error, onHighlight}) => {\n  let message = error;\n  let target: ValidationError | null = null;\n  if (isValidationError(error)) {\n    message = error.message;\n    target = error;\n  }\n\n  let displayed = message;\n  if (typeof message === 'string' && message.length > 400) {\n    displayed = truncateErrorMessage(message);\n  }\n\n  return (\n    <ErrorRowContainer\n      hoverable={!!target}\n      onClick={() => target && onHighlight(errorStackToYamlPath(target.stack.entries))}\n    >\n      <div style={{paddingRight: 4}}>\n        <IconWIP name=\"error\" color={ColorsWIP.Red500} />\n      </div>\n      <div>\n        {displayed}\n        {displayed !== message && (\n          <>\n            &nbsp;\n            <ButtonLink\n              onClick={() =>\n                showCustomAlert({\n                  body: <div style={{whiteSpace: 'pre-wrap'}}>{message}</div>,\n                })\n              }\n            >\n              View all\n            </ButtonLink>\n          </>\n        )}\n      </div>\n    </ErrorRowContainer>\n  );\n};\n\nfunction truncateErrorMessage(message: string) {\n  let split = message.indexOf('{');\n  if (split === -1) {\n    split = message.indexOf('. ');\n  }\n  if (split === -1) {\n    split = 400;\n  }\n  return message.substr(0, split) + '... ';\n}\n\nfunction pathExistsInObject(path: string[], object: any): boolean {\n  if (!object || typeof object !== 'object') {\n    return false;\n  }\n  if (path.length === 0) {\n    return true;\n  }\n  const [first, ...rest] = path;\n  return pathExistsInObject(rest, object[first]);\n}\n","import {gql, useQuery} from '@apollo/client';\nimport {Colors, Intent, Popover} from '@blueprintjs/core';\nimport * as React from 'react';\nimport styled from 'styled-components/macro';\n\nimport {useFeatureFlags} from '../app/Flags';\nimport {filterByQuery} from '../app/GraphQueryImpl';\nimport {ShortcutHandler} from '../app/ShortcutHandler';\nimport {PipelineGraph, PIPELINE_GRAPH_SOLID_FRAGMENT} from '../graph/PipelineGraph';\nimport {SVGViewport} from '../graph/SVGViewport';\nimport {getDagrePipelineLayout} from '../graph/getFullSolidLayout';\nimport {GraphQueryInput} from '../ui/GraphQueryInput';\nimport {repoAddressToSelector} from '../workspace/repoAddressToSelector';\nimport {RepoAddress} from '../workspace/types';\n\nimport {\n  SolidSelectorQuery,\n  SolidSelectorQuery_pipelineOrError,\n  SolidSelectorQuery_pipelineOrError_Pipeline_solids,\n} from './types/SolidSelectorQuery';\n\ninterface ISolidSelectorProps {\n  pipelineName: string;\n  serverProvidedSubsetError?: {message: string};\n  value: string[] | null;\n  query: string | null;\n  onChange: (value: string[] | null, query: string | null) => void;\n  onRequestClose?: () => void;\n  repoAddress: RepoAddress;\n}\n\ninterface SolidSelectorModalProps {\n  pipelineOrError: SolidSelectorQuery_pipelineOrError;\n  queryResultSolids: SolidSelectorQuery_pipelineOrError_Pipeline_solids[];\n  errorMessage: string | null;\n}\n\nclass SolidSelectorModal extends React.PureComponent<SolidSelectorModalProps> {\n  graphRef = React.createRef<PipelineGraph>();\n\n  render() {\n    const {pipelineOrError, queryResultSolids, errorMessage} = this.props;\n\n    if (pipelineOrError.__typename !== 'Pipeline') {\n      return (\n        <SolidSelectorModalContainer>\n          {errorMessage && <ModalErrorOverlay>{errorMessage}</ModalErrorOverlay>}\n        </SolidSelectorModalContainer>\n      );\n    }\n\n    return (\n      <SolidSelectorModalContainer>\n        {errorMessage && <ModalErrorOverlay>{errorMessage}</ModalErrorOverlay>}\n        <PipelineGraph\n          ref={this.graphRef}\n          backgroundColor={Colors.WHITE}\n          pipelineName={pipelineOrError.name}\n          solids={queryResultSolids}\n          layout={getDagrePipelineLayout(queryResultSolids)}\n          interactor={SVGViewport.Interactors.None}\n          focusSolids={[]}\n          highlightedSolids={[]}\n        />\n      </SolidSelectorModalContainer>\n    );\n  }\n}\n\nconst SOLID_SELECTOR_QUERY = gql`\n  query SolidSelectorQuery($selector: PipelineSelector!) {\n    pipelineOrError(params: $selector) {\n      __typename\n      ... on Pipeline {\n        id\n        name\n        solids {\n          name\n          ...PipelineGraphSolidFragment\n        }\n      }\n      ... on PipelineNotFoundError {\n        message\n      }\n      ... on InvalidSubsetError {\n        message\n      }\n      ... on PythonError {\n        message\n      }\n    }\n  }\n  ${PIPELINE_GRAPH_SOLID_FRAGMENT}\n`;\n\nexport const SolidSelector = (props: ISolidSelectorProps) => {\n  const {serverProvidedSubsetError, query, onChange, pipelineName, repoAddress} = props;\n  const [pending, setPending] = React.useState<string>(query || '*');\n  const [focused, setFocused] = React.useState(false);\n  const selector = {\n    ...repoAddressToSelector(repoAddress),\n    pipelineName,\n  };\n\n  const {flagPipelineModeTuples} = useFeatureFlags();\n\n  const {data, loading} = useQuery<SolidSelectorQuery>(SOLID_SELECTOR_QUERY, {\n    variables: {selector},\n    fetchPolicy: 'cache-and-network',\n  });\n\n  React.useEffect(() => {\n    setPending(query || '*');\n  }, [query, focused]);\n\n  const queryResultSolids =\n    data?.pipelineOrError.__typename === 'Pipeline'\n      ? filterByQuery(data!.pipelineOrError.solids, pending).all\n      : [];\n\n  const pipelineErrorMessage =\n    data?.pipelineOrError.__typename !== 'Pipeline' ? data?.pipelineOrError.message || null : null;\n\n  if (pipelineErrorMessage) {\n    console.error(`Could not load pipeline ${props.pipelineName}`);\n  }\n\n  const invalidResult = !loading && (queryResultSolids.length === 0 || pending.length === 0);\n\n  const errorMessage = React.useMemo(() => {\n    if (invalidResult) {\n      return flagPipelineModeTuples\n        ? `You must provide a valid op query or * to execute the entire job.`\n        : `You must provide a valid solid query or * to execute the entire pipeline.`;\n    }\n\n    return serverProvidedSubsetError ? serverProvidedSubsetError.message : pipelineErrorMessage;\n  }, [flagPipelineModeTuples, invalidResult, pipelineErrorMessage, serverProvidedSubsetError]);\n\n  const onCommitPendingValue = (applied: string) => {\n    if (data?.pipelineOrError.__typename !== 'Pipeline') {\n      return;\n    }\n\n    if (applied === '') {\n      applied = '*';\n    }\n    const queryResultSolids = filterByQuery(data.pipelineOrError.solids, applied).all;\n\n    // If all solids are returned, we set the subset to null rather than sending\n    // a comma separated list of evey solid to the API\n    if (queryResultSolids.length === data.pipelineOrError.solids.length) {\n      onChange(null, applied);\n    } else {\n      onChange(\n        queryResultSolids.map((s) => s.name),\n        applied,\n      );\n    }\n  };\n\n  return (\n    <div style={{position: 'relative'}}>\n      <Popover\n        autoFocus={false}\n        isOpen={focused}\n        minimal\n        modifiers={{arrow: {enabled: false}, offset: {enabled: true, offset: '0, 8px'}}}\n        position=\"bottom-left\"\n      >\n        <ShortcutHandler shortcutLabel={'⌥S'} shortcutFilter={(e) => e.keyCode === 83 && e.altKey}>\n          <GraphQueryInput\n            width={(pending !== '*' && pending !== '') || focused ? 350 : 90}\n            intent={errorMessage ? Intent.DANGER : Intent.NONE}\n            items={\n              data?.pipelineOrError.__typename === 'Pipeline' ? data?.pipelineOrError.solids : []\n            }\n            value={pending}\n            placeholder={flagPipelineModeTuples ? 'Type an op subset' : 'Type a solid subset'}\n            onChange={setPending}\n            onBlur={(pending) => {\n              onCommitPendingValue(pending);\n              setFocused(false);\n            }}\n            onFocus={() => setFocused(true)}\n            onKeyDown={(e) => {\n              if (e.isDefaultPrevented()) {\n                return;\n              }\n              if (e.key === 'Enter' || e.key === 'Return' || e.key === 'Escape') {\n                e.currentTarget.blur();\n              }\n            }}\n          />\n        </ShortcutHandler>\n        {data?.pipelineOrError && (\n          <SolidSelectorModal\n            pipelineOrError={data?.pipelineOrError}\n            errorMessage={errorMessage}\n            queryResultSolids={queryResultSolids}\n          />\n        )}\n      </Popover>\n    </div>\n  );\n};\n\nconst SolidSelectorModalContainer = styled.div`\n  border-radius: 4px;\n  width: 60vw;\n  height: 60vh;\n  background: ${Colors.WHITE};\n  & > div {\n    border-radius: 4px;\n  }\n`;\n\nconst ModalErrorOverlay = styled.div`\n  position: absolute;\n  margin: 5px;\n  padding: 4px 8px;\n  z-index: 2;\n  border-radius: 2px;\n  border: 1px solid ${Colors.RED3};\n  background: ${Colors.RED5};\n  color: white;\n`;\n","import {assertUnreachable} from '../app/Util';\nimport {\n  ConfigEditorRunConfigSchemaFragment_allConfigTypes,\n  ConfigEditorRunConfigSchemaFragment,\n} from '../configeditor/types/ConfigEditorRunConfigSchemaFragment';\n\nexport const scaffoldType = (\n  configTypeKey: string,\n  typeLookup: {[key: string]: ConfigEditorRunConfigSchemaFragment_allConfigTypes},\n): any => {\n  const type = typeLookup[configTypeKey];\n\n  switch (type.__typename) {\n    case 'CompositeConfigType':\n      if (type.isSelector) {\n        // Could potentially do something better here, like scaffold out\n        // all the types and let the user delete the ones they don't want.\n        return '<selector>';\n      }\n\n      const config = {};\n      for (const field of type.fields) {\n        const {name, isRequired, configTypeKey} = field;\n        if (isRequired) {\n          config[name] = scaffoldType(configTypeKey, typeLookup);\n        }\n      }\n\n      return config;\n    case 'ArrayConfigType':\n      return [];\n    case 'NullableConfigType':\n      // If a type is nullable we include it in the scaffolded config anyway\n      // by using the inner type\n      const innerType = type.typeParamKeys[0];\n      return scaffoldType(innerType, typeLookup);\n    case 'EnumConfigType':\n      // Here we just join all the potential enum values with a |. The user needs to delete\n      // all the values but the ones they want to use.\n      return type.values.map((i) => i.value).join('|');\n    case 'ScalarUnionConfigType':\n      // Here we just scaffold the scalar value. Could potentially try to\n      // scaffold the other type instead.\n      const {scalarTypeKey} = type;\n      return scaffoldType(scalarTypeKey, typeLookup);\n    case 'RegularConfigType':\n      return {\n        String: '',\n        Int: 0,\n        Bool: true,\n        Any: 'AnyType',\n      }[type.key];\n    default:\n      assertUnreachable(type);\n  }\n};\n\nexport const createTypeLookup = (\n  allConfigTypes: ConfigEditorRunConfigSchemaFragment_allConfigTypes[],\n) => {\n  const typeLookup: {[key: string]: ConfigEditorRunConfigSchemaFragment_allConfigTypes} = {};\n  for (const type of allConfigTypes) {\n    typeLookup[type.key] = type;\n  }\n\n  return typeLookup;\n};\n\nexport const scaffoldPipelineConfig = (configSchema: ConfigEditorRunConfigSchemaFragment) => {\n  const {allConfigTypes, rootConfigType} = configSchema;\n  console.log(allConfigTypes);\n  const typeLookup = createTypeLookup(allConfigTypes);\n  const config = scaffoldType(rootConfigType.key, typeLookup);\n  return config;\n};\n","import {gql, useApolloClient, useQuery} from '@apollo/client';\nimport {Button, Colors} from '@blueprintjs/core';\nimport merge from 'deepmerge';\nimport * as React from 'react';\nimport styled from 'styled-components/macro';\nimport * as yaml from 'yaml';\n\nimport {showCustomAlert} from '../app/CustomAlertProvider';\nimport {useFeatureFlags} from '../app/Flags';\nimport {\n  PipelineRunTag,\n  SessionBase,\n  useStorage,\n  applyChangesToSession,\n  applyCreateSession,\n  IExecutionSessionChanges,\n} from '../app/LocalStorage';\nimport {PythonErrorInfo} from '../app/PythonErrorInfo';\nimport {ShortcutHandler} from '../app/ShortcutHandler';\nimport {ConfigEditor} from '../configeditor/ConfigEditor';\nimport {ConfigEditorHelpContext} from '../configeditor/ConfigEditorHelpContext';\nimport {\n  CONFIG_EDITOR_RUN_CONFIG_SCHEMA_FRAGMENT,\n  CONFIG_EDITOR_VALIDATION_FRAGMENT,\n  responseToYamlValidationResult,\n} from '../configeditor/ConfigEditorUtils';\nimport {isHelpContextEqual} from '../configeditor/isHelpContextEqual';\nimport {DagsterTag} from '../runs/RunTag';\nimport {RepositorySelector} from '../types/globalTypes';\nimport {Box} from '../ui/Box';\nimport {ButtonLink} from '../ui/ButtonLink';\nimport {ColorsWIP} from '../ui/Colors';\nimport {Group} from '../ui/Group';\nimport {IconWIP} from '../ui/Icon';\nimport {SecondPanelToggle, SplitPanelContainer} from '../ui/SplitPanelContainer';\nimport {repoAddressToSelector} from '../workspace/repoAddressToSelector';\nimport {RepoAddress} from '../workspace/types';\n\nimport {\n  ConfigEditorConfigPicker,\n  CONFIG_PARTITION_SELECTION_QUERY,\n} from './ConfigEditorConfigPicker';\nimport {ConfigEditorHelp} from './ConfigEditorHelp';\nimport {ConfigEditorModePicker} from './ConfigEditorModePicker';\nimport {ExecutionTabs} from './ExecutionTabs';\nimport {LaunchRootExecutionButton} from './LaunchRootExecutionButton';\nimport {LoadingOverlay} from './LoadingOverlay';\nimport {RunPreview, RUN_PREVIEW_VALIDATION_FRAGMENT} from './RunPreview';\nimport {SessionSettingsBar} from './SessionSettingsBar';\nimport {SolidSelector} from './SolidSelector';\nimport {TagContainer, TagEditor} from './TagEditor';\nimport {scaffoldPipelineConfig} from './scaffoldType';\nimport {ConfigEditorGeneratorPipelineFragment_presets} from './types/ConfigEditorGeneratorPipelineFragment';\nimport {ExecutionSessionContainerPartitionSetsFragment} from './types/ExecutionSessionContainerPartitionSetsFragment';\nimport {ExecutionSessionContainerPipelineFragment} from './types/ExecutionSessionContainerPipelineFragment';\nimport {PipelineExecutionConfigSchemaQuery} from './types/PipelineExecutionConfigSchemaQuery';\nimport {PreviewConfigQuery, PreviewConfigQueryVariables} from './types/PreviewConfigQuery';\n\nconst YAML_SYNTAX_INVALID = `The YAML you provided couldn't be parsed. Please fix the syntax errors and try again.`;\nconst LOADING_CONFIG_FOR_PARTITION = `Generating configuration...`;\nconst LOADING_CONFIG_SCHEMA = `Loading config schema...`;\nconst LOADING_RUN_PREVIEW = `Checking config...`;\n\ntype Preset = ConfigEditorGeneratorPipelineFragment_presets;\n\ninterface IExecutionSessionContainerProps {\n  pipeline: ExecutionSessionContainerPipelineFragment;\n  partitionSets: ExecutionSessionContainerPartitionSetsFragment;\n  pipelineMode?: string;\n  repoAddress: RepoAddress;\n}\n\ninterface IExecutionSessionContainerState {\n  preview: PreviewConfigQuery | null;\n  previewLoading: boolean;\n  previewedDocument: any | null;\n  configLoading: boolean;\n  editorHelpContext: ConfigEditorHelpContext | null;\n  showWhitespace: boolean;\n  tagEditorOpen: boolean;\n}\n\ntype Action =\n  | {type: 'preview-loading'; payload: boolean}\n  | {\n      type: 'set-preview';\n      payload: {\n        preview: PreviewConfigQuery | null;\n        previewLoading: boolean;\n        previewedDocument: any | null;\n      };\n    }\n  | {type: 'toggle-tag-editor'; payload: boolean}\n  | {type: 'toggle-config-loading'; payload: boolean}\n  | {type: 'set-editor-help-context'; payload: ConfigEditorHelpContext | null}\n  | {type: 'toggle-whitepsace'; payload: boolean};\n\nconst reducer = (state: IExecutionSessionContainerState, action: Action) => {\n  switch (action.type) {\n    case 'preview-loading':\n      return {...state, previewLoading: action.payload};\n    case 'set-preview': {\n      const {preview, previewedDocument, previewLoading} = action.payload;\n      return {\n        ...state,\n        preview,\n        previewedDocument,\n        previewLoading,\n      };\n    }\n    case 'toggle-tag-editor':\n      return {...state, tagEditorOpen: action.payload};\n    case 'toggle-config-loading':\n      return {...state, configLoading: action.payload};\n    case 'set-editor-help-context':\n      return {...state, editorHelpContext: action.payload};\n    case 'toggle-whitepsace':\n      return {...state, showWhitespace: action.payload};\n    default:\n      return state;\n  }\n};\n\nconst initialState: IExecutionSessionContainerState = {\n  preview: null,\n  previewLoading: false,\n  previewedDocument: null,\n  configLoading: false,\n  showWhitespace: true,\n  editorHelpContext: null,\n  tagEditorOpen: false,\n};\n\nconst ExecutionSessionContainer: React.FC<IExecutionSessionContainerProps> = (props) => {\n  const {partitionSets, pipeline, pipelineMode, repoAddress} = props;\n\n  const client = useApolloClient();\n  const [state, dispatch] = React.useReducer(reducer, initialState);\n\n  const mounted = React.useRef<boolean>(false);\n  const editor = React.useRef<ConfigEditor | null>(null);\n  const editorSplitPanelContainer = React.useRef<SplitPanelContainer | null>(null);\n  const previewCounter = React.useRef(0);\n  const {flagPipelineModeTuples} = useFeatureFlags();\n\n  const {presets} = pipeline;\n\n  const initialDataForMode = React.useMemo(() => {\n    if (flagPipelineModeTuples) {\n      const presetsForMode = presets.filter((preset) => preset.mode === pipelineMode);\n      const partitionSetsForMode = partitionSets.results.filter(\n        (partitionSet) => partitionSet.mode === pipelineMode,\n      );\n\n      if (presetsForMode.length === 1 && partitionSetsForMode.length === 0) {\n        return {runConfigYaml: presetsForMode[0].runConfigYaml};\n      }\n\n      if (!presetsForMode.length && partitionSetsForMode.length === 1) {\n        return {base: {partitionsSetName: partitionSetsForMode[0].name, partitionName: null}};\n      }\n    }\n\n    return {};\n  }, [flagPipelineModeTuples, partitionSets, pipelineMode, presets]);\n\n  const [data, onSave] = useStorage(\n    repoAddress.name || '',\n    flagPipelineModeTuples ? `${pipeline.name}:${pipelineMode}` : pipeline.name,\n    initialDataForMode,\n  );\n\n  const currentSession = data.sessions[data.current];\n\n  const pipelineSelector = {\n    ...repoAddressToSelector(repoAddress),\n    pipelineName: pipeline.name,\n    solidSelection: currentSession?.solidSelection || undefined,\n  };\n\n  const configResult = useQuery<PipelineExecutionConfigSchemaQuery>(\n    PIPELINE_EXECUTION_CONFIG_SCHEMA_QUERY,\n    {\n      variables: {selector: pipelineSelector, mode: currentSession?.mode},\n      fetchPolicy: 'cache-and-network',\n      partialRefetch: true,\n    },\n  );\n\n  const configSchemaOrError = configResult?.data?.runConfigSchemaOrError;\n\n  React.useEffect(() => {\n    mounted.current = true;\n    return () => {\n      mounted.current = false;\n    };\n  });\n\n  const onSaveSession = (changes: IExecutionSessionChanges) => {\n    onSave(applyChangesToSession(data, data.current, changes));\n  };\n\n  const onConfigChange = (config: any) => {\n    onSaveSession({\n      runConfigYaml: config,\n    });\n  };\n\n  const onSolidSelectionChange = (\n    solidSelection: string[] | null,\n    solidSelectionQuery: string | null,\n  ) => {\n    onSaveSession({\n      solidSelection,\n      solidSelectionQuery,\n    });\n  };\n\n  const onModeChange = (mode: string) => {\n    onSaveSession({mode});\n  };\n\n  const onRemoveExtraPaths = (paths: string[]) => {\n    const deletePropertyPath = (obj: any, path: string) => {\n      const parts = path.split('.');\n\n      // Here we iterate through the parts of the path to get to\n      // the second to last nested object. This is so we can call `delete` using\n      // this object and the last part of the path.\n      for (let i = 0; i < parts.length - 1; i++) {\n        obj = obj[parts[i]];\n        if (typeof obj === 'undefined') {\n          return;\n        }\n      }\n\n      const lastKey = parts.pop();\n      if (lastKey) {\n        delete obj[lastKey];\n      }\n    };\n\n    let runConfigData = {};\n    try {\n      // Note: parsing `` returns null rather than an empty object,\n      // which is preferable for representing empty config.\n      runConfigData = yaml.parse(currentSession.runConfigYaml || '') || {};\n\n      for (const path of paths) {\n        deletePropertyPath(runConfigData, path);\n      }\n\n      const runConfigYaml = yaml.stringify(runConfigData);\n      onSaveSession({runConfigYaml});\n    } catch (err) {\n      showCustomAlert({title: 'Invalid YAML', body: YAML_SYNTAX_INVALID});\n      return;\n    }\n  };\n\n  const runConfigSchema =\n    configSchemaOrError?.__typename === 'RunConfigSchema' ? configSchemaOrError : undefined;\n  const modeError =\n    configSchemaOrError?.__typename === 'ModeNotFoundError' ? configSchemaOrError : undefined;\n\n  const onScaffoldMissingConfig = () => {\n    const config = runConfigSchema ? scaffoldPipelineConfig(runConfigSchema) : {};\n    try {\n      // Note: parsing `` returns null rather than an empty object,\n      // which is preferable for representing empty config.\n      const runConfigData = yaml.parse(currentSession.runConfigYaml || '') || {};\n\n      const updatedRunConfigData = merge(config, runConfigData);\n      const runConfigYaml = yaml.stringify(updatedRunConfigData);\n      onSaveSession({runConfigYaml});\n    } catch (err) {\n      showCustomAlert({title: 'Invalid YAML', body: YAML_SYNTAX_INVALID});\n    }\n  };\n\n  const buildExecutionVariables = () => {\n    if (!currentSession) {\n      return;\n    }\n    const mode = pipelineMode || currentSession.mode;\n    if (!mode) {\n      return;\n    }\n    const tags = currentSession.tags || [];\n    let runConfigData = {};\n    try {\n      // Note: parsing `` returns null rather than an empty object,\n      // which is preferable for representing empty config.\n      runConfigData = yaml.parse(currentSession.runConfigYaml || '') || {};\n    } catch (err) {\n      showCustomAlert({title: 'Invalid YAML', body: YAML_SYNTAX_INVALID});\n      return;\n    }\n\n    return {\n      executionParams: {\n        runConfigData,\n        selector: pipelineSelector,\n        mode,\n        executionMetadata: {\n          tags: [\n            ...tags.map((tag) => ({key: tag.key, value: tag.value})),\n            // pass solid selection query via tags\n            // clean up https://github.com/dagster-io/dagster/issues/2495\n            ...(currentSession.solidSelectionQuery\n              ? [\n                  {\n                    key: DagsterTag.SolidSelection,\n                    value: currentSession.solidSelectionQuery,\n                  },\n                ]\n              : []),\n            ...(currentSession?.base?.['presetName']\n              ? [\n                  {\n                    key: DagsterTag.PresetName,\n                    value: currentSession?.base?.['presetName'],\n                  },\n                ]\n              : []),\n          ],\n        },\n      },\n    };\n  };\n\n  const saveTags = (tags: PipelineRunTag[]) => {\n    const tagDict = {};\n    const toSave: PipelineRunTag[] = [];\n    tags.forEach((tag: PipelineRunTag) => {\n      if (!(tag.key in tagDict)) {\n        tagDict[tag.key] = tag.value;\n        toSave.push(tag);\n      }\n    });\n    onSaveSession({tags: toSave});\n  };\n\n  const checkConfig = async (configJSON: Record<string, unknown>) => {\n    // Another request to preview a newer document may be made while this request\n    // is in flight, in which case completion of this async method should not set loading=false.\n    previewCounter.current += 1;\n    const currentPreviewCount = previewCounter.current;\n\n    dispatch({type: 'preview-loading', payload: true});\n\n    const {data} = await client.query<PreviewConfigQuery, PreviewConfigQueryVariables>({\n      fetchPolicy: 'no-cache',\n      query: PREVIEW_CONFIG_QUERY,\n      variables: {\n        runConfigData: configJSON,\n        pipeline: pipelineSelector,\n        mode: pipelineMode || currentSession.mode || 'default',\n      },\n    });\n\n    if (mounted.current) {\n      const isLatestRequest = currentPreviewCount === previewCounter.current;\n      dispatch({\n        type: 'set-preview',\n        payload: {\n          preview: data,\n          previewedDocument: configJSON,\n          previewLoading: isLatestRequest ? false : state.previewLoading,\n        },\n      });\n    }\n\n    return responseToYamlValidationResult(configJSON, data.isPipelineConfigValid);\n  };\n\n  const onSelectPreset = async (preset: Preset) => {\n    const tagsDict: {[key: string]: string} = [...(pipeline?.tags || []), ...preset.tags].reduce(\n      (tags, kv) => {\n        tags[kv.key] = kv.value;\n        return tags;\n      },\n      {},\n    );\n\n    onSaveSession({\n      base: {presetName: preset.name},\n      name: preset.name,\n      runConfigYaml: preset.runConfigYaml || '',\n      solidSelection: preset.solidSelection,\n      solidSelectionQuery: preset.solidSelection === null ? '*' : preset.solidSelection.join(','),\n      mode: preset.mode,\n      tags: Object.entries(tagsDict).map(([key, value]) => ({key, value})),\n      needsRefresh: false,\n    });\n  };\n\n  const onSelectPartition = async (\n    repositorySelector: RepositorySelector,\n    partitionSetName: string,\n    partitionName: string,\n    sessionSolidSelection?: string[] | null,\n  ) => {\n    onConfigLoading();\n    try {\n      const {base} = currentSession;\n      const {data} = await client.query({\n        query: CONFIG_PARTITION_SELECTION_QUERY,\n        variables: {repositorySelector, partitionSetName, partitionName},\n      });\n\n      if (\n        !data ||\n        !data.partitionSetOrError ||\n        data.partitionSetOrError.__typename !== 'PartitionSet'\n      ) {\n        onConfigLoaded();\n        return;\n      }\n\n      const {partition} = data.partitionSetOrError;\n\n      let tags;\n      if (partition.tagsOrError.__typename === 'PythonError') {\n        tags = (pipeline?.tags || []).slice();\n        showCustomAlert({\n          body: <PythonErrorInfo error={partition.tagsOrError} />,\n        });\n      } else {\n        tags = [...(pipeline?.tags || []), ...partition.tagsOrError.results];\n      }\n\n      let runConfigYaml;\n      if (partition.runConfigOrError.__typename === 'PythonError') {\n        runConfigYaml = '';\n        showCustomAlert({\n          body: <PythonErrorInfo error={partition.runConfigOrError} />,\n        });\n      } else {\n        runConfigYaml = partition.runConfigOrError.yaml;\n      }\n\n      const solidSelection = sessionSolidSelection || partition.solidSelection;\n\n      onSaveSession({\n        name: partition.name,\n        base: Object.assign({}, base, {\n          partitionName: partition.name,\n        }),\n        runConfigYaml,\n        solidSelection,\n        solidSelectionQuery: solidSelection === null ? '*' : solidSelection.join(','),\n        mode: partition.mode,\n        tags,\n        needsRefresh: false,\n      });\n    } catch {}\n    onConfigLoaded();\n  };\n\n  const onRefreshConfig = async (base: SessionBase) => {\n    // Handle preset-based configuration.\n    if ('presetName' in base) {\n      const {presetName} = base;\n      const matchingPreset = pipeline.presets.find((preset) => preset.name === presetName);\n      if (matchingPreset) {\n        onSelectPreset({\n          ...matchingPreset,\n          solidSelection: currentSession.solidSelection || matchingPreset.solidSelection,\n        });\n      }\n      return;\n    }\n\n    // Otherwise, handle partition-based configuration.\n    const {partitionName, partitionsSetName} = base;\n    const repositorySelector = repoAddressToSelector(repoAddress);\n\n    // It is expected that `partitionName` is set here, since we shouldn't be showing the\n    // button at all otherwise.\n    if (partitionName) {\n      onConfigLoading();\n      await onSelectPartition(\n        repositorySelector,\n        partitionsSetName,\n        partitionName,\n        currentSession.solidSelection,\n      );\n      onConfigLoaded();\n    }\n  };\n\n  const onDismissRefreshWarning = () => {\n    onSaveSession({needsRefresh: false});\n  };\n\n  const openTagEditor = () => dispatch({type: 'toggle-tag-editor', payload: true});\n  const closeTagEditor = () => dispatch({type: 'toggle-tag-editor', payload: false});\n\n  const onConfigLoading = () => dispatch({type: 'toggle-config-loading', payload: true});\n  const onConfigLoaded = () => dispatch({type: 'toggle-config-loading', payload: false});\n\n  const onCreateSession = () => {\n    onSave(applyCreateSession(data, initialDataForMode));\n  };\n\n  const {\n    preview,\n    previewLoading,\n    previewedDocument,\n    configLoading,\n    editorHelpContext,\n    showWhitespace,\n    tagEditorOpen,\n  } = state;\n\n  const tagsFromDefinition: PipelineRunTag[] = React.useMemo(() => pipeline.tags || [], [pipeline]);\n  const tagsFromSession = React.useMemo(() => currentSession.tags || [], [currentSession]);\n  const allTags = React.useMemo(\n    () => ({fromDefinition: tagsFromDefinition, fromSession: tagsFromSession}),\n    [tagsFromDefinition, tagsFromSession],\n  );\n\n  const refreshableSessionBase = React.useMemo(() => {\n    const {base, needsRefresh} = currentSession;\n    if (\n      base &&\n      needsRefresh &&\n      ('presetName' in base || (base.partitionsSetName && base.partitionName))\n    ) {\n      return base;\n    }\n    return null;\n  }, [currentSession]);\n\n  return (\n    <>\n      <ExecutionTabs data={data} onCreate={onCreateSession} onSave={onSave} />\n      <SplitPanelContainer\n        axis={'vertical'}\n        identifier={'execution'}\n        firstMinSize={100}\n        firstInitialPercent={75}\n        first={\n          <>\n            <LoadingOverlay isLoading={configLoading} message={LOADING_CONFIG_FOR_PARTITION} />\n            <SessionSettingsBar>\n              <ConfigEditorConfigPicker\n                pipeline={pipeline}\n                pipelineMode={pipelineMode}\n                partitionSets={partitionSets.results}\n                base={currentSession.base}\n                onSaveSession={onSaveSession}\n                onSelectPreset={onSelectPreset}\n                onSelectPartition={onSelectPartition}\n                repoAddress={repoAddress}\n              />\n              <SessionSettingsSpacer />\n              <SolidSelector\n                serverProvidedSubsetError={\n                  preview?.isPipelineConfigValid.__typename === 'InvalidSubsetError'\n                    ? preview.isPipelineConfigValid\n                    : undefined\n                }\n                pipelineName={pipeline.name}\n                value={currentSession.solidSelection || null}\n                query={currentSession.solidSelectionQuery || null}\n                onChange={onSolidSelectionChange}\n                repoAddress={repoAddress}\n              />\n              {pipelineMode ? (\n                <span />\n              ) : (\n                <>\n                  <SessionSettingsSpacer />\n                  <ConfigEditorModePicker\n                    modes={pipeline.modes}\n                    modeError={modeError}\n                    onModeChange={onModeChange}\n                    modeName={currentSession.mode}\n                  />\n                </>\n              )}\n              {tagsFromSession.length ? null : (\n                <Box margin={{left: 12}}>\n                  <ShortcutHandler\n                    shortcutLabel={'⌥T'}\n                    shortcutFilter={(e) => e.keyCode === 84 && e.altKey}\n                    onShortcut={openTagEditor}\n                  >\n                    <ButtonLink\n                      color={{link: Colors.GRAY3, hover: Colors.DARK_GRAY3}}\n                      onClick={openTagEditor}\n                      underline=\"always\"\n                    >\n                      + Add tags\n                    </ButtonLink>\n                  </ShortcutHandler>\n                </Box>\n              )}\n              <TagEditor\n                tagsFromDefinition={tagsFromDefinition}\n                tagsFromSession={tagsFromSession}\n                onChange={saveTags}\n                open={tagEditorOpen}\n                onRequestClose={closeTagEditor}\n              />\n              <div style={{flex: 1}} />\n              <Button\n                icon=\"paragraph\"\n                small={true}\n                active={showWhitespace}\n                style={{marginLeft: 'auto'}}\n                onClick={() => dispatch({type: 'toggle-whitepsace', payload: !showWhitespace})}\n              />\n              <SessionSettingsSpacer />\n              <SecondPanelToggle axis=\"horizontal\" container={editorSplitPanelContainer} />\n            </SessionSettingsBar>\n            {allTags.fromDefinition.length || allTags.fromSession.length ? (\n              <TagContainer tags={allTags} onRequestEdit={openTagEditor} />\n            ) : null}\n            {refreshableSessionBase ? (\n              <Box\n                padding={{vertical: 8, horizontal: 12}}\n                border={{side: 'bottom', width: 1, color: Colors.LIGHT_GRAY1}}\n              >\n                <Group direction=\"row\" spacing={8} alignItems=\"center\">\n                  <IconWIP name=\"warning\" color={ColorsWIP.Yellow500} />\n                  <div>\n                    Your repository has been manually refreshed, and this configuration may now be\n                    out of date.\n                  </div>\n                  <Button\n                    small\n                    intent=\"primary\"\n                    onClick={() => onRefreshConfig(refreshableSessionBase)}\n                    disabled={state.configLoading}\n                  >\n                    Refresh config\n                  </Button>\n                  <Button small onClick={onDismissRefreshWarning}>\n                    Dismiss\n                  </Button>\n                </Group>\n              </Box>\n            ) : null}\n            <SplitPanelContainer\n              ref={editorSplitPanelContainer}\n              axis=\"horizontal\"\n              identifier=\"execution-editor\"\n              firstMinSize={100}\n              firstInitialPercent={70}\n              first={\n                <ConfigEditor\n                  ref={editor}\n                  readOnly={false}\n                  runConfigSchema={runConfigSchema}\n                  configCode={currentSession.runConfigYaml}\n                  onConfigChange={onConfigChange}\n                  onHelpContextChange={(next) => {\n                    if (!isHelpContextEqual(editorHelpContext, next)) {\n                      dispatch({type: 'set-editor-help-context', payload: next});\n                    }\n                  }}\n                  showWhitespace={showWhitespace}\n                  checkConfig={checkConfig}\n                />\n              }\n              second={\n                <ConfigEditorHelp\n                  context={editorHelpContext}\n                  allInnerTypes={runConfigSchema?.allConfigTypes || []}\n                />\n              }\n            />\n          </>\n        }\n        second={\n          <>\n            <LoadingOverlay\n              isLoading={previewLoading}\n              message={!runConfigSchema ? LOADING_CONFIG_SCHEMA : LOADING_RUN_PREVIEW}\n            />\n            <RunPreview\n              document={previewedDocument}\n              validation={preview ? preview.isPipelineConfigValid : null}\n              solidSelection={currentSession.solidSelection}\n              runConfigSchema={runConfigSchema}\n              onHighlightPath={(path) => editor.current?.moveCursorToPath(path)}\n              onRemoveExtraPaths={(paths) => onRemoveExtraPaths(paths)}\n              onScaffoldMissingConfig={onScaffoldMissingConfig}\n            />\n          </>\n        }\n      />\n      <div style={{position: 'absolute', bottom: 14, right: 14, zIndex: 1}}>\n        <LaunchRootExecutionButton\n          pipelineName={pipeline.name}\n          getVariables={buildExecutionVariables}\n          disabled={preview?.isPipelineConfigValid?.__typename !== 'PipelineConfigValidationValid'}\n        />\n      </div>\n    </>\n  );\n};\n\n// Imported via React.lazy, which requires a default export.\n// eslint-disable-next-line import/no-default-export\nexport default ExecutionSessionContainer;\n\nconst PREVIEW_CONFIG_QUERY = gql`\n  query PreviewConfigQuery(\n    $pipeline: PipelineSelector!\n    $runConfigData: RunConfigData!\n    $mode: String!\n  ) {\n    isPipelineConfigValid(pipeline: $pipeline, runConfigData: $runConfigData, mode: $mode) {\n      ...ConfigEditorValidationFragment\n      ...RunPreviewValidationFragment\n    }\n  }\n  ${RUN_PREVIEW_VALIDATION_FRAGMENT}\n  ${CONFIG_EDITOR_VALIDATION_FRAGMENT}\n`;\n\nconst SessionSettingsSpacer = styled.div`\n  width: 5px;\n`;\n\nconst RUN_CONFIG_SCHEMA_OR_ERROR_FRAGMENT = gql`\n  fragment ExecutionSessionContainerRunConfigSchemaFragment on RunConfigSchemaOrError {\n    __typename\n    ... on RunConfigSchema {\n      ...ConfigEditorRunConfigSchemaFragment\n    }\n    ... on ModeNotFoundError {\n      message\n    }\n  }\n  ${CONFIG_EDITOR_RUN_CONFIG_SCHEMA_FRAGMENT}\n`;\n\nconst PIPELINE_EXECUTION_CONFIG_SCHEMA_QUERY = gql`\n  query PipelineExecutionConfigSchemaQuery($selector: PipelineSelector!, $mode: String) {\n    runConfigSchemaOrError(selector: $selector, mode: $mode) {\n      ...ExecutionSessionContainerRunConfigSchemaFragment\n    }\n  }\n\n  ${RUN_CONFIG_SCHEMA_OR_ERROR_FRAGMENT}\n`;\n"],"sourceRoot":""}